<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Mambo</title>
  
  <subtitle>Today I Learned ğŸ”¥</subtitle>
  <link href="https://kdevkr.github.io/atom.xml" rel="self"/>
  
  <link href="https://kdevkr.github.io/"/>
  <updated>2024-06-28T15:32:50.104Z</updated>
  <id>https://kdevkr.github.io/</id>
  
  <author>
    <name>Mambo</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Spring AI + Ollama</title>
    <link href="https://kdevkr.github.io/spring-ai-with-ollama/"/>
    <id>https://kdevkr.github.io/spring-ai-with-ollama/</id>
    <published>2024-06-28T14:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.104Z</updated>
    
    <content type="html"><![CDATA[<p>Spring AI í”„ë¡œì íŠ¸ì—ì„œ OpenAIì˜ ChatGPT ë˜ëŠ” Anthropicì˜ Claudeë¥¼ ì§€ì›í•˜ì§€ë§Œ ë¡œì»¬ ë¨¸ì‹ ì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” Ollamaë„ ì§€ì›í•˜ê³  ìˆë‹¤.<br>ë‚´ ì»´í“¨í„°ì— Ollamaë¥¼ ì„¤ì¹˜í•˜ê³  íŒŒë¼ë¯¸í„°ê°€ ì‘ì€ ëª¨ë¸ì„ ì„ íƒí•´ì„œ ê°„ë‹¨í•˜ê²Œ AI ì—”ì§€ë‹ˆì–´ë§ì„ í•´ë³´ë„ë¡ í•˜ë ¤ê³  í•œë‹¤. </p><h4 id="ìœˆë„ìš°-Ollama-ì„¤ì¹˜"><a href="#ìœˆë„ìš°-Ollama-ì„¤ì¹˜" class="headerlink" title="ìœˆë„ìš° Ollama ì„¤ì¹˜"></a>ìœˆë„ìš° Ollama ì„¤ì¹˜</h4><p><a href="https://ollama.com/download/windows">Download for Windows (Preview)</a>ë¥¼ í†µí•´ ìœˆë„ìš° ì»´í“¨í„°ì— Ollamaë¥¼ ì„¤ì¹˜í•˜ê³  ì‚¬ìš©ê°€ëŠ¥í•œ <a href="https://ollama.com/library">ëª¨ë¸</a> ì¤‘ì—ì„œ íŒŒë¼ë¯¸í„°ê°€ ì‘ì€ ëª¨ë¸ ì¤‘ í•˜ë‚˜ì¸ <a href="https://ollama.com/library/phi3">phi3</a>ë¥¼ ì„ íƒí•´ë³´ì.<br>ì¼ë°˜ì ì¸ ì˜ˆì‹œì—ì„œëŠ” <a href="https://ollama.com/library/mistral">mistral</a>ë¥¼ ì„¤ì¹˜í•´ì„œ ì‚¬ìš©í•´ë³´ëŠ” ê²ƒ ê°™ë‹¤. ì•„ë¬´íŠ¼, <code>ollama run phi3</code> ëª…ë ¹ì–´ë¡œ ëª¨ë¸ì„ ì„¤ì¹˜í•  ìˆ˜ ìˆë‹¤.</p><pre class="language-ps" data-language="ps"><code class="language-ps">PS C:\Users\Mambo\ollama&gt; ollama run phi3pulling manifestpulling b26e6713dc74... 100% â–•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– 2.4 GBpulling fa8235e5b48f... 100% â–•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– 1.1 KBpulling 542b217f179c... 100% â–•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  148 Bpulling 8dde1baf1db0... 100% â–•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   78 Bpulling f91db7a2deb9... 100% â–•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  485 Bverifying sha256 digestwriting manifestremoving any unused layerssuccess</code></pre><h4 id="Open-WebUI-ì„¤ì¹˜"><a href="#Open-WebUI-ì„¤ì¹˜" class="headerlink" title="Open WebUI ì„¤ì¹˜"></a>Open WebUI ì„¤ì¹˜</h4><p>Spring AIì™€ëŠ” ìƒê´€ì—†ì§€ë§Œ ChatGPTì™€ ê°™ì€ AI ì„œë¹„ìŠ¤ì²˜ëŸ¼ Ollamaì™€ ì—°ë™ì´ ê°€ëŠ¥í•œ <a href="https://openwebui.com/">Open WebUI</a>ë¥¼ ì„¤ì¹˜í•´ë³´ì•˜ë‹¤. </p><pre class="language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">services</span><span class="token punctuation">:</span>  <span class="token key atrule">open-webui</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> ghcr.io/open<span class="token punctuation">-</span>webui/open<span class="token punctuation">-</span>webui<span class="token punctuation">:</span>main    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> open<span class="token punctuation">-</span>webui    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"3000:8080"</span>    <span class="token key atrule">environment</span><span class="token punctuation">:</span>      <span class="token key atrule">OLLAMA_BASE_URL</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//host.docker.internal<span class="token punctuation">:</span><span class="token number">11434</span>      <span class="token key atrule">WEBUI_AUTH</span><span class="token punctuation">:</span> <span class="token boolean important">False</span>    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> open<span class="token punctuation">-</span>webui<span class="token punctuation">:</span>/app/backend/data    <span class="token key atrule">extra_hosts</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> host.docker.internal<span class="token punctuation">:</span>host<span class="token punctuation">-</span>gateway    <span class="token key atrule">restart</span><span class="token punctuation">:</span> unless<span class="token punctuation">-</span>stopped<span class="token key atrule">volumes</span><span class="token punctuation">:</span>  <span class="token key atrule">open-webui</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></code></pre><blockquote><p>ì €ëŠ” ì»´í“¨í„° í˜¸ìŠ¤íŠ¸ì— Ollamaë¥¼ ì„¤ì¹˜í•˜ê³  ì‹¤í–‰í•˜ì˜€ê¸°ì— host.docker.internalë¡œ ì ‘ê·¼í–ˆìŠµë‹ˆë‹¤.<br>Ollamaë¥¼ ë„ì»¤ ì»´í¬ì¦ˆë¡œ ì‹¤í–‰í•˜ê¸° ìœ„í•œ ì„¤ì •ì€ <a href="https://github.com/open-webui/open-webui/blob/main/docker-compose.yaml">docker-compose.yaml</a>ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.</p></blockquote><h4 id="Spring-AI-Ollama-Chat"><a href="#Spring-AI-Ollama-Chat" class="headerlink" title="Spring AI Ollama Chat"></a>Spring AI Ollama Chat</h4><p><a href="https://docs.spring.io/spring-ai/reference/api/chat/ollama-chat.html">OllamaChatModel</a></p><pre class="language-groovy" data-language="groovy"><div class="caption"><span>build.gradle</span></div><code class="language-groovy">repositories <span class="token punctuation">&#123;</span>    maven <span class="token punctuation">&#123;</span> url <span class="token string">'https://repo.spring.io/milestone'</span> <span class="token punctuation">&#125;</span>    maven <span class="token punctuation">&#123;</span> url <span class="token string">'https://repo.spring.io/snapshot'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>dependencies <span class="token punctuation">&#123;</span>    implementation <span class="token string">'org.springframework.ai:spring-ai-ollama-spring-boot-starter'</span><span class="token punctuation">&#125;</span>dependencyManagement <span class="token punctuation">&#123;</span>    imports <span class="token punctuation">&#123;</span>        mavenBom <span class="token interpolation-string"><span class="token string">"de.codecentric:spring-boot-admin-dependencies:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">springBootAdminVersion</span></span><span class="token string">"</span></span>        mavenBom <span class="token interpolation-string"><span class="token string">"org.springframework.ai:spring-ai-bom:1.0.0-M1"</span></span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-yaml" data-language="yaml"><div class="caption"><span>application.yml</span></div><code class="language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>  <span class="token key atrule">ai</span><span class="token punctuation">:</span>    <span class="token key atrule">ollama</span><span class="token punctuation">:</span>      <span class="token key atrule">base-url</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">11434</span>      <span class="token key atrule">chat</span><span class="token punctuation">:</span>        <span class="token key atrule">options</span><span class="token punctuation">:</span>          <span class="token key atrule">model</span><span class="token punctuation">:</span> phi3          <span class="token key atrule">temperature</span><span class="token punctuation">:</span> <span class="token number">0.9</span>    <span class="token key atrule">retry</span><span class="token punctuation">:</span>      <span class="token key atrule">max-attempts</span><span class="token punctuation">:</span> <span class="token number">1</span></code></pre><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RequiredArgsConstructor</span><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ChatApi</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">TEMPLATE</span> <span class="token operator">=</span> <span class="token triple-quoted-string string">"""            Hello ai, How many hours does &#123;timezone&#125; differ by UTC?.            """</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">OllamaChatModel</span> chatModel<span class="token punctuation">;</span>    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/ai/generate"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">generate</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">String</span> timezone<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">PromptTemplate</span> promptTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PromptTemplate</span><span class="token punctuation">(</span><span class="token constant">TEMPLATE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        promptTemplate<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"timezone"</span><span class="token punctuation">,</span> timezone<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> chatModel<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>promptTemplate<span class="token punctuation">.</span><span class="token function">createMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-txt" data-language="txt"><div class="caption"><span>AI Response</span></div><code class="language-txt">Seoul, South Korea operates on Korea Standard Time (KST), which is 9 hours ahead of Coordinated Universal Time (UTC+9). Therefore, the difference between UTC and KST in Seoul is 9 hours.To calculate this for any specific time:- If you're looking to convert a time from UTC to KST, add 9 hours.- If you're converting a time from KST back to UTC, subtract 9 hours.</code></pre><p>ê²°ì œê°€ í•„ìš”í•œ ChatGPTì™€ Claude API ëŒ€ì‹ ì— ë¡œì»¬ ë¨¸ì‹ ì— Ollamaë¥¼ ì„¤ì¹˜í•˜ê³  Spring AIë¥¼ ê°„ë‹¨í•˜ê²Œ ë‹¤ë£¨ì–´ë³´ì•˜ë‹¤.<br>ê°œì¸ì ìœ¼ë¡œ AIì— ëŒ€í•œ ì¸ì‹ì€ ì•„ì§ <strong>ì„¤ë ˆë°œ</strong>ì´ë¼ê³  ìƒê°ì´ ë˜ì§€ë§Œ AIê°€ ì„±ì¥í• ìˆ˜ë¡ <a href="https://www.promptingguide.ai/kr">í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§</a>ë„ ê°œë°œìì—ê²Œ í•„ìš”í•œ ì—­ëŸ‰ì´ ë˜ì–´ê°ˆ ìˆ˜ ìˆì–´ì„œ ì¤€ë¹„ê°€ í•„ìš”í•˜ë‹¤.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Spring AI í”„ë¡œì íŠ¸ì—ì„œ OpenAIì˜ ChatGPT ë˜ëŠ” Anthropicì˜ Claudeë¥¼ ì§€ì›í•˜ì§€ë§Œ ë¡œì»¬ ë¨¸ì‹ ì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” Ollamaë„ ì§€ì›í•˜ê³  ìˆë‹¤.&lt;br&gt;ë‚´ ì»´í“¨í„°ì— Ollamaë¥¼ ì„¤ì¹˜í•˜ê³  íŒŒë¼ë¯¸í„°ê°€ ì‘ì€ ëª¨ë¸ì„ ì„ íƒí•´ì„œ ê°„</summary>
      
    
    
    
    
    <category term="spring ai" scheme="https://kdevkr.github.io/tags/spring-ai/"/>
    
    <category term="ollama" scheme="https://kdevkr.github.io/tags/ollama/"/>
    
  </entry>
  
  <entry>
    <title>AWS EC2 ì¸ìŠ¤í„´ìŠ¤ ë©”íƒ€ë°ì´í„°</title>
    <link href="https://kdevkr.github.io/aws-ec2-instance-metadata/"/>
    <id>https://kdevkr.github.io/aws-ec2-instance-metadata/</id>
    <published>2024-06-25T13:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.100Z</updated>
    
    <content type="html"><![CDATA[<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># IMDSv1</span><span class="token function">curl</span> http://169.254.169.254/latest/dynamic/instance-identity/document<span class="token comment"># IMDSv2</span><span class="token assign-left variable">TOKEN</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">curl</span> <span class="token parameter variable">-H</span> <span class="token string">"X-aws-ec2-metadata-token-ttl-seconds: 21600"</span><span class="token variable">`</span></span> <span class="token parameter variable">-X</span> PUT <span class="token string">"http://169.254.169.254/latest/api/token"</span> <span class="token function">curl</span> <span class="token parameter variable">-H</span> <span class="token string">"X-aws-ec2-metadata-token: <span class="token variable">$TOKEN</span>"</span> http://169.254.169.254/latest/dynamic/instance-identity/document<span class="token punctuation">&#123;</span>    <span class="token string">"accountId"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,    <span class="token string">"architecture"</span><span class="token builtin class-name">:</span> <span class="token string">"arm64"</span>,    <span class="token string">"availabilityZone"</span><span class="token builtin class-name">:</span> <span class="token string">"ap-northeast-2c"</span>,    <span class="token string">"billingProducts"</span><span class="token builtin class-name">:</span> null,    <span class="token string">"devpayProductCodes"</span><span class="token builtin class-name">:</span> null,    <span class="token string">"marketplaceProductCodes"</span><span class="token builtin class-name">:</span> null,    <span class="token string">"imageId"</span><span class="token builtin class-name">:</span> <span class="token string">"ami-0331a5c9d849893dc"</span>,    <span class="token string">"instanceId"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,    <span class="token string">"instanceType"</span><span class="token builtin class-name">:</span> <span class="token string">"c6g.xlarge"</span>,    <span class="token string">"kernelId"</span><span class="token builtin class-name">:</span> null,    <span class="token string">"pendingTime"</span><span class="token builtin class-name">:</span> <span class="token string">"2024-06-23T01:01:23Z"</span>,    <span class="token string">"privateIp"</span><span class="token builtin class-name">:</span> <span class="token string">"192.169.44.196"</span>,    <span class="token string">"ramdiskId"</span><span class="token builtin class-name">:</span> null,    <span class="token string">"region"</span><span class="token builtin class-name">:</span> <span class="token string">"ap-northeast-2"</span>,    <span class="token string">"version"</span><span class="token builtin class-name">:</span> <span class="token string">"2017-09-30"</span><span class="token punctuation">&#125;</span></code></pre><p><a href="https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/instancedata-data-retrieval.html">ì¸ìŠ¤í„´ìŠ¤ ë©”íƒ€ë°ì´í„° ê²€ìƒ‰</a>ì„ í™œìš©í•´ì„œ ë™ì  ë°ì´í„°ì˜ <a href="https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/instance-identity-documents.html">ì¸ìŠ¤í„´ìŠ¤ ìê²© ì¦ëª… ë¬¸ì„œ(instance-identity&#x2F;document)</a>ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì˜ˆì‹œì´ë‹¤. ì´ë²ˆ ê¸€ì—ì„œëŠ” <code>AWS SDK for Java</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì œê³µí•˜ëŠ” <code>EC2 ë©”íƒ€ë°ì´í„° ìœ í‹¸ë¦¬í‹°</code>ë¥¼ í†µí•´ AWS EC2 ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ì‹¤í–‰ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ì—ì„œ EC2 ì¸ìŠ¤í„´ìŠ¤ ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë„ë¡ ì‘ì„±í•´ë³´ë ¤ê³  í•œë‹¤. ìŠ¤í”„ë§ ë¶€íŠ¸ ê¸°ë°˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë¼ë©´ ìŠ¤í”„ë§ ë¶€íŠ¸ ì•¡ì¶”ì—ì´í„°ì˜ <a href="https://docs.spring.io/spring-boot/reference/actuator/endpoints.html#actuator.endpoints.info">InfoContributor</a> ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ <code>EC2MetadataInfoContributor</code>ë¥¼ ë§Œë“¤ì–´ë³´ì.</p><h4 id="EC2MetadataInfoContributor-with-SDK-for-Java-1-x"><a href="#EC2MetadataInfoContributor-with-SDK-for-Java-1-x" class="headerlink" title="EC2MetadataInfoContributor with SDK for Java 1.x"></a>EC2MetadataInfoContributor with SDK for Java 1.x</h4><pre class="language-groovy" data-language="groovy"><div class="caption"><span>build.gradle</span></div><code class="language-groovy">dependencies <span class="token punctuation">&#123;</span>    <span class="token comment">// the AWS SDK for Java v1.x will enter maintenance mode on July 31, 2024, and reach end-of-support on December 31, 2025.</span>    implementation <span class="token function">platform</span><span class="token punctuation">(</span><span class="token string">'com.amazonaws:aws-java-sdk-bom:1.12.748'</span><span class="token punctuation">)</span>    implementation <span class="token string">'com.amazonaws:aws-java-sdk-ec2'</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-java" data-language="java"><div class="caption"><span>EC2MetadataInfoContributor.java</span></div><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>amazonaws<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">EC2MetadataUtils</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>actuate<span class="token punctuation">.</span>info<span class="token punctuation">.</span></span><span class="token class-name">Info</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>actuate<span class="token punctuation">.</span>info<span class="token punctuation">.</span></span><span class="token class-name">InfoContributor</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span></span><span class="token punctuation">;</span><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EC2MetadataInfoContributor</span> <span class="token keyword">implements</span> <span class="token class-name">InfoContributor</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> isRunningAwsEC2<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">EC2MetadataInfoContributor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        isRunningAwsEC2 <span class="token operator">=</span> <span class="token class-name">EC2MetadataUtils</span><span class="token punctuation">.</span><span class="token function">getInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contribute</span><span class="token punctuation">(</span><span class="token class-name">Info<span class="token punctuation">.</span>Builder</span> builder<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>isRunningAwsEC2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">EC2MetadataUtils<span class="token punctuation">.</span>InstanceInfo</span> instanceInfo <span class="token operator">=</span> <span class="token class-name">EC2MetadataUtils</span><span class="token punctuation">.</span><span class="token function">getInstanceInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            builder<span class="token punctuation">.</span><span class="token function">withDetail</span><span class="token punctuation">(</span><span class="token string">"ec2"</span><span class="token punctuation">,</span> instanceInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="EC2MetadataInfoContributor-with-SDK-for-Java-2-x"><a href="#EC2MetadataInfoContributor-with-SDK-for-Java-2-x" class="headerlink" title="EC2MetadataInfoContributor with SDK for Java 2.x"></a>EC2MetadataInfoContributor with SDK for Java 2.x</h4><pre class="language-groovy" data-language="groovy"><div class="caption"><span>build.gradle</span></div><code class="language-groovy">dependencies <span class="token punctuation">&#123;</span>    implementation <span class="token function">platform</span><span class="token punctuation">(</span><span class="token string">'software.amazon.awssdk:bom:2.21.4'</span><span class="token punctuation">)</span>    implementation <span class="token string">'software.amazon.awssdk:imds'</span>    implementation <span class="token string">'software.amazon.awssdk:url-connection-client'</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-java" data-language="java"><div class="caption"><span>EC2MetadataInfoContributorV2.java</span></div><code class="language-java">mport <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>actuate<span class="token punctuation">.</span>info<span class="token punctuation">.</span></span>Info</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>actuate<span class="token punctuation">.</span>info<span class="token punctuation">.</span></span><span class="token class-name">InfoContributor</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">software<span class="token punctuation">.</span>amazon<span class="token punctuation">.</span>awssdk<span class="token punctuation">.</span>core<span class="token punctuation">.</span>document<span class="token punctuation">.</span></span><span class="token class-name">Document</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">software<span class="token punctuation">.</span>amazon<span class="token punctuation">.</span>awssdk<span class="token punctuation">.</span>imds<span class="token punctuation">.</span></span><span class="token class-name">Ec2MetadataClient</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">software<span class="token punctuation">.</span>amazon<span class="token punctuation">.</span>awssdk<span class="token punctuation">.</span>imds<span class="token punctuation">.</span></span><span class="token class-name">Ec2MetadataResponse</span></span><span class="token punctuation">;</span><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EC2MetadataInfoContributorV2</span> <span class="token keyword">implements</span> <span class="token class-name">InfoContributor</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">boolean</span> isRunningAwsEC2<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">EC2MetadataInfoContributorV2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">Ec2MetadataClient</span> client <span class="token operator">=</span> <span class="token class-name">Ec2MetadataClient</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            isRunningAwsEC2 <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/latest/meta-data/instance-id"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">asString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ignored<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// ignored</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contribute</span><span class="token punctuation">(</span><span class="token class-name">Info<span class="token punctuation">.</span>Builder</span> builder<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>isRunningAwsEC2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">Ec2MetadataClient</span> client <span class="token operator">=</span> <span class="token class-name">Ec2MetadataClient</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">Ec2MetadataResponse</span> metadataResponse <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/latest/dynamic/instance-identity/document"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token class-name">Document</span> document <span class="token operator">=</span> metadataResponse<span class="token punctuation">.</span><span class="token function">asDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                builder<span class="token punctuation">.</span><span class="token function">withDetail</span><span class="token punctuation">(</span><span class="token string">"ec2"</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">asMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ignored<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// ignored</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="ì¸ìŠ¤í„´ìŠ¤-ë©”íƒ€ë°ì´í„°-ê²€ìƒ‰"><a href="#ì¸ìŠ¤í„´ìŠ¤-ë©”íƒ€ë°ì´í„°-ê²€ìƒ‰" class="headerlink" title="ì¸ìŠ¤í„´ìŠ¤ ë©”íƒ€ë°ì´í„° ê²€ìƒ‰"></a>ì¸ìŠ¤í„´ìŠ¤ ë©”íƒ€ë°ì´í„° ê²€ìƒ‰</h4><ol><li>SDK ë²„ì „ì— ë”°ë¼ <a href="https://docs.aws.amazon.com/ko_kr/sdk-for-java/latest/developer-guide/migration-imds.html#migration-imds-behavior-endpoint-res">SDKê°€ ì—”ë“œí¬ì¸íŠ¸ë¥¼ IMDSë¡œ í™•ì¸í•˜ê¸° ìœ„í•´ í™•ì¸í•˜ëŠ” ìœ„ì¹˜</a>ê°€ ë‹¤ë¥´ë‹¤.</li><li><a href="https://docs.aws.amazon.com/ko_kr/sdk-for-java/latest/developer-guide/migration-imds.html#migration-imds-behavior-imdsv2">Java 2.xëŠ” IMDSv2ë§Œ ì§€ì›</a>í•˜ì§€ë§Œ Java 1.xëŠ” IMDSv2 ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ì„ë•Œ IMDSv1 ìœ¼ë¡œë„ ì¡°íšŒí•œë‹¤.</li><li>Java 2.xëŠ” <a href="https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/instancedata-data-categories.html">ì¸ìŠ¤í„´ìŠ¤ ë©”íƒ€ë°ì´í„° ì¹´í…Œê³ ë¦¬</a>ë¥¼ ì§ì ‘ ëª…ì‹œí•´ì•¼í•œë‹¤.</li><li>Java 1.xëŠ” 2025ë…„ 12ì›” 31ì¼ <a href="https://aws.amazon.com/ko/blogs/developer/announcing-end-of-support-for-aws-sdk-for-java-v1-x-on-december-31-2025/">ì§€ì› ì¢…ë£Œ(End of support)</a>ëœë‹¤.</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;pre class=&quot;language-bash&quot; data-language=&quot;bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# IMDSv1&lt;/span&gt;
&lt;span class=&quot;token f</summary>
      
    
    
    
    
    <category term="IMDSv1" scheme="https://kdevkr.github.io/tags/IMDSv1/"/>
    
    <category term="IMDSv2" scheme="https://kdevkr.github.io/tags/IMDSv2/"/>
    
  </entry>
  
  <entry>
    <title>ìŠ¤í”„ë§ ë¶€íŠ¸ ë©”ì¼ í—¬ìŠ¤ì²´í¬ ìºì‹œí•˜ê¸°</title>
    <link href="https://kdevkr.github.io/spring-boot-mail-health-check/"/>
    <id>https://kdevkr.github.io/spring-boot-mail-health-check/</id>
    <published>2024-06-23T02:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.108Z</updated>
    
    <content type="html"><![CDATA[<p>í† ìŠ¤ì˜ <a href="https://toss.tech/article/how-to-work-health-check-in-spring-boot-actuator">Spring Boot Actuatorì˜ í—¬ìŠ¤ì²´í¬ ì‚´í´ë³´ê¸°</a>ë¼ëŠ” ê¸€ì„ ë³´ê³  ìŠ¤í”„ë§ ë¶€íŠ¸ ì•¡ì¶”ì—ì´í„°ì—ì„œ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ëŠ” MailHealthIndiatorì˜ í—¬ìŠ¤ ì²´í¬ ê²°ê³¼ë¥¼ ë³„ë„ë¡œ ìš”ì²­í•˜ëŠ” ê²½ìš° <code>management.endpoint.health.cache-time-to-live</code> ì†ì„±ìœ¼ë¡œ ìºì‹œë˜ì§€ ì•ŠìŒì„ í™•ì¸í–ˆë‹¤. í•´ë‹¹ ì†ì„±ì€ ì „ì²´ í—¬ìŠ¤ ì²´í¬ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ” í—¬ìŠ¤ ì—”ë“œí¬ì¸íŠ¸(&#x2F;actuator&#x2F;health)ì— í•´ë‹¹í•˜ëŠ” ìºì‹œ ì˜µì…˜ìœ¼ë¡œ ë©”ì¼ì— ëŒ€í•œ í—¬ìŠ¤ ì—”ë“œí¬ì¸íŠ¸(&#x2F;actuator&#x2F;health&#x2F;mail)ì— ëŒ€í•´ì„œëŠ” ì ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.</p><p>ìŠ¤í”„ë§ ë¶€íŠ¸ ì•¡ì¶”ì—ì´í„°ì˜ <a href="https://github.com/spring-projects/spring-boot/blob/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/mail/MailHealthIndicator.java">MailHealthIndicator</a> ëŠ” JavaMailSenderImplì˜ testConnection í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ í—¬ìŠ¤ ì²´í¬ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ë„ë¡ ì‘ì„±ë˜ì–´ìˆë‹¤. MailHealthIndicatorë¼ëŠ” ì´ë¦„ìœ¼ë¡œ HealthIIndicatorë¥¼ êµ¬í˜„í•˜ë©´ ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µí•˜ëŠ” MailHealthIndicator ëŒ€ì‹ ì— ë“±ë¡ë˜ë¯€ë¡œ SMTP ì„œë²„ë¡œì˜ ì—°ê²° ìˆ˜í–‰ ê²°ê³¼ë¥¼ ìºì‹œí•˜ì—¬ ì‘ë‹µí•˜ë„ë¡ ì‘ì„±í•´ë³¼ ìˆ˜ ìˆë‹¤.</p><h4 id="CachableMailHealthIndicator"><a href="#CachableMailHealthIndicator" class="headerlink" title="CachableMailHealthIndicator"></a>CachableMailHealthIndicator</h4><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>common<span class="token punctuation">.</span>cache<span class="token punctuation">.</span></span><span class="token class-name">Cache</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>common<span class="token punctuation">.</span>cache<span class="token punctuation">.</span></span><span class="token class-name">CacheBuilder</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span></span><span class="token class-name">InitializingBean</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>actuate<span class="token punctuation">.</span>health<span class="token punctuation">.</span></span><span class="token class-name">Health</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>actuate<span class="token punctuation">.</span>mail<span class="token punctuation">.</span></span><span class="token class-name">MailHealthIndicator</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>mail<span class="token punctuation">.</span>javamail<span class="token punctuation">.</span></span><span class="token class-name">JavaMailSenderImpl</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">Duration</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">Instant</span></span><span class="token punctuation">;</span><span class="token annotation punctuation">@Component</span><span class="token punctuation">(</span><span class="token string">"mailHealthIndicator"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CachableMailHealthIndicator</span> <span class="token keyword">extends</span> <span class="token class-name">MailHealthIndicator</span> <span class="token keyword">implements</span> <span class="token class-name">InitializingBean</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">Cache</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Health</span><span class="token punctuation">></span></span> cache<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">CachableMailHealthIndicator</span><span class="token punctuation">(</span><span class="token class-name">JavaMailSenderImpl</span> javaMailSender<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>javaMailSender<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doHealthCheck</span><span class="token punctuation">(</span><span class="token class-name">Health<span class="token punctuation">.</span>Builder</span> builder<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Health</span> cached <span class="token operator">=</span> cache <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> cache<span class="token punctuation">.</span><span class="token function">getIfPresent</span><span class="token punctuation">(</span><span class="token string">"mail"</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>cached <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            builder<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>cached<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withDetails</span><span class="token punctuation">(</span>cached<span class="token punctuation">.</span><span class="token function">getDetails</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">doHealthCheck</span><span class="token punctuation">(</span>builder<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            builder<span class="token punctuation">.</span><span class="token function">down</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>cache <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Health</span> health <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">withDetail</span><span class="token punctuation">(</span><span class="token string">"datetime"</span><span class="token punctuation">,</span> <span class="token class-name">Instant</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"mail"</span><span class="token punctuation">,</span> health<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        cache <span class="token operator">=</span> <span class="token class-name">CacheBuilder</span><span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">maximumSize</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">expireAfterWrite</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img data-src="/images/posts/spring-boot-mail-health-check/01.png" alt="268ms â†’ 4ms"></p><blockquote><p>CacheableMailHealthIndicatorëŠ” í˜¸ìŠ¤íŠ¸ ì •ë³´ ë¿ë§Œ ì•„ë‹ˆë¼ <strong>ìºì‹œëœ ì‹œê°„</strong>ì„ í¬í•¨í•˜ì—¬ ì–¸ì œ ì¸¡ì •ëœ ê²°ê³¼ì¸ì§€ë„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;í† ìŠ¤ì˜ &lt;a href=&quot;https://toss.tech/article/how-to-work-health-check-in-spring-boot-actuator&quot;&gt;Spring Boot Actuatorì˜ í—¬ìŠ¤ì²´í¬ ì‚´í´ë³´ê¸°&lt;/a&gt;ë¼ëŠ” ê¸€ì„ ë³´ê³  ìŠ¤í”„ë§ </summary>
      
    
    
    
    
    <category term="Spring Boot Actuator" scheme="https://kdevkr.github.io/tags/Spring-Boot-Actuator/"/>
    
    <category term="MailHealthIndicator" scheme="https://kdevkr.github.io/tags/MailHealthIndicator/"/>
    
  </entry>
  
  <entry>
    <title>Redis Stream</title>
    <link href="https://kdevkr.github.io/spring-boot-data-redis-stream/"/>
    <id>https://kdevkr.github.io/spring-boot-data-redis-stream/</id>
    <published>2024-06-22T03:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.108Z</updated>
    
    <content type="html"><![CDATA[<p>ì†Œê·œëª¨ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ì—ì„œ ë ˆë””ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì„ë•Œ RabbitMQ ë˜ëŠ” Apache Kafkaì™€ ê°™ì€ ë©”ì‹œì§€ íë¥¼ í†µí•´ ë¹„ë™ê¸° ì´ë²¤íŠ¸ì— ëŒ€í•œ ìš”êµ¬ê°€ í•„ìš”í•œ ê²½ìš° ë³„ë„ì˜ ë©”ì‹œì§€ í ì†”ë£¨ì…˜ì„ ë„ì…í•˜ëŠ” ê²ƒì€ ì¸í”„ë¼ ìƒ ê³¼ë„í•  ìˆ˜ë„ ìˆë‹¤. ì´ëŸ¬í•œ ê²½ìš° ë ˆë””ìŠ¤ì—ì„œ ì œê³µí•˜ëŠ” ìŠ¤íŠ¸ë¦¼ì„ ì‚¬ìš©í•˜ì—¬ ë©”ì‹œì§€ ê¸°ë°˜ì˜ í”„ë¡œê·¸ë˜ë°ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ”ë° ìŠ¤í”„ë§ ë¶€íŠ¸ ê¸°ë°˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì¸ ê²½ìš° <a href="https://spring.io/projects/spring-data-redis">Spring Data Redis</a>ì— <a href="https://docs.spring.io/spring-data/redis/reference/redis/redis-streams.html">ë ˆë””ìŠ¤ ìŠ¤íŠ¸ë¦¼ì— ëŒ€í•œ ê¸°ëŠ¥</a>ì„ í¬í•¨í•˜ê³  ìˆìœ¼ë¯€ë¡œ ì‰½ê²Œ ìŠ¤íŠ¸ë¦¼ì— ë©”ì‹œì§€ë¥¼ ë“±ë¡í•˜ê³  ì»¨ìŠˆë¨¸ë¥¼ ì¶”ê°€í•˜ì—¬ ë©”ì‹œì§€ë¥¼ ìˆ˜ì‹ í•˜ë„ë¡ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.</p><h4 id="ë©”ì‹œì§€-ì—†ëŠ”-ë¹ˆ-ìŠ¤íŠ¸ë¦¼-ìƒì„±í•˜ê¸°"><a href="#ë©”ì‹œì§€-ì—†ëŠ”-ë¹ˆ-ìŠ¤íŠ¸ë¦¼-ìƒì„±í•˜ê¸°" class="headerlink" title="ë©”ì‹œì§€ ì—†ëŠ” ë¹ˆ ìŠ¤íŠ¸ë¦¼ ìƒì„±í•˜ê¸°"></a>ë©”ì‹œì§€ ì—†ëŠ” ë¹ˆ ìŠ¤íŠ¸ë¦¼ ìƒì„±í•˜ê¸°</h4><pre class="language-bash" data-language="bash"><code class="language-bash">XGROUP CREATE stream_key group_name $ MKSTREAM</code></pre><p>ê¸°ë³¸ì ì¸ ë ˆë””ìŠ¤ ëª…ë ¹ì–´ë¡œëŠ” ìœ„ì™€ ê°™ì´ ì»¨ìŠˆë¨¸ ê·¸ë£¹ì„ ìƒì„±í•  ë•Œ MKSTREAM ì˜µì…˜ì„ ì§€ì •í•˜ì—¬ ìŠ¤íŠ¸ë¦¼ì´ ì¡´ì¬í•˜ì§€ ì•Šì€ ê²½ìš°ì— ìŠ¤íŠ¸ë¦¼ì´ ìë™ìœ¼ë¡œ ìƒì„±ë˜ë„ë¡ í•  ìˆ˜ ìˆë‹¤. Spring Data Redis ì—ì„œëŠ” RedisConnection ê³¼ RedisStreamCommands ì¸í„°í˜ì´ìŠ¤ì— xGroupCreate ë¼ëŠ” í•¨ìˆ˜ë¡œ ì •ì˜ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ì•„ë˜ì™€ ê°™ì´ êµ¬í˜„í•˜ë©´ ëœë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> streamKey <span class="token operator">=</span> <span class="token string">"stream-1"</span><span class="token punctuation">;</span><span class="token class-name">String</span> groupName <span class="token operator">=</span> <span class="token string">"group-1"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">.</span><span class="token constant">TRUE</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>redisTemplate<span class="token punctuation">.</span><span class="token function">hasKey</span><span class="token punctuation">(</span>streamKey<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    redisTemplate<span class="token punctuation">.</span><span class="token function">opsForStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createGroup</span><span class="token punctuation">(</span>streamKey<span class="token punctuation">,</span> <span class="token class-name">ReadOffset</span><span class="token punctuation">.</span><span class="token function">lastConsumed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> groupName<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">RedisConnection</span> connection <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">getConnectionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">RedisStreamCommands</span> streamCommands <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">streamCommands</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    streamCommands<span class="token punctuation">.</span><span class="token function">xGroupCreate</span><span class="token punctuation">(</span>streamKey<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> groupName<span class="token punctuation">,</span> <span class="token class-name">ReadOffset</span><span class="token punctuation">.</span><span class="token function">latest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="StreamMessageListenerContainer"><a href="#StreamMessageListenerContainer" class="headerlink" title="StreamMessageListenerContainer"></a>StreamMessageListenerContainer</h4><p>StreamMessageListenerContainer ì™€ StreamListener ë¥¼ í™œìš©í•˜ë©´ RedisTemplate ìœ¼ë¡œ ìŠ¤íŠ¸ë¦¼ì„ ì§ì ‘ ì½ì§€ ì•Šì•„ë„ ë‹¤ì¤‘ ìŠ¤ë ˆë“œë¥¼ í†µí•´ ë©”ì‹œì§€ë¥¼ ìˆ˜ì‹ í•˜ì—¬ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. </p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">StreamMessageListenerContainer</span> messageListenerContainer <span class="token operator">=</span> <span class="token class-name">StreamMessageListenerContainer</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>redisTemplate<span class="token punctuation">.</span><span class="token function">getConnectionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token class-name">StreamMessageListenerContainer<span class="token punctuation">.</span>StreamMessageListenerContainerOptions</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">hashKeySerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">hashValueSerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Consumer</span> consumer <span class="token operator">=</span> <span class="token class-name">Consumer</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>groupName<span class="token punctuation">,</span> consumerName<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">StreamOffset</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> streamOffset <span class="token operator">=</span> <span class="token class-name">StreamOffset</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>streamKey<span class="token punctuation">,</span> <span class="token class-name">ReadOffset</span><span class="token punctuation">.</span><span class="token function">lastConsumed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Subscription</span> subscription <span class="token operator">=</span> messageListenerContainer<span class="token punctuation">.</span><span class="token function">receiveAutoAck</span><span class="token punctuation">(</span>consumer<span class="token punctuation">,</span> streamOffset<span class="token punctuation">,</span> record <span class="token operator">-></span> <span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>subscription<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>messageListenerContainer<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ì†Œê·œëª¨ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ì—ì„œ ë ˆë””ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì„ë•Œ RabbitMQ ë˜ëŠ” Apache Kafkaì™€ ê°™ì€ ë©”ì‹œì§€ íë¥¼ í†µí•´ ë¹„ë™ê¸° ì´ë²¤íŠ¸ì— ëŒ€í•œ ìš”êµ¬ê°€ í•„ìš”í•œ ê²½ìš° ë³„ë„ì˜ ë©”ì‹œì§€ í ì†”ë£¨ì…˜ì„ ë„ì…í•˜ëŠ” ê²ƒì€ ì¸í”„ë¼ ìƒ ê³¼ë„í•  ìˆ˜ë„ ìˆë‹¤. ì´ëŸ¬í•œ ê²½</summary>
      
    
    
    
    
    <category term="Redis Stream" scheme="https://kdevkr.github.io/tags/Redis-Stream/"/>
    
  </entry>
  
  <entry>
    <title>AWS RDS ìŠ¬ë¡œìš° ì¿¼ë¦¬ ë¡œê·¸ì˜ ì»¤ì„œ ì´ë¦„ ì´ìŠˆ</title>
    <link href="https://kdevkr.github.io/aws-rds-slow-query-with-cursor-name./"/>
    <id>https://kdevkr.github.io/aws-rds-slow-query-with-cursor-name./</id>
    <published>2024-06-20T13:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.100Z</updated>
    
    <content type="html"><![CDATA[<p><img data-src="/images/posts/aws-rds-slow-query-with-cursor-name/01.png"></p><p>ìœ„ ìŠ¤í¬ë¦°ìƒ·ì˜ 14ì‹œì™€ 15ì‹œ ì‚¬ì´ì— RDS ì˜ DB ì¸ìŠ¤í„´ìŠ¤ì˜ CPU ë¶€í•˜ê°€ 90% ì´ìƒì„ ì´ˆê³¼í–ˆë‹¤. ì´ëŸ¬í•œ ìƒí™©ì˜ ê²½ìš° ì–´ë–¤ í˜¸ìŠ¤íŠ¸ì—ì„œ ìˆ˜í–‰í•œ ì¿¼ë¦¬ê°€ ë¬¸ì œê°€ ë˜ê³  ìˆëŠ”ì§€ ì•Œê¸° ìœ„í•´ì„œ AWS Aurora PostgreSQLì˜ í´ëŸ¬ìŠ¤í„° ë˜ëŠ” ì¸ìŠ¤í„´ìŠ¤ íŒŒë¼ë¯¸í„°ë¥¼ ë³€ê²½í•˜ì—¬ <a href="https://docs.aws.amazon.com/ko_kr/AmazonRDS/latest/AuroraUserGuide/USER_LogAccess.Concepts.PostgreSQL.html#USER_LogAccess.Concepts.PostgreSQL.Query_Logging">ì¿¼ë¦¬ ë¡œê¹…ì„ í™œì„±í™”</a>í•˜ê³  <a href="https://docs.aws.amazon.com/ko_kr/prescriptive-guidance/latest/tuning-postgresql-parameters/log-min-duration-statement.html">log_min_duration_statement</a>ì— ëŒ€í•œ ê°’ì„ ì§€ì •í•˜ë©´ í•´ë‹¹ ë°€ë¦¬ì´ˆë¥¼ ì´ˆê³¼í•˜ì—¬ ìˆ˜í–‰í•œ ì¿¼ë¦¬ì— ëŒ€í•œ duration ë¡œê·¸ë¥¼ ê¸°ë¡í•˜ê³  CloudWatchì˜ ë¡œê·¸ ì¸ì‚¬ì´íŠ¸ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><h4 id="FETCH-ALL-IN-rcursor-ğŸ¤”"><a href="#FETCH-ALL-IN-rcursor-ğŸ¤”" class="headerlink" title="FETCH ALL IN &quot;rcursor&quot; ğŸ¤”"></a>FETCH ALL IN &quot;rcursor&quot; ğŸ¤”</h4><p><img data-src="/images/posts/aws-rds-slow-query-with-cursor-name/02.png"></p><p>RDS ì½˜ì†”ì˜ ì„±ëŠ¥ ê°œì„  ë„ìš°ë¯¸ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ ë¡œë“œì™€ ìƒìœ„ SQL ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë° ìœ„ì™€ ê°™ì´ FETCH ALL IN &quot;rcursor&quot; ê°€ ëŒ€ë¶€ë¶„ì˜ ë¡œë“œë¡œ ê¸°ë¡ë˜ì–´ìˆëŠ” ê±¸ ë³¼ ìˆ˜ ìˆë‹¤. ì‹¤ì œ SQLë¥¼ í™•ì¸í•  ìˆ˜ ìˆëŠ” ê²ƒë“¤ ì´ì™¸ì— <code>rcursor</code> ë€ ê²ƒì€ ë„ëŒ€ì²´ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ëŠ” ê²ƒì¸ì§€ ì•Œì•„ì•¼í•  ê²ƒ ê°™ë‹¤. PL&#x2F;pgSQL í•¨ìˆ˜ë¥¼ ì‘ì„±í•  ë•Œ <a href="https://www.postgresql.org/docs/current/plpgsql-cursors.html">Cursor</a>ë¥¼ ì„ ì–¸í•˜ê³  ì¡°íšŒí•œ ê²°ê³¼ë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì´ì•¼ê¸°í•˜ëŠ” í”„ë¡œì‹œì € í•¨ìˆ˜ë¥¼ ì˜ë¯¸í•˜ë©° ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©ì¤‘ì¸ ëŒ€ë¶€ë¶„ì˜ í•¨ìˆ˜ì˜ ì»¤ì„œ ì´ë¦„ì„ ë™ì¼í•˜ê²Œ ì§€ì •í•˜ì—¬ ì„ ì–¸í–ˆë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.</p><p>ê¸°ë³¸ì ìœ¼ë¡œ ì»¤ì„œ ì´ë¦„ì„ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ìë™ìœ¼ë¡œ <code>&lt;unnamed cursor 1&gt;</code>ì™€ ê°™ì€ ëœë¤í•œ ì»¤ì„œê°€ ë§Œë“¤ì–´ì§€ê³  JDBC ì—ì„œ SQL í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œ ê²°ê³¼ì—ì„œ ì»¤ì„œ ì´ë¦„ì„ êµ³ì´ ë™ì¼í•˜ê²Œ ì§€ì •í•  í•„ìš”ëŠ” ì—†ë‹¤. ë”°ë¼ì„œ, ì• í”Œë¦¬ì¼€ì´ì…˜ì€ í•¨ìˆ˜ ì •ì˜ ì‹œ ì–´ë–¤ ì´ë¦„ì˜ ì»¤ì„œë¥¼ ì‚¬ìš©í•˜ëŠ”ì§€ì— ëŒ€í•´ì„œëŠ” ìƒê´€í•˜ì§€ ì•Šìœ¼ë©° SQL í•¨ìˆ˜ë¥¼ ê´€ë¦¬í•˜ëŠ” ê°œë°œì í˜¹ì€ DBAê°€ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ì´ë¦„ì¼ ë¿ì´ë‹¤. ê·¸ë˜ì„œ ì‰½ê²Œ ê´€ë¦¬í•˜ì—¬ ì‚¬ìš©í•˜ê¸° ìœ„í•´ í†µì¼í–ˆë˜ ê²ƒìœ¼ë¡œ ìƒê°ëœë‹¤.</p><h4 id="RDS-ëª¨ë‹ˆí„°ë§ì„-ìœ„í•œ-ì»¤ì„œ-ì´ë¦„ì„-ì‚¬ìš©í•˜ì„¸ìš”"><a href="#RDS-ëª¨ë‹ˆí„°ë§ì„-ìœ„í•œ-ì»¤ì„œ-ì´ë¦„ì„-ì‚¬ìš©í•˜ì„¸ìš”" class="headerlink" title="RDS ëª¨ë‹ˆí„°ë§ì„ ìœ„í•œ ì»¤ì„œ ì´ë¦„ì„ ì‚¬ìš©í•˜ì„¸ìš”."></a>RDS ëª¨ë‹ˆí„°ë§ì„ ìœ„í•œ ì»¤ì„œ ì´ë¦„ì„ ì‚¬ìš©í•˜ì„¸ìš”.</h4><p><img data-src="/images/posts/aws-rds-slow-query-with-cursor-name/03.png"></p><p>RDS ëª¨ë‹ˆí„°ë§ ë° ìŠ¬ë¡œìš° ì¿¼ë¦¬ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ ë™ì¼í•œ ì»¤ì„œ ì´ë¦„ì´ ì•„ë‹Œ SQL í•¨ìˆ˜ë³„ ë³„ë„ì˜ ì»¤ì„œ ì´ë¦„ì„ ì •ì˜í•˜ì—¬ êµ¬ë¶„í•˜ëŠ”ê²Œ í•„ìš”í•˜ë‹¤. SQL í•¨ìˆ˜ ì‘ì„± ì‹œ ì»¤ì„œ ì´ë¦„ì€ í•¨ìˆ˜ ì´ë¦„ê³¼ ë™ì¼í•˜ê²Œ í•˜ì—¬ ëª…í™•íˆ êµ¬ë¶„í•˜ê¸°ë¡œ í˜‘ì˜í–ˆê³  ìœ„ì™€ ê°™ì´ ì˜¤ë˜ ìˆ˜í–‰ë˜ëŠ” ìŠ¬ë¡œìš° ì¿¼ë¦¬ë¥¼ ì‰½ê²Œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ê¸°ì¡´ì—ëŠ” ê°œë°œìê°€ ìŠ¬ë¡œìš° ì¿¼ë¦¬ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ì— ë¡œê·¸ê°€ ì¶œë ¥ë˜ë„ë¡ í–ˆì§€ë§Œ ì´ì œëŠ” ê°œë°œì ë¿ë§Œ ì•„ë‹ˆë¼ DB í˜¹ì€ ì¸í”„ë¼ ì—”ì§€ë‹ˆì–´ë„ RDS ëª¨ë‹ˆí„°ë§ìœ¼ë¡œ ìŠ¬ë¡œìš° ì¿¼ë¦¬ êµ¬ë¶„ì´ ê°€ëŠ¥í•˜ë„ë¡ ë³€ê²½í•˜ê³  ìˆë‹¤.</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># ì—¬ëŸ¬ë¶„ì€ ì–´ë–¤ ì¿¼ë¦¬ê°€ 2ì´ˆë‚˜ ì†Œìš”ë¬ëŠ”ì§€ íŒŒì•…í•  ìˆ˜ ìˆë‚˜ìš”?</span>LOG:  duration: <span class="token number">2217.321</span> ms  execute <span class="token operator">&lt;</span>unnamed<span class="token operator">></span>: FETCH ALL IN <span class="token string">"rcursor"</span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;img data-src=&quot;/images/posts/aws-rds-slow-query-with-cursor-name/01.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;ìœ„ ìŠ¤í¬ë¦°ìƒ·ì˜ 14ì‹œì™€ 15ì‹œ ì‚¬ì´ì— RDS ì˜ DB ì¸ìŠ¤í„´ìŠ¤ì˜ CPU ë¶€í•˜ê°€ 90% ì´ìƒì„ ì´ˆê³¼í–ˆë‹¤</summary>
      
    
    
    
    
    <category term="AWS RDS" scheme="https://kdevkr.github.io/tags/AWS-RDS/"/>
    
    <category term="PostgreSQL" scheme="https://kdevkr.github.io/tags/PostgreSQL/"/>
    
    <category term="Cursor" scheme="https://kdevkr.github.io/tags/Cursor/"/>
    
  </entry>
  
  <entry>
    <title>ìë°” ë©”ì¼ ë°œì†¡ ì‹œ ì¥ì•  ì²˜ë¦¬</title>
    <link href="https://kdevkr.github.io/java-mail-sender-limits/"/>
    <id>https://kdevkr.github.io/java-mail-sender-limits/</id>
    <published>2024-06-16T11:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.104Z</updated>
    
    <content type="html"><![CDATA[<p>ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ ê¸°ë°˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ì—ì„œëŠ” <code>JavaMailSenderImpl</code>ì„ ì‚¬ìš©í•˜ì—¬ ì‰½ê²Œ <a href="https://docs.spring.io/spring-framework/reference/integration/email.html">ì´ë©”ì¼</a>ì„ ë³´ë‚´ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜, ì´ë©”ì¼ ë°œì†¡ì— ëŒ€í•œ ì¸í„°í˜ì´ìŠ¤ì™€ êµ¬í˜„ì„ ì œê³µí•˜ë¯€ë¡œ ë©”ì¼ ë°œì†¡ ì‹¤íŒ¨ì— ë”°ë¥¸ ì¥ì•  ì²˜ë¦¬ì— ëŒ€í•´ì„œëŠ” ë³„ë„ë¡œ ê³ ë ¤í•´ì•¼í•  í•„ìš”ê°€ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë‹¤ìˆ˜ì˜ ìŠ¤ë ˆë“œë¡œ ì´ë©”ì¼ ëŒ€ê¸°ì—´ íë¥¼ ë¹ ë¥´ê²Œ ì†Œì§„í•œë‹¤ë©´ <a href="https://docs.aws.amazon.com/ko_kr/ses/latest/dg/manage-sending-quotas-errors.html">Amazon SES ê³„ì •ì˜ ë°œì‹  í• ë‹¹ëŸ‰ê³¼ ê´€ë ¨ëœ ì˜¤ë¥˜</a> ì¤‘ ì´ˆë‹¹ ì´ë©”ì¼ ìˆ˜ì— ëŒ€í•œ ì œí•œëŸ‰ì„ ë„˜ì–´ì„œëŠ” ê²½ìš° 454 Throttling failure: Maximum sending rate exceeded ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.</p><h4 id="ThreadPoolExecutorë¥¼-í†µí•œ-ë©”ì¼-ëŒ€ê¸°ì—´-í-ë³‘ë ¬-ì²˜ë¦¬"><a href="#ThreadPoolExecutorë¥¼-í†µí•œ-ë©”ì¼-ëŒ€ê¸°ì—´-í-ë³‘ë ¬-ì²˜ë¦¬" class="headerlink" title="ThreadPoolExecutorë¥¼ í†µí•œ ë©”ì¼ ëŒ€ê¸°ì—´ í ë³‘ë ¬ ì²˜ë¦¬"></a>ThreadPoolExecutorë¥¼ í†µí•œ ë©”ì¼ ëŒ€ê¸°ì—´ í ë³‘ë ¬ ì²˜ë¦¬</h4><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MimeMessage</span><span class="token punctuation">></span></span> waitingQueue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">50000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">MimeMessage</span> message <span class="token operator">=</span> waitingQueue<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            javaMailSender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"Mail-Thread"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">setDaemon</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ìœ„ ì½”ë“œëŠ” ê°„ë‹¨í•˜ê²Œ ë©”ì¼ ëŒ€ê¸°ì—´ íë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì†Œì§„í•˜ëŠ” ë‹¨ì¼ ìŠ¤ë ˆë“œë¡œ ì´ë©”ì¼ì„ ë°œì†¡í•˜ëŠ” ì½”ë“œë¡œ ëŒ€ê¸°ì—´ íì— ìŒ“ì´ëŠ” ë©”ì¼ì˜ ìˆ˜ê°€ ë§ì•„ì§„ë‹¤ë©´ ThreadPoolExecutorë¥¼ ì‚¬ìš©í•˜ì—¬ ë©”ì¼ ë°œì†¡ì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ ë³‘ë ¬ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. ë©”ì¼ ë°œì†¡ ì²˜ë¦¬ë¥¼ ë³‘ë ¬ë¡œ ìˆ˜í–‰í•œë‹¤ë©´ SMTP ì„œë²„ì˜ ë°œì‹  í•œë„ì— ëŒ€í•´ì„œ ê³ ë ¤í•´ì•¼í•œë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> coreSize <span class="token operator">=</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">availableProcessors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">ThreadFactory</span> threadFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setNameFormat</span><span class="token punctuation">(</span><span class="token string">"Mail-Thread-%d"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">ThreadPoolExecutor</span> executor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span>coreSize<span class="token punctuation">,</span> coreSize<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> threadFactory<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MimeMessage</span><span class="token punctuation">></span></span> waitingQueue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">50000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>waitingQueue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        executor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">MimeMessage</span> message <span class="token operator">=</span> waitingQueue<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                javaMailSender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"Mail-Thread"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">setDaemon</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="Spring-Retryë¥¼-í†µí•œ-ë©”ì¼-ë°œì†¡-ì‹¤íŒ¨-ì‹œ-ì¬ì‹œë„-ì „ëµ-Guide-to-Spring-Retry"><a href="#Spring-Retryë¥¼-í†µí•œ-ë©”ì¼-ë°œì†¡-ì‹¤íŒ¨-ì‹œ-ì¬ì‹œë„-ì „ëµ-Guide-to-Spring-Retry" class="headerlink" title="Spring Retryë¥¼ í†µí•œ ë©”ì¼ ë°œì†¡ ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„ ì „ëµ - Guide to Spring Retry"></a>Spring Retryë¥¼ í†µí•œ ë©”ì¼ ë°œì†¡ ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„ ì „ëµ - <a href="https://www.baeldung.com/spring-retry">Guide to Spring Retry</a></h4><p>ì´ë©”ì¼ ë°œì†¡ ì‹¤íŒ¨ ê±´ì— ëŒ€í•´ì„œ Spring Retryë¥¼ í†µí•´ ì¬ì‹œë„ ë¡œì§ì„ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤. ë©”ì¼ ë°œì†¡ì„ ìœ„í•œ RetryTemplate êµ¬ì„± ì‹œ ì¬ì‹œë„ ì „ëµì„ êµ¬ì„±í•˜ê³  ë©”ì¼ì„ ë°œì†¡í•˜ëŠ” í•¨ìˆ˜ë¥¼ RetryTemplateë¡œ ê°ì‹¸ë©´ ëœë‹¤. context.getRetryCount() í•¨ìˆ˜ë¥¼ í†µí•´ ì¬ì‹œë„ íšŸìˆ˜ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">RetryTemplate</span> retryTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RetryTemplateBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">maxAttempts</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">exponentialBackoff</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">10L</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofMinutes</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">retryOn</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">MessagingException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">MailException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MimeMessage</span><span class="token punctuation">></span></span> waitingQueue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">50000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>waitingQueue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        retryTemplate<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>context <span class="token operator">-></span> <span class="token punctuation">&#123;</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">MimeMessage</span> message <span class="token operator">=</span> waitingQueue<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                javaMailSender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"Mail-Thread"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">setDaemon</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="Guava-RateLimiterë¥¼-í†µí•œ-ì´ˆë‹¹-ì´ë©”ì¼-ë°œì†¡-ì‹œë„-ì œí•œ-Quick-Guide-to-the-Guava-RateLimiter"><a href="#Guava-RateLimiterë¥¼-í†µí•œ-ì´ˆë‹¹-ì´ë©”ì¼-ë°œì†¡-ì‹œë„-ì œí•œ-Quick-Guide-to-the-Guava-RateLimiter" class="headerlink" title="Guava RateLimiterë¥¼ í†µí•œ ì´ˆë‹¹ ì´ë©”ì¼ ë°œì†¡ ì‹œë„ ì œí•œ - Quick Guide to the Guava RateLimiter"></a>Guava RateLimiterë¥¼ í†µí•œ ì´ˆë‹¹ ì´ë©”ì¼ ë°œì†¡ ì‹œë„ ì œí•œ - <a href="https://www.baeldung.com/guava-rate-limiter">Quick Guide to the Guava RateLimiter</a></h4><p>AWS SESì˜ ë°œì‹  í•œë„ ì¤‘ì—ëŠ” ì´ˆë‹¹ ë³´ë‚¼ ìˆ˜ ìˆëŠ” ì´ë©”ì¼ ìˆ˜ì— ëŒ€í•œ ì œí•œëŸ‰ì´ ìˆìœ¼ë¯€ë¡œ Guava RateLimiterë¥¼ í†µí•´ ì´ˆë‹¹ ì´ë©”ì¼ ë°œì†¡ ìˆ˜ë¥¼ ë„˜ì–´ì„œì§€ ì•Šë„ë¡ ë°©ì–´í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤. ë¬¼ë¡ , SMTP ì„œë²„ë¥¼ ë‹¤ìˆ˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ì—ì„œë„ ì—°ê²°í•  ê°€ëŠ¥ì„±ì´ ìˆìœ¼ë¯€ë¡œ ë°œì‹  í• ë‹¹ëŸ‰ì— ëŒ€í•œ ëª¨ë‹ˆí„°ë§ ë° ë°œì‹  í•œë„ë¥¼ ë³„ë„ë¡œ ê´€ë¦¬í•  í•„ìš”ëŠ” ìˆë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">RateLimiter</span> rateLimiter <span class="token operator">=</span> <span class="token class-name">RateLimiter</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>waitingQueue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">boolean</span> acquire <span class="token operator">=</span> rateLimiter<span class="token punctuation">.</span><span class="token function">tryAcquire</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>acquire<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            executor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    <span class="token class-name">MimeMessage</span> message <span class="token operator">=</span> waitingQueue<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    javaMailSender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"Mail-Thread"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">setDaemon</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><blockquote><p>Guava RateLimiterëŠ” ì´ˆë‹¹ í˜¸ì¶œì— ëŒ€í•œ ì œí•œë§Œ ê°€ëŠ¥í•˜ë¯€ë¡œ ë¶„ë‹¹ ì´ë©”ì¼ ë°œì†¡ì„ ì œí•œí•˜ê³  ì‹¶ë‹¤ë©´ Resilience4jì˜ RateLimiterë¥¼ ë„ì…í•´ì•¼í•©ë‹ˆë‹¤.</p></blockquote><h4 id="Resilience4j-CircuitBreakerë¥¼-í†µí•œ-ë©”ì¼-ë°œì†¡-ì¤‘ë‹¨-Guide-to-Resilience4j"><a href="#Resilience4j-CircuitBreakerë¥¼-í†µí•œ-ë©”ì¼-ë°œì†¡-ì¤‘ë‹¨-Guide-to-Resilience4j" class="headerlink" title="Resilience4j CircuitBreakerë¥¼ í†µí•œ ë©”ì¼ ë°œì†¡ ì¤‘ë‹¨ - Guide to Resilience4j"></a>Resilience4j CircuitBreakerë¥¼ í†µí•œ ë©”ì¼ ë°œì†¡ ì¤‘ë‹¨ - <a href="https://www.baeldung.com/resilience4j">Guide to Resilience4j</a></h4><p>SMTP ì„œë²„ì˜ ë°œì‹  í•œë„ ì œí•œì„ ë„˜ì–´ì„œëŠ” ê²½ìš°ì— ëŒ€í•œ ì¥ì•  ì²˜ë¦¬ë¥¼ ìœ„í•´ <a href="https://github.com/resilience4j/resilience4j">Resilience4j</a>ë¥¼ ë„ì…í•  ìˆ˜ ìˆë‹¤. í•˜ë£¨ë™ì•ˆ ë©”ì¼ì„ ë³´ë‚¼ ìˆ˜ ìˆëŠ” í• ë‹¹ëŸ‰ì„ ì´ˆê³¼í•˜ê±°ë‚˜ ì´ˆë‹¹ ë³´ë‚¼ ìˆ˜ ìˆëŠ” ì´ë©”ì¼ ìˆ˜ì— ì œí•œì´ ë˜ì—ˆë‹¤ë©´ ì¼ì • ì‹œê°„ë™ì•ˆ ì´ë©”ì¼ ë°œì†¡ì„ ì‹œë„í•˜ì§€ ì•Šë„ë¡ <code>CircuitBreaker</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¥ì•  ì „íŒŒ ë°©ì§€ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤. AWS SESì˜ ë°œì‹  í•œë„ì¸ ì•„ë˜ì˜ ë‘ê°œ í•­ëª©ì— ëŒ€í•´ì„œ ì²˜ë¦¬ë¥¼ ê³ ë ¤í•˜ë„ë¡ í•˜ì.</p><ul><li>454 Throttling failure: Maximum sending rate exceeded (1ì´ˆë‹¹ ì´ë©”ì¼ ë°œì†¡ ìˆ˜ ì œí•œëŸ‰)</li><li>454 Throttling failure: Daily message quota exceeded (24ì‹œê°„ ë‹¹ ì´ë©”ì¼ ë°œì†¡ í• ë‹¹ëŸ‰)</li></ul><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">CircuitBreaker</span> circuitBreaker <span class="token operator">=</span> <span class="token class-name">CircuitBreaker</span><span class="token punctuation">.</span><span class="token function">ofDefaults</span><span class="token punctuation">(</span><span class="token string">"MailSendingLimitExceeded"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">RateLimiter</span> rateLimiter <span class="token operator">=</span> <span class="token class-name">RateLimiter</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>waitingQueue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">boolean</span> permission <span class="token operator">=</span> circuitBreaker<span class="token punctuation">.</span><span class="token function">tryAcquirePermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        permission <span class="token operator">&amp;=</span> rateLimiter<span class="token punctuation">.</span><span class="token function">tryAcquire</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>permission<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            executor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    <span class="token class-name">MimeMessage</span> message <span class="token operator">=</span> waitingQueue<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    javaMailSender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token class-name">String</span> failReason <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>failReason <span class="token operator">!=</span> <span class="token keyword">null</span>                            <span class="token operator">&amp;&amp;</span> failReason<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"454 Throttling failure"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        circuitBreaker<span class="token punctuation">.</span><span class="token function">transitionToClosedState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                    log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>failReason<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"Mail-Thread"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">setDaemon</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="JavaMailSenderImplì€-ë§¤ë²ˆ-ì—°ê²°í•œë‹¤"><a href="#JavaMailSenderImplì€-ë§¤ë²ˆ-ì—°ê²°í•œë‹¤" class="headerlink" title="JavaMailSenderImplì€ ë§¤ë²ˆ ì—°ê²°í•œë‹¤?!"></a>JavaMailSenderImplì€ ë§¤ë²ˆ ì—°ê²°í•œë‹¤?!</h4><p>ì¼ë¶€ ì‹œìŠ¤í…œ í™˜ê²½ì—ì„œ AWS SESì˜ SMTP ì„œë²„ë¥¼ ë™ì¼í•œ ë¦¬ì „ì´ ì•„ë‹Œ ìƒë‹¹íˆ ë©€ë¦¬ ë–¨ì–´ì ¸ìˆëŠ” ë¦¬ì „ì— êµ¬ì„±ëœ SMTPë¥¼ í†µí•´ ë©”ì¼ ë°œì†¡ì„ ì‹œë„í•˜ëŠ” ê²½ìš° ì»¤ë„¥ì…˜ì— ëŒ€í•œ ì†Œìš” ì‹œê°„ì´ í¬ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, US East (Ohio) ë¦¬ì „ì˜ SMTP ì—”ë“œí¬ì¸íŠ¸ë¥¼ Asia Pacific (Seoul) ë¦¬ì „ì—ì„œ ì—°ê²°í•˜ëŠ” ê²½ìš° ì•½ 2ì´ˆ ì •ë„ì˜ ì‹œê°„ì´ ì†Œìš”ë˜ëŠ”ë° ë™ì¼í•œ ë¦¬ì „ì—ì„œ ì—°ê²°í•˜ë©´ ì•½ 100ms ê°€ ê±¸ë¦°ë‹¤. </p><p>JavaMailSenderImplì˜ connectTransport í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ testConnection ë˜ëŠ” doSend í•¨ìˆ˜ì—ì„œ ì—°ê²°ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë° MimeMessage ëª©ë¡ì„ send í•¨ìˆ˜ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬í•  ë•Œ ì—°ê²°ì„ ìˆ˜í–‰í•˜ê³  í•´ì œí•˜ë¯€ë¡œ ì´ë©”ì¼ì„ í•˜ë‚˜ì”© ë³´ë‚´ë„ë¡ êµ¬í˜„í–ˆë‹¤ë©´ ì´ë©”ì¼ì„ ë³´ë‚¼ë•Œë§ˆë‹¤ ì—°ê²°ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ë‹¤.</p><pre class="language-java" data-language="java"><div class="caption"><span>JavaMailSenderImpl</span></div><code class="language-java"><span class="token keyword">protected</span> <span class="token class-name">Transport</span> <span class="token function">connectTransport</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MessagingException</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">String</span> password <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        username <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            password <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">Transport</span> transport <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getTransport</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    transport<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> transport<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><a href="https://www.simplejavamail.org/configuration.html#section-reusing-connections">SimpleJavaMailì˜ Batch Module</a>ì€ Transport ì—°ê²°ì— ëŒ€í•œ ì»¤ë„¥ì…˜ í’€ì„ ì‚¬ìš©í•œë‹¤ê³  ë˜ì–´ìˆìœ¼ë¯€ë¡œ SMTP ì„œë²„ë¡œì˜ ì—°ê²° ìˆ˜í–‰ì‹œê°„ì´ ì˜¤ë˜ê±¸ë¦°ë‹¤ë©´ Transport ì— ëŒ€í•œ ì»¤ë„¥ì…˜ í’€ì„ ì´ìš©í•´ë³´ëŠ” ê²ƒë„ ì¢‹ì€ ë°©ë²•ìœ¼ë¡œ ìƒê°ëœë‹¤.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ ê¸°ë°˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ì—ì„œëŠ” &lt;code&gt;JavaMailSenderImpl&lt;/code&gt;ì„ ì‚¬ìš©í•˜ì—¬ ì‰½ê²Œ &lt;a href=&quot;https://docs.spring.io/spring-framework/reference/integratio</summary>
      
    
    
    
    
    <category term="JavaMailSenderImpl" scheme="https://kdevkr.github.io/tags/JavaMailSenderImpl/"/>
    
    <category term="Simple Email Service" scheme="https://kdevkr.github.io/tags/Simple-Email-Service/"/>
    
    <category term="Sending Limits" scheme="https://kdevkr.github.io/tags/Sending-Limits/"/>
    
  </entry>
  
  <entry>
    <title>AWS NLB ECDSA TLS ì˜¤í”„ë¡œë“œ</title>
    <link href="https://kdevkr.github.io/aws-nlb-tls-ecdsa/"/>
    <id>https://kdevkr.github.io/aws-nlb-tls-ecdsa/</id>
    <published>2024-05-25T14:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.100Z</updated>
    
    <content type="html"><![CDATA[<h4 id="AWS-ì¸ì¦ì„œ-ê´€ë ¨-íˆìŠ¤í† ë¦¬"><a href="#AWS-ì¸ì¦ì„œ-ê´€ë ¨-íˆìŠ¤í† ë¦¬" class="headerlink" title="AWS ì¸ì¦ì„œ ê´€ë ¨ íˆìŠ¤í† ë¦¬"></a>AWS ì¸ì¦ì„œ ê´€ë ¨ íˆìŠ¤í† ë¦¬</h4><ul><li><a href="https://aws.amazon.com/ko/about-aws/whats-new/2021/07/aws-certificate-manager-provides-expanded-usage-imported-ecdsa-rsa-certificates/">AWS Certificate Manager, ê°€ì ¸ì˜¨ ECDSA ë° RSA ì¸ì¦ì„œì˜ í™•ì¥ëœ ì‚¬ìš© ì œê³µ</a></li><li><a href="https://aws.amazon.com/ko/about-aws/whats-new/2022/11/aws-certificate-manager-elliptic-curve-digital-signature-algorithm-tls-certificates/">AWS Certificate Manager, ì´ì œ Elliptic Curve Digital Signature Algorithm TLS ì¸ì¦ì„œ ì§€ì›</a></li><li><a href="https://aws.amazon.com/ko/about-aws/whats-new/2024/01/network-load-balancer-rsa-3072-bit-ecdsa-256-384-521-bit-certificates/">Network Load Balancer, ì´ì œ AWS Certificate Managerë¥¼ í†µí•œ RSA 3072-ë¹„íŠ¸, ECDSA 256&#x2F;384&#x2F;521-ë¹„íŠ¸ ì¸ì¦ì„œ ì§€ì›</a></li></ul><p>ìœ„ ê¸°ë¡ì²˜ëŸ¼ 2021ë…„ 7ì›” ë¶€í„° AWS Certificate Managerì—ì„œ ì™¸ë¶€ì—ì„œ ë°œê¸‰ëœ ECDSA ì¸ì¦ì„œë¥¼ ê°€ì ¸ì™€ì„œ ë“±ë¡í•  ìˆ˜ ìˆê²Œ ì§€ì›í•˜ì˜€ê³  2022ë…„ 11ì›” ë¶€í„°ëŠ” ACM ìì²´ì ìœ¼ë¡œ ECDSA ì¸ì¦ì„œ ë°œê¸‰ì„ ì§€ì›í•œë‹¤. ê·¸ë¦¬ê³  ì‹œê°„ì´ í˜ëŸ¬ 2024ë…„ 1ì›”ë¶€í„°ëŠ” <a href="https://aws.amazon.com/ko/about-aws/whats-new/2024/01/network-load-balancer-rsa-3072-bit-ecdsa-256-384-521-bit-certificates/">Network Load Balancer ì—ì„œë„ ECDSA ì¸ì¦ì„œ ë“±ë¡ì„ ì§€ì›</a>í•œë‹¤.</p><p><img data-src="/images/posts/aws-nlb-tls-ecdsa/01.png"></p><blockquote><p>ìœ„ í™”ë©´ì€ ACM ì™¸ë¶€ì—ì„œ ë°œê¸‰ëœ ECDSA ì¸ì¦ì„œë¥¼ ê°€ì ¸ì˜¨ ì˜ˆì‹œë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.</p></blockquote><h4 id="Network-Load-Balancer-TLS-ë¦¬ìŠ¤ë„ˆ-êµ¬ì„±"><a href="#Network-Load-Balancer-TLS-ë¦¬ìŠ¤ë„ˆ-êµ¬ì„±" class="headerlink" title="Network Load Balancer TLS ë¦¬ìŠ¤ë„ˆ êµ¬ì„±"></a>Network Load Balancer TLS ë¦¬ìŠ¤ë„ˆ êµ¬ì„±</h4><p>ê·¸ë™ì•ˆ ELB ì—ì„œ ECDSA ì¸ì¦ì„œë¡œ TLS ì˜¤í”„ë¡œë“œë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œëŠ” ì˜¤ì§ ALB(Application Load Balancer)ë¥¼ êµ¬ì„±í•´ì•¼í–ˆë‹¤. ì´ì œëŠ” <code>NLB(Network Load Balancer)</code>ë¡œ êµ¬ì„±í•˜ê³  <a href="https://docs.aws.amazon.com/ko_kr/elasticloadbalancing/latest/network/create-tls-listener.html">TLS ë¦¬ìŠ¤ë„ˆ</a>ì—ì„œ ACMì— ì¶”ê°€ë˜ì–´ìˆëŠ” <code>ECDSA ì¸ì¦ì„œ</code>ë¥¼ ì„ íƒí•˜ì—¬ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤.</p><p><img data-src="/images/posts/aws-nlb-tls-ecdsa/02.png"></p><blockquote><p>í•˜ì§€ë§Œ, NLBê°€ TLS ë¦¬ìŠ¤ë„ˆë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° mTLSëŠ” ì§€ì›í•˜ì§€ ëª»í•˜ëŠ” êµ¬ì„±ì´ ë˜ëŠ” ê²ƒì€ ì¼ë¶€ ì‹œìŠ¤í…œì—ì„œ ì¤‘ìš”í•œ ë¶€ë¶„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></blockquote><h4 id="ëŒ€ìƒ-ê·¸ë£¹-í”„ë¡ì‹œ-í”„ë¡œí† ì½œ-v2"><a href="#ëŒ€ìƒ-ê·¸ë£¹-í”„ë¡ì‹œ-í”„ë¡œí† ì½œ-v2" class="headerlink" title="ëŒ€ìƒ ê·¸ë£¹ - í”„ë¡ì‹œ í”„ë¡œí† ì½œ v2"></a>ëŒ€ìƒ ê·¸ë£¹ - í”„ë¡ì‹œ í”„ë¡œí† ì½œ v2</h4><p>NLB ëŠ” ALBì™€ëŠ” ë‹¤ë¥´ê²Œ L4 ë ˆë²¨ë¡œ ë™ì‘í•˜ë¯€ë¡œ HTTP íŠ¸ë˜í”½ì„ HTTPSë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•˜ëŠ” ê²ƒì„ ì§€ì›í•˜ì§€ ëª»í•œë‹¤. ChatGPTì—ê²Œ ë¬¼ì–´ë³´ë”ë¼ë„ TCP ë¦¬ìŠ¤ë„ˆë¡œ êµ¬ì„±í•˜ê³  Nginxì™€ ê°™ì€ ë³„ë„ì˜ ë¡œë“œë°¸ëŸ°ì„œì—ì„œ TLS ì˜¤í”„ë¡œë“œë¥¼ ì²˜ë¦¬í•¨ê³¼ ë™ì‹œì— <code>Forward http to https</code> ë¥¼ ì ìš©í•˜ëŠ” ì˜ˆì‹œë¥¼ ì„¤ëª…í•œë‹¤.</p><p>ì‚¬ë‚´ ì—”ì§€ë‹ˆì–´ì™€ ì‚½ì§ˆì„ í•´ë³¸ê²°ê³¼ ë¡œë“œ ë°¸ëŸ°ì„œì— ì—°ê²°ë˜ëŠ” ëŒ€ìƒ ê·¸ë£¹ì—ì„œ <code>í”„ë¡ì‹œ í”„ë¡œí† ì½œ v2</code>ë¥¼ í™œì„±í™”í•˜ë©´ Elastic Beanstalkì˜ Nginx í”Œë«í¼ì—ì„œ <a href="https://docs.nginx.com/nginx/admin-guide/load-balancer/using-proxy-protocol/">PROXY Protocol</a>ì„ í†µí•´ <code>$proxy_protocol_server_port</code> ì†ì„±ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŒì„ í™•ì¸í–ˆë‹¤. ë” ë‚˜ì•„ê°€ì„œëŠ” <code>$proxy_protocol_addr</code> ì†ì„±ìœ¼ë¡œ ì‹¤ì œë¡œ íŠ¸ë˜í”½ì„ ì „ë‹¬í•œ <code>í´ë¼ì´ì–¸íŠ¸ IP</code>ë¥¼ ì•¡ì„¸ìŠ¤ ë¡œê·¸ì— ì¶œë ¥í•˜ê±°ë‚˜ <code>X-Forwarded-For</code> í—¤ë”ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ê¹Œì§€ ì „ë‹¬í•  ìˆ˜ ìˆì–´ë³´ì¸ë‹¤.</p><p><img data-src="/images/posts/aws-nlb-tls-ecdsa/03.png"></p><pre class="language-conf" data-language="conf"><code class="language-conf">http &#123;    server &#123;        listen 80 proxy_protocol;        if ($proxy_protocol_server_port &#x3D; 80) &#123;            return 301 https:&#x2F;&#x2F;$host$request_uri;        &#125;    &#125;&#125;</code></pre><blockquote><p>NLB ì—ì„œ Nginxë¡œ ì „ë‹¬í•  ë•Œ ì‚¬ìš©í•œ í¬íŠ¸ê°€ 80 ì´ë¼ë©´ HTTP ìš”ì²­ìœ¼ë¡œ ê°„ì£¼í•˜ê³  HTTPS ìš”ì²­ìœ¼ë¡œ ì „ë‹¬ë  ìˆ˜ ìˆë„ë¡ 301 ì‘ë‹µì„ ì²˜ë¦¬í–ˆìŠµë‹ˆë‹¤.</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;AWS-ì¸ì¦ì„œ-ê´€ë ¨-íˆìŠ¤í† ë¦¬&quot;&gt;&lt;a href=&quot;#AWS-ì¸ì¦ì„œ-ê´€ë ¨-íˆìŠ¤í† ë¦¬&quot; class=&quot;headerlink&quot; title=&quot;AWS ì¸ì¦ì„œ ê´€ë ¨ íˆìŠ¤í† ë¦¬&quot;&gt;&lt;/a&gt;AWS ì¸ì¦ì„œ ê´€ë ¨ íˆìŠ¤í† ë¦¬&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;htt</summary>
      
    
    
    
    
    <category term="AWS NLB" scheme="https://kdevkr.github.io/tags/AWS-NLB/"/>
    
    <category term="ECDSA" scheme="https://kdevkr.github.io/tags/ECDSA/"/>
    
  </entry>
  
  <entry>
    <title>ì  í‚¨ìŠ¤ ë„ì»¤ ë©€í‹° í”Œë«í¼ ë¹Œë“œ</title>
    <link href="https://kdevkr.github.io/jenkins-docker-buildx/"/>
    <id>https://kdevkr.github.io/jenkins-docker-buildx/</id>
    <published>2024-05-24T11:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.104Z</updated>
    
    <content type="html"><![CDATA[<p>ì  í‚¨ìŠ¤ì—ì„œ Docker Plugin ì„ ì‚¬ìš©í•´ì„œ Dockerfileì„ í†µí•´ ì‰½ê²Œ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•  ìˆ˜ ìˆë‹¤. ì•„ë§ˆì¡´ ì›¹ ì„œë¹„ìŠ¤ì™€ ê°™ì€ í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ì—ì„œëŠ” x86_64(AMD64) ì•„í‚¤í…ì²˜ ë¿ë§Œ ì•„ë‹ˆë¼ ARM64 ì•„í‚¤í…ì²˜ ê¸°ë°˜ì˜ ë” ì €ë ´í•˜ê³  ì„±ëŠ¥ì´ ì¢‹ì€ ì„œë²„ë¥¼ í™œìš©í•  ìˆ˜ ìˆë‹¤. ê¸°ë³¸ì ì¸ ë„ì»¤ ì´ë¯¸ì§€ ë¹Œë“œ ëª…ë ¹ì–´ëŠ” ë¹Œë“œë¥¼ ì‹œë„í•˜ëŠ” ì„œë²„ì™€ ë™ì¼í•œ ì•„í‚¤í…ì²˜ì— ëŒ€í•œ ì´ë¯¸ì§€ë§Œ ë§Œë“¤ ìˆ˜ ìˆìœ¼ë¯€ë¡œ <a href="https://docs.docker.com/build/building/multi-platform/">ë©€í‹° í”Œë«í¼ ì´ë¯¸ì§€</a>ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” <a href="https://docs.docker.com/reference/cli/docker/buildx/">Buildkit</a>ì„ ì´ìš©í•´ì•¼í•œë‹¤.</p><h4 id="Jenkins-ì‚¬ìš©ì-ë„ì»¤-ê·¸ë£¹ì—-ì¶”ê°€"><a href="#Jenkins-ì‚¬ìš©ì-ë„ì»¤-ê·¸ë£¹ì—-ì¶”ê°€" class="headerlink" title="Jenkins ì‚¬ìš©ì ë„ì»¤ ê·¸ë£¹ì— ì¶”ê°€"></a>Jenkins ì‚¬ìš©ì ë„ì»¤ ê·¸ë£¹ì— ì¶”ê°€</h4><p>ì  í‚¨ìŠ¤ê°€ ì„¤ì¹˜ëœ ì„œë²„ì— ì‹¤í–‰ë˜ì–´ìˆëŠ” ë„ì»¤ ì—”ì§„ìœ¼ë¡œ ë¹Œë“œí•  ìˆ˜ ìˆë„ë¡ ë„ì»¤ ê·¸ë£¹ì— ì  í‚¨ìŠ¤ ì‚¬ìš©ìë¥¼ í¬í•¨ì‹œì¼œì•¼í•œë‹¤. ì  í‚¨ìŠ¤ ì‚¬ìš©ìë¥¼ ë„ì»¤ ê·¸ë£¹ì— ì¶”ê°€í•˜ê³ ë‚˜ì„œëŠ” ë„ì»¤ì™€ ì  í‚¨ìŠ¤ ëª¨ë‘ ì¬ì‹¤í–‰ì„ ìˆ˜í–‰í•˜ì—¬ì•¼ í•œë‹¤.</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">usermod</span> <span class="token parameter variable">-aG</span> <span class="token function">docker</span> jenkins<span class="token function">sudo</span> systemctl restart jenkins<span class="token function">sudo</span> systemctl restart <span class="token function">docker</span></code></pre><h4 id="QEMU-ì„¤ì¹˜"><a href="#QEMU-ì„¤ì¹˜" class="headerlink" title="QEMU ì„¤ì¹˜"></a>QEMU ì„¤ì¹˜</h4><p>ìœˆë„ìš°ì™€ ë§¥ í™˜ê²½ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë„ì»¤ ë°ìŠ¤í¬íƒ‘ì—ëŠ” QEMU ì„ í¬í•¨í•˜ê³  ìˆì–´ ì‰½ê²Œ ë©€í‹° í”Œë«í¼ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ, ì¼ë°˜ì ìœ¼ë¡œ ì  í‚¨ìŠ¤ë¥¼ ì„¤ì¹˜í•˜ëŠ” ë¦¬ëˆ…ìŠ¤ ì„œë²„ì—ì„œëŠ” <a href="https://docs.docker.com/build/building/multi-platform/#qemu-without-docker-desktop">QEMU</a>ì˜ ë„ì›€ì„ ë°›ê¸° ìœ„í•´ì„œ ì§ì ‘ ì„¤ì¹˜í•´ì•¼í•œë‹¤.</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> run <span class="token parameter variable">--privileged</span> <span class="token parameter variable">--rm</span> tonistiigi/binfmt <span class="token parameter variable">--install</span> all</code></pre><h4 id="Docker-Build-Cloud-ë¥¼-ë¹Œë”ë¡œ-ì´ìš©í•˜ê¸°"><a href="#Docker-Build-Cloud-ë¥¼-ë¹Œë”ë¡œ-ì´ìš©í•˜ê¸°" class="headerlink" title="Docker Build Cloud ë¥¼ ë¹Œë”ë¡œ ì´ìš©í•˜ê¸°"></a>Docker Build Cloud ë¥¼ ë¹Œë”ë¡œ ì´ìš©í•˜ê¸°</h4><p><a href="https://docs.docker.com/build/cloud/">Docker Build Cloud</a>ë¥¼ ì´ìš©í•˜ì—¬ ë¹Œë“œí•˜ê¸° ìœ„í•´ì„œëŠ” cloud ë“œë¼ì´ë²„ë¥¼ ì§€ì›í•˜ëŠ” buildx ë²„ì „ì„ ì„¤ì¹˜í•´ì•¼í•œë‹¤. <a href="https://github.com/docker/buildx-desktop">buildx-desktop</a> ì—ì„œ ë¦¬ëˆ…ìŠ¤ ì„œë²„ì— ë§ëŠ” ë°”ì´ë„ˆë¦¬ íŒŒì¼ì„ ë‹¤ìš´ë°›ì•„ì„œ ì  í‚¨ìŠ¤ ê³„ì •ì—ì„œ ë°”ë¼ë³´ëŠ” ë„ì»¤ ê²½ë¡œì— docker-buildx í”ŒëŸ¬ê·¸ì¸ìœ¼ë¡œ ì¶”ê°€í•˜ì.</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># ì  í‚¨ìŠ¤ ì‚¬ìš©ìë¡œ ì „í™˜</span><span class="token function">sudo</span> <span class="token function">su</span> jenkins <span class="token parameter variable">-s</span> /bin/bash<span class="token comment"># cloud ë“œë¼ì´ë²„ë¥¼ ì§€ì›í•˜ëŠ” Buildx ì„¤ì¹˜</span><span class="token function">wget</span> https://github.com/docker/buildx-desktop/releases/download/v0.14.0-desktop.1/buildx-v0.14.0-desktop.1.linux-amd64<span class="token function">mv</span> buildx-v0.14.0-desktop.1.linux-amd64 ~/docker/cli-plugins/docker-buildx<span class="token function">chmod</span> a+x ~/.docker/cli-plugins/docker-buildx<span class="token comment"># Buildx ë²„ì „ í™•ì¸</span><span class="token function">docker</span> buildx versiongithub.com/docker/buildx v0.14.0-desktop.1 7b0470cffd54ccbf42976d2f75febc4532c85073<span class="token comment"># Docker Build Cloud ë¹Œë” ì¶”ê°€</span><span class="token function">docker</span> buildx create <span class="token parameter variable">--driver</span> xxxinc/builder <span class="token parameter variable">--use</span><span class="token function">docker</span> buildx <span class="token function">ls</span>NAME/NODE               DRIVER/ENDPOINT                          STATUS    BUILDKIT       PLATFORMScloud-eipgridinc-ddd*   cloud <span class="token punctuation">\</span>_ linux-amd64          <span class="token punctuation">\</span>_ cloud://xxxinc/builder_linux-amd64   running   v0.13.1        linux/amd64*, linux/amd64/v2, linux/amd64/v3, linux/amd64/v4, linux/386 <span class="token punctuation">\</span>_ linux-arm64          <span class="token punctuation">\</span>_ cloud://xxxinc/builder_linux-arm64   running   v0.13.1        linux/arm64*, linux/arm64/v6, linux/arm64/v7default                 <span class="token function">docker</span> <span class="token punctuation">\</span>_ default              <span class="token punctuation">\</span>_ default                              running   v0.8+unknown   linux/amd64, linux/arm64, linux/riscv64, linux/ppc64le, linux/s390x, linux/386, linux/arm/v7, linux/arm/v6</code></pre><blockquote><p>Docker Build Cloud í™˜ê²½ì—ì„œ ë¹Œë“œí•˜ë¯€ë¡œ â€“bootstrap ì˜µì…˜ìœ¼ë¡œ ë¹Œë” ì´ˆê¸°í™”ë¥¼ ìˆ˜í–‰í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.</p></blockquote><h4 id="Jenkins-ì—ì„œ-ë¹Œë“œí•˜ê¸°"><a href="#Jenkins-ì—ì„œ-ë¹Œë“œí•˜ê¸°" class="headerlink" title="Jenkins ì—ì„œ ë¹Œë“œí•˜ê¸°"></a>Jenkins ì—ì„œ ë¹Œë“œí•˜ê¸°</h4><p>Docker Plugin ì—ì„œëŠ” buildx ëª…ë ¹ì–´ë¥¼ ì„ íƒí•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— Execute Shell ì„ ì„ íƒí•´ì„œ ì§ì ‘ buildx ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•´ì•¼í•œë‹¤. ì•„ë˜ì˜ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ë„ì»¤ ê³„ì •ì— ë¡œê·¸ì¸í•˜ê¸° ìœ„í•´ì„œ ì  í‚¨ìŠ¤ ì‚¬ìš©ìì˜ config.json ì„ ì´ìš©í•˜ê²Œ í–ˆë‹¤.</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># Log in to Docker Hub</span><span class="token builtin class-name">echo</span> <span class="token string">"Logging into Docker Hub..."</span><span class="token function">docker</span> login<span class="token assign-left variable">BUILDER_NAME</span><span class="token operator">=</span><span class="token string">"cloud-xxxinc-builder"</span><span class="token comment"># Check if the builder already exists</span><span class="token assign-left variable">BUILDER_EXISTS</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> buildx <span class="token function">ls</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"<span class="token variable">$BUILDER_NAME</span>"</span> <span class="token operator">||</span> <span class="token boolean">true</span><span class="token variable">)</span></span><span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">$BUILDER_EXISTS</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>  <span class="token builtin class-name">echo</span> <span class="token string">"Creating new builder instance..."</span>  <span class="token function">docker</span> buildx create <span class="token parameter variable">--name</span> <span class="token string">"<span class="token variable">$BUILDER_NAME</span>"</span> <span class="token parameter variable">--driver</span> cloud xxxinc/builder <span class="token parameter variable">--use</span><span class="token keyword">else</span>  <span class="token builtin class-name">echo</span> <span class="token string">"Using existing builder instance..."</span>  <span class="token function">docker</span> buildx use <span class="token string">"<span class="token variable">$BUILDER_NAME</span>"</span><span class="token keyword">fi</span><span class="token comment"># List the builder instances</span><span class="token function">docker</span> buildx <span class="token function">ls</span><span class="token comment"># Install QEMU emulators for building multi-architecture images</span><span class="token function">docker</span> run <span class="token parameter variable">--rm</span> <span class="token parameter variable">--privileged</span> tonistiigi/binfmt <span class="token parameter variable">--install</span> all<span class="token comment"># build</span><span class="token builtin class-name">echo</span> <span class="token string">"Building Docker image using Buildx with Docker Build Cloud..."</span><span class="token function">docker</span> buildx build <span class="token parameter variable">--platform</span> linux/amd64,linux/arm64 <span class="token parameter variable">-t</span> xxxinc/testapp:<span class="token variable">$&#123;version&#125;</span>-buildx <span class="token parameter variable">--push</span> <span class="token builtin class-name">.</span></code></pre><h4 id="Optional-HDF5-for-ARM64"><a href="#Optional-HDF5-for-ARM64" class="headerlink" title="(Optional) HDF5 for ARM64"></a>(Optional) HDF5 for ARM64</h4><p>ARM64 ì•„í‚¤í…ì²˜ë¡œ ë¹Œë“œí•˜ëŠ” ê²½ìš°ì—ë§Œ <code>ValueError: did not find HDF5 headers</code> ê°€ ë°œìƒí•˜ëŠ” ê²ƒì„ ê²½í—˜í–ˆë‹¤. ê²€ìƒ‰ ê²°ê³¼ ì•„ë˜ì˜ ì„¸ê°œì˜ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ëŠ” ê²ƒìœ¼ë¡œ í•´ê²°ì´ ë˜ì—ˆë‹¤.</p><ul><li>libhdf5-serial-dev</li><li>netcdf-bin</li><li>libnetcdf-dev</li></ul><pre class="language-docker" data-language="docker"><div class="caption"><span>Dockerfile</span></div><code class="language-docker"><span class="token instruction"><span class="token keyword">FROM</span> python:3.8-slim-buster</span><span class="token instruction"><span class="token keyword">RUN</span> apt-get update &amp;&amp; apt-get install -y <span class="token operator">\</span>    gcc  <span class="token operator">\</span>    libpq-dev <span class="token operator">\</span>    libhdf5-serial-dev <span class="token operator">\</span>    netcdf-bin \ </span>    libnetcdf-dev</code></pre><h4 id="ë¬¸ì œ-í•´ê²°ì—-ë„ì›€ì´-ëœ-ê¸€"><a href="#ë¬¸ì œ-í•´ê²°ì—-ë„ì›€ì´-ëœ-ê¸€" class="headerlink" title="ë¬¸ì œ í•´ê²°ì— ë„ì›€ì´ ëœ ê¸€"></a>ë¬¸ì œ í•´ê²°ì— ë„ì›€ì´ ëœ ê¸€</h4><ul><li><a href="https://hotfoxy.tistory.com/114">jenkins(image) ì—ì„œ docker buildxë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ì–´ìš”!</a></li><li><a href="https://forums.docker.com/t/docker-buildx-failed-to-find-driver-cloud/141238/4">Docker buildx â€œfailed to find driverâ€</a></li><li><a href="https://stackoverflow.com/a/36165209">https://stackoverflow.com/a/36165209</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ì  í‚¨ìŠ¤ì—ì„œ Docker Plugin ì„ ì‚¬ìš©í•´ì„œ Dockerfileì„ í†µí•´ ì‰½ê²Œ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•  ìˆ˜ ìˆë‹¤. ì•„ë§ˆì¡´ ì›¹ ì„œë¹„ìŠ¤ì™€ ê°™ì€ í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ì—ì„œëŠ” x86_64(AMD64) ì•„í‚¤í…ì²˜ ë¿ë§Œ ì•„ë‹ˆë¼ ARM64 ì•„í‚¤í…ì²˜ ê¸°ë°˜ì˜ ë” ì €ë ´í•˜ê³  </summary>
      
    
    
    
    
    <category term="Jenkins" scheme="https://kdevkr.github.io/tags/Jenkins/"/>
    
    <category term="Docker" scheme="https://kdevkr.github.io/tags/Docker/"/>
    
    <category term="Buildx" scheme="https://kdevkr.github.io/tags/Buildx/"/>
    
  </entry>
  
  <entry>
    <title>ìŠ¤í”„ë§ ì‹œíë¦¬í‹° JWT ì‚¬ìš©ì í…ŒìŠ¤íŠ¸</title>
    <link href="https://kdevkr.github.io/spring-security-jwt-user-test/"/>
    <id>https://kdevkr.github.io/spring-security-jwt-user-test/</id>
    <published>2024-03-27T12:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.108Z</updated>
    
    <content type="html"><![CDATA[<p>JWT ê¸°ë°˜ì˜ ì¸ì¦ì„ êµ¬ì„±í•œ í”„ë¡œì íŠ¸ì—ì„œ í…ŒìŠ¤íŠ¸ ì½”ë“œì— ëŒ€í•œ ì‚¬ìš©ìë¥¼ ë§Œë“¤ê¸° ìœ„í•´ì„œ <code>WithSecurityContext</code> ì™€ <code>WithSecurityContextFactory</code> ë¥¼ ì‚¬ìš©í•´ì„œ ê°€ìƒì˜ ì‚¬ìš©ìì™€ í† í°ì„ ë°œê¸‰í•˜ëŠ” ì½”ë“œë¥¼ êµ¬í˜„í•˜ë©´ ë˜ëŠ” ê²ƒìœ¼ë¡œ ì•Œë ¤ì ¸ ìˆë‹¤. í•˜ì§€ë§Œ, ì‹ ê·œ í”„ë¡œì íŠ¸ì—ì„œëŠ” ë‹¨ì¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì•„ë‹Œ ì¸ì¦ì˜ ê¸°ë°˜ì´ ë˜ëŠ” ì™¸ë¶€ í”Œë«í¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ìš”ì²­í•˜ì—¬ ì¸ì¦ì„ ìˆ˜í–‰í•˜ê³  ê¶Œí•œì„ ì²˜ë¦¬í•˜ë„ë¡ ë¡œì§ì„ êµ¬ì„±í•˜ì—¬ ë‹¨ìˆœíˆ <strong>ê°€ìƒì˜ ì‚¬ìš©ìê°€ ì•„ë‹Œ ì‹¤ì œë¡œ ì¡´ì¬í•˜ëŠ” ì‚¬ìš©ìë¡œ ì¸ì¦í•  ìˆ˜ ìˆëŠ” ì»¨í…ìŠ¤íŠ¸</strong>ë¥¼ ë§Œë“¤ì–´ì•¼ í–ˆë‹¤. ì‚¬ìš©ì í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì ìš©í•˜ê¸° ìœ„í•´ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í–ˆë‹¤.</p><pre class="language-java" data-language="java"><div class="caption"><span>WithMockUser</span></div><code class="language-java"><span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span><span class="token annotation punctuation">@WithSecurityContext</span><span class="token punctuation">(</span>factory <span class="token operator">=</span> <span class="token class-name">WithMockUserSecurityContextFactory</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">WithMockUser</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> <span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">"kdevkr@gmail.com"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-java" data-language="java"><div class="caption"><span>WithMockUserSecurityContextFactory</span></div><code class="language-java"><span class="token annotation punctuation">@RequiredArgsConstructor</span><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WithMockUserSecurityContextFactory</span> <span class="token keyword">implements</span> <span class="token class-name">WithSecurityContextFactory</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WithMockUser</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">JwtTokenProvider</span> jwtTokenProvider<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">SecurityContext</span> <span class="token function">createSecurityContext</span><span class="token punctuation">(</span><span class="token class-name">WithMockUser</span> mockUser<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">SecurityContext</span> context <span class="token operator">=</span> <span class="token class-name">SecurityContextHolder</span><span class="token punctuation">.</span><span class="token function">createEmptyContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> optionalUser <span class="token operator">=</span> <span class="token function">getUserById</span><span class="token punctuation">(</span>mockUser<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>optionalUser<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">User</span> user <span class="token operator">=</span> optionalUser<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JwtToken</span><span class="token punctuation">></span></span> token <span class="token operator">=</span> <span class="token function">getToken</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">String</span> accessToken <span class="token operator">=</span> token<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAccessToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token class-name">Authentication</span> authentication <span class="token operator">=</span> jwtTokenProvider<span class="token punctuation">.</span><span class="token function">getAuthentication</span><span class="token punctuation">(</span>accessToken<span class="token punctuation">)</span><span class="token punctuation">;</span>                context<span class="token punctuation">.</span><span class="token function">setAuthentication</span><span class="token punctuation">(</span>authentication<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> context<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="No-thread-bound-request-found"><a href="#No-thread-bound-request-found" class="headerlink" title="No thread-bound request found"></a>No thread-bound request found</h4><blockquote><p>java.lang.IllegalStateException: No thread-bound request found: Are you referring to request attributes outside of an actual web request, or processing a request outside of the originally receiving thread? If you are actually operating within a web request and still receive this message, your code is probably running outside of DispatcherServlet: In this case, use RequestContextListener or RequestContextFilter to expose the current request.</p></blockquote><p>ì„œë¹„ìŠ¤ ë ˆì´ì–´ì˜ í´ë˜ìŠ¤ì—ì„œ ìš”ì²­ ìŠ¤ë ˆë“œì—ì„œ í† í° ì •ë³´ë¥¼ ì¡°íšŒí•˜ê¸° ìœ„í•´ <code>RequestContextHolder</code> ë¥¼ ì‚¬ìš©í•˜ì—¬ í˜„ì¬ ìš”ì²­ì— ëŒ€í•œ <code>Authorization</code> í—¤ë”ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë¡œì§ìœ¼ë¡œ ì¸í•´ ë°œìƒí•œ ë¬¸ì œë¼ê³  í•  ìˆ˜ ìˆë‹¤. ì„œë¹„ìŠ¤ ë ˆë²¨ì˜ í…ŒìŠ¤íŠ¸ ì½”ë“œì—ì„œëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í†µí•œ ë¡œì§ì„ ìˆ˜í–‰í•œ ìŠ¤ë ˆë“œê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ê¸°ë³¸ì ìœ¼ë¡œëŠ” ì¡°íšŒí•  ìˆ˜ ì—†ë‹¤. ì˜¤ë¥˜ ë©”ì‹œì§€ì— í¬í•¨ëœ <code>RequestContextListener</code> ê°€ í•´ê²°ë°©ì•ˆì´ ë  ìˆ˜ ìˆë‹¤. <a href="https://github.com/spring-projects/spring-framework/blob/main/spring-web/src/test/java/org/springframework/web/context/request/RequestContextListenerTests.java">RequestContextListenerTests.java</a> ë¥¼ ì°¸ê³ í•˜ì—¬ RequestContextListener í´ë˜ìŠ¤ë¥¼ í†µí•´ ìš”ì²­ì— ëŒ€í•œ ìŠ¤ë ˆë“œë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆìŒì„ í™•ì¸í–ˆìœ¼ë©° MockHttpServletRequestë¥¼ í†µí•´ ServletRequestAttributesë¥¼ RequestContextHolderì˜ ìŠ¤ë ˆë“œ ë¡œì»¬ì— ë°˜ì˜ë˜ê²Œ í•˜ì—¬ ì»¨íŠ¸ë¡¤ëŸ¬ ë ˆë²¨ì´ ì•„ë‹Œ ì„œë¹„ìŠ¤ ë ˆë²¨ì—ì„œë„ ì¸ì¦ëœ ì‚¬ìš©ì ê¸°ë°˜ì˜ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ í•˜ì˜€ë‹¤. </p><pre class="language-java" data-language="java"><div class="caption"><span>WithMockUserSecurityContextFactory</span></div><code class="language-java"><span class="token annotation punctuation">@RequiredArgsConstructor</span><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WithMockUserSecurityContextFactory</span> <span class="token keyword">implements</span> <span class="token class-name">WithSecurityContextFactory</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WithMockUser</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">JwtTokenProvider</span> jwtTokenProvider<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">SecurityContext</span> <span class="token function">createSecurityContext</span><span class="token punctuation">(</span><span class="token class-name">WithMockUser</span> mockUser<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">SecurityContext</span> context <span class="token operator">=</span> <span class="token class-name">SecurityContextHolder</span><span class="token punctuation">.</span><span class="token function">createEmptyContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">RequestContextListener</span> listener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RequestContextListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">MockServletContext</span> servletContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MockServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">MockHttpServletRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MockHttpServletRequest</span><span class="token punctuation">(</span>servletContext<span class="token punctuation">)</span><span class="token punctuation">;</span>        listener<span class="token punctuation">.</span><span class="token function">requestInitialized</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ServletRequestEvent</span><span class="token punctuation">(</span>servletContext<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> optionalUser <span class="token operator">=</span> <span class="token function">getUserById</span><span class="token punctuation">(</span>mockUser<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>optionalUser<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">User</span> user <span class="token operator">=</span> optionalUser<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JwtToken</span><span class="token punctuation">></span></span> token <span class="token operator">=</span> <span class="token function">getToken</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">String</span> accessToken <span class="token operator">=</span> token<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAccessToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token class-name">Authentication</span> authentication <span class="token operator">=</span> jwtTokenProvider<span class="token punctuation">.</span><span class="token function">getAuthentication</span><span class="token punctuation">(</span>accessToken<span class="token punctuation">)</span><span class="token punctuation">;</span>                context<span class="token punctuation">.</span><span class="token function">setAuthentication</span><span class="token punctuation">(</span>authentication<span class="token punctuation">)</span><span class="token punctuation">;</span>                request<span class="token punctuation">.</span><span class="token function">addHeader</span><span class="token punctuation">(</span><span class="token class-name">HttpHeaders</span><span class="token punctuation">.</span><span class="token constant">AUTHORIZATION</span><span class="token punctuation">,</span> <span class="token string">"Bearer %s"</span><span class="token punctuation">.</span><span class="token function">formatted</span><span class="token punctuation">(</span>accessToken<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token class-name">ServletRequestAttributes</span> requestAttributes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServletRequestAttributes</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token class-name">RequestContextHolder</span><span class="token punctuation">.</span><span class="token function">setRequestAttributes</span><span class="token punctuation">(</span>requestAttributes<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> context<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="ì°¸ê³ -ë§í¬"><a href="#ì°¸ê³ -ë§í¬" class="headerlink" title="ì°¸ê³  ë§í¬"></a>ì°¸ê³  ë§í¬</h4><ul><li><a href="https://tecoble.techcourse.co.kr/post/2020-09-30-spring-security-test/">Spring Securityê°€ ì ìš©ëœ ê³³ì„ íš¨ìœ¨ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•˜ì.</a></li><li><a href="https://stackoverflow.com/a/9430545">https://stackoverflow.com/a/9430545</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;JWT ê¸°ë°˜ì˜ ì¸ì¦ì„ êµ¬ì„±í•œ í”„ë¡œì íŠ¸ì—ì„œ í…ŒìŠ¤íŠ¸ ì½”ë“œì— ëŒ€í•œ ì‚¬ìš©ìë¥¼ ë§Œë“¤ê¸° ìœ„í•´ì„œ &lt;code&gt;WithSecurityContext&lt;/code&gt; ì™€ &lt;code&gt;WithSecurityContextFactory&lt;/code&gt; ë¥¼ ì‚¬ìš©í•´ì„œ ê°€ìƒì˜ ì‚¬ìš©ìì™€</summary>
      
    
    
    
    
    <category term="WithSecurityContext" scheme="https://kdevkr.github.io/tags/WithSecurityContext/"/>
    
    <category term="WithSecurityContextFactory" scheme="https://kdevkr.github.io/tags/WithSecurityContextFactory/"/>
    
    <category term="RequestContextListener" scheme="https://kdevkr.github.io/tags/RequestContextListener/"/>
    
  </entry>
  
  <entry>
    <title>Request Header Is Too Large</title>
    <link href="https://kdevkr.github.io/request-header-is-too-large/"/>
    <id>https://kdevkr.github.io/request-header-is-too-large/</id>
    <published>2024-03-26T14:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.104Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>java.lang.IllegalArgumentException: Request header is too large</p></blockquote><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/by-ids"</span><span class="token punctuation">)</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> <span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"ids"</span><span class="token punctuation">)</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ids<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ìœ„ì™€ ê°™ì€ GET APIëŠ” ids íŒŒë¼ë¯¸í„°ì— ëŒ€í•œ ê¸¸ì´ ì œí•œì„ ë‘ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ Request header is too large ì— ëŒ€í•œ ì·¨ì•½ì ì´ ë‚´ì¬ë˜ì–´ìˆëŠ” ìƒíƒœë¡œ ë³¼ ìˆ˜ ìˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì´ì— ëŒ€í•œ ë¬¸ì œëŠ” ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ì¢‹ì„ê¹Œ?</p><h4 id="ì²«ë²ˆì§¸-ì„œë²„ì—ì„œ-ì²˜ë¦¬í•˜ëŠ”-í—¤ë”-í¬ê¸°-ì‚¬ì´ì¦ˆë¥¼-ëŠ˜ë¦¬ì"><a href="#ì²«ë²ˆì§¸-ì„œë²„ì—ì„œ-ì²˜ë¦¬í•˜ëŠ”-í—¤ë”-í¬ê¸°-ì‚¬ì´ì¦ˆë¥¼-ëŠ˜ë¦¬ì" class="headerlink" title="ì²«ë²ˆì§¸, ì„œë²„ì—ì„œ ì²˜ë¦¬í•˜ëŠ” í—¤ë” í¬ê¸° ì‚¬ì´ì¦ˆë¥¼ ëŠ˜ë¦¬ì"></a>ì²«ë²ˆì§¸, ì„œë²„ì—ì„œ ì²˜ë¦¬í•˜ëŠ” í—¤ë” í¬ê¸° ì‚¬ì´ì¦ˆë¥¼ ëŠ˜ë¦¬ì</h4><p>ê¸°ë³¸ì ì¸ í•´ê²°ë°©ë²•ì€ ìƒê°ë³´ë‹¤ ì‘ê²Œ ì„¤ì •ë˜ì–´ìˆëŠ” í—¤ë” í¬ê¸°ë¥¼ ì–´ëŠì •ë„ ëŠ˜ë¦¬ëŠ” ê²ƒì´ë‹¤. ë‹¤ë§Œ, ì—¬ì „íˆ ì˜ˆìƒí•  ìˆ˜ ì—†ëŠ” í—¤ë” í¬ê¸°ë¥¼ ì»¤ë²„í•  ìˆ˜ ì—†ìœ¼ë©° ì´ì— ëŒ€í•œ ëŒ€ì‘ìœ¼ë¡œëŠ” GET ìš”ì²­ì´ ì•„ë‹Œ POST ìš”ì²­ì„ í™œìš©í•´ì•¼í•œë‹¤. ìš”ì²­ í—¤ë” í¬ê¸°ì— ëŒ€í•œ ì œí•œì„ ëŠ˜ë¦¬ëŠ” ë°©ì•ˆì€ ì„ì‹œ ì¡°ì¹˜ì„ì„ ìŠì§€ ë§ì.</p><pre class="language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">server.max-http-request-header-size</span><span class="token punctuation">:</span> 10MB</code></pre><h4 id="ë‘ë²ˆì§¸-URL-ì¸ì½”ë”©-ë°©ì‹ì˜-í¼-ë°ì´í„°ë¥¼-ì „ë‹¬í•˜ì"><a href="#ë‘ë²ˆì§¸-URL-ì¸ì½”ë”©-ë°©ì‹ì˜-í¼-ë°ì´í„°ë¥¼-ì „ë‹¬í•˜ì" class="headerlink" title="ë‘ë²ˆì§¸, URL ì¸ì½”ë”© ë°©ì‹ì˜ í¼ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ì"></a>ë‘ë²ˆì§¸, URL ì¸ì½”ë”© ë°©ì‹ì˜ í¼ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ì</h4><p>GET ìš”ì²­ ì‹œ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ê°€ ë„ˆë¬´ ê¸¸ì–´ì§ˆ ìˆ˜ ìˆë‹¤ë©´ í¼ ë°ì´í„° í˜•ì‹ìœ¼ë¡œ ë³´ë‚¼ ìˆ˜ ìˆë„ë¡ <strong>POST ìš”ì²­ì— ëŒ€í•´ì„œë„ ì§€ì›</strong>í•˜ë©´ ëœë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">"/by-ids"</span><span class="token punctuation">)</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> <span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"ids"</span><span class="token punctuation">)</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ids<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">"/by-ids"</span><span class="token punctuation">,</span> consumes <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">APPLICATION_FORM_URLENCODED_VALUE</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> <span class="token function">getUsersUsingFormData</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"ids"</span><span class="token punctuation">)</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ids<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">getUsers</span><span class="token punctuation">(</span>ids<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="ì°¸ê³ í• ë§Œí•œ-ë§í¬"><a href="#ì°¸ê³ í• ë§Œí•œ-ë§í¬" class="headerlink" title="ì°¸ê³ í• ë§Œí•œ ë§í¬"></a>ì°¸ê³ í• ë§Œí•œ ë§í¬</h4><ul><li><a href="https://www.baeldung.com/spring-boot-max-http-header-size">Max-Http-Request-Header-Size in Spring Boot</a></li><li><a href="https://www.baeldung.com/postman-form-data-raw-x-www-form-urlencoded">Difference Between form-data, x-www-form-urlencoded and raw in Postman</a></li><li><a href="https://www.baeldung.com/spring-url-encoded-form-data">Handling URL Encoded Form Data in Spring REST</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;java.lang.IllegalArgumentException: Request header is too large&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre class=&quot;language-java&quot; data-language=&quot;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì ˆì°¨</title>
    <link href="https://kdevkr.github.io/reset-password-flow/"/>
    <id>https://kdevkr.github.io/reset-password-flow/</id>
    <published>2024-03-22T13:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.104Z</updated>
    
    <content type="html"><![CDATA[<p>ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°ëŠ” ëŒ€ë¶€ë¶„ì˜ ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš©ìì—ê²Œ ë°˜ë“œì‹œ ìš”êµ¬ë˜ëŠ” ê¸°ëŠ¥ì´ë‹¤. ì˜¤ë˜ëœ ë ˆê±°ì‹œ ì‹œìŠ¤í…œì´ ì•„ë‹Œ ì´ìƒ ì‚¬ìš©ì ê³„ì •ì— ëŒ€í•œ ë¹„ë°€ë²ˆí˜¸ëŠ” ë³µí˜¸í™”ê°€ ë¶ˆê°€ëŠ¥í•˜ë„ë¡ ë‹¨ë°©í–¥ ì•”í˜¸í™”ëœ ê°’ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ëœë‹¤. ê·¸ë˜ì„œ ì‹¤ì§ˆì ìœ¼ë¡œ <strong>ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸° ìì²´ì˜ ìš”êµ¬ì‚¬í•­ì€ êµ¬í˜„í•  ìˆ˜ ì—†ë‹¤.</strong> íšŒì›ê°€ì… ì‹œ ì…ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì°¾ì„ ìˆ˜ëŠ” ì—†ìœ¼ë¯€ë¡œ ëŒ€ë¶€ë¶„ ë¹„ë°€ë²ˆí˜¸ ì—†ì´ ë³¸ì¸ ì¸ì¦ì„ í†µí•´ ë¡œê·¸ì¸í•  ìˆ˜ ìˆê²Œ í•˜ê±°ë‚˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¬ì„¤ì •í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì œê³µí•œë‹¤.</p><ul><li><a href="https://github.com/password_reset">https://github.com/password_reset</a></li><li><a href="https://account.samsung.com/accounts/odchb/resetPasswordGate">https://account.samsung.com/accounts/odchb/resetPasswordGate</a></li><li><a href="https://sslmember2.gmarket.co.kr/FindPW/FindPW">https://sslmember2.gmarket.co.kr/FindPW/FindPW</a></li><li><a href="https://www.jobplanet.co.kr/users/password/new">https://www.jobplanet.co.kr/users/password/new</a></li></ul><h4 id="ë¹„ë°€ë²ˆí˜¸-ì¬ì„¤ì •-ë˜ëŠ”-ì´ˆê¸°í™”"><a href="#ë¹„ë°€ë²ˆí˜¸-ì¬ì„¤ì •-ë˜ëŠ”-ì´ˆê¸°í™”" class="headerlink" title="ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ë˜ëŠ” ì´ˆê¸°í™”"></a>ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ë˜ëŠ” ì´ˆê¸°í™”</h4><p>ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì ˆì°¨ì— ëŒ€í•´ì„œ ë” ìì„¸í•˜ê²Œ ì•Œì•„ë³´ë„ë¡ í•˜ì.</p><ol><li>ë¹„ë°€ë²ˆí˜¸ë¥¼ ì°¾ê³ ìí•˜ëŠ” ì‚¬ìš©ìì—ê²Œ ì•„ì´ë”” ë˜ëŠ” ì´ë©”ì¼ ì…ë ¥ì„ ìš”êµ¬</li><li>(Optional) ë¬´ë¶„ë³„í•œ ìš”êµ¬ë¥¼ ì œí•œí•˜ê¸° ìœ„í•´ì„œ ìº¡ì°¨ ë˜ëŠ” <a href="https://www.baeldung.com/spring-bucket4j">ìš”ì²­ ì œí•œëŸ‰</a>ì„ êµ¬í˜„</li><li>ì‚¬ìš©ìì—ê²Œ <strong>ì¸ì¦</strong>í•  ìˆ˜ ìˆëŠ” <strong><a href="https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html#url-tokens">URL í† í°</a></strong> ë§í¬ë¥¼ ì œê³µ</li><li>(Optional) URL í† í°ê³¼ í•¨ê»˜ ì¸ì¦ ì½”ë“œ ì…ë ¥ì„ ìš”êµ¬</li><li>ì‚¬ìš©ìê°€ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì„ <strong>ì™„ë£Œ</strong>í–ˆë‹¤ë©´ URL í† í°ì€ ì¦‰ì‹œ <strong>ë§Œë£Œ</strong></li><li>ì‚¬ìš©ìì— ì˜í•´ ë¹„ë°€ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŒì„ ë³„ë„ <strong>ì•Œë¦¼</strong> ì œê³µ</li></ol><blockquote><p>URL ì¿¼ë¦¬ìŠ¤íŠ¸ë§ì— í¬í•¨ë˜ëŠ” ì¸ì¦ ì •ë³´ëŠ” JWT í† í°ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ê²Œ ì¼ë°˜ì ì…ë‹ˆë‹¤.</p></blockquote><p>ìœ íŠœë¸Œ <a href="https://www.youtube.com/watch?v=b5xWS8MYl0Q">ì œë¯¸ë‹ˆì˜ ê°œë°œì‹¤ë¬´</a>ì—ì„œ ê°œë°œ ìš”êµ¬ì‚¬í•­ì— ëŒ€í•´ ê·¸ëŒ€ë¡œ êµ¬í˜„í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼ ê°œë°œì ì…ì¥ì—ì„œ í•„ìš”í•˜ê±°ë‚˜ ê³ ë ¤ë˜ì–´ì•¼í•  ë¶€ë¶„ì— ëŒ€í•´ì„œ ì²´í¬í•˜ëŠ” ê²ƒë„ ê°œë°œìì˜ ì—­ëŸ‰ì´ë¼ëŠ” ë¶€ë¶„ì„ ì´ì•¼ê¸°í•˜ëŠ” ê²ƒì„ ë³´ê³  ëŒ€ë¶€ë¶„ì˜ ì‹œìŠ¤í…œì—ì„œ ìš”êµ¬í•˜ëŠ” <strong>ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</strong>ì— ëŒ€í•´ì„œ ì‚´í´ë³´ì•˜ë‹¤.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°ëŠ” ëŒ€ë¶€ë¶„ì˜ ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš©ìì—ê²Œ ë°˜ë“œì‹œ ìš”êµ¬ë˜ëŠ” ê¸°ëŠ¥ì´ë‹¤. ì˜¤ë˜ëœ ë ˆê±°ì‹œ ì‹œìŠ¤í…œì´ ì•„ë‹Œ ì´ìƒ ì‚¬ìš©ì ê³„ì •ì— ëŒ€í•œ ë¹„ë°€ë²ˆí˜¸ëŠ” ë³µí˜¸í™”ê°€ ë¶ˆê°€ëŠ¥í•˜ë„ë¡ ë‹¨ë°©í–¥ ì•”í˜¸í™”ëœ ê°’ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ëœë‹¤. ê·¸ë˜ì„œ ì‹¤ì§ˆì ìœ¼ë¡œ &lt;strong&gt;ë¹„ë°€ë²ˆ</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ë ˆë””ìŠ¤ ì›¹ì†Œì¼“ ì•ŒëŒ ë™ê¸°í™”</title>
    <link href="https://kdevkr.github.io/spring-boot-redis-websocket-sync/"/>
    <id>https://kdevkr.github.io/spring-boot-redis-websocket-sync/</id>
    <published>2024-03-14T14:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.108Z</updated>
    
    <content type="html"><![CDATA[<h4 id="ì›¹ì†Œì¼“-ì•ŒëŒ-ê°±ì‹ -ë™ê¸°í™”"><a href="#ì›¹ì†Œì¼“-ì•ŒëŒ-ê°±ì‹ -ë™ê¸°í™”" class="headerlink" title="ì›¹ì†Œì¼“ ì•ŒëŒ ê°±ì‹  ë™ê¸°í™”"></a>ì›¹ì†Œì¼“ ì•ŒëŒ ê°±ì‹  ë™ê¸°í™”</h4><p>ëŒ€ë¶€ë¶„ì˜ ì˜ˆì œëŠ” ì±„íŒ…ìœ¼ë¡œ ê³µìœ ë˜ê³  ìˆì§€ë§Œ ì¼ë°˜ì ì¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œì˜ ì›¹ì†Œì¼“ ê¸°ëŠ¥ì€ ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œì˜ ì•ŒëŒê³¼ ì´ë²¤íŠ¸ë¥¼ ì¦‰ì‹œ ì „ë‹¬í•˜ê¸° ìœ„í•´ì„œ ì‚¬ìš©í•˜ê³  ìˆì„ ê²ƒì´ë‹¤. ë‹¨ì¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” ê³ ë ¤í•˜ì§€ ì•Šì•„ë„ ë  ë¶€ë¶„ì´ì§€ë§Œ ìŠ¤ì¼€ì¼ ì•„ì›ƒë˜ì–´ ë¶„ì‚° ì²˜ë¦¬ë˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì— ê°ê° ì—°ê²°ëœ ì›¹ì†Œì¼“ìœ¼ë¡œ íŠ¹ì • ì„œë²„ì—ì„œ ë°œìƒí•˜ì—¬ ë§Œë“¤ì–´ì§€ëŠ” ì•ŒëŒ ì •ë³´ë¥¼ ì¦‰ì‹œ ì „ë‹¬í•˜ê¸° ìœ„í•´ì„œëŠ” ì „íŒŒí•˜ê³  ë™ê¸°í™”í•˜ëŠ” ë°©ì•ˆì´ í•„ìš”í•˜ë‹¤. <a href="https://pompitzz.github.io/blog/Redis/LocalCacheSyncWithRedisPubSub.html">Redis(Pub&#x2F;Sub)ë¡œ ë¡œì»¬ ìºì‹œ ë™ê¸°í™”í•˜ê¸°</a>ì™€ ë¹„ìŠ·í•˜ë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Slf4j</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token keyword">implements</span> <span class="token class-name">MessageListener</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">ChannelTopic</span> topic <span class="token operator">=</span> <span class="token class-name">ChannelTopic</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"NOTIFICATIONS"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">public</span> <span class="token class-name">StringRedisTemplate</span> redisTemplate<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">CommandLineRunner</span> <span class="token function">commandLineRunner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> args <span class="token operator">-></span> redisTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span>topic<span class="token punctuation">.</span><span class="token function">getTopic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"REQUIRE.SYNC"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">RedisMessageListenerContainer</span> <span class="token function">redisMessageListenerContainer</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> connectionFactory<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">RedisMessageListenerContainer</span> container <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisMessageListenerContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        container<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>connectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>        container<span class="token punctuation">.</span><span class="token function">addMessageListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> topic<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> container<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">MessageListenerAdapter</span> <span class="token function">listenerAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MessageListenerAdapter</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onMessage</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pattern<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"receive: &#123;&#125;"</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="í™œìš©-í´ë˜ìŠ¤-ëª©ë¡"><a href="#í™œìš©-í´ë˜ìŠ¤-ëª©ë¡" class="headerlink" title="í™œìš© í´ë˜ìŠ¤ ëª©ë¡"></a>í™œìš© í´ë˜ìŠ¤ ëª©ë¡</h4><p>ë ˆë””ìŠ¤ì— ì˜í•œ Pub&#x2F;Subì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„œ ì‚¬ìš©ë˜ëŠ” ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ í´ë˜ìŠ¤ë“¤ì€ ì•„ë˜ì™€ ê°™ë‹¤.</p><ul><li>RedisMessageListenerContainer</li><li>RedisConnectionFactory</li><li>MessageListenerAdapter</li><li>MessageListener</li><li>StringRedisTemplate</li><li>ChannelTopic</li></ul><h4 id="ì°¸ê³ -ë§í¬"><a href="#ì°¸ê³ -ë§í¬" class="headerlink" title="ì°¸ê³  ë§í¬"></a>ì°¸ê³  ë§í¬</h4><ul><li><a href="https://redis.io/docs/interact/pubsub/">How to use pub&#x2F;sub channels in Redis</a></li><li><a href="https://docs.spring.io/spring-data/redis/reference/redis/pubsub.html">Pub&#x2F;Sub Messaging</a></li><li><a href="https://www.baeldung.com/spring-data-redis-pub-sub">PubSub Messaging with Spring Data Redis</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;ì›¹ì†Œì¼“-ì•ŒëŒ-ê°±ì‹ -ë™ê¸°í™”&quot;&gt;&lt;a href=&quot;#ì›¹ì†Œì¼“-ì•ŒëŒ-ê°±ì‹ -ë™ê¸°í™”&quot; class=&quot;headerlink&quot; title=&quot;ì›¹ì†Œì¼“ ì•ŒëŒ ê°±ì‹  ë™ê¸°í™”&quot;&gt;&lt;/a&gt;ì›¹ì†Œì¼“ ì•ŒëŒ ê°±ì‹  ë™ê¸°í™”&lt;/h4&gt;&lt;p&gt;ëŒ€ë¶€ë¶„ì˜ ì˜ˆì œëŠ” ì±„íŒ…ìœ¼ë¡œ ê³µìœ ë˜ê³  ìˆì§€ë§Œ ì¼ë°˜ì </summary>
      
    
    
    
    
    <category term="Redis" scheme="https://kdevkr.github.io/tags/Redis/"/>
    
    <category term="Websocket" scheme="https://kdevkr.github.io/tags/Websocket/"/>
    
  </entry>
  
  <entry>
    <title>êµ¬ê¸€ ì£¼ì†Œ ê²€ìƒ‰ìœ¼ë¡œ ìœ„ ê²½ë„ ì¡°íšŒ</title>
    <link href="https://kdevkr.github.io/google-address-search/"/>
    <id>https://kdevkr.github.io/google-address-search/</id>
    <published>2024-03-10T14:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.104Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://mapsplatform.google.com/">Google Maps Platform</a>ì„ í†µí•´ ì£¼ì†Œ ë˜ëŠ” ìœ„ â€¢ ê²½ë„ ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤. Places ë˜ëŠ” Geocoding API ëª¨ë‘ì—ì„œ í•œêµ­ì–´ë¥¼ í¬í•¨í•œ ë‹¤ì–‘í•œ ì–¸ì–´ì— ëŒ€í•´ ê²€ìƒ‰ì„ ì§€ì›í•œë‹¤. ë¹„ë¡ êµ­ë‚´ ëŒ€ìƒìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” <a href="https://postcode.map.daum.net/guide">ìš°í¸ë²ˆí˜¸ ì„œë¹„ìŠ¤</a>ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒë³´ë‹¤ ìì„¸í•œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê¸°ëŠ” í˜ë“¤ì§€ë§Œ êµ­ë‚´ ì£¼ì†Œ ë¿ë§Œ ì•„ë‹ˆë¼ í•´ì™¸ ì£¼ì†Œë‚˜ ìœ„ì¹˜ì— ëŒ€í•œ ê²€ìƒ‰ì„ ì»¤ë²„í•˜ê¸° ìœ„í•´ì„œëŠ” ê±°ì˜ ëŒ€ì•ˆì´ ì—†ë‹¤ê³  ìƒê°ëœë‹¤. ë˜í•œ, HTTP ìš”ì²­ì„ ì§ì ‘ ì‚¬ìš©í•´ì„œ êµ¬í˜„í•˜ì§€ ì•Šì•„ë„ ì‰½ê²Œ ì ìš©í•  ìˆ˜ ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ìˆë‹¤.</p><ul><li><a href="https://github.com/googlemaps/react-wrapper">Google Maps JavaScript API React Wrapper</a></li><li><a href="https://vue-map.netlify.app/">Vue 3 Google maps</a></li><li><a href="https://github.com/googlemaps/google-maps-services-java">Java Client for Google Maps Services</a></li></ul><h4 id="FE-Vue-3-Google-maps"><a href="#FE-Vue-3-Google-maps" class="headerlink" title="[FE] Vue 3 Google maps"></a>[FE] Vue 3 Google maps</h4><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createApp <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token keyword">import</span> <span class="token string">'./style.css'</span><span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span><span class="token keyword">import</span> VueGoogleMaps <span class="token keyword">from</span> <span class="token string">'@fawmi/vue-google-maps'</span><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueGoogleMaps<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>    <span class="token literal-property property">load</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_GOOGLE_MAP_API_KEY</span><span class="token punctuation">,</span>        <span class="token literal-property property">libraries</span><span class="token operator">:</span> <span class="token string">"places"</span><span class="token punctuation">,</span>        <span class="token literal-property property">language</span><span class="token operator">:</span> <span class="token string">'ja'</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span></code></pre><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>GMapAutocomplete</span>    <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Please input address<span class="token punctuation">"</span></span>    <span class="token attr-name">@place_changed</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>(result) => console.log(result)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>GMapAutocomplete</span><span class="token punctuation">></span></span></code></pre><h4 id="BE-Java-Client-for-Google-Maps-Services"><a href="#BE-Java-Client-for-Google-Maps-Services" class="headerlink" title="[BE] Java Client for Google Maps Services"></a>[BE] Java Client for Google Maps Services</h4><pre class="language-groovy" data-language="groovy"><div class="caption"><span>build.gradle</span></div><code class="language-groovy">dependencies <span class="token punctuation">&#123;</span>    implementation <span class="token string">'com.google.maps:google-maps-services:2.2.0'</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootTest</span><span class="token keyword">class</span> <span class="token class-name">GoogleMapTests</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> apiKey <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Gson</span> gson <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GsonBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setPrettyPrinting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">void</span> <span class="token class-name">Test_Places</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Assertions</span><span class="token punctuation">.</span><span class="token function">assertDoesNotThrow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>            <span class="token class-name">GeoApiContext</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GeoApiContext<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">apiKey</span><span class="token punctuation">(</span>apiKey<span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">queryRateLimit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">PlaceAutocompleteRequest<span class="token punctuation">.</span>SessionToken</span> session <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PlaceAutocompleteRequest<span class="token punctuation">.</span>SessionToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> input <span class="token operator">=</span> <span class="token string">"ê°•ë‚¨ì—­"</span><span class="token punctuation">;</span>            <span class="token class-name">AutocompletePrediction</span><span class="token punctuation">[</span><span class="token punctuation">]</span> predictions <span class="token operator">=</span> <span class="token class-name">PlacesApi</span><span class="token punctuation">.</span><span class="token function">placeAutocomplete</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> input<span class="token punctuation">,</span> session<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>gson<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span>predictions<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            context<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="Place-Autocomplete-ìµœì í™”"><a href="#Place-Autocomplete-ìµœì í™”" class="headerlink" title="Place Autocomplete ìµœì í™”"></a>Place Autocomplete ìµœì í™”</h4><p>Places API ì™€ Geocoding API ëª¨ë‘ <a href="https://developers.google.com/maps/documentation/geocoding/usage-and-billing">ì‚¬ìš©í•œ ë§Œí¼ ì§€ë¶ˆí•˜ëŠ” ê°€ê²© ëª¨ë¸</a>ì„ ê°€ì§€ë¯€ë¡œ <a href="https://developers.google.com/maps/documentation/places/web-service/autocomplete">Place Autocomplete ìµœì í™”</a> ì™€ <a href="https://developers.google.com/maps/documentation/geocoding/best-practices">ì£¼ì†Œ ì§€ì˜¤ì½”ë”© ê¶Œì¥ì‚¬í•­</a> ê°™ì€ ì •ë³´ê°€ ë„ì›€ì´ ë  ìˆ˜ ìˆë‹¤. ì£¼ì†Œì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ê°€ í•„ìš”í•œ ê²ƒì´ ì•„ë‹Œ ì£¼ì†Œ ë° ìœ„ì¹˜ ì •ë³´ë§Œ í•„ìš”ë¡œ í•˜ëŠ” ê²½ìš°ì—ëŠ” ì•„ë˜ì˜ í•­ëª©ì„ ì²´í¬í•´ë³´ë„ë¡ í•˜ì.</p><ul><li>ì£¼ì†Œì™€ ìœ„ì¹˜ ì •ë³´ë§Œì„ í•„ìš”ë¡œ í•œë‹¤ë©´ Place Autocomplete ë³´ë‹¤ëŠ” Geocoding APIê°€ íš¨ìœ¨ì ì´ë‹¤.</li><li>ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ì£¼ì†Œë¥¼ ëª…í™•í•˜ê²Œ ì•Œê³  ìˆë‹¤ë©´ Geocoding APIë¥¼ ì‚¬ìš©í•˜ëŠ”ê²Œ ì¢‹ë‹¤.</li></ul><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootTest</span><span class="token keyword">class</span> <span class="token class-name">GoogleMapTests</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> apiKey <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Gson</span> gson <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GsonBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setPrettyPrinting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token class-name">GeoApiContext</span> context<span class="token punctuation">;</span>    <span class="token annotation punctuation">@BeforeAll</span>    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GeoApiContext<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">apiKey</span><span class="token punctuation">(</span>apiKey<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">queryRateLimit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token annotation punctuation">@Test</span>    <span class="token keyword">void</span> <span class="token class-name">Test_Geocoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Assertions</span><span class="token punctuation">.</span><span class="token function">assertDoesNotThrow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> address <span class="token operator">=</span> <span class="token string">"ê°•ë‚¨ì—­"</span><span class="token punctuation">;</span>            <span class="token class-name">GeocodingResult</span><span class="token punctuation">[</span><span class="token punctuation">]</span> results <span class="token operator">=</span>  <span class="token class-name">GeocodingApi</span><span class="token punctuation">.</span><span class="token function">geocode</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> address<span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">language</span><span class="token punctuation">(</span><span class="token string">"ko"</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">locationType</span><span class="token punctuation">(</span><span class="token class-name">LocationType</span><span class="token punctuation">.</span><span class="token constant">ROOFTOP</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">resultType</span><span class="token punctuation">(</span><span class="token class-name">AddressType</span><span class="token punctuation">.</span><span class="token constant">STREET_ADDRESS</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>gson<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            context<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="Samples"><a href="#Samples" class="headerlink" title="Samples"></a>Samples</h4><ul><li><a href="https://developers.google.com/maps/documentation/javascript/examples/geocoding-simple">Geocoding Service</a></li><li><a href="https://developers.google.com/maps/documentation/javascript/examples/geocoding-reverse">Reverse Geocoding</a></li><li><a href="https://developers.google.com/maps/documentation/javascript/examples/geocoding-place-id">Get the Address for a Place ID</a></li><li><a href="https://developers.google.com/maps/documentation/javascript/examples/places-autocomplete">Place Autocomplete</a></li><li><a href="https://developers.google.com/maps/documentation/javascript/examples/place-details">Place Details</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://mapsplatform.google.com/&quot;&gt;Google Maps Platform&lt;/a&gt;ì„ í†µí•´ ì£¼ì†Œ ë˜ëŠ” ìœ„ â€¢ ê²½ë„ ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤. Places ë˜ëŠ” Geocoding API ëª¨ë‘ì—ì„œ í•œêµ­ì–´ë¥¼ í¬í•¨í•œ </summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ì—”ì§„ì—‘ìŠ¤ íŠ¸ë˜í”½ ë¯¸ëŸ¬ë§</title>
    <link href="https://kdevkr.github.io/nginx-mirror/"/>
    <id>https://kdevkr.github.io/nginx-mirror/</id>
    <published>2024-03-02T03:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.104Z</updated>
    
    <content type="html"><![CDATA[<p>ì—”ì§„ì—‘ìŠ¤(Nginx)ì˜ <code>ngx_http_mirror_module</code> ëª¨ë“ˆì„ ì‚¬ìš©í•˜ë©´ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì „ë‹¬í•˜ëŠ” <a href="https://medium.com/gaurav-shukla/testing-your-code-against-production-using-nginx-mirroring-567b3c2f4921">ì¼ë¶€ íŠ¸ë˜í”½ì„ ë³µì œí•˜ì—¬ ë‹¤ë¥¸ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ ì „ë‹¬</a>í•  ìˆ˜ ìˆë‹¤. ìš°ë¦¬ëŠ” ì´ê²ƒì„ í™œìš©í•´ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì „ë‹¬í•˜ëŠ” íŠ¸ë˜í”½ì„ ì•Œ ìˆ˜ ì—†ëŠ” ìƒí™©ì´ì§€ë§Œ ì–´ë– í•œ ë¬¸ì œê°€ ë°œìƒí•˜ê³  ìˆì„ë•Œ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ì–´ì„œ êµ¬ë™í•˜ê³  ë””ë²„ê·¸í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤.</p><h4 id="íŠ¸ë˜í”½-ë¯¸ëŸ¬ë§-ì„¤ì •"><a href="#íŠ¸ë˜í”½-ë¯¸ëŸ¬ë§-ì„¤ì •" class="headerlink" title="íŠ¸ë˜í”½ ë¯¸ëŸ¬ë§ ì„¤ì •"></a>íŠ¸ë˜í”½ ë¯¸ëŸ¬ë§ ì„¤ì •</h4><pre class="language-conf" data-language="conf"><div class="caption"><span>nginx.conf</span></div><code class="language-conf">http &#123;    upstream backend_for_test &#123;        server app:8081;        keepalive 128;    &#125;    server &#123;        proxy_set_header Host $host;        proxy_set_header X-Real-IP $remote_addr;        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;        # hop-by-hop        proxy_http_version 1.1;        location &#x2F;mtls&#x2F; &#123;            proxy_pass http:&#x2F;&#x2F;backend;            mirror &#x2F;mirror;            mirror_request_body on;        &#125;        location &#x2F;mtls_mirror &#123;            internal;            proxy_pass http:&#x2F;&#x2F;backend_for_test$request_uri;        &#125;    &#125;&#125;</code></pre><blockquote><p>ë¬¸ì œì— ëŒ€í•œ ì›ì¸ì„ íŒŒì•…í•˜ê¸° ìœ„í•œ ìš”ì²­ì— ë°”ë”” ì •ë³´ê°€ í•„ìš”í•˜ì§€ ì•Šì€ ê²½ìš° mirror_request_body ì˜µì…˜ì„ ë¹„í™œì„±í™”(off) í•˜ì„¸ìš”.</p></blockquote><h4 id="íŠ¸ë˜í”½-ë¯¸ëŸ¬ë§-ì¶œë ¥"><a href="#íŠ¸ë˜í”½-ë¯¸ëŸ¬ë§-ì¶œë ¥" class="headerlink" title="íŠ¸ë˜í”½ ë¯¸ëŸ¬ë§ ì¶œë ¥"></a>íŠ¸ë˜í”½ ë¯¸ëŸ¬ë§ ì¶œë ¥</h4><p>ì¼ë°˜ì ìœ¼ë¡œ ì„œë²„ í¬íŠ¸ ì˜¤í”ˆì„ í™•ì¸í•˜ëŠ”ë° ì‚¬ìš©í•˜ëŠ” Netcat ëª…ë ¹ì–´ë¥¼ í†µí•´ ê°„ë‹¨í•œ ì„œë²„ë¥¼ ì‹¤í–‰í•˜ê³  ë³µì œëœ íŠ¸ë˜í”½ì— ëŒ€í•œ ì •ë³´ë¥¼ ì¶œë ¥í•´ë³¼ ìˆ˜ ìˆë‹¤.</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">nc</span> <span class="token parameter variable">-lp</span> localhost <span class="token number">8081</span></code></pre><blockquote><p>AWS í™˜ê²½ì—ì„œ ìš´ì˜í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•œ íŠ¸ë˜í”½ ë¯¸ëŸ¬ë§ì€ <a href="https://aws.amazon.com/ko/blogs/tech/mirror-production-traffic-to-test-environment-with-vpc-traffic-mirroring/">VPC íŠ¸ë˜í”½ ë¯¸ëŸ¬ë§</a>ì„ êµ¬ì„±í•˜ëŠ” ê²ƒì´ ì í•©í•©ë‹ˆë‹¤.</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ì—”ì§„ì—‘ìŠ¤(Nginx)ì˜ &lt;code&gt;ngx_http_mirror_module&lt;/code&gt; ëª¨ë“ˆì„ ì‚¬ìš©í•˜ë©´ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì „ë‹¬í•˜ëŠ” &lt;a href=&quot;https://medium.com/gaurav-shukla/testing-your-co</summary>
      
    
    
    
    
    <category term="nginx" scheme="https://kdevkr.github.io/tags/nginx/"/>
    
    <category term="mirror" scheme="https://kdevkr.github.io/tags/mirror/"/>
    
  </entry>
  
  <entry>
    <title>AWS Elastic Beanstalk ë¡œê·¸ ì•Œì•„ë³´ê¸°</title>
    <link href="https://kdevkr.github.io/beanstalk-logs/"/>
    <id>https://kdevkr.github.io/beanstalk-logs/</id>
    <published>2024-03-01T14:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.100Z</updated>
    
    <content type="html"><![CDATA[<p><img data-src="/images/posts/beanstalk-logs/01.png"></p><p>AWS Elastic Beanstalk í™˜ê²½ ì½˜ì†”ì˜ ë¡œê·¸ ë©”ë‰´ì—ì„œ ë¡œê·¸ ìš”ì²­ì„ í†µí•´ ì „ì²´(ë²ˆë“¤) ë˜ëŠ” ë§ˆì§€ë§‰ 100ì¤„(í…Œì¼) ë¡œê·¸ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤. ì´ëŸ¬í•œ ìš”ì²­ì— ëŒ€í•œ ë¡œê·¸ëŠ” ì•„ë˜ì˜ íŒŒì¼ë“¤ì„ ì‚¬ìš©í•˜ì—¬ ê°€ì ¸ì˜¤ë©° ì‚¬ìš©ì ê¶Œí•œì„ í†µí•´ S3 ë²„í‚·ì— ì €ì¥í•œ í›„ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆê²Œ ì œê³µí•œë‹¤. ë”°ë¼ì„œ, ì¸ìŠ¤í„´ìŠ¤ í”„ë¡œíŒŒì¼ì— S3ì— ëŒ€í•œ ê¶Œí•œ ì •ì±…ì´ í¬í•¨ë˜ì–´ìˆì–´ì•¼ í•œë‹¤.</p><ul><li>í…Œì¼ ë¡œê·¸ - &#x2F;opt&#x2F;elasticbeanstalk&#x2F;tasks&#x2F;taillogs.d&#x2F;</li><li>ë²ˆë“¤ ë¡œê·¸ - &#x2F;opt&#x2F;elasticbeanstalk&#x2F;tasks&#x2F;bundlelogs.d&#x2F;</li><li>íšŒì „ëœ ë¡œê·¸ - &#x2F;opt&#x2F;elasticbeanstalk&#x2F;tasks&#x2F;publishlogs.d&#x2F;</li></ul><blockquote><p>S3ì— ì €ì¥ë˜ëŠ” ë¡œê·¸ ìœ„ì¹˜ëŠ” elasticbeanstalk-{region}-{account-id}&#x2F;resources&#x2F;environments&#x2F;logs ì…ë‹ˆë‹¤.<br>Elastic BeanstalkëŠ” ìš”ì²­í•œ ë²ˆë“¤ ë˜ëŠ” í…Œì¼ ë¡œê·¸ì— ëŒ€í•´ì„œ 15ë¶„ì´ ê²½ê³¼ëœ ì´í›„ì— íŒŒì¼ì„ S3ì—ì„œ ì‚­ì œí•©ë‹ˆë‹¤.</p></blockquote><h4 id="í…Œì¼-ë¡œê·¸"><a href="#í…Œì¼-ë¡œê·¸" class="headerlink" title="í…Œì¼ ë¡œê·¸"></a>í…Œì¼ ë¡œê·¸</h4><p>í…Œì¼(ë§ˆì§€ë§‰ 100ì¤„) ë¡œê·¸ëŠ” EB ì—”ì§„ ë° Nginx ê·¸ë¦¬ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ ë¡œê·¸ì˜ ë§ˆì§€ë§‰ 100ì¤„ì„ ëª¨ì•„ ë‹¨ì¼ í…ìŠ¤íŠ¸ íŒŒì¼ì„ ìƒì„±í•˜ê³  S3ì— ì—…ë¡œë“œí•œë‹¤. Amazon Linux 2 ë¦¬ëˆ…ìŠ¤ í”Œë«í¼ì—ì„œ í¬í•¨ë˜ëŠ” ë¡œê·¸ í•­ëª©ì€ ì•„ë˜ì™€ ê°™ë‹¤.</p><ul><li>&#x2F;var&#x2F;log&#x2F;web.stdout.log</li><li>&#x2F;var&#x2F;log&#x2F;eb-engine.log</li><li>&#x2F;var&#x2F;log&#x2F;eb-hooks.log</li><li>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</li><li>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;error.log</li></ul><h4 id="ë²ˆë“¤-ë¡œê·¸"><a href="#ë²ˆë“¤-ë¡œê·¸" class="headerlink" title="ë²ˆë“¤ ë¡œê·¸"></a>ë²ˆë“¤ ë¡œê·¸</h4><p>ë²ˆë“¤(ì „ì²´) ë¡œê·¸ëŠ” ì‹œìŠ¤í…œ ì „ì²´ ë©”ì‹œì§€ ë¿ë§Œ ì•„ë‹ˆë¼ yum ë° cron ë¡œê·¸ì™€ ê°™ì€ ë‹¤ì–‘í•œ ë¡œê·¸ë¥¼ í¬í•¨í•˜ì—¬ Zip íŒŒì¼ë¡œ ì••ì¶•í•œ í›„ S3ì— ì—…ë¡œë“œí•œë‹¤. ë‹¤ìš´ë¡œë“œí•œ ë²ˆë“¤ ë¡œê·¸ì—ëŠ” ì•„ë˜ì™€ ê°™ì€ ë¡œê·¸ í•­ëª©ì´ í¬í•¨ë˜ì–´ìˆë‹¤.</p><ul><li>&#x2F;var&#x2F;log&#x2F;healthd&#x2F;</li><li>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;</li><li>&#x2F;var&#x2F;log&#x2F;rotate&#x2F;</li><li>&#x2F;var&#x2F;log&#x2F;cfn-hup.log</li><li>&#x2F;var&#x2F;log&#x2F;cfn-init.log</li><li>&#x2F;var&#x2F;log&#x2F;cfn-init-cmd.log</li><li>&#x2F;var&#x2F;log&#x2F;cfn-wire.log</li><li>&#x2F;var&#x2F;log&#x2F;cloud-init.log</li><li>&#x2F;var&#x2F;log&#x2F;cloud-init-output.log</li><li>&#x2F;var&#x2F;log&#x2F;cron</li><li>&#x2F;var&#x2F;log&#x2F;eb-cfn-init.log</li><li>&#x2F;var&#x2F;log&#x2F;eb-cfn-init-call.log</li><li>&#x2F;var&#x2F;log&#x2F;eb-engine.log</li><li>&#x2F;var&#x2F;log&#x2F;eb-publish.log</li><li>&#x2F;var&#x2F;log&#x2F;eb-tools.log</li><li>&#x2F;var&#x2F;log&#x2F;messages</li><li>&#x2F;var&#x2F;log&#x2F;web.stdout.log</li><li>&#x2F;var&#x2F;log&#x2F;yum.log</li></ul><blockquote><p>ë²ˆë“¤ ë¡œê·¸ì—ëŠ” ì‹œìŠ¤í…œ ì „ë°˜ì ì¸ ë©”ì‹œì§€ë¥¼ í¬í•¨í•˜ëŠ” &#x2F;var&#x2F;log&#x2F;messages ê°€ í¬í•¨ë˜ì–´ìˆì–´ ë” ìì„¸í•˜ê²Œ ì›ì¸ì„ ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></blockquote><h4 id="ë¡œê·¸-ë¡œí…Œì´ì…˜"><a href="#ë¡œê·¸-ë¡œí…Œì´ì…˜" class="headerlink" title="ë¡œê·¸ ë¡œí…Œì´ì…˜"></a>ë¡œê·¸ ë¡œí…Œì´ì…˜</h4><p>AWS Elastic Beanstalk ì˜ ë¦¬ëˆ…ìŠ¤ í”Œë«í¼ì—ì„œëŠ” logrotate ë¥¼ ì‚¬ìš©í•´ì„œ ë¡œê·¸ë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ íšŒì „í•˜ê³  Amazon S3ì— ì—…ë¡œë“œí•œë‹¤. í™˜ê²½ ì½˜ì†”ì—ì„œ ìš”ì²­í•˜ëŠ” ë²ˆë“¤ ë˜ëŠ” ë§ˆì§€ë§‰ 100ì¤„ ë¡œê·¸ ìš”ì²­ì—ëŠ” íšŒì „ë˜ëŠ” ë¡œê·¸ëŠ” í¬í•¨ë˜ì§€ ì•ŠëŠ”ë‹¤. ë¡œê·¸ íšŒì „ì— ëŒ€í•œ êµ¬ì„± íŒŒì¼ì€ &#x2F;etc&#x2F;logrotate.elasticbeanstalk.hourly&#x2F; ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìœ¼ë©° &#x2F;etc&#x2F;cron.hourly&#x2F; ì—ì„œ í¬ë¡  ì‘ì—…ìœ¼ë¡œ í˜¸ì¶œëœë‹¤.</p><hr><p>ì„œë²„ ì—”ì§€ë‹ˆì–´ ë˜ëŠ” ë°ë¸Œì˜µìŠ¤ ì—”ì§€ë‹ˆì–´ì—ê²Œ ì „ë‹¬ë°›ì€ ë¡œê·¸ë“¤ì´ ì–´ë– í•œ ì •ë³´ë¥¼ í¬í•¨í•˜ê³  ìˆëŠ”ì§€ë¥¼ ì•Œê³  ë¹ ë¥´ê³  ìì„¸í•˜ê²Œ ë¬¸ì œì— ëŒ€í•œ ì›ì¸ì„ ë¶„ì„í•˜ëŠ”ë°ì— ì‚¬ìš©í•˜ëŠ” ê²ƒì— ëŒ€í•œ ì—­ëŸ‰ì€ ë°±ì—”ë“œ ì—”ì§€ë‹ˆì–´ì—ê²Œ í•„ìš”í•œ ë¶€ë¶„ì´ë‹¤.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;img data-src=&quot;/images/posts/beanstalk-logs/01.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;AWS Elastic Beanstalk í™˜ê²½ ì½˜ì†”ì˜ ë¡œê·¸ ë©”ë‰´ì—ì„œ ë¡œê·¸ ìš”ì²­ì„ í†µí•´ ì „ì²´(ë²ˆë“¤) ë˜ëŠ” ë§ˆì§€ë§‰ 100ì¤„(í…Œì¼) ë¡œê·¸ë¥¼ ì¡°íšŒí• </summary>
      
    
    
    
    
    <category term="Beanstalk" scheme="https://kdevkr.github.io/tags/Beanstalk/"/>
    
    <category term="TailLogs" scheme="https://kdevkr.github.io/tags/TailLogs/"/>
    
    <category term="Bundlelogs" scheme="https://kdevkr.github.io/tags/Bundlelogs/"/>
    
  </entry>
  
  <entry>
    <title>ë¬¸ìì—´ì—ì„œ ë¡œì¼€ì¼ë¡œ ë³€í™˜í•˜ëŠ” ë°©ë²•</title>
    <link href="https://kdevkr.github.io/java-locale-from-language/"/>
    <id>https://kdevkr.github.io/java-locale-from-language/</id>
    <published>2024-02-21T14:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.104Z</updated>
    
    <content type="html"><![CDATA[<h4 id="Locale-forLanguageTag"><a href="#Locale-forLanguageTag" class="headerlink" title="Locale.forLanguageTag"></a>Locale.forLanguageTag</h4><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Locale</span><span class="token punctuation">.</span><span class="token function">forLanguageTag</span><span class="token punctuation">(</span><span class="token string">"ko_KR"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// â†’ ""</span><span class="token class-name">Locale</span><span class="token punctuation">.</span><span class="token function">forLanguageTag</span><span class="token punctuation">(</span><span class="token string">"ko_KR"</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"_"</span><span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// â†’ ko_KR</span></code></pre><p>Locale.forLanguageTag í•¨ìˆ˜ì—ì„œ <code>ko-KR</code> ì´ ì•„ë‹Œ <code>ko_KR</code> ê³¼ ê°™ì´ ì–¸ì–´(Langauge)ì™€ êµ­ê°€(Country)ì— ëŒ€í•œ ì •ë³´ë¥¼ ì–¸ë”ìŠ¤ì½”ì–´ í˜•íƒœì˜ ë¬¸ìì—´ì„ íŒŒë¼ë¯¸í„°ì— ë„£ëŠ” ê²½ìš° ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•Šê³  <strong>ë¹„ì–´ìˆëŠ” Locale</strong>ì´ ë§Œë“¤ì–´ì§„ë‹¤. ë”°ë¼ì„œ, <code>Locale.forLanguageTag</code> í•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ ë¡œì¼€ì¼ë¡œ ë³€í™˜í•˜ë ¤ëŠ” ê²½ìš°ì—ëŠ” <strong>ì–¸ë”ìŠ¤ì½”ì–´(_)ë¥¼ í•˜ì´í”ˆ(-)ìœ¼ë¡œ ë³€í™˜</strong>í•´ì•¼í•œë‹¤.</p><h4 id="LocaleUtils-ì™€-StringUtils"><a href="#LocaleUtils-ì™€-StringUtils" class="headerlink" title="LocaleUtils ì™€ StringUtils"></a>LocaleUtils ì™€ StringUtils</h4><p>String í´ë˜ìŠ¤ì— í¬í•¨ë˜ì–´ìˆëŠ” replace í•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ <code>IETF BCP 47 ì–¸ì–´ íƒœê·¸</code> í˜•ì‹ìœ¼ë¡œ ë³€ê²½í•´ë„ ë˜ì§€ë§Œ ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ ë˜ëŠ” í”„ë¡œì íŠ¸ì—ì„œ ë§ì´ ì‚¬ìš©ë˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì— í¬í•¨ë˜ì–´ìˆëŠ” ì•„ë˜ì™€ ê°™ì€ ìœ í‹¸ í•¨ìˆ˜ë“¤ì„ ì´ìš©í•´ë„ ë¬¸ìì—´ì„ Localeë¡œ ì˜¬ë°”ë¥´ê²Œ ë³€í™˜í•  ìˆ˜ ìˆë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>lang3<span class="token punctuation">.</span></span>LocaleUtils</span><span class="token punctuation">.</span><span class="token function">toLocale</span><span class="token punctuation">(</span><span class="token string">"ko_KR"</span><span class="token punctuation">)</span>l<span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>StringUtils</span><span class="token punctuation">.</span><span class="token function">parseLocale</span><span class="token punctuation">(</span><span class="token string">"ko_KR"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;Locale-forLanguageTag&quot;&gt;&lt;a href=&quot;#Locale-forLanguageTag&quot; class=&quot;headerlink&quot; title=&quot;Locale.forLanguageTag&quot;&gt;&lt;/a&gt;Locale.forLanguageTag&lt;/</summary>
      
    
    
    
    
    <category term="Locale" scheme="https://kdevkr.github.io/tags/Locale/"/>
    
    <category term="LocaleUtils" scheme="https://kdevkr.github.io/tags/LocaleUtils/"/>
    
    <category term="StringUtils" scheme="https://kdevkr.github.io/tags/StringUtils/"/>
    
  </entry>
  
  <entry>
    <title>ë¼ì¸ ë¡œê·¸ì¸ ì—°ë™</title>
    <link href="https://kdevkr.github.io/line-login/"/>
    <id>https://kdevkr.github.io/line-login/</id>
    <published>2024-02-18T13:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.104Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ë³¸ ê¸€ì— ëŒ€í•œ ì½”ë“œëŠ” <a href="https://github.com/kdevkr/spring-boot-line-login">kdevkr&#x2F;spring-boot-line-login</a> ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></blockquote><p>ìš°ë¦¬ê°€ ì´ìš©í•˜ëŠ” ìˆ˜ ë§ì€ ì›¹ ì„œë¹„ìŠ¤ì—ì„œëŠ” íšŒì›ê°€ì… í•œ ê³„ì • í˜¹ì€ ì´ë©”ì¼ë¡œ ë¡œê·¸ì¸í•˜ê¸° ë¿ë§Œ ì•„ë‹ˆë¼ ì¹´ì¹´ì˜¤, ë„¤ì´ë²„, êµ¬ê¸€, ë©”íƒ€, ì• í”Œ, ê¹ƒí—ˆë¸Œì™€ ê°™ì€ ì†Œì…œ í”„ë¡œë°”ì´ë”ì˜ ê³„ì •ìœ¼ë¡œ ì¸ì¦í•˜ì—¬ ì‰½ê²Œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆëŠ” ì—°ë™ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤. êµ­ë‚´ì˜ ê²½ìš° ëŒ€ë¶€ë¶„ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì´ë‚˜ ë„¤ì´ë²„ ë¡œê·¸ì¸ì„ ì‚¬ìš©í•˜ëŠ” í¸ì¸ë° ë¼ì¸ í”ŒëŸ¬ìŠ¤ì—ì„œ ì œê³µí•˜ëŠ” ë¼ì¸ ë©”ì‹ ì €ëŠ” êµ­ë‚´ ë³´ë‹¤ëŠ” ì¼ë³¸ì´ë‚˜ íƒœêµ­ê³¼ ê°™ì€ í•´ì™¸ êµ­ê°€ì—ì„œ ë§ì´ ì‚¬ìš©ë˜ëŠ” í¸ì´ë‹¤. <a href="https://linepluscorp.com/">ë¼ì¸ í”ŒëŸ¬ìŠ¤</a>ê°€ ìˆì§€ë§Œ ë¼ì¸ ê°œë°œì ì‚¬ì´íŠ¸ ë° ê°œë°œ ë¬¸ì„œì˜ ê²½ìš° ì˜ì–´ì™€ ì¼ë³¸ì–´ë§Œ ì§€ì›í•˜ê³  ìˆë‹¤. ë§Œì•½, íšŒì‚¬ì—ì„œ ë§Œë“œëŠ” ì„œë¹„ìŠ¤ê°€ ì¼ë³¸ì´ë‚˜ íƒœêµ­ ê·¸ë¦¬ê³  ë§ë ˆì‹œì´ì•„ êµ­ê°€ì˜ ê³ ê°ë“¤ì„ ëŒ€ìƒìœ¼ë¡œ í•œë‹¤ë©´ ë¼ì¸ ë©”ì‹ ì €ë¥¼ í†µí•œ ì—°ë™ ê¸°ëŠ¥ ì§€ì›ì€ ê±°ì˜ í•„ìˆ˜ì ìœ¼ë¡œ ë„ì…ë  ê°€ëŠ¥ì„±ì´ ìˆë‹¤.</p><p><img data-src="https://lineapiusecase.com/img/LINE_login_en.webp" alt="LINE Login Diagram"></p><h4 id="LINE-Developers-Console"><a href="#LINE-Developers-Console" class="headerlink" title="LINE Developers Console"></a>LINE Developers Console</h4><p><a href="https://manager.line.biz/">ë¼ì¸ ë¹„ì¦ˆë‹ˆìŠ¤ ì½˜ì†”</a>ì„ í†µí•´ ë¹„ì¦ˆë‹ˆìŠ¤ ê³„ì •ì„ ìƒì„±í•  ìˆ˜ ìˆìœ¼ë©° ë¼ì¸ ë¹„ì¦ˆë‹ˆìŠ¤ ê³„ì •ì„ ë§Œë“  í›„ì— <a href="https://developers.line.biz/">ê°œë°œì ì½˜ì†”</a>ì— ë³„ë„ë¡œ ì ‘ì†í•˜ì—¬ ë¼ì¸ ë¡œê·¸ì¸ ì´ë‚˜ ë©”ì‹œì§€ ì±„ë„ì„ ë“±ë¡í•˜ê³  ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ë¼ì¸ í”Œë«í¼ì— ì—°ë™í•  ì„œë¹„ìŠ¤ í”„ë¡œë°”ì´ë”ë¥¼ ìƒì„±í•´ì•¼í•˜ë©° ë¼ì¸ ë¡œê·¸ì¸ê³¼ ë©”ì‹œì§• API ì±„ë„ì€ ë³„ë„ë¡œ êµ¬ë¶„ë˜ì–´ ë§Œë“¤ì–´ì§„ë‹¤. ê° ì±„ë„ì€ ë³„ë„ë¡œ ìš´ì˜ë  ìˆ˜ ìˆì§€ë§Œ ë¼ì¸ ë¡œê·¸ì¸ ì±„ë„ì— ì¹œêµ¬ ì˜µì…˜ìœ¼ë¡œ ë©”ì‹œì§€ ì±„ë„ ê³„ì •ì„ ì—°ê²°í•  ìˆ˜ ìˆê²Œ ì§€ì›í•œë‹¤.</p><blockquote><p>ë¼ì¸ ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ ì±„ë„ì— ì—°ë™í•˜ë”ë¼ë„ ì„œë¹„ìŠ¤ ì•±ì—ì„œ ì‚¬ìš©ìì—ê²Œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ê¸° ìœ„í•´ì„œëŠ” ì‚¬ìš©ìê°€ ë©”ì‹œì§€ ì±„ë„ì— ì¹œêµ¬ë¡œ ë“±ë¡ë˜ì–´ìˆì–´ì•¼ë§Œ í•©ë‹ˆë‹¤.</p></blockquote><h4 id="ë¼ì¸-ë¡œê·¸ì¸-ì±„ë„-ì¶”ê°€í•˜ê¸°"><a href="#ë¼ì¸-ë¡œê·¸ì¸-ì±„ë„-ì¶”ê°€í•˜ê¸°" class="headerlink" title="ë¼ì¸ ë¡œê·¸ì¸ ì±„ë„ ì¶”ê°€í•˜ê¸°"></a>ë¼ì¸ ë¡œê·¸ì¸ ì±„ë„ ì¶”ê°€í•˜ê¸°</h4><p>ì‚¬ìš©ìê°€ ë¼ì¸ í”Œë«í¼ì„ í†µí•´ ì„œë¹„ìŠ¤ì— ì—°ë™í•  ìˆ˜ ìˆë„ë¡ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°©ì‹ì˜ ë¼ì¸ ë¡œê·¸ì¸ ì±„ë„ì„ ì¶”ê°€í•´ì•¼í•œë‹¤. ì„œë¹„ìŠ¤ ì§€ì—­ ì˜µì…˜ì˜ ê²½ìš° ì¼ë³¸ â€¢ íƒœêµ­ â€¢ ëŒ€ë§Œ â€¢ ì¸ë„ë„¤ì´ì‚¬ ë¿ì´ë©° í•œêµ­ì„ ì„ íƒí•  ìˆ˜ ì—†ëŠ”ê²Œ ì˜ì•„í•˜ê¸´ í•˜ì§€ë§Œ êµ­ë‚´ì˜ ê²½ìš° ê°€ì¥ ê°€ê¹Œìš´ ì¼ë³¸ì„ ì„ íƒí•˜ë©´ ë  ê²ƒ ê°™ë‹¤.</p><p><img data-src="/images/posts/line-login/01.png"></p><h4 id="ë¼ì¸-ë¡œê·¸ì¸-ì½œë°±-ì£¼ì†Œ-ì„¤ì •"><a href="#ë¼ì¸-ë¡œê·¸ì¸-ì½œë°±-ì£¼ì†Œ-ì„¤ì •" class="headerlink" title="ë¼ì¸ ë¡œê·¸ì¸ ì½œë°± ì£¼ì†Œ ì„¤ì •"></a>ë¼ì¸ ë¡œê·¸ì¸ ì½œë°± ì£¼ì†Œ ì„¤ì •</h4><p>ë¼ì¸ ë¡œê·¸ì¸ ì±„ë„ì„ ì¶”ê°€í–ˆë‹¤ë©´ LINE Login ì„¤ì • í˜ì´ì§€ë¡œ ì´ë™í•˜ì—¬ ë¼ì¸ ë¡œê·¸ì¸ ê³¼ì •ì—ì„œ ë¼ì¸ í”Œë«í¼ì´ ì¸ì¦ëœ ì½”ë“œë¥¼ ì „ë‹¬í•´ì¤„ ì„œë¹„ìŠ¤ ì½œë°± ì£¼ì†Œë¥¼ ë“±ë¡í•´ë‘ì–´ì•¼ í•œë‹¤. ë°˜ë“œì‹œ ë°±ì—”ë“œ ì„œë²„ ì£¼ì†Œê°€ ì½œë°± ì£¼ì†Œì¼ í•„ìš”ëŠ” ì—†ìœ¼ë©° í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì½œë°±ì„ ë°›ì€ í›„ ì½”ë“œê°’ì„ ë°±ì—”ë“œì— REST APIë¡œ ì „ë‹¬í•´ë„ ë¬´ë°©í•˜ë‹¤. ì½œë°± ì£¼ì†ŒëŠ” ê°œí–‰ìœ¼ë¡œ ì—¬ëŸ¬ê°œë¥¼ ë“±ë¡í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•œë‹¤.</p><p><img data-src="/images/posts/line-login/02.png"></p><pre class="language-bash" data-language="bash"><div class="caption"><span>Callback URL</span></div><code class="language-bash">https://access.line.me/oauth2/v2.1/authorize?response_type<span class="token operator">=</span>code<span class="token operator">&amp;</span><span class="token assign-left variable">client_id</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>LOGIN_CHANNEL_ID<span class="token punctuation">&#125;</span><span class="token operator">&amp;</span><span class="token assign-left variable">redirect_uri</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>CALLBACK_URL<span class="token punctuation">&#125;</span></code></pre><blockquote><p>ì½œë°± ì£¼ì†ŒëŠ” ì„œë¹„ìŠ¤ì—ì„œ ì¸ì¦ ì½”ë“œë¡œ ì•¡ì„¸ìŠ¤ í† í°ì„ ë°œê¸‰í•˜ëŠ” ê²½ìš°ì—ë„ ì‚¬ìš©ì ë¡œê·¸ì¸ ì‹œ ì‚¬ìš©ëœ ë™ì¼í•œ ì½œë°± ì£¼ì†Œë¥¼ ìš”êµ¬í•˜ë¯€ë¡œ ë°±ì—”ë“œ ì„œë²„ì—ì„œë„ ì±„ë„ ì•„ì´ë””ì™€ ì±„ë„ ì‹œí¬ë¦¿ ë¿ë§Œ ì•„ë‹ˆë¼ ë³„ë„ë¡œ ì½œë°± ì£¼ì†Œë¥¼ ê´€ë¦¬í•´ì•¼í•©ë‹ˆë‹¤.</p></blockquote><h4 id="OIDC-ì´ë©”ì¼-ê¶Œí•œ-ìš”ì²­"><a href="#OIDC-ì´ë©”ì¼-ê¶Œí•œ-ìš”ì²­" class="headerlink" title="OIDC ì´ë©”ì¼ ê¶Œí•œ ìš”ì²­"></a>OIDC ì´ë©”ì¼ ê¶Œí•œ ìš”ì²­</h4><p>ì„œë¹„ìŠ¤ ì—°ë™ì‹œ ì‚¬ìš©ìê°€ ì‚¬ìš©í•˜ëŠ” ì´ë©”ì¼ ì£¼ì†Œê°€ ë°˜ë“œì‹œ í•„ìš”í•˜ë‹¤ë©´ ì´ë©”ì¼ íšë“ ê¶Œí•œì„ ìœ„í•´ì„œ ë¡œê·¸ì¸ ì±„ë„ ì˜µì…˜ì˜ OpenID Connectì— ëŒ€í•œ ì´ë©”ì¼ ì£¼ì†Œ ê¶Œí•œì„ ë³„ë„ë¡œ í™œì„±í™” í•´ì•¼í•œë‹¤. ì‹¤ì œë¡œëŠ” ì´ë©”ì¼ì„ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ”ì§€ì— ëŒ€í•œ ìŠ¤í¬ë¦°ìƒ·ì„ ì—…ë¡œë“œ í•´ì•¼í•˜ê² ì§€ë§Œ ê°œë°œ ë‹¨ê³„ì—ì„œëŠ” ì„ì˜ì˜ ì´ë¯¸ì§€ë¥¼ ë“±ë¡í•´ë„ í—ˆìš©ëœë‹¤. ì‚¬ìš©ì ë¡œê·¸ì¸ ì‹œ ì „ë‹¬í•˜ëŠ” URL íŒŒë¼ë¯¸í„° ì¤‘ ìŠ¤ì½”í”„ì— ì•„ë˜ì™€ ê°™ì´ emailì„ ì¶”ê°€í•˜ë©´ ì´ë©”ì¼ì— ëŒ€í•œ ê¶Œí•œ ì˜µì…˜ì´ UIì— ë…¸ì¶œë  ê²ƒì´ë‹¤.</p><p><img data-src="/images/posts/line-login/03.png"><br><img data-src="/images/posts/line-login/04.png"><br><img data-src="/images/posts/line-login/05.png"></p><pre class="language-bash" data-language="bash"><div class="caption"><span>profile+openid+email</span></div><code class="language-bash">https://access.line.me/oauth2/v2.1/authorize?response_type<span class="token operator">=</span>code<span class="token operator">&amp;</span><span class="token assign-left variable">client_id</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>LOGIN_CHANNEL_ID<span class="token punctuation">&#125;</span><span class="token operator">&amp;</span><span class="token assign-left variable">scope</span><span class="token operator">=</span>profile%20openid%20email</code></pre><blockquote><p>ì‚¬ìš©ì ì¸ì¦ í™”ë©´ì—ì„œ ì´ë©”ì¼ ì£¼ì†Œ ê¶Œí•œì„ í•„ìˆ˜ë¡œ ìš”êµ¬í•˜ëŠ” ì˜µì…˜ì€ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p></blockquote><h4 id="OAuth-v2-1-ì•¡ì„¸ìŠ¤-í† í°-ë°œê¸‰"><a href="#OAuth-v2-1-ì•¡ì„¸ìŠ¤-í† í°-ë°œê¸‰" class="headerlink" title="OAuth v2.1 ì•¡ì„¸ìŠ¤ í† í° ë°œê¸‰"></a>OAuth v2.1 ì•¡ì„¸ìŠ¤ í† í° ë°œê¸‰</h4><p>ì‚¬ìš©ì ë¡œê·¸ì¸ í›„ ì½œë°±ë˜ì–´ ì „ë‹¬ë˜ëŠ” URLì— í¬í•¨ëœ code íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë²„ì—ì„œëŠ” <a href="https://developers.line.biz/en/reference/line-login/#issue-access-token">ì•¡ì„¸ìŠ¤ í† í°</a>ì„ ë°œê¸‰í•  ìˆ˜ ìˆë‹¤. OpenID Connect ì— ë”°ë¼ ì•¡ì„¸ìŠ¤ í† í°ê³¼ í•¨ê»˜ ID Tokenì´ ì œê³µë˜ëŠ”ë° JWT í˜•ì‹ìœ¼ë¡œ êµ¬ì„±ëœ ë¬¸ìì—´ì´ë¯€ë¡œ í˜ì´ë¡œë“œë¥¼ í™•ì¸í•˜ê±°ë‚˜ <a href="https://developers.line.biz/en/reference/line-login/#verify-id-token">Verify ID token</a>ì„ í†µí•´ í† í° ê²€ì¦ê³¼ í•¨ê»˜ ë¶„ì„ëœ ê²°ê³¼ë¥¼ ì‘ë‹µìœ¼ë¡œ ë°›ì•„ë³¼ ìˆ˜ ìˆë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> idToken <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getIdToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> payload <span class="token operator">=</span> idToken<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"\\."</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> claims <span class="token operator">=</span> objectMapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getUrlDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">TypeReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  <span class="token property">"iss"</span><span class="token operator">:</span> <span class="token string">"https://access.line.me"</span><span class="token punctuation">,</span>  <span class="token property">"sub"</span><span class="token operator">:</span> <span class="token string">"U1234567890abcdef1234567890abcdef"</span><span class="token punctuation">,</span>  <span class="token property">"aud"</span><span class="token operator">:</span> <span class="token string">"1234567890"</span><span class="token punctuation">,</span>  <span class="token property">"exp"</span><span class="token operator">:</span> <span class="token number">1504169092</span><span class="token punctuation">,</span>  <span class="token property">"iat"</span><span class="token operator">:</span> <span class="token number">1504263657</span><span class="token punctuation">,</span>  <span class="token property">"nonce"</span><span class="token operator">:</span> <span class="token string">"0987654asdf"</span><span class="token punctuation">,</span>  <span class="token property">"amr"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"pwd"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Taro Line"</span><span class="token punctuation">,</span>  <span class="token property">"picture"</span><span class="token operator">:</span> <span class="token string">"https://sample_line.me/aBcdefg123456"</span><span class="token punctuation">,</span>  <span class="token property">"email"</span><span class="token operator">:</span> <span class="token string">"taro.line@example.com"</span><span class="token punctuation">&#125;</span></code></pre><blockquote><p>JWT í˜ì´ë¡œë“œì— í¬í•¨ë˜ëŠ” í•­ëª© ì¤‘ <code>sub</code> ëŠ” ë¼ì¸ ì‚¬ìš©ìì— ëŒ€í•œ User IDë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.</p></blockquote><hr><h4 id="ë©”ì‹œì§€-ì±„ë„ê³¼-ì—°ë™í•˜ê¸°-ì¹œêµ¬-ì¶”ê°€-ì˜µì…˜"><a href="#ë©”ì‹œì§€-ì±„ë„ê³¼-ì—°ë™í•˜ê¸°-ì¹œêµ¬-ì¶”ê°€-ì˜µì…˜" class="headerlink" title="ë©”ì‹œì§€ ì±„ë„ê³¼ ì—°ë™í•˜ê¸° (ì¹œêµ¬ ì¶”ê°€ ì˜µì…˜)"></a>ë©”ì‹œì§€ ì±„ë„ê³¼ ì—°ë™í•˜ê¸° (ì¹œêµ¬ ì¶”ê°€ ì˜µì…˜)</h4><p>ë¼ì¸ ë¡œê·¸ì¸ ê¸°ëŠ¥ì„ ë„ì…í•˜ë”ë¼ë„ ë¡œê·¸ì¸ ì±„ë„ê³¼ ë©”ì‹œì§€ ì±„ë„ì€ ë³„ë„ë¡œ ë¶„ë¦¬ë˜ì–´ìˆì–´ ë©”ì‹œì§€ ì±„ë„ì„ ë³„ë„ë¡œ ìƒì„±í•œ í›„ ë¡œê·¸ì¸ ì±„ë„ì—ì„œ ë©”ì‹œì§€ ì±„ë„ì— ë“±ë¡í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ í™œì„±í™”í•˜ê³  <a href="https://developers.line.biz/en/docs/line-login/link-a-bot/">ì‚¬ìš©ìì—ê²Œ ì¹œêµ¬ ì¶”ê°€ë¥¼ ìš”êµ¬</a>í•´ì•¼í•œë‹¤. ì¹œêµ¬ ì¶”ê°€ ì˜µì…˜(Add friend option)ì— ë©”ì‹œì§€ ì±„ë„ì„ ì„ íƒí•œë‹¤ë©´ ë¡œê·¸ì¸ ì—°ë™ ì‹œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” bot_prompt íŒŒë¼ë¯¸í„°ì— ê°’ì— ë”°ë¼ ì¹œêµ¬ ì¶”ê°€ ì˜µì…˜ ë…¸ì¶œ ë°©ì‹ì„ ì œê³µí•  ìˆ˜ ìˆë‹¤.</p><pre class="language-bash" data-language="bash"><code class="language-bash">https://client.example.org/cb?code<span class="token operator">=</span><span class="token punctuation">&#123;</span>CODE<span class="token punctuation">&#125;</span><span class="token operator">&amp;</span><span class="token assign-left variable">state</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>STATE<span class="token punctuation">&#125;</span><span class="token operator">&amp;</span><span class="token assign-left variable">friendship_status_changed</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>FRIENDSHIP_STATUS_CHANGED<span class="token punctuation">&#125;</span></code></pre><p>ì¹œêµ¬ ì¶”ê°€ ì˜µì…˜ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì— ì‚¬ìš©ì ë¡œê·¸ì¸ í›„ ì½œë°± ì‹œ ì „ë‹¬ë˜ëŠ” ì½”ë“œ íŒŒë¼ë¯¸í„° ì´ì™¸ì— friendship_status_changed íŒŒë¼ë¯¸í„°ê°€ ì¶”ê°€ì ìœ¼ë¡œ ì „ë‹¬ë˜ì–´ í•´ë‹¹ ì‚¬ìš©ìê°€ ì¹œêµ¬ ì¶”ê°€ë¥¼ ìˆ˜í–‰í–ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ë§Œì•½, ë¡œê·¸ì¸ í™”ë©´ì— ë©”ì‹œì§€ ì±„ë„ì„ ì¹œêµ¬ë¡œ ì¶”ê°€í•  ìˆ˜ ìˆëŠ” ë²„íŠ¼ì´ ë…¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ì•„ë˜ì™€ ê°™ì€ í•­ëª©ì„ ì œëŒ€ë¡œ ì„¤ì •í–ˆëŠ”ì§€ ë‹¤ì‹œ í•œë²ˆ ì²´í¬í•´ë³´ë„ë¡ í•˜ì.</p><ul><li><a href="https://developers.line.biz/en/docs/line-login/link-a-bot/#link-a-line-official-account">Link a LINE Official Account with your channel</a></li><li><a href="https://developers.line.biz/en/docs/line-login/link-a-bot/#redirect-users">Redirect users to the LINE Login authorization URL with the bot_prompt query parameter</a></li></ul><h4 id="ì‚¬ìš©ìì—ê²Œ-ë©”ì‹œì§€-ë³´ë‚´ê¸°"><a href="#ì‚¬ìš©ìì—ê²Œ-ë©”ì‹œì§€-ë³´ë‚´ê¸°" class="headerlink" title="ì‚¬ìš©ìì—ê²Œ ë©”ì‹œì§€ ë³´ë‚´ê¸°"></a>ì‚¬ìš©ìì—ê²Œ ë©”ì‹œì§€ ë³´ë‚´ê¸°</h4><p>ì‚¬ìš©ìê°€ ë©”ì‹œì§€ ì±„ë„ì— ì¹œêµ¬ë¡œ ë“±ë¡í•˜ì˜€ë‹¤ë©´ ë¡œê·¸ì¸ ì—°ë™ì„ ìˆ˜í–‰í•œ ì‚¬ìš©ìì—ê²Œ ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆë‹¤. ì‚¬ìš©ì í”„ë¡œí•„ ì •ë³´ë¥¼ í¬í•¨í•˜ê³  ìˆëŠ” <a href="https://developers.line.biz/en/docs/line-login/verify-id-token/#page-title">JWT í˜•ì‹ì˜ IDToken</a>ì˜ í•­ëª© ì¤‘ sub ê°€ ë¼ì¸ì—ì„œ ì œê³µí•˜ëŠ” APIì—ì„œ ë‚´ë¶€ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” User IDì´ë©° <a href="https://developers.line.biz/en/reference/messaging-api/#send-push-message">Messaging API</a> ì—ì„œëŠ” User IDë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìì—ê²Œ ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆë„ë¡ ì œê³µí•œë‹¤.</p><pre class="language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">line</span><span class="token punctuation">:</span>  <span class="token key atrule">bot</span><span class="token punctuation">:</span>    <span class="token key atrule">channel-token</span><span class="token punctuation">:</span> WQ9SQjcWBJqD020+ri<span class="token important">***</span>    <span class="token key atrule">channel-secret</span><span class="token punctuation">:</span> 1ba24f197605a2<span class="token important">***</span></code></pre><blockquote><p>User IDëŠ” U1234567890abcdef1234567890abcdef ì™€ ê°™ì´ UXXX ë¡œ ì‹œì‘í•˜ëŠ” ê°’ ì…ë‹ˆë‹¤.<br>Line Java SDK ì—ì„œ ì±„ë„ í† í°ì€ ë©”ì‹œì§€ ì±„ë„ì˜ ì•„ì´ë””ê°€ ì•„ë‹Œ Messaging APIì˜ ì•¡ì„¸ìŠ¤ í† í°ì„ì„ ì£¼ì˜í•´ì•¼í•©ë‹ˆë‹¤.</p></blockquote><h4 id="ë¼ì¸-ë¡œê·¸ì¸-ì¸ì¦-í™”ë©´-êµ­ì œí™”"><a href="#ë¼ì¸-ë¡œê·¸ì¸-ì¸ì¦-í™”ë©´-êµ­ì œí™”" class="headerlink" title="ë¼ì¸ ë¡œê·¸ì¸ ì¸ì¦ í™”ë©´ êµ­ì œí™”"></a>ë¼ì¸ ë¡œê·¸ì¸ ì¸ì¦ í™”ë©´ êµ­ì œí™”</h4><p><img data-src="/images/posts/line-login/06.png"></p><p><code>ui_locales</code> íŒŒë¼ë¯¸í„°ì— ë¡œì¼€ì¼ì„ ì „ë‹¬í•˜ì—¬ ì‚¬ìš©ìê°€ ë¼ì¸ í”Œë«í¼ì— ì¸ì¦í•˜ê¸° ìœ„í•œ í™”ë©´ì— ëŒ€í•´ êµ­ì œí™”ë¥¼ ì ìš©í•  ìˆ˜ ìˆë‹¤. ë˜í•œ, ë¼ì¸ ë¡œê·¸ì¸ ì±„ë„ ì„¤ì •ì—ì„œ Localization ì„¤ì •ì„ í†µí•´ ì±„ë„ ì´ë¦„ê³¼ ì„¤ëª… ë¶€ë¶„ì„ ì–¸ì–´ì— ë”°ë¼ í‘œì‹œë˜ë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ë‹¨, ì¹œêµ¬ ì˜µì…˜ìœ¼ë¡œ í‘œì‹œë˜ëŠ” ë©”ì‹œì§€ ì±„ë„ì— ëŒ€í•œ ì´ë¦„ì€ ë³„ë„ë¡œ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤.</p><pre class="language-bash" data-language="bash"><code class="language-bash">https://access.line.me/oauth2/v2.1/authorize?response_type<span class="token operator">=</span>code<span class="token operator">&amp;</span><span class="token assign-left variable">client_id</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>LOGIN_CHANNEL_ID<span class="token punctuation">&#125;</span><span class="token operator">&amp;</span><span class="token assign-left variable">redirect_uri</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>CALLBACK_URL<span class="token punctuation">&#125;</span><span class="token operator">&amp;</span><span class="token assign-left variable">ui_locales</span><span class="token operator">=</span>ja_JP</code></pre><p><img data-src="/images/posts/line-login/07.png">  </p><p><img data-src="/images/posts/line-login/08.png">  </p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;ë³¸ ê¸€ì— ëŒ€í•œ ì½”ë“œëŠ” &lt;a href=&quot;https://github.com/kdevkr/spring-boot-line-login&quot;&gt;kdevkr&amp;#x2F;spring-boot-line-login&lt;/a&gt; ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Springdoc OpenAPI UI</title>
    <link href="https://kdevkr.github.io/springdoc-openapi-ui/"/>
    <id>https://kdevkr.github.io/springdoc-openapi-ui/</id>
    <published>2024-02-04T00:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.108Z</updated>
    
    <content type="html"><![CDATA[<p>Springdoc OpenAPI UIëŠ” OpenAPI 3 ê¸°ë°˜ì˜ Swagger API ë¬¸ì„œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆê²Œ ì œê³µí•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤. ì˜¤ëŠ˜ì€ Springdoc OpenAPI UI ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ í•™ìŠµí•´ë³´ë©´ì„œ ì•Œê²Œëœ ìœ ìš©í•œ ì •ë³´ë“¤ ëŒ€í•´ì„œ ê³µìœ í•´ë³´ê³ ì í•œë‹¤. </p><h4 id="Select-a-definition-ê¸°ë³¸-ì„ íƒí•˜ê¸°"><a href="#Select-a-definition-ê¸°ë³¸-ì„ íƒí•˜ê¸°" class="headerlink" title="Select a definition ê¸°ë³¸ ì„ íƒí•˜ê¸°"></a>Select a definition ê¸°ë³¸ ì„ íƒí•˜ê¸°</h4><p>GroupeOpenAPIë¥¼ ë“±ë¡í•˜ì—¬ í•˜ë‚˜ê°€ ì•„ë‹Œ ë‹¤ìˆ˜ì˜ API ê·¸ë£¹ì„ ì •ì˜í•˜ê³ ì í• ë•Œ <code>springdoc.swagger-ui.urls-primary-name</code>ì— ê¸°ë³¸ìœ¼ë¡œ ì„ íƒí•˜ê³  ì‹¶ì€ <a href="https://github.com/springdoc/springdoc-openapi/issues/2022">ê·¸ë£¹ ì´ë¦„ì„ ì…ë ¥í•˜ë©´ ê¸°ë³¸ìœ¼ë¡œ ì„ íƒ</a>ë˜ì–´ì§„ë‹¤. ê·¸ë£¹ í‘œì‹œ ìˆœì„œ ì •ë ¬ì— ì˜í•´ ê¸°ë³¸ê°’ì´ ë¨¼ì € ë…¸ì¶œë˜ì§€ ì•Šì„ ë•Œ ìœ ìš©í•˜ë‹¤.</p><pre class="language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">springdoc</span><span class="token punctuation">:</span>  <span class="token key atrule">swagger-ui</span><span class="token punctuation">:</span>    <span class="token key atrule">path</span><span class="token punctuation">:</span> /swagger<span class="token punctuation">-</span>ui.html    <span class="token key atrule">groups-order</span><span class="token punctuation">:</span> desc    <span class="token key atrule">urls-primary-name</span><span class="token punctuation">:</span> v1</code></pre><p><img data-src="/images/posts/springdoc-openapi-ui/01.png"></p><h4 id="ì„œë²„-URL-ì§ì ‘-ê´€ë¦¬í•˜ê¸°"><a href="#ì„œë²„-URL-ì§ì ‘-ê´€ë¦¬í•˜ê¸°" class="headerlink" title="ì„œë²„ URL ì§ì ‘ ê´€ë¦¬í•˜ê¸°"></a>ì„œë²„ URL ì§ì ‘ ê´€ë¦¬í•˜ê¸°</h4><p>ê¸°ë³¸ìœ¼ë¡œ ë§Œë“¤ì–´ì£¼ëŠ” URLë¡œë„ ì¶©ë¶„í•  ìˆ˜ ìˆì§€ë§Œ API ë¬¸ì„œì— ëŒ€í•œ ì„œë²„ë¥¼ ë³„ë„ë¡œ ì œê³µí•˜ê³ ì í•œë‹¤ë©´ í˜¸ì¶œí•  ìˆ˜ ìˆëŠ” ì—”ë“œí¬ì¸íŠ¸ë¥¼ ë…¸ì¶œí•´ì¤„ í•„ìš”ê°€ ìˆë‹¤. ì´ëŸ¬í•œ ê²½ìš° í•´ë‹¹ ê¸°ëŠ¥ì€ ì œê³µí•´ì£¼ì§€ ì•Šê¸° ë•Œë¬¸ì— ì„œë²„ ì£¼ì†Œì— ëŒ€í•œ ConfigurationPropertiesë¥¼ ë§Œë“¤ê³  ì£¼ì…í•˜ë©´ ëœë‹¤.</p><pre class="language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">springdoc</span><span class="token punctuation">:</span>  <span class="token key atrule">server</span><span class="token punctuation">:</span>    <span class="token punctuation">-</span> <span class="token key atrule">url</span><span class="token punctuation">:</span> /      <span class="token key atrule">description</span><span class="token punctuation">:</span> Default</code></pre><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Getter</span><span class="token annotation punctuation">@RequiredArgsConstructor</span><span class="token annotation punctuation">@ConstructorBinding</span><span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"springdoc"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringdocServersProperties</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Server</span><span class="token punctuation">></span></span> servers<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Bean</span><span class="token keyword">public</span> <span class="token class-name">OpenAPI</span> <span class="token function">openAPI</span><span class="token punctuation">(</span><span class="token class-name">SpringdocServersProperties</span> serversProperties<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">OpenAPI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">servers</span><span class="token punctuation">(</span>serversProperties<span class="token punctuation">.</span><span class="token function">getServers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="ê¸°ë³¸-ì‘ë‹µ-ë©”ì‹œì§€-í‘œì‹œ-ë¹„í™œì„±í™”"><a href="#ê¸°ë³¸-ì‘ë‹µ-ë©”ì‹œì§€-í‘œì‹œ-ë¹„í™œì„±í™”" class="headerlink" title="ê¸°ë³¸ ì‘ë‹µ ë©”ì‹œì§€ í‘œì‹œ ë¹„í™œì„±í™”"></a>ê¸°ë³¸ ì‘ë‹µ ë©”ì‹œì§€ í‘œì‹œ ë¹„í™œì„±í™”</h4><p>ì‹¤ë¬´ì—ì„œëŠ” GlobalOpenApiCustomizer ë¥¼ ì‚¬ìš©í•´ì„œ <a href="https://github.com/springdoc/springdoc-openapi/issues/381#issuecomment-579583870">ê¸°ë³¸ìœ¼ë¡œ ì œê³µë˜ëŠ” ì‘ë‹µ ë©”ì‹œì§€ ì¤‘ì—ì„œ ì¼ë¶€ì— ëŒ€í•´ì„œë§Œ í‘œì‹œ</a>ë˜ë„ë¡ í–ˆëŠ”ë° <a href="https://stackoverflow.com/a/66871601">ìŠ¤íƒì˜¤ë²„í”Œë¡œìš°ì˜ ë‹µë³€</a>ì„ ë³´ë‹ˆ ê¸°ë³¸ì ìœ¼ë¡œ @ControllerAdviceì— ì˜í•´ ì°¾ì•„ì£¼ì–´ ì¶”ê°€í•´ì£¼ëŠ” ì‘ë‹µ ë©”ì‹œì§€ë¥¼ ì œì™¸í•  ìˆ˜ ìˆë‹¤.</p><pre class="language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">springdoc</span><span class="token punctuation">:</span>  <span class="token key atrule">override-with-generic-response</span><span class="token punctuation">:</span> <span class="token boolean important">false</span></code></pre><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Bean</span><span class="token keyword">public</span> <span class="token class-name">GlobalOpenApiCustomizer</span> <span class="token function">globalOpenApiCustomizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> openapi <span class="token operator">-></span> openapi<span class="token punctuation">.</span><span class="token function">getPaths</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>pathItem <span class="token operator">-></span> pathItem<span class="token punctuation">.</span><span class="token function">readOperations</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>operation <span class="token operator">-></span> operation<span class="token punctuation">.</span><span class="token function">getResponses</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">addApiResponse</span><span class="token punctuation">(</span><span class="token string">"500"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ApiResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">"Server Error"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Content</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addMediaType</span><span class="token punctuation">(</span><span class="token string">"application/json"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">MediaType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="Could-not-resolve-pointer-components-schemas-XXX-does-not-exist-in-document"><a href="#Could-not-resolve-pointer-components-schemas-XXX-does-not-exist-in-document" class="headerlink" title="Could not resolve pointer: &#x2F;components&#x2F;schemas&#x2F;XXX does not exist in document"></a>Could not resolve pointer: &#x2F;components&#x2F;schemas&#x2F;XXX does not exist in document</h4><p>API ê·¸ë£¹ë§ˆë‹¤ ë‹¤ë¥¸ ì¸ì¦ ë°©ì‹ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ ë¶„ë¦¬í•œë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ .components ë¥¼ ì§€ì •í•˜ëŠ” ê²ƒì„ ì£¼ì˜í•˜ë„ë¡ í•´ì•¼í•œë‹¤. ì¸ì¦ ìŠ¤í‚¤ë§ˆ ì´ì™¸ì— ìš”ì²­ê³¼ ì‘ë‹µì— ëŒ€í•œ ìŠ¤í‚¤ë§ˆ í´ë˜ìŠ¤ê°€ í¬í•¨ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— .getComponents ë¥¼ ì´ìš©í•˜ì—¬ ì¸ì¦ ìŠ¤í‚¤ë§ˆë¥¼ ì¶”ê°€í•˜ì.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Bean</span><span class="token keyword">public</span> <span class="token class-name">GroupedOpenApi</span> <span class="token function">apiV1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">SecurityScheme</span> bearerScheme <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecurityScheme</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token class-name">SecurityScheme<span class="token punctuation">.</span>Type</span><span class="token punctuation">.</span><span class="token constant">HTTP</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">in</span><span class="token punctuation">(</span><span class="token class-name">SecurityScheme<span class="token punctuation">.</span>In</span><span class="token punctuation">.</span><span class="token constant">HEADER</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">scheme</span><span class="token punctuation">(</span><span class="token string">"bearer"</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">bearerFormat</span><span class="token punctuation">(</span><span class="token string">"JWT"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token class-name">GroupedOpenApi</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token string">"v1"</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">pathsToMatch</span><span class="token punctuation">(</span><span class="token string">"/api/**"</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">addOpenApiCustomiser</span><span class="token punctuation">(</span>openapi <span class="token operator">-></span> openapi<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">addSecurityItem</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SecurityRequirement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addList</span><span class="token punctuation">(</span><span class="token constant">DEFAULT_AUTH</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment">//.components(new Components().addSecuritySchemes(DEFAULT_AUTH, bearerScheme)) // Resolve error!</span>            <span class="token punctuation">.</span><span class="token function">getComponents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addSecuritySchemes</span><span class="token punctuation">(</span><span class="token constant">DEFAULT_AUTH</span><span class="token punctuation">,</span> bearerScheme<span class="token punctuation">)</span>        <span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><blockquote><p>ì´ì— ëŒ€í•œ ìì„¸í•œ ì½”ë“œëŠ” <a href="https://github.com/kdevkr/spring-boot-2-springdoc.git">spring-boot2-springdoc</a> ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Springdoc OpenAPI UIëŠ” OpenAPI 3 ê¸°ë°˜ì˜ Swagger API ë¬¸ì„œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆê²Œ ì œê³µí•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤. ì˜¤ëŠ˜ì€ Springdoc OpenAPI UI ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ í•™ìŠµí•´ë³´ë©´ì„œ ì•Œê²Œëœ ìœ ìš©í•œ ì •ë³´ë“¤ ëŒ€í•´</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>SpringDoc UI ì¸ì¦ì„ ìœ„í•œ í† í° ê¸°ë³¸ê°’ í‘œì‹œ</title>
    <link href="https://kdevkr.github.io/springdoc-ui-bearer-authentication/"/>
    <id>https://kdevkr.github.io/springdoc-ui-bearer-authentication/</id>
    <published>2024-02-03T02:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.108Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.baeldung.com/openapi-jwt-authentication">Configure JWT Authentication for OpenAPI</a>ë¥¼ ì°¸ê³ í•˜ë©´ SpringDoc UIë¥¼ ì‚¬ìš©í•  ë•Œ JWT ì¸ì¦ì„ ìœ„í•´ Bearer ìŠ¤í‚¤ë§ˆ ìœ í˜•ì„ êµ¬ì„±í•  ìˆ˜ ìˆìŒì„ ì‰½ê²Œ ì•Œ ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜, Bearerì™€ ê°™ì€ ì¸ì¦ ë°©ì‹ì˜ ê²½ìš° OAuth ì™€ëŠ” ë‹¤ë¥´ê²Œ ê¸°ë³¸ê°’ì„ ì ìš©í•  ìˆ˜ ìˆëŠ” ë°©ì•ˆì´ ì—†ë‹¤. ìŠ¤ì›¨ê±° ë¬¸ì„œì—ì„œ APIë¥¼ í˜¸ì¶œí•´ë³´ê³  ì‹¶ì€ ê²½ìš° ëŒ€ë¶€ë¶„ ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì—ì„œ ì œê³µí•˜ëŠ” HTTP ê¸°ë³¸ ì¸ì¦ì´ë‚˜ í¼ ë¡œê·¸ì¸ì„ í•˜ì§€ ëª»í•˜ë„ë¡ ë¹„í™œì„±í™”í•˜ê¸° ë•Œë¬¸ì— ì‚¬ìš©ì ë¡œê·¸ì¸ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì—”ë“œí¬ì¸íŠ¸ë¥¼ ë§Œë“¤ì–´ì„œ ë¬¸ì„œì— ë…¸ì¶œí•˜ì—¬ í† í°ì„ ë°œê¸‰í•  ìˆ˜ ìˆë„ë¡ í•´ì•¼í•œë‹¤.</p><blockquote><p>ê¸°ë³¸ì ìœ¼ë¡œ í”„ë¡œì íŠ¸ ê°œë°œ ì‹œ Bearer ì¸ì¦ ì‹œ Input ë°•ìŠ¤ì— ê¸°ë³¸ê°’ì„ ë„£ì–´ë‘˜ ë°©ì•ˆì€ ì—†ìŠµë‹ˆë‹¤.</p></blockquote><h4 id="SecurityScheme"><a href="#SecurityScheme" class="headerlink" title="SecurityScheme"></a>SecurityScheme</h4><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SecurityScheme</span><span class="token punctuation">(</span>    name <span class="token operator">=</span> <span class="token string">"Bearer Authentication"</span><span class="token punctuation">,</span>    type <span class="token operator">=</span> <span class="token class-name">SecuritySchemeType</span><span class="token punctuation">.</span><span class="token constant">HTTP</span><span class="token punctuation">,</span>    in <span class="token operator">=</span> <span class="token class-name">SecuritySchemeIn</span><span class="token punctuation">.</span><span class="token constant">HEADER</span><span class="token punctuation">,</span>    bearerFormat <span class="token operator">=</span> <span class="token string">"JWT"</span><span class="token punctuation">,</span>    scheme <span class="token operator">=</span> <span class="token string">"bearer"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DocsConfig</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></code></pre><p><img data-src="https://www.baeldung.com/wp-content/uploads/2022/06/auth-modal.png" alt="Configure JWT Authentication for OpenAPI"></p><p>ìœ„ ë§í¬ì—ì„œ <code>Bearer Authentication</code> ì— ëŒ€í•œ ì´ë¯¸ì§€ë¥¼ ì˜ ì‚´í´ë³´ë©´ <code>Description</code> ì´ í‘œì‹œë˜ëŠ” ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì¸ì¦ ë°©ë²•ì— ëŒ€í•œ ì„¤ëª…ì„ ì œê³µí•˜ëŠ” ë¶€ë¶„ì´ì§€ë§Œ ì¼ë°˜ í…ìŠ¤íŠ¸ ë¿ë§Œ ì•„ë‹ˆë¼ HTML íƒœê·¸ê°€ ê°€ëŠ¥í•œ ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤. ë³¸ ê¸€ì—ì„œëŠ” ì´ê²ƒì„ ì´ìš©í•´ì„œ <strong>ê°œë°œ í™˜ê²½ì—ì„œëŠ” í…ŒìŠ¤íŠ¸ ì‚¬ìš©ìì— ëŒ€í•œ ì´ë¦„ê³¼ í† í°ì´ í‘œì‹œë  ìˆ˜ ìˆë„ë¡</strong> í•  ì˜ˆì •ì´ë‹¤.</p><h4 id="Customize-SecurityScheme"><a href="#Customize-SecurityScheme" class="headerlink" title="Customize SecurityScheme"></a>Customize SecurityScheme</h4><p><code>@SecurityScheme</code> ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ê¸€ë¡œë²Œ ì¸ì¦ì— ëŒ€í•œ ì„¤ì •ì„ êµ¬ì„±í–ˆë‹¤ë©´ <a href="https://www.baeldung.com/openapi-jwt-authentication#3-global-configuration">OpenAPIë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ëŠ” êµ¬ì„±</a>ìœ¼ë¡œ ë³€ê²½ì´ í•„ìš”í•˜ë‹¤.<br>ì•„ë˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì†ì„±ìœ¼ë¡œ ë“±ë¡ëœ ì‚¬ìš©ì í† í° ì •ë³´ë¥¼ Description ì˜ì—­ì— í‘œì‹œë  ìˆ˜ ìˆë„ë¡ êµ¬í˜„í•œ ì˜ˆì œì´ë‹¤. </p><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DocsConfig</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">DEFAULT_AUTH</span> <span class="token operator">=</span> <span class="token string">"JWT Authentication"</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">OpenAPI</span> <span class="token function">openAPI</span><span class="token punctuation">(</span><span class="token class-name">BearerTokenProperties</span> bearerTokenProperties<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">SecurityRequirement</span> securityRequirement <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecurityRequirement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addList</span><span class="token punctuation">(</span><span class="token constant">DEFAULT_AUTH</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">SecurityScheme</span> securityScheme <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecurityScheme</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token constant">DEFAULT_AUTH</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token class-name">SecurityScheme<span class="token punctuation">.</span>Type</span><span class="token punctuation">.</span><span class="token constant">HTTP</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">in</span><span class="token punctuation">(</span><span class="token class-name">SecurityScheme<span class="token punctuation">.</span>In</span><span class="token punctuation">.</span><span class="token constant">HEADER</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">scheme</span><span class="token punctuation">(</span><span class="token string">"bearer"</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">bearerFormat</span><span class="token punctuation">(</span><span class="token string">"JWT"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>bearerTokenProperties<span class="token punctuation">.</span><span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>bearerTokenProperties<span class="token punctuation">.</span><span class="token function">getTokens</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BearerTokenProperties<span class="token punctuation">.</span>BearerToken</span><span class="token punctuation">></span></span> tokens <span class="token operator">=</span> bearerTokenProperties<span class="token punctuation">.</span><span class="token function">getTokens</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// NOTE: It is rendered as a markdown.</span>            <span class="token class-name">String</span> description <span class="token operator">=</span> tokens<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>item <span class="token operator">-></span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"**%s** %s"</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span><span class="token function">getToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">joining</span><span class="token punctuation">(</span><span class="token string">"\n\n"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            securityScheme<span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span>description<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">OpenAPI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">addSecurityItem</span><span class="token punctuation">(</span>securityRequirement<span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">components</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Components</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">addSecuritySchemes</span><span class="token punctuation">(</span><span class="token constant">DEFAULT_AUTH</span><span class="token punctuation">,</span> securityScheme<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Getter</span><span class="token annotation punctuation">@ConstructorBinding</span><span class="token annotation punctuation">@RequiredArgsConstructor</span><span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">"springdoc.bearer"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BearerTokenProperties</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> enabled<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BearerToken</span><span class="token punctuation">></span></span> tokens<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Getter</span>    <span class="token annotation punctuation">@RequiredArgsConstructor</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">BearerToken</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>        <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> token<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-yaml" data-language="yaml"><div class="caption"><span>application-dev.yml</span></div><code class="language-yaml"><span class="token key atrule">springdoc</span><span class="token punctuation">:</span>  <span class="token key atrule">bearer</span><span class="token punctuation">:</span>    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> on    <span class="token key atrule">tokens</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Default        <span class="token key atrule">token</span><span class="token punctuation">:</span> eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> User2        <span class="token key atrule">token</span><span class="token punctuation">:</span> eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</code></pre><p><img data-src="/images/posts/springdoc-ui-bearer-authentication/01.png"></p><blockquote><p>ì°¸ê³ ë¡œ ìœ„ ì˜ˆì œ ì½”ë“œë¥¼ ë³´ë©´ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ë¬¸ìì—´ì„ êµ¬ì„±í–ˆëŠ”ë° ê°œë°œì ë„êµ¬ë¡œ Description ì˜ì—­ì„ ì‚´í´ë³´ë‹ˆ ë§ˆí¬ë‹¤ìš´ ë Œë”ë§ìœ¼ë¡œ ë˜ê³  ìˆì–´ì„œ êµ³ì´ HTML íƒœê·¸ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë§ˆí¬ë‹¤ìš´ì— ìµìˆ™í•˜ì§€ ì•ŠëŠ” ê°œë°œìë¼ë©´ ì¼ë°˜ HTML íƒœê·¸ë¡œ ë§Œë“œì‹œë©´ ë©ë‹ˆë‹¤.</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://www.baeldung.com/openapi-jwt-authentication&quot;&gt;Configure JWT Authentication for OpenAPI&lt;/a&gt;ë¥¼ ì°¸ê³ í•˜ë©´ SpringDoc UIë¥¼ ì‚¬ìš©í•  ë•Œ JWT </summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>PathVariable ê°’ì„ RequestBody ì˜¤ë¸Œì íŠ¸ì— ì£¼ì…í•˜ê¸°</title>
    <link href="https://kdevkr.github.io/spring-boot-path-variable-with-request-body/"/>
    <id>https://kdevkr.github.io/spring-boot-path-variable-with-request-body/</id>
    <published>2024-02-02T14:00:00.000Z</published>
    <updated>2024-06-28T15:32:50.108Z</updated>
    
    <content type="html"><![CDATA[<p>ì˜¤ëŠ˜ ì •ë¦¬í•˜ê³  ê³µìœ í•˜ê³ ì í•˜ëŠ” ë‚´ìš©ì€ @PathVariableë¡œ ì§€ì •ëœ íŒŒë¼ë¯¸í„°ê°€ ìˆì„ ê²½ìš° @RequestBodyê°€ ì§€ì •ëœ ì˜¤ë¸Œì íŠ¸ í•„ë“œì— ë°ì´í„°ë¥¼ ì£¼ì…í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” êµ¬í˜„ ë°©ì•ˆì´ë‹¤. @PathVariableë¡œ ì§€ì •ëœ íŒŒë¼ë¯¸í„°ê°€ ìˆì„ ê²½ìš° @ModelAttributeì— ì£¼ì…ë˜ë„ë¡ ServletModelAttributeMethodProcessorê°€ êµ¬í˜„ë˜ì–´ìˆëŠ” ë°˜ë©´ì— @RequestBodyì— ëŒ€í•´ì„œ ë³€í™˜ì„ ë‹´ë‹¹í•˜ëŠ” MappingJackson2HttpMessageConverter ì—ì„œëŠ” ObjectMapper ì— ì˜í•´ ë³€í™˜ë§Œ ìˆ˜í–‰í•˜ë„ë¡ ë˜ì–´ìˆë‹¤.</p><blockquote><p>ë”°ë¼ì„œ, ê¸°ë³¸ì ìœ¼ë¡œëŠ” @PathVariable íŒŒë¼ë¯¸í„° ê°’ì´ @RequestBody ì˜¤ë¸Œì íŠ¸ì— ì£¼ì…ë˜ì§€ ì•ŠëŠ”ë‹¤.</p></blockquote><h4 id="RequestBodyAdviceAdapter"><a href="#RequestBodyAdviceAdapter" class="headerlink" title="RequestBodyAdviceAdapter"></a>RequestBodyAdviceAdapter</h4><p>ChatGPT ì—ê²Œ íŒíŠ¸ë¥¼ ì–»ì–´ <code>RequestBodyAdvice</code> ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ì—¬ <strong>RequestBodyë¥¼ ì „í›„ì²˜ë¦¬ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤</strong>ëŠ” ê²ƒì„ ì•Œì•„ëƒˆë‹¤. ëŒ€ë¶€ë¶„ @RestControllerAdviceì™€ í•¨ê»˜ ê³µí†µ ì˜¤ë¥˜ì²˜ë¦¬ë¥¼ ìœ„í•œ í•¸ë“¤ëŸ¬ë¥¼ ì‘ì„±í•´ì™”ì„í…ë° RequestBodyAdviceAdapterë¥¼ í™•ì¥í•˜ì—¬ ServletModelAttributeMethodProcessor ì—ì„œì˜ êµ¬í˜„ì²˜ëŸ¼ @PathVariableë¡œ ì§€ì •ëœ íŒŒë¼ë¯¸í„°ì˜ ê°’ì„ RequestBody ì˜¤ë¸Œì íŠ¸ì— ì£¼ì…í•  ìˆ˜ ìˆì§€ ì•Šì„ê¹Œ ì‹œë„í•´ë³´ì•˜ë‹¤.</p><pre class="language-java" data-language="java"><div class="caption"><span>PathVariableRequestBodyBinder</span></div><code class="language-java"><span class="token annotation punctuation">@RestControllerAdvice</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PathVariableRequestBodyBinder</span> <span class="token keyword">extends</span> <span class="token class-name">RequestBodyAdviceAdapter</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">ParameterNameDiscoverer</span> parameterNameDiscoverer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultParameterNameDiscoverer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">"unchecked"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">afterBodyRead</span><span class="token punctuation">(</span><span class="token class-name">Object</span> body<span class="token punctuation">,</span> <span class="token class-name">HttpInputMessage</span> inputMessage<span class="token punctuation">,</span> <span class="token class-name">MethodParameter</span> methodParameter<span class="token punctuation">,</span>                                <span class="token class-name">Type</span> targetType<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">HttpMessageConverter</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span><span class="token punctuation">></span></span> converterType<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Object</span> object <span class="token operator">=</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">afterBodyRead</span><span class="token punctuation">(</span>body<span class="token punctuation">,</span> inputMessage<span class="token punctuation">,</span> methodParameter<span class="token punctuation">,</span> targetType<span class="token punctuation">,</span> converterType<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Method</span> method <span class="token operator">=</span> methodParameter<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">RequestAttributes</span> requestAttributes <span class="token operator">=</span> <span class="token class-name">RequestContextHolder</span><span class="token punctuation">.</span><span class="token function">currentRequestAttributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token operator">?</span><span class="token punctuation">></span></span> pathVariables <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token operator">?</span><span class="token punctuation">></span></span><span class="token punctuation">)</span> requestAttributes<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span>            <span class="token class-name">HandlerMapping</span><span class="token punctuation">.</span><span class="token constant">URI_TEMPLATE_VARIABLES_ATTRIBUTE</span><span class="token punctuation">,</span> <span class="token class-name">RequestAttributes</span><span class="token punctuation">.</span><span class="token constant">SCOPE_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>method <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> pathVariables <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> pathVariables<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> object<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> clazz <span class="token operator">=</span> object<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> parameterNames <span class="token operator">=</span> parameterNameDiscoverer<span class="token punctuation">.</span><span class="token function">getParameterNames</span><span class="token punctuation">(</span>method<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>parameterNames <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> parameterNames<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Parameter</span><span class="token punctuation">[</span><span class="token punctuation">]</span> parameters <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">getParameters</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> parameterNames<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">String</span> parameterName <span class="token operator">=</span> parameterNames<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token class-name">Parameter</span> parameter <span class="token operator">=</span> parameters<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token comment">// NOTE: Set PathVariable into RequestBody.</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>parameter<span class="token punctuation">.</span><span class="token function">isAnnotationPresent</span><span class="token punctuation">(</span><span class="token class-name">PathVariable</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> pathVariables<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>parameterName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                        <span class="token class-name">Field</span> field <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span>parameterName<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token class-name">ReflectionUtils</span><span class="token punctuation">.</span><span class="token function">makeAccessible</span><span class="token punctuation">(</span>field<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token class-name">Object</span> o <span class="token operator">=</span> <span class="token class-name">ReflectionUtils</span><span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span>field<span class="token punctuation">,</span> object<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                            <span class="token class-name">ReflectionUtils</span><span class="token punctuation">.</span><span class="token function">setField</span><span class="token punctuation">(</span>field<span class="token punctuation">,</span> object<span class="token punctuation">,</span> pathVariables<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>parameterName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NoSuchFieldException</span> ignored<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token comment">// ignored</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> object<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">supports</span><span class="token punctuation">(</span><span class="token class-name">MethodParameter</span> methodParameter<span class="token punctuation">,</span> <span class="token class-name">Type</span> targetType<span class="token punctuation">,</span>                            <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">HttpMessageConverter</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span><span class="token punctuation">></span></span> converterType<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Method</span> method <span class="token operator">=</span> methodParameter<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>method <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Parameter</span><span class="token punctuation">[</span><span class="token punctuation">]</span> parameters <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">getParameters</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Parameter</span> parameter <span class="token operator">:</span> parameters<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>parameter<span class="token punctuation">.</span><span class="token function">isAnnotationPresent</span><span class="token punctuation">(</span><span class="token class-name">PathVariable</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ì»¨íŠ¸ë¡¤ëŸ¬ í•¸ë“¤ëŸ¬ í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„°ì— @PathVariable ì´ ì¡´ì¬í•œë‹¤ë©´ ì²˜ë¦¬í•˜ë„ë¡ <code>supports</code> ê²°ê³¼ë¥¼ êµ¬í˜„í•˜ì˜€ë‹¤. RequestBodyAdviceAdapter ìì²´ê°€ RequestBodyë¥¼ ì²˜ë¦¬í•¨ìœ¼ë¡œ @PathVariable íŒŒë¼ë¯¸í„°ê°€ ì¡´ì¬í•˜ëŠ”ì§€ë§Œ ì²´í¬í•´ë„ ë¬´ë°©í•´ë³´ì¸ë‹¤. RequestBodyê°€ ì˜¤ë¸Œì íŠ¸ë¡œ ë³€í™˜ë˜ê³ ë‚˜ì„œ ì£¼ì…ì„ ì‹œë„í•˜ê¸° ìœ„í•´ì„œ <code>afterBodyRead</code> í•¨ìˆ˜ë¥¼ ì˜¤ë²„ë¼ì´ë”©í•˜ì—¬ êµ¬í˜„í•˜ì˜€ëŠ”ë° <code>HandlerMapping.URI_TEMPLATE_VARIABLES_ATTRIBUTE</code>ë¡œ PathVariable ê°’ì„ ê°€ì ¸ì˜¤ê³  íŒŒë¼ë¯¸í„° ì´ë¦„ì„ ì¶”ë¡ í•˜ê¸° ìœ„í•˜ì—¬ <code>DefaultParameterNameDiscoverer</code>ë¥¼ ì‚¬ìš©í–ˆëŠ”ë° ê·¸ ì´ìœ ì—ëŠ” <code>@PathVariable</code> ì²˜ëŸ¼ ì´ë¦„ì„ ë³„ë„ë¡œ ì§€ì •í•˜ì§€ ì•ŠëŠ” ê²½ìš° <code>arg0</code> ê³¼ ê°™ì´ ì´ë¦„ì´ ë¶€ì—¬ë˜ê¸° ë•Œë¬¸ì— ê¸°ë³¸ì ìœ¼ë¡œëŠ” ê°€ì ¸ì˜¬ ìˆ˜ ì—†ë‹¤.</p><p>@RequestBodyë¡œ ë³€í™˜ë˜ì–´ì•¼í•˜ëŠ” ì˜¤ë¸Œì íŠ¸ íŒŒë¼ë¯¸í„°ì— ì‹¤ì œë¡œ í•„ë“œê°€ ì¡´ì¬í•˜ëŠ”ì§€ì— ëŒ€í•´ì„œëŠ” <strong>ë¦¬í”Œë ‰ì…˜ APIì— ëŒ€í•´ì„œ ê¹Šì€ ì´í•´ê°€ ì—†ëŠ” ê´€ê³„ë¡œ</strong> ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ì— í¬í•¨ë˜ì–´ìˆëŠ” <code>ReflectionUtils</code> í´ë˜ìŠ¤ë¥¼ ì´ìš©í•˜ì˜€ë‹¤. ìë°”ì—ì„œ ëŒ€ë¶€ë¶„ì˜ ì˜¤ë¸Œì íŠ¸ í•„ë“œì—ëŠ” private ì ‘ê·¼ ì œì–´ìë¥¼ ì„ ì–¸í•˜ë¯€ë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í•œ ì´í›„ì— í•„ë“œì— ê°’ì´ ì—†ëŠ” ê²½ìš°ì— í•œí•´ì„œë§Œ PathVariableì— ëŒ€í•œ ê°’ì„ ë°”ì¸ë”©í•˜ì˜€ë‹¤. ê²°ê³¼ì ìœ¼ë¡œ ì•„ë˜ì˜ ì´ë¯¸ì§€ì™€ ê°™ì´ ìš”ì²­ ë°ì´í„°ì— ì•„ì´ë””ê°€ í¬í•¨ë˜ì§€ ì•Šì•„ë„ PathVariableì— í•´ë‹¹ë˜ëŠ” <strong>111</strong> ê°’ì´ í¬í•¨ë¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.</p><p><img data-src="/images/posts/spring-boot-path-variable-with-request-body/01.png"></p><h4 id="DefaultParameterNameDiscoverer"><a href="#DefaultParameterNameDiscoverer" class="headerlink" title="DefaultParameterNameDiscoverer"></a>DefaultParameterNameDiscoverer</h4><p>ìŠ¤í”„ë§ ë¶€íŠ¸ 3.2 ë¶€í„°ëŠ” <code>LocalVariableTableParameterNameDiscoverer</code>ê°€ ì•„ë‹Œ <code>StandardReflectionParameterNameDiscoverer</code>ê°€ ì‚¬ìš©ë˜ë¯€ë¡œ <code>-parameters</code> ì»´íŒŒì¼ ì˜µì…˜ì„ í™œì„±í•´ì•¼í•œë‹¤. ìŠ¤í”„ë§ ë¶€íŠ¸ 2.7.18 ë²„ì „ ê¸°ì¤€ì˜ <code>DefaultParameterNameDiscoverer</code>ë¥¼ ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ë˜ì–´ìˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><pre class="language-java" data-language="java"><div class="caption"><span>DefaultParameterNameDiscoverer</span></div><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DefaultParameterNameDiscoverer</span> <span class="token keyword">extends</span> <span class="token class-name">PrioritizedParameterNameDiscoverer</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">DefaultParameterNameDiscoverer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">KotlinDetector</span><span class="token punctuation">.</span><span class="token function">isKotlinReflectPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token class-name">NativeDetector</span><span class="token punctuation">.</span><span class="token function">inNativeImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addDiscoverer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">KotlinReflectionParameterNameDiscoverer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addDiscoverer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StandardReflectionParameterNameDiscoverer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addDiscoverer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LocalVariableTableParameterNameDiscoverer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ì˜¤ëŠ˜ ì •ë¦¬í•˜ê³  ê³µìœ í•˜ê³ ì í•˜ëŠ” ë‚´ìš©ì€ @PathVariableë¡œ ì§€ì •ëœ íŒŒë¼ë¯¸í„°ê°€ ìˆì„ ê²½ìš° @RequestBodyê°€ ì§€ì •ëœ ì˜¤ë¸Œì íŠ¸ í•„ë“œì— ë°ì´í„°ë¥¼ ì£¼ì…í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” êµ¬í˜„ ë°©ì•ˆì´ë‹¤. @PathVariableë¡œ ì§€ì •ëœ íŒŒë¼ë¯¸í„°ê°€ ìˆì„ ê²½ìš° </summary>
      
    
    
    
    
    <category term="RequestBodyAdviceAdapter" scheme="https://kdevkr.github.io/tags/RequestBodyAdviceAdapter/"/>
    
    <category term="LocalVariableTableParameterNameDiscoverer" scheme="https://kdevkr.github.io/tags/LocalVariableTableParameterNameDiscoverer/"/>
    
  </entry>
  
</feed>
