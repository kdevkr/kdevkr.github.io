<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Mambo</title>
  
  <subtitle>Today I Learned ğŸ”¥</subtitle>
  <link href="https://kdevkr.github.io/atom.xml" rel="self"/>
  
  <link href="https://kdevkr.github.io/"/>
  <updated>2023-10-22T05:50:35.890Z</updated>
  <id>https://kdevkr.github.io/</id>
  
  <author>
    <name>Mambo</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Cross Site Request Forgery (CSRF)</title>
    <link href="https://kdevkr.github.io/spring-boot-security-csrf/"/>
    <id>https://kdevkr.github.io/spring-boot-security-csrf/</id>
    <published>2023-10-21T00:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.890Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë¶„ë¦¬ë˜ì–´ìˆì–´ë„ <a href="https://docs.spring.io/spring-security/reference/servlet/exploits/csrf.html">Cross Site Request Forgery (CSRF)</a>ë¥¼ ë¹„í™œì„±í™”í•˜ì§€ ë§ì.</p></blockquote><p>CSRF ìì²´ì— ëŒ€í•´ì„œ ì˜ ëª¨ë¥´ëŠ” ê°œë°œìë¼ë©´ <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html">Cross-Site Request Forgery Prevention Cheat Sheet</a>ë¥¼ ì°¸ê³ í•´ë³´ë„ë¡ í•˜ì. ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆ ê°€ì´ë“œì—ì„œ <a href="https://docs.spring.io/spring-security/reference/servlet/exploits/csrf.html#csrf-considerations">ë¡œê·¸ì¸ê³¼ ë¡œê·¸ì•„ì›ƒ í–‰ìœ„ì— ëŒ€í•´ì„œëŠ” CSRF í† í°ì„ ì‚¬ìš©í•œ ê²€ì¦ì„ ìš”êµ¬</a>í•˜ëŠ” í¸ì´ë‹¤. ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì—ì„œëŠ” <a href="https://docs.spring.io/spring-security/reference/features/exploits/csrf.html#csrf-protection">CSRF ê³µê²©ì— ë°©ì–´í•˜ëŠ” ë§¤ì»¤ë‹ˆì¦˜</a>ì„ ì œê³µí•˜ì—¬ ì‰½ê²Œ CSRF í† í°ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤.</p><ul><li>HttpSessionCsrfTokenRepository</li><li>CookieCsrfTokenRepository</li><li>XorCsrfTokenRequestAttributeHandler</li><li>XorCsrfChannelInterceptor</li><li>CsrfFilter</li><li>CsrfLogoutHandler</li></ul><p>ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì˜ SecurityFilterChainì„ êµ¬ì„±í•˜ëŠ” ê³¼ì •ì˜ <code>CsrfConfigurer</code>ë¥¼ ì‚´í´ë³´ë©´ <code>CsrfFilter</code>ë¥¼ í•„í„°ì— ë“±ë¡í•˜ëŠ”ë° CsrfTokenRepositoryì™€ CsrfTokenRequestHandlerê°€ ì‚¬ìš©ë˜ë„ë¡ ì „ë‹¬ëœë‹¤. ê³µì‹ ë¬¸ì„œë¥¼ ì°¸ê³ í•´ë³´ë©´ ê¸°ë³¸ì ìœ¼ë¡œëŠ” ìŠ¤í”„ë§ ì‹œíë¦¬í‹° 6 ë¶€í„° <code>HttpSessionCsrfTokenRepository</code>ì™€ <code>XorCsrfTokenRequestAttributeHandler</code>ê°€ ì‚¬ìš©ë˜ë„ë¡ ë˜ì–´ìˆìœ¼ë©° HTTPê°€ ì•„ë‹Œ ì›¹ì†Œì¼“ì„ ìœ„í•œ ë³´ì•ˆ ì„¤ì • ì‹œ(@EnableWebSocketSecurity)ì—ëŠ” <code>XorCsrfChannelInterceptor</code>ì´ ì ìš©ë˜ì–´ ë™ì‘í•œë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token class-name">SecurityConfig</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">SecurityFilterChain</span> <span class="token function">filterChain</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>       http<span class="token punctuation">.</span><span class="token function">csrf</span><span class="token punctuation">(</span>csrf <span class="token operator">-></span> csrf<span class="token punctuation">.</span><span class="token function">csrfTokenRepository</span><span class="token punctuation">(</span><span class="token class-name">CookieCsrfTokenRepository</span><span class="token punctuation">.</span><span class="token function">withHttpOnlyFalse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="CSRF-í† í°-API-ì—”ë“œí¬ì¸íŠ¸"><a href="#CSRF-í† í°-API-ì—”ë“œí¬ì¸íŠ¸" class="headerlink" title="CSRF í† í° API ì—”ë“œí¬ì¸íŠ¸"></a>CSRF í† í° API ì—”ë“œí¬ì¸íŠ¸</h4><p>ë°±ì—”ë“œì™€ í”„ë¡ íŠ¸ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë¶„ë¦¬ë˜ì–´ìˆë‹¤ê³  í•´ì„œ HttpOnly ì†ì„±ì´ ì§€ì •ë˜ì§€ ì•Šì€ CSRF ì¿ í‚¤ë¥¼ ì „ë‹¬í•˜ê¸° ìœ„í•´ <code>CookieCsrfTokenRepository</code>ë¥¼ ì‚¬ìš©í•  í•„ìš”ëŠ” ì—†ë‹¤. í”„ë¡ íŠ¸ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìœ„í•œ CSRF í† í°ì´ í•„ìš”í•˜ë‹¤ë©´ ì•„ë˜ì™€ ê°™ì€ CSRF í† í°ì„ ì‘ë‹µí•´ì£¼ëŠ” APIë¥¼ ë§Œë“¤ì–´ì„œ ì œê³µí•˜ì. ê¸°ë³¸ì ìœ¼ë¡œ GET ìš”ì²­ì€ ì•ˆì „í•œ ë©”ì†Œë“œë¡œ ê°„ì£¼í•˜ì—¬ ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ëŠ” CSRF í† í°ì— ëŒ€í•œ ê²€ì¦ì„ ì²˜ë¦¬í•˜ì§€ ì•ŠëŠ”ë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CsrfController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/csrf"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">CsrfToken</span> <span class="token function">csrf</span><span class="token punctuation">(</span><span class="token class-name">CsrfToken</span> csrfToken<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> csrfToken<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><a href="https://www.data.go.kr/data/15049185/fileData.do">ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆ ê°€ì´ë“œ</a>ì—ì„œëŠ” ë¡œê·¸ì¸ê³¼ ë¡œê·¸ì•„ì›ƒ ìš”ì²­ì— ëŒ€í•´ CSRF ê³µê²©ì— ëŒ€í•œ ë°©ì–´ë¥¼ ìš”êµ¬í•œë‹¤. ê°„í˜¹ ë°±ì—”ë“œì™€ í”„ë¡ íŠ¸ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë¶„ë¦¬ë˜ì–´ JWTì™€ ê°™ì€ í† í° ê¸°ë°˜ ì¸ì¦ì„ ìˆ˜í–‰í•œë‹¤ë©´ ë¹„í™œì„±í™”í•˜ê±°ë‚˜ ì¡°ì¹˜í•  í•„ìš”ê°€ ì—†ë‹¤ëŠ” ê²ƒì„ ê¸°ë¡í•œ ë¸”ë¡œê·¸ê°€ ë³´ì´ëŠ”ë° ì´ê²ƒì€ ì˜ëª»ëœ ì •ë³´ì´ë‹¤. ë¸Œë¼ìš°ì €ì—ì„œ í† í°ì„ ì „ë‹¬í•  ë°©ë²•ì€ ì¿ í‚¤ë‚˜ ë³„ë„ì˜ í—¤ë” ë¿ì´ë©° ì¿ í‚¤ë„ ì‚¬ì‹¤ ìƒ í—¤ë” ì¤‘ í•˜ë‚˜ì¼ ë¿ì´ë‹¤. </p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">DefaultRequiresCsrfMatcher</span> <span class="token keyword">implements</span> <span class="token class-name">RequestMatcher</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> allowedMethods <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span> <span class="token string">"HEAD"</span><span class="token punctuation">,</span> <span class="token string">"TRACE"</span><span class="token punctuation">,</span> <span class="token string">"OPTIONS"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">matches</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>allowedMethods<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ <code>GET, HEAD, TRACE, OPTIONS</code>ì— ëŒ€í•´ì„œëŠ” ì•ˆì „í•œ ë©”ì†Œë“œë¡œ íŒë‹¨í•˜ì—¬ CSRF ê²€ì¦ì„ ë¬´ì‹œí•œë‹¤. ë§Œì•½, GETì„ ì•ˆì „í•˜ì§€ ì•ŠëŠ” í–‰ìœ„ë¡œ ì‚¬ìš©í•œë‹¤ë©´ CSRF ê²€ì¦ì„ ë³„ë„ë¡œ ìˆ˜í–‰í•´ì•¼í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì‰½ê²Œ ë¡œê·¸ì•„ì›ƒ í•˜ê¸° ìœ„í•´ì„œ POST ìš”ì²­ì´ ì•„ë‹Œ GET ìš”ì²­ìœ¼ë¡œ êµ¬í˜„í–ˆë‹¤ë©´ CSRF í•„í„°ì—ì„œ ë¬´ì‹œë˜ê³  ë„˜ì–´ê°€ë¯€ë¡œ <code>requireCsrfProtectionMatcher</code> ë¥¼ ìˆ˜ì •í•˜ì.</p><h4 id="CSRF-í† í°ì„-ì „ë‹¬í•˜ëŠ”-ë°©ë²•"><a href="#CSRF-í† í°ì„-ì „ë‹¬í•˜ëŠ”-ë°©ë²•" class="headerlink" title="CSRF í† í°ì„ ì „ë‹¬í•˜ëŠ” ë°©ë²•"></a>CSRF í† í°ì„ ì „ë‹¬í•˜ëŠ” ë°©ë²•</h4><p>CSRF í† í°ì€ ì¼ë°˜ì ìœ¼ë¡œ HTML í¼ ì „ì†¡ ì‹œ _csrf íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬í•˜ëŠ”ë° X-CSRF-TOKEN ë˜ëŠ” X-XSRF-TOKEN í—¤ë”ë¡œë„ ì „ë‹¬í•  ìˆ˜ ìˆë„ë¡ ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì—ì„œ ì§€ì›í•œë‹¤. ê¸°ë³¸ì ìœ¼ë¡œëŠ” HttpSessionCsrfTokenRepository ê°€ ì‚¬ìš©ë˜ëŠ”ë° <code>X-CSRF-TOKEN</code> ì´ë¼ëŠ” í—¤ë”ë¥¼ CookieCsrfTokenRepositoryëŠ” <code>X-XSRF-TOKEN</code> í—¤ë”ë¥¼ ë§¤ì¹­í•œë‹¤. ê·¸ëŸ¬ë‹ˆê¹Œ, ê¸°ë³¸ì ìœ¼ë¡œëŠ” X-CSRF-TOKEN í—¤ë”ë¡œ ì „ë‹¬í•´ì•¼í•˜ì§€ë§Œ ì¿ í‚¤ ê¸°ë°˜ì˜ CookieCsrfTokenRepositoryë¥¼ ì ìš©í–ˆë‹¤ë©´ X-XSRF-TOKEN í—¤ë”ë¡œ ìš”ì²­ ì‹œ ì „ë‹¬í•´ì•¼ CSRF í† í°ì„ ì œëŒ€ë¡œ ê²€ì¦í•  ìˆ˜ ìˆë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@FunctionalInterface</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">CsrfTokenRequestHandler</span> <span class="token keyword">extends</span> <span class="token class-name">CsrfTokenRequestResolver</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CsrfToken</span><span class="token punctuation">></span></span> csrfToken<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">default</span> <span class="token class-name">String</span> <span class="token function">resolveCsrfTokenValue</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">CsrfToken</span> csrfToken<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"request cannot be null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>csrfToken<span class="token punctuation">,</span> <span class="token string">"csrfToken cannot be null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> actualToken <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span>csrfToken<span class="token punctuation">.</span><span class="token function">getHeaderName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>actualToken <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            actualToken <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span>csrfToken<span class="token punctuation">.</span><span class="token function">getParameterName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> actualToken<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ì•ì„œ CSRF í† í°ì„ ì‘ë‹µí•˜ëŠ” API ì—ì„œëŠ” í† í° ë¿ë§Œ ì•„ë‹ˆë¼ ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ ì „ë‹¬í•  ì´ë¦„ê³¼ í—¤ë”ë¥¼ í•¨ê»˜ ì œê³µí•´ì¤€ë‹¤. ë”°ë¼ì„œ, Axiosì™€ ê°™ì€ HTTP ìš”ì²­ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í†µí•´ XHR ìš”ì²­ì„ ìˆ˜í–‰í•œë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤. </p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/csrf'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">const</span> csrf <span class="token operator">=</span> res<span class="token punctuation">.</span>data    axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>post<span class="token punctuation">[</span>csrf<span class="token punctuation">.</span>headerName<span class="token punctuation">]</span> <span class="token operator">=</span> csrf<span class="token punctuation">.</span>token    axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>put<span class="token punctuation">[</span>csrf<span class="token punctuation">.</span>headerName<span class="token punctuation">]</span> <span class="token operator">=</span> csrf<span class="token punctuation">.</span>token    axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>delete<span class="token punctuation">[</span>csrf<span class="token punctuation">.</span>headerName<span class="token punctuation">]</span> <span class="token operator">=</span> csrf<span class="token punctuation">.</span>token<span class="token punctuation">&#125;</span><span class="token punctuation">)</span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë¶„ë¦¬ë˜ì–´ìˆì–´ë„ &lt;a href=&quot;https://docs.spring.io/spring-security/reference/servlet/exploits/csrf.html&quot;&gt;Cross Site </summary>
      
    
    
    
    
    <category term="Spring Security" scheme="https://kdevkr.github.io/tags/Spring-Security/"/>
    
    <category term="Axios" scheme="https://kdevkr.github.io/tags/Axios/"/>
    
    <category term="CSRF" scheme="https://kdevkr.github.io/tags/CSRF/"/>
    
    <category term="XSRF" scheme="https://kdevkr.github.io/tags/XSRF/"/>
    
  </entry>
  
  <entry>
    <title>ìŠ¤í”„ë§ ë¶€íŠ¸ ë³´ì•ˆ ì„¤ì •</title>
    <link href="https://kdevkr.github.io/spring-boot-security/"/>
    <id>https://kdevkr.github.io/spring-boot-security/</id>
    <published>2023-10-17T13:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.890Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ë³¸ ê¸€ì€ ìŠ¤í”„ë§ ë¶€íŠ¸ í”„ë¡œì íŠ¸ë¡œ ë§Œë“¤ì–´ì§„ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ìŠ¤í”„ë§ ì‹œíë¦¬í‹° ëª¨ë“ˆì„ ì ìš©í•˜ëŠ” ê²½ìš°ì— ë³´ì•ˆ ì„¤ì •ì— ëŒ€í•´ ì •ë¦¬í•œ ê²ƒ ì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì˜¤í•´í•˜ê³  ìˆê±°ë‚˜ ì‹ ê²½ì“°ì§€ ì•ŠëŠ” ë¶€ë¶„ì— ëŒ€í•´ì„œ ë‹¤ë£¨ê³ ì í•©ë‹ˆë‹¤.</p></blockquote><h4 id="ë”-ì•ˆì „í•œ-CSRF-í† í°-ì„¤ì •"><a href="#ë”-ì•ˆì „í•œ-CSRF-í† í°-ì„¤ì •" class="headerlink" title="ë” ì•ˆì „í•œ CSRF í† í° ì„¤ì •"></a>ë” ì•ˆì „í•œ CSRF í† í° ì„¤ì •</h4><p>ë¦¬ì•¡íŠ¸ë‚˜ ë·°ì™€ ê°™ì€ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ í™˜ê²½ì´ì–´ë„ ì„œë²„ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ CSRF í† í°ì„ í”„ë¡ íŠ¸ì—”ë“œë¡œ ì „ë‹¬í•˜ê¸° ìœ„í•´ ì¿ í‚¤ë¥¼ ì´ìš©í•  í•„ìš”ëŠ” ì—†ë‹¤. ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì¿ í‚¤ì— ì €ì¥ëœ XSRF-TOKEN ê°’ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë„ë¡ httpOnly ì„¤ì •ì„ ë¹„í™œì„±í™”í•˜ì§€ ë§ì. ì´ê²ƒì— ëŒ€ì•ˆìœ¼ë¡œ CSRF í† í°ì„ ì œê³µí•˜ëŠ” APIë¥¼ ë§Œë“¤ì–´ì„œ ì‘ë‹µí•˜ë©´ ëœë‹¤.</p><pre class="language-java" data-language="java"><div class="caption"><span>WebSecurityConfig.java</span></div><code class="language-java"><span class="token annotation punctuation">@AllArgsConstructor</span><span class="token annotation punctuation">@Configuration</span><span class="token annotation punctuation">@EnableWebSecurity</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebSecurityConfig</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ServerProperties</span> serverProperties<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">CsrfTokenRepository</span> <span class="token function">csrfTokenRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Session<span class="token punctuation">.</span>Cookie</span> cookie <span class="token operator">=</span> serverProperties<span class="token punctuation">.</span><span class="token function">getServlet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCookie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">CookieCsrfTokenRepository</span> tokenRepository <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CookieCsrfTokenRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        tokenRepository<span class="token punctuation">.</span><span class="token function">setCookieCustomizer</span><span class="token punctuation">(</span>c <span class="token operator">-></span> c<span class="token punctuation">.</span><span class="token function">secure</span><span class="token punctuation">(</span>cookie<span class="token punctuation">.</span><span class="token function">getSecure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span>cookie<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">httpOnly</span><span class="token punctuation">(</span>cookie<span class="token punctuation">.</span><span class="token function">getHttpOnly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">sameSite</span><span class="token punctuation">(</span>cookie<span class="token punctuation">.</span><span class="token function">getSameSite</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attributeValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">maxAge</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofMinutes</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> tokenRepository<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">SecurityFilterChain</span> <span class="token function">filterChain</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        http<span class="token punctuation">.</span><span class="token function">csrf</span><span class="token punctuation">(</span>csrf <span class="token operator">-></span> csrf<span class="token punctuation">.</span><span class="token function">csrfTokenRepository</span><span class="token punctuation">(</span><span class="token function">csrfTokenRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> http<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-java" data-language="java"><div class="caption"><span>CsrfController.java</span></div><code class="language-java"><span class="token annotation punctuation">@AllArgsConstructor</span><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CsrfController</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">CsrfTokenRepository</span> csrfTokenRepository<span class="token punctuation">;</span>    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/csrf"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">CsrfToken</span> <span class="token function">csrf</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> csrfTokenRepository<span class="token punctuation">.</span><span class="token function">loadDeferredToken</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><blockquote><p>ìë°”ìŠ¤í¬ë¦½íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìœ„í•œ ë” ë‹¤ì–‘í•œ ë°©ë²•ì€ <a href="https://docs.spring.io/spring-security/reference/servlet/exploits/csrf.html#csrf-integration-javascript">ê³µì‹ ë¬¸ì„œë¥¼ ì°¸ê³ </a>í•˜ì„¸ìš”.</p></blockquote><p>ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆì—ì„œ ë” ì¤‘ìš”í•œ ê²ƒì€ ë¡œê·¸ì¸ ë° ë¡œê·¸ì•„ì›ƒ ìš”ì²­ì— ëŒ€í•´ CSRFë¥¼ ì‚¬ìš©í•´ì„œ ë¡œê·¸ì¸ ì‹œë„ë¥¼ ìœ„ì¡°í•˜ì§€ ëª»í•˜ë„ë¡ í•˜ëŠ” ê²ƒì´ë‹¤. ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì˜ ê¸°ë³¸ í¼ ë¡œê·¸ì¸ì´ë‚˜ HTTP ë² ì´ì§ ì¸ì¦ì´ ì•„ë‹ˆë¼ ë³„ë„ì˜ APIë¥¼ ì‘ì„±í•œë‹¤ë©´ ë°˜ë“œì‹œ <a href="https://docs.spring.io/spring-security/reference/servlet/exploits/csrf.html#csrf-testing">CSRF í† í°ì´ ì ìš©ë˜ëŠ”ì§€ ê²€ì¦</a>í•˜ë„ë¡ í•˜ì.</p><h4 id="ë¦¬ë²„ìŠ¤-í”„ë¡ì‹œ-ë³´ì•ˆ"><a href="#ë¦¬ë²„ìŠ¤-í”„ë¡ì‹œ-ë³´ì•ˆ" class="headerlink" title="ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ ë³´ì•ˆ"></a>ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ ë³´ì•ˆ</h4><p>ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ <a href="https://docs.spring.io/spring-security/reference/features/exploits/headers.html">ë³´ì•ˆì„ ìœ„í•œ ì‘ë‹µ í—¤ë”</a>ë¥¼ ì¶”ê°€í•´ì¤€ë‹¤. ë‹¤ë§Œ, <a href="https://docs.spring.io/spring-security/reference/features/exploits/headers.html#headers-hsts">HSTS</a>ì˜ ê²½ìš°ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ìì²´ê°€ HTTPS í”„ë¡œí† ì½œë¡œ ì‹¤í–‰ë˜ì—ˆì„ë•Œ í™œì„±í™”ëœë‹¤. ë”°ë¼ì„œ, ì—”ì§„ì—‘ìŠ¤ì™€ ê°™ì€ ì›¹ ì„œë²„ë‚˜ ë¡œë“œë°¸ëŸ°ì„œë¥¼ í†µí•´ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œë¥¼ êµ¬ì„±í•˜ëŠ” ê²½ìš°ì—ëŠ” HTTP í¬íŠ¸ë¥¼ ì‚¬ìš©í•´ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ë¯€ë¡œ <code>ì—”ì§„ì—‘ìŠ¤ì™€ ê°™ì€ ì›¹ ì„œë²„ì—ì„œ HSTS í—¤ë”ë¥¼ ì‘ë‹µ</code>í•˜ë„ë¡ í•˜ì.</p><pre class="language-conf" data-language="conf"><div class="caption"><span>nginx.conf</span></div><code class="language-conf">server &#123;    listen 443 ssl http2;    add_header Strict-Transport-Security &quot;max-age&#x3D;31536000; includeSubDomains&quot;;    location &#x2F;api&#x2F; &#123;        limit_except GET POST PUT DELETE OPTIONS &#123;            deny all;        &#125;    &#125;&#125;</code></pre><blockquote><p>ë¦¬ì•¡íŠ¸ ë˜ëŠ” ë·°ì˜ ë¹Œë“œ ì—ì…‹ì„ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë°°í¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ì›¹ ì„œë²„ì—ì„œ ë³´ì•ˆ ì‘ë‹µ í—¤ë”ë¥¼ ë™ì¼í•˜ê²Œ ì „ë‹¬ë˜ë„ë¡ êµ¬ì„±í•´ì•¼í•©ë‹ˆë‹¤.</p></blockquote><h4 id="ì›¹ì†Œì¼“-ë³´ì•ˆ"><a href="#ì›¹ì†Œì¼“-ë³´ì•ˆ" class="headerlink" title="ì›¹ì†Œì¼“ ë³´ì•ˆ"></a>ì›¹ì†Œì¼“ ë³´ì•ˆ</h4><p>ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ HTTP í†µì‹ ì— ëŒ€í•œ ë³´ì•ˆ ì„¤ì •ì„ ì œê³µí•œë‹¤. ë§Œì•½, ì• í”Œë¦¬ì¼€ì´ì…˜ ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­ì„ ìœ„í•´ ì›¹ì†Œì¼“ í”„ë¡œí† ì½œì„ ì‚¬ìš©í•œë‹¤ë©´ <a href="https://docs.spring.io/spring-security/reference/servlet/integrations/websocket.html">ì›¹ì†Œì¼“ì— ëŒ€í•œ ë³´ì•ˆ</a>ì— ëŒ€í•´ ë³„ë„ë¡œ ì²´í¬í•´ì•¼í•œë‹¤. ìŠ¤í”„ë§ ì‹œíë¦¬í‹° ëª¨ë“ˆì„ ì‚¬ìš©í•œë‹¤ë©´ ì¼ë°˜ì ì¸ ì›¹ì†Œì¼“ êµ¬í˜„ë³´ë‹¤ëŠ” STOMP ë°©ì‹ì˜ ì›¹ì†Œì¼“ ì—°ê²°ì„ êµ¬ì„±í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. <a href="https://docs.spring.io/spring-security/reference/servlet/integrations/websocket.html#websocket-sameorigin-csrf">CSRF</a>ì„ ì ìš©í•˜ê±°ë‚˜ SockJSë¥¼ ìœ„í•œ <a href="https://docs.spring.io/spring-security/reference/servlet/integrations/websocket.html#websocket-sockjs-sameorigin">iFrame</a> ì˜µì…˜ì„ ì²´í¬í•˜ë„ë¡ í•˜ì.</p><pre class="language-java" data-language="java"><div class="caption"><span>WebSocketSecurity.java</span></div><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token annotation punctuation">@EnableWebSocketSecurity</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebSocketSecurity</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">AuthorizationManager</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Message</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token function">messageAuthorizationManager</span><span class="token punctuation">(</span><span class="token class-name">MessageMatcherDelegatingAuthorizationManager<span class="token punctuation">.</span>Builder</span> messages<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// NOTE: Failed to send message to ExecutorSubscribableChannel[clientInboundChannel]: Access Denied</span>        messages                <span class="token punctuation">.</span><span class="token function">nullDestMatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">simpDestMatchers</span><span class="token punctuation">(</span><span class="token string">"/app/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string">"USER"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">simpSubscribeDestMatchers</span><span class="token punctuation">(</span><span class="token string">"/user/queue/error"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">simpSubscribeDestMatchers</span><span class="token punctuation">(</span><span class="token string">"/user/**"</span><span class="token punctuation">,</span> <span class="token string">"/topic/hello"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string">"USER"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">anyMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">denyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> messages<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><blockquote><p>SockJSì˜ ì›¹ì†Œì¼“ ì—°ê²°ì„ ìœ„í•´ ì‚¬ì „ì— ìš”ì²­í•˜ëŠ” &#x2F;info ì—”ë“œí¬ì¸íŠ¸ëŠ” ì¼ë°˜ì ì¸ HTTP í†µì‹ ì„ì— ì£¼ì˜í•˜ë„ë¡ í•´ì•¼í•©ë‹ˆë‹¤.</p></blockquote><p>ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆ ì ê²€ìœ¼ë¡œ ì¸í•´ ë‹¤ì‹œ í•œë²ˆ í•™ìŠµí•˜ëŠ” ê²ƒì€ ì•ˆ ë¹„ë°€ì´ë‹¤.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;ë³¸ ê¸€ì€ ìŠ¤í”„ë§ ë¶€íŠ¸ í”„ë¡œì íŠ¸ë¡œ ë§Œë“¤ì–´ì§„ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ìŠ¤í”„ë§ ì‹œíë¦¬í‹° ëª¨ë“ˆì„ ì ìš©í•˜ëŠ” ê²½ìš°ì— ë³´ì•ˆ ì„¤ì •ì— ëŒ€í•´ ì •ë¦¬í•œ ê²ƒ ì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì˜¤í•´í•˜ê³  ìˆê±°ë‚˜ ì‹ ê²½ì“°ì§€ ì•ŠëŠ” ë¶€ë¶„ì— ëŒ€í•´ì„œ ë‹¤ë£¨ê³ ì í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;/bl</summary>
      
    
    
    
    
    <category term="Spring Security" scheme="https://kdevkr.github.io/tags/Spring-Security/"/>
    
    <category term="Protection Aganinst Exploits" scheme="https://kdevkr.github.io/tags/Protection-Aganinst-Exploits/"/>
    
  </entry>
  
  <entry>
    <title>Invalid SockJS Path.</title>
    <link href="https://kdevkr.github.io/invalid-sockjs-path/"/>
    <id>https://kdevkr.github.io/invalid-sockjs-path/</id>
    <published>2023-10-16T13:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.886Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Invalid SockJS path â€˜XXXâ€™ required to have 3 path segments.</p></blockquote><p>êµ¬ê¸€ì— <a href="https://www.google.com/search?q=Invalid+SockJS+path">Invalid SockJS path</a> ë¼ëŠ” í‚¤ì›Œë“œë¡œ ê²€ìƒ‰í•´ë³´ë©´ ì´ì™€ ê°™ì€ ì˜¤ë¥˜ ë¡œê·¸ì— ëŒ€í•œ ì¡°ì¹˜ë¡œ <a href="https://stackoverflow.com/a/64576478">Stomp í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ë¼ëŠ” ë‹µë³€</a>ì´ë‚˜ <a href="https://github.com/spring-projects/spring-framework/issues/28103">ìŠ¤íƒ ì˜¤ë²„í”Œë¡œìš°ì— ì§ˆë¬¸í•˜ë¼ëŠ” ë‹µë³€</a>ì„ ì°¾ì•„ë³¼ ìˆ˜ ìˆë‹¤. ì•„ë¬´íŠ¼ ìœ„ ìƒí™©ì— ëŒ€í•œ ì›ì¸ì€ ëª…í™•íˆ ì•Œ ìˆ˜ ì—†ëŠ” ìƒí™©ì—ì„œ ì•„ë˜ì™€ ê°™ì€ êµ¬ì¡°ì—ì„œ í•´ë‹¹ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆë‹¤.</p><ol><li>Nginx Websocket Proxy</li><li>Spring WebSocket with Stomp + SockJS</li><li><code>sockjs-client@1.6.1</code></li><li><code>@stomp/stompjs@7.0.0</code></li></ol><h4 id="ì´ìŠˆ-íŒŒì•…"><a href="#ì´ìŠˆ-íŒŒì•…" class="headerlink" title="ì´ìŠˆ íŒŒì•…"></a>ì´ìŠˆ íŒŒì•…</h4><p><a href="https://github.com/kdevkr/nginx.conf">nginx.conf</a>ì™€ ê°™ì´ ì—”ì§„ì—‘ìŠ¤ì—ì„œ ì›¹ì†Œì¼“ ì£¼ì†Œ íŒ¨í„´ì— ëŒ€í•´ ë°±ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œì˜ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ êµ¬ì„±ì„ ì•„ë˜ì™€ ê°™ì´ í•´ë‘” ìƒíƒœì˜€ë‹¤. ê·¸ë¦¬ê³  Stomp ë°©ì‹ì˜ ì›¹ ì†Œì¼“ ì—°ê²°ì„ ìˆ˜í–‰í•˜ëŠ” ì—”ë“œí¬ì¸íŠ¸ëŠ” <code>/ws/stomp</code> ë¡œ ì •ì˜ë˜ì–´ìˆì—ˆë‹¤. ë³¸ë˜ <code>/ws</code> ëŠ” ì¼ë°˜ì ì¸ ì›¹ ì†Œì¼“ ì—°ê²°ì„ ìˆ˜í–‰í•˜ê³  <code>/ws/stmop</code>ë¡œ ì‹œì‘ë˜ëŠ” ê²ƒì€ Stompë¡œ ë™ì‘í•˜ëŠ” ê²ƒì„ ì˜ë„í•œ ê²ƒì´ë‹¤.</p><pre class="language-conf" data-language="conf"><div class="caption"><span>nginx.conf</span></div><code class="language-conf">http &#123;    upstream backend &#123;        server app:8080;        keepalive 128;    &#125;    server &#123;        location &#x2F;ws&#x2F; &#123;            proxy_pass http:&#x2F;&#x2F;backend;            proxy_set_header Host $host;            proxy_set_header X-Real-IP $remote_addr;            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;            # hop-by-hop            proxy_http_version 1.1;            proxy_set_header Connection &quot;upgrade&quot;;            proxy_set_header Upgrade $http_upgrade;            proxy_read_timeout 65s;        &#125;    &#125;&#125;</code></pre><blockquote><p>Vite ê°œë°œ ì„œë²„ì—ì„œì˜ Proxy êµ¬ì„±ì˜ ê²½ìš° ì˜¬ë°”ë¥´ê²Œ Stomp ë°©ì‹ì˜ ì›¹ì†Œì¼“ ì—°ê²°ì„ ìˆ˜í–‰ëœë‹¤.</p></blockquote><p>í•˜ì§€ë§Œ, ì—”ì§„ì—‘ìŠ¤ì™€ í•¨ê»˜ ë™ì‘ì¤‘ì¸ ë°°í¬ í™˜ê²½ì—ì„œëŠ” Stomp í´ë¼ì´ì–¸íŠ¸ê°€ SockJSë¥¼ ì‚¬ìš©í•˜ì—¬ ì—°ê²°ì„ ìˆ˜í–‰í•˜ë ¤ê³  í• ë•Œ <code>/ws/stomp/info?t=0</code> ì—”ë“œí¬ì¸íŠ¸ì— ëŒ€í•´ 404 ì‘ë‹µì„ ë°›ê²Œë˜ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ì—ëŠ” <code>Invalid SockJS path ...</code>ê°€ ì¶œë ¥ë˜ëŠ” ê²ƒì„ í™•ì¸í–ˆë‹¤.</p><h4 id="ì†”ë£¨ì…˜"><a href="#ì†”ë£¨ì…˜" class="headerlink" title="ì†”ë£¨ì…˜"></a>ì†”ë£¨ì…˜</h4><p>ì´ë¦¬ì €ë¦¬ ì‹œë„í•´ë³¸ ê²°ê³¼ í•´ê²°ì±…ì€ ì¼ë°˜ì ì¸ ì›¹ ì†Œì¼“ ì—°ê²°ê³¼ Stomp ë°©ì‹ì˜ ì—°ê²°ì„ ì•„ì˜ˆ ë¶„ë¦¬í•˜ëŠ” ê²ƒì´ë‹¤. <code>/ws/</code> ì´ì™¸ì— <code>/ws-stomp/</code>ë¡œ Stomp ë°©ì‹ì˜ ì›¹ ì†Œì¼“ ì—°ê²°ì„ ìœ„í•œ ë³„ë„ì˜ ì—”ë“œí¬ì¸íŠ¸ íŒ¨í„´ì„ ì‚¬ìš©í•˜ê³  ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ êµ¬ì„±ì„ í•˜ê³ ë‚˜ë‹ˆ í•´ë‹¹ ì¦ìƒì€ ë°œìƒí•˜ì§€ ì•Šì•˜ë‹¤.</p><pre class="language-conf" data-language="conf"><div class="caption"><span>nginx.conf</span></div><code class="language-conf">http &#123;    upstream backend &#123;        server app:8080;        keepalive 128;    &#125;    server &#123;        location ~ ^&#x2F;(ws|ws-stomp)&#x2F; &#123;            proxy_pass http:&#x2F;&#x2F;backend;            proxy_set_header Host $host;            proxy_set_header X-Real-IP $remote_addr;            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;            # hop-by-hop            proxy_http_version 1.1;            proxy_set_header Connection &quot;upgrade&quot;;            proxy_set_header Upgrade $http_upgrade;            proxy_read_timeout 65s;        &#125;    &#125;&#125;</code></pre><p>ì•„ë¬´íŠ¼ ì •í™•í•œ ì›ì¸ì— ëŒ€í•´ì„œëŠ” ë³„ë„ë¡œ ì°¾ì•„ë³´ì•„ì•¼ê² ì§€ë§Œ ê¸°ë¡ìœ¼ë¡œ ë‚¨ê¸°ê³ ì í•œë‹¤.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;Invalid SockJS path â€˜XXXâ€™ required to have 3 path segments.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;êµ¬ê¸€ì— &lt;a href=&quot;https://www.google.com/search?</summary>
      
    
    
    
    
    <category term="Nginx" scheme="https://kdevkr.github.io/tags/Nginx/"/>
    
    <category term="Spring" scheme="https://kdevkr.github.io/tags/Spring/"/>
    
    <category term="SockJS" scheme="https://kdevkr.github.io/tags/SockJS/"/>
    
    <category term="Stomp" scheme="https://kdevkr.github.io/tags/Stomp/"/>
    
  </entry>
  
  <entry>
    <title>ìŠ¤í”„ë§ ë¶€íŠ¸ ì›¹ì†Œì¼“</title>
    <link href="https://kdevkr.github.io/spring-boot-websocket/"/>
    <id>https://kdevkr.github.io/spring-boot-websocket/</id>
    <published>2023-10-14T13:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.890Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ë³¸ ê¸€ì—ì„œ ì–¸ê¸‰í•˜ëŠ” ê´€ë ¨ ì½”ë“œëŠ” <a href="https://github.com/kdevkr/spring-boot-demo/tree/main/websocket-demo">github.com&#x2F;kdevkr&#x2F;spring-boot-demo&#x2F;websocket-demo</a>ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></blockquote><p>ì¼ë°˜ì ì¸ ìŠ¤í”„ë§ ë¶€íŠ¸ ìŠ¤íƒ€í„°ì™€ëŠ” ë‹¤ë¥´ê²Œ ìŠ¤íƒ€í„° ì›¹ì†Œì¼“ ëª¨ë“ˆì—ëŠ” ì›¹ì†Œì¼“ ì—°ê²°ì— ëŒ€í•œ ìë™ êµ¬ì„±ì„ ìˆ˜í–‰í•˜ì§€ëŠ” ì•ŠëŠ”ë‹¤. ì›¹ì†Œì¼“ ê´€ë ¨í•œ ìë™ êµ¬ì„±(WebSocketServletAutoConfiguration)ì€ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©ì¤‘ì¸ ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆì— ë”°ë¼ ì›¹ì†Œì¼“ì— ëŒ€í•´ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ í™•ì¥í•˜ë©° WebSocketMessagingAutoConfiguration ì—ì„œëŠ” Stomp ë°©ì‹ì˜ ì›¹ì†Œì¼“ì„ ìœ„í•œ ë©”ì‹œì§€ ë¸Œë¡œì»¤ë¥¼ êµ¬ì„±í•  ë•Œ ì‚¬ìš©ë˜ëŠ” ë©”ì‹œì§€ ì»¨ë²„í„°ë¥¼ ì„¤ì •í•œë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebSocketConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebSocketConfigurer</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerWebSocketHandlers</span><span class="token punctuation">(</span><span class="token class-name">WebSocketHandlerRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        registry<span class="token punctuation">.</span><span class="token function">addHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TextWebSocketHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token string">"/ws"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setAllowedOriginPatterns</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">addInterceptors</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpSessionHandshakeInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">withSockJS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><a href="https://docs.spring.io/spring-framework/reference/web/websocket/server.html">WebSocket API</a>ì˜ WebSocketConfigurer ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ì—¬ ì›¹ì†Œì¼“ ì—°ê²°ì— ëŒ€í•´ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” í•¸ë“¤ëŸ¬ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜, ì¼ë°˜ì ì¸ ì›¹ì†Œì¼“ ì—°ê²° ë°©ì‹ì—ëŠ” ì—¬ëŸ¬ê°€ì§€ ë‹¨ì ì´ ìˆëŠ”ë° ì„¸ì…˜ê³¼ ì‹œíë¦¬í‹°ì™€ ê°™ì€ ë¶€ê°€ì ì¸ ê¸°ëŠ¥ê³¼ì˜ ì—°ê³„ë¥¼ ì§ì ‘ì ìœ¼ë¡œ êµ¬í˜„í•´ì•¼í•œë‹¤ëŠ” ê²ƒì´ë‹¤.</p><h4 id="SockJS-Fallback"><a href="#SockJS-Fallback" class="headerlink" title="SockJS Fallback"></a>SockJS Fallback</h4><p><a href="https://docs.spring.io/spring-framework/reference/web/websocket/fallback.html">SockJS</a>ëŠ” ì›¹ì†Œì¼“ ì—°ê²°ì— ëŒ€í•œ ë¬¸ì œë¥¼ ë³´ì™„í•˜ê¸° ìœ„í•´ì„œ ë„ì…í•˜ëŠ” ê¸°ìˆ ì´ë©° SockJS í´ë¼ì´ì–¸íŠ¸ëŠ” ì›¹ì†Œì¼“ ì—°ê²° ì£¼ì†Œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì„œë²„ì—ê²Œ &#x2F;info ì—”ë“œí¬ì¸íŠ¸ë¥¼ ìš”ì²­í•˜ì—¬ ì›¹ì†Œì¼“ ì—°ê²° ë°©ì‹ì— ëŒ€í•´ ì§ˆì˜ë¥¼ í•˜ê³  ì‘ë‹µë°›ì€ ê²°ê³¼ë¥¼ í† ëŒ€ë¡œ ì—°ê²°ì„ ì‹œë„í•œë‹¤. ìŠ¤í”„ë§ ì›¹ì†Œì¼“ ëª¨ë“ˆì˜ DefaultSockJsService ì—ì„œëŠ” ì•„ë˜ì™€ ê°™ì€ ì—°ê²°ì„ ì§€ì›í•œë‹¤.</p><pre class="language-java" data-language="java"><div class="caption"><span>DefaultSockJsService.java</span></div><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TransportHandler</span><span class="token punctuation">></span></span> <span class="token function">getDefaultTransportHandlers</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TransportHandler</span><span class="token punctuation">></span></span> overrides<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TransportHandler</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">XhrPollingTransportHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">XhrReceivingTransportHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">XhrStreamingTransportHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">EventSourceTransportHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HtmlFileTransportHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WebSocketTransportHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DefaultHandshakeHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// ...</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>overrides <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        result<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>overrides<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># http://localhost:8080/ws/info?t=1696757550304</span><span class="token punctuation">&#123;</span>  <span class="token string">"entropy"</span><span class="token builtin class-name">:</span> <span class="token number">1279751018</span>,  <span class="token string">"origins"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>    <span class="token string">"*:*"</span>  <span class="token punctuation">]</span>,  <span class="token string">"cookie_needed"</span><span class="token builtin class-name">:</span> true,  <span class="token string">"websocket"</span><span class="token builtin class-name">:</span> <span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token comment"># &#123;websocket-protocol&#125;://&#123;host&#125;:&#123;port&#125;/&#123;websocket-endpoint&#125;/&#123;server-id&#125;/&#123;session-id&#125;/&#123;transport&#125;</span>ws://localhost:8080/ws/712/yyfmvviz/websocket</code></pre><blockquote><p>ê¸°ë³¸ì ìœ¼ë¡œ SockJsServiceRegistrationì˜ ì›¹ì†Œì¼“ ì—°ê²° ì„¤ì •ì´ í™œì„±í™”ë˜ì–´ìˆê³  ì¼ë¶€ ë¡œë“œë°¸ëŸ°ì„œì—ì„œ ì›¹ì†Œì¼“ì„ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ë¹„í™œì„±í™”í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•œë‹¤.</p></blockquote><h4 id="Stomp-over-WebSocket"><a href="#Stomp-over-WebSocket" class="headerlink" title="Stomp over WebSocket"></a>Stomp over WebSocket</h4><h4 id="Webjars"><a href="#Webjars" class="headerlink" title="Webjars"></a>Webjars</h4><p>ë¦¬ì•¡íŠ¸ë‚˜ ë·°ì™€ ê°™ì€ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ í™˜ê²½ì„ êµ¬ì„±í•œë‹¤ë©´ ìì²´ì ìœ¼ë¡œ ë¼ì´ë¸ŒëŸ¬ë¦¬ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ê³  ê´€ë¦¬í•˜ê² ì§€ë§Œ ë°±ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì œê³µí•˜ê³  ì‹¶ë‹¤ë©´ Webjarsë¥¼ ì´ìš©í•  ìˆ˜ë„ ìˆë‹¤.</p><pre class="language-groovy" data-language="groovy"><div class="caption"><span>build.gradle</span></div><code class="language-groovy">dependencies <span class="token punctuation">&#123;</span>    implementation <span class="token string">'org.webjars:webjars-locator-core:0.53'</span>    implementation <span class="token string">'org.webjars:sockjs-client:1.5.1'</span>    implementation <span class="token string">'org.webjars:stomp-websocket:2.3.4'</span><span class="token punctuation">&#125;</span></code></pre><h4 id="ìŠ¤í”„ë§-ì„¸ì…˜ê³¼ì˜-í†µí•©"><a href="#ìŠ¤í”„ë§-ì„¸ì…˜ê³¼ì˜-í†µí•©" class="headerlink" title="ìŠ¤í”„ë§ ì„¸ì…˜ê³¼ì˜ í†µí•©"></a>ìŠ¤í”„ë§ ì„¸ì…˜ê³¼ì˜ í†µí•©</h4><p>Stomp ë°©ì‹ì˜ ì›¹ ì†Œì¼“ ì—°ê²°ì„ êµ¬ì„±í•˜ëŠ” ê²½ìš°ì—ëŠ” WebSocketMessageBrokerConfigurerë¥¼ ì§ì ‘ êµ¬í˜„í•˜ê¸°ë³´ë‹¤ ìŠ¤í”„ë§ ì„¸ì…˜ ëª¨ë“ˆì— í¬í•¨ë˜ì–´ìˆëŠ” AbstractSessionWebSocketMessageBrokerConfigurerë¥¼ í™•ì¥í•˜ëŠ” ê²ƒì´ ë” í¸ë¦¬í•˜ë‹¤. ìŠ¤í”„ë§ ì„¸ì…˜ê³¼ ì—°ê³„ë˜ëŠ” ë¯¸ë¦¬ êµ¬í˜„ëœ í´ë˜ìŠ¤ë“¤ì„ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ì—¬ ì›¹ì†Œì¼“ ì„¸ì…˜(WebSocketSession)ì—ì„œ ì‚¬ìš©ì ì •ë³´ë¥¼ ì£¼ì…í•˜ê³  ì‰½ê²Œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë„ë¡ ì§€ì›í•œë‹¤.</p><pre class="language-groovy" data-language="groovy"><div class="caption"><span>build.gradle</span></div><code class="language-groovy">dependencies <span class="token punctuation">&#123;</span>    implementation <span class="token string">'org.springframework.boot:spring-boot-starter-websocket'</span>    implementation <span class="token string">'org.springframework.session:spring-session-core'</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@EnableWebSocketMessageBroker</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StompConfig</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractSessionWebSocketMessageBrokerConfigurer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MapSession</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configureStompEndpoints</span><span class="token punctuation">(</span><span class="token class-name">StompEndpointRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        registry<span class="token punctuation">.</span><span class="token function">addEndpoint</span><span class="token punctuation">(</span><span class="token string">"/ws/stomp"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setAllowedOriginPatterns</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">withSockJS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configureMessageBroker</span><span class="token punctuation">(</span><span class="token class-name">MessageBrokerRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// NOTE: /topic: Broadcast, /queue: Unicast</span>        registry<span class="token punctuation">.</span><span class="token function">enableSimpleBroker</span><span class="token punctuation">(</span><span class="token string">"/topic"</span><span class="token punctuation">,</span> <span class="token string">"/queue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        registry<span class="token punctuation">.</span><span class="token function">setApplicationDestinationPrefixes</span><span class="token punctuation">(</span><span class="token string">"/app"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        registry<span class="token punctuation">.</span><span class="token function">setPreservePublishOrder</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-java" data-language="java"><div class="caption"><span>StompController.java</span></div><code class="language-java"><span class="token annotation punctuation">@AllArgsConstructor</span><span class="token annotation punctuation">@Slf4j</span><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StompController</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">SimpMessagingTemplate</span> template<span class="token punctuation">;</span>    <span class="token annotation punctuation">@SendTo</span><span class="token punctuation">(</span><span class="token string">"/topic/hello"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@MessageMapping</span><span class="token punctuation">(</span><span class="token string">"/hello"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token class-name">GenericMessage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> message<span class="token punctuation">,</span>                                     <span class="token annotation punctuation">@Header</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"simpSessionId"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> wsSessionId<span class="token punctuation">,</span>                                     <span class="token annotation punctuation">@Header</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"simpSessionAttributes"</span><span class="token punctuation">)</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> sessionAttributes<span class="token punctuation">,</span>                                     <span class="token class-name">Principal</span> principal<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token class-name">SessionRepositoryMessageInterceptor</span><span class="token punctuation">.</span><span class="token function">getSessionId</span><span class="token punctuation">(</span>sessionAttributes<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>principal <span class="token keyword">instanceof</span> <span class="token class-name">Authentication</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            username <span class="token operator">=</span> principal<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> payload <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        payload<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">,</span> <span class="token string">"Hello, %s"</span><span class="token punctuation">.</span><span class="token function">formatted</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        payload<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"from"</span><span class="token punctuation">,</span> <span class="token string">"StompController"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// NOTE: similar @SendToUser</span>        template<span class="token punctuation">.</span><span class="token function">convertAndSendToUser</span><span class="token punctuation">(</span>wsSessionId<span class="token punctuation">,</span> <span class="token string">"/queue/hello"</span><span class="token punctuation">,</span> payload<span class="token punctuation">,</span> message<span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> payload<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="ìŠ¤í”„ë§-ì‹œíë¦¬í‹°ì™€ì˜-í†µí•©"><a href="#ìŠ¤í”„ë§-ì‹œíë¦¬í‹°ì™€ì˜-í†µí•©" class="headerlink" title="ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì™€ì˜ í†µí•©"></a>ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì™€ì˜ í†µí•©</h4><p>Stomp ë°©ì‹ì˜ ì›¹ ì†Œì¼“ ì—°ê²°ì˜ ê²½ìš° ìŠ¤í”„ë§ ì„¸ì…˜ê³¼ì˜ í†µí•©ì²˜ëŸ¼ ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì™€ì˜ í†µí•©ë„ ì§€ì›í•œë‹¤. ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ê°€ ê¸°ë³¸ HTTP ë³´ì•ˆì„ ì„¤ì •í•œë‹¤ë©´ @EnableWebSocketSecurityê°€ ì„ ì–¸ëœ êµ¬ì„± í´ë˜ìŠ¤ë¥¼ í†µí•´ì„œ Stomp ë©”ì‹œì§€ì— ëŒ€í•´ ë³´ì•ˆ ê·œì¹™ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ì¼ë°˜ì ì¸ ì›¹ ì†Œì¼“ ì—°ê²°ì„ êµ¬ì„±í•˜ëŠ” ê²½ìš°ì— ë³´ì•ˆì ì¸ ë¡œì§ì„ ì§ì ‘ êµ¬í˜„í•´ì•¼í•˜ì§€ë§Œ ë” ê°„ë‹¨í•˜ê²Œ ì ìš©í•  ìˆ˜ ìˆë‹¤.</p><pre class="language-groovy" data-language="groovy"><div class="caption"><span>build.gradle</span></div><code class="language-groovy">dependencies <span class="token punctuation">&#123;</span>    implementation <span class="token string">'org.springframework.boot:spring-boot-starter-security'</span>    implementation <span class="token string">'org.springframework.security:spring-security-messaging'</span>    testImplementation <span class="token string">'org.springframework.security:spring-security-test'</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-java" data-language="java"><div class="caption"><span>WebSocketSecurity.java</span></div><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token annotation punctuation">@EnableWebSocketSecurity</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebSocketSecurity</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">AuthorizationManager</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Message</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token function">messageAuthorizationManager</span><span class="token punctuation">(</span><span class="token class-name">MessageMatcherDelegatingAuthorizationManager<span class="token punctuation">.</span>Builder</span> messages<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// NOTE: Failed to send message to ExecutorSubscribableChannel[clientInboundChannel]: Access Denied</span>        messages                <span class="token punctuation">.</span><span class="token function">nullDestMatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">simpDestMatchers</span><span class="token punctuation">(</span><span class="token string">"/app/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string">"USER"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">simpSubscribeDestMatchers</span><span class="token punctuation">(</span><span class="token string">"/user/queue/error"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">simpSubscribeDestMatchers</span><span class="token punctuation">(</span><span class="token string">"/user/**"</span><span class="token punctuation">,</span> <span class="token string">"/topic/hello"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string">"USER"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">anyMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">denyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> messages<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="WebSocketSession-Management"><a href="#WebSocketSession-Management" class="headerlink" title="WebSocketSession Management"></a>WebSocketSession Management</h4><p>ìŠ¤ì¼€ì¤„ë§ ê¸°ëŠ¥ì„ í†µí•´ íŠ¹ì • ìƒí™©ì—ì„œ ì›¹ì†Œì¼“ì— ì—°ê²°ëœ ì‚¬ìš©ìì—ê²Œ ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•  í•„ìš”ì„±ì´ ìˆë‹¤. ì›¹ ì†Œì¼“ ì—°ê²°ì— ëŒ€í•œ ì„¸ì…˜ ê´€ë¦¬ë¥¼ í•´ì£¼ì§€ë§Œ ì„¸ì…˜ì´ ì—°ê²°ì¤‘ì¸ WebSocketSession ëª©ë¡ì€ ê´€ë¦¬í•´ì£¼ì§€ ì•ŠëŠ”ë‹¤. ì•ì„œ, WebSocketRegistryListenerë¥¼ í†µí•´ ì—°ê²°ê³¼ í•´ì§€ ê·¸ë¦¬ê³  ë©”ì‹œì§€ ìˆ˜ì‹  êµ¬ë…ì— ëŒ€í•œ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•  í•¸ë“¤ëŸ¬ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì›¹ ì†Œì¼“ ì„¸ì…˜ì„ ì €ì¥í•˜ëŠ” í´ë˜ìŠ¤ë¥¼ êµ¬í˜„í•´ë³´ë„ë¡ í•˜ì.</p><ul><li><a href="https://github.com/kdevkr/spring-boot-demo/blob/main/websocket-demo/src/main/java/kr/kdev/demo/WebSocketRepository.java">WebSocketRepository.java</a></li><li><a href="https://github.com/kdevkr/spring-boot-demo/blob/main/websocket-demo/src/main/java/kr/kdev/demo/WebSocketEventHandler.java">WebSocketEventHandler.java</a></li></ul><p>ì¼ë¶€ ì˜ˆì œì—ì„œëŠ” WebSocketHandlerDecorator í´ë˜ìŠ¤ë¥¼ í™•ì¥í•˜ì—¬ ì›¹ ì†Œì¼“ ì„¸ì…˜ ê´€ë¦¬ë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒì„ ì°¾ì•„ë³¼ ìˆ˜ ìˆìœ¼ë‚˜ ì´ë¯¸ êµ¬í˜„ë˜ì–´ìˆê³  êµ³ì´ í•¸ë“¤ëŸ¬ë¥¼ êµì²´í•  í•„ìš”ê°€ ì—†ì´ ìœ„ì™€ ê°™ì´ ì´ë²¤íŠ¸ë§Œì„ ë°›ì•„ì„œ ì²˜ë¦¬í•˜ëŠ”ê²Œ ë” ê°„ë‹¨í•˜ë‹¤. ë˜í•œ, êµ³ì´ í•¸ë“¤ëŸ¬ ìœ„ì¹˜ê°€ ì•„ë‹ˆë”ë¼ë„ SimpMessagingTemplateë¥¼ í†µí•´ <a href="https://docs.spring.io/spring-framework/reference/web/websocket/stomp/handle-send.html">ë©”ì‹œì§€ë¥¼ ì†¡ì‹ </a>í•  ìˆ˜ ìˆë‹¤. SessionSubscribeEvent ì™€ SessionUnsubscribeEventëŠ” ì„¸ì…˜ ìì²´ë¥¼ ì „ë‹¬í•´ì£¼ì§€ëŠ” ì•Šì§€ë§Œ ì›¹ì†Œì¼“ ì„¸ì…˜ ì•„ì´ë””ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìœ¼ë¯€ë¡œ íŠ¹ì • íŒ¨í„´ì˜ êµ¬ë… ì£¼ì†Œë¥¼ ê°ì§€í•˜ì—¬ ì„¸ì…˜ ì•„ì´ë”” ëª©ë¡ì„ ê´€ë¦¬í•˜ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì–´ë– í•œ ë°ì´í„°ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</p><blockquote><p>ìŠ¤í”„ë§ ì„¸ì…˜ ëª¨ë“ˆê³¼ ì—°ê³„ëœ ì›¹ì†Œì¼“ ì—°ê²°ì„ êµ¬ì„±í•˜ëŠ” ê²½ìš°ì— SimpMessaingTemplateë¥¼ í†µí•´ ì›¹ì†Œì¼“ ì„¸ì…˜ ì•„ì´ë””ê°€ ì•„ë‹Œ ì‚¬ìš©ì ì´ë¦„ìœ¼ë¡œë„ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.</p></blockquote><h4 id="ì›¹-ì†Œì¼“-ê´€ë ¨-ë¬¸ì„œ"><a href="#ì›¹-ì†Œì¼“-ê´€ë ¨-ë¬¸ì„œ" class="headerlink" title="ì›¹ ì†Œì¼“ ê´€ë ¨ ë¬¸ì„œ"></a>ì›¹ ì†Œì¼“ ê´€ë ¨ ë¬¸ì„œ</h4><ul><li><a href="https://docs.spring.io/spring-framework/reference/web/websocket.html">Spring Framework - WebSockets</a></li><li><a href="https://docs.spring.io/spring-session/reference/web-socket.html">Spring Session - WebSocket Integration</a></li><li><a href="https://docs.spring.io/spring-security/reference/servlet/integrations/websocket.html">Spring Security - WebSocket Security</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;ë³¸ ê¸€ì—ì„œ ì–¸ê¸‰í•˜ëŠ” ê´€ë ¨ ì½”ë“œëŠ” &lt;a href=&quot;https://github.com/kdevkr/spring-boot-demo/tree/main/websocket-demo&quot;&gt;github.com&amp;#x2F;kdevkr&amp;#x2F;</summary>
      
    
    
    
    
    <category term="SockJS" scheme="https://kdevkr.github.io/tags/SockJS/"/>
    
    <category term="WebSocket" scheme="https://kdevkr.github.io/tags/WebSocket/"/>
    
    <category term="STOMP" scheme="https://kdevkr.github.io/tags/STOMP/"/>
    
  </entry>
  
  <entry>
    <title>Systemd ì„œë¹„ìŠ¤ë¡œ ìë°” ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰í•˜ê¸°</title>
    <link href="https://kdevkr.github.io/java-app-service-with-systemd/"/>
    <id>https://kdevkr.github.io/java-app-service-with-systemd/</id>
    <published>2023-10-12T14:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.886Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.baeldung.com/linux/run-java-application-as-service">Run a Java Application as a Service on Linux</a> ë¥¼ ì°¸ê³ í•´ë³´ë‹ˆ <code>Systemd</code> ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•´ì„œ ìë°” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ê³  ê´€ë¦¬í•˜ëŠ” ì„œë¹„ìŠ¤ë¥¼ ë“±ë¡í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œê²Œë˜ì—ˆë‹¤. ê·¸ë™ì•ˆ ìë°” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•˜ê¸° ìœ„í•œ <code>ì‰˜ ìŠ¤í¬ë¦½íŠ¸</code>ë¥¼ ì‘ì„±í•˜ì—¬ ì‹¤í–‰í•˜ê³  ì¢…ë£Œí•˜ê³  ë°°í¬í•´ì˜¤ê³¤ í–ˆë‹¤. ë°˜ë©´ì— Nginxì˜ ê²½ìš° íŒ¨í‚¤ì§€ë¡œ ì„¤ì¹˜í•˜ì—¬ ìë™ìœ¼ë¡œ ì„œë¹„ìŠ¤ê°€ ë§Œë“¤ì–´ì ¸ì„œ ì‰½ê²Œ ì‹¤í–‰í•  ìˆ˜ ìˆì—ˆë‹¤. ì‹ ê·œ í”„ë¡œì íŠ¸ë¡œ ì¸í•´ ë°ëª¨ìš© ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìƒˆë¡­ê²Œ ë°°í¬í•´ì•¼í•˜ëŠ” ìš”êµ¬ì‚¬í•­ì´ ìƒê²¼ê¸°ì— ì´ë²ˆì—ëŠ” Systemd ì„œë¹„ìŠ¤ë¡œ ë“±ë¡í•˜ì—¬ ê´€ë¦¬í•´ë³´ì.</p><h4 id="Systemd-ì„œë¹„ìŠ¤-ë“±ë¡í•˜ê¸°"><a href="#Systemd-ì„œë¹„ìŠ¤-ë“±ë¡í•˜ê¸°" class="headerlink" title="Systemd ì„œë¹„ìŠ¤ ë“±ë¡í•˜ê¸°"></a>Systemd ì„œë¹„ìŠ¤ ë“±ë¡í•˜ê¸°</h4><p><code>/etc/systemd/system/</code> í´ë” í•˜ìœ„ì— <code>vi</code> ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•´ì„œ ì•„ë˜ì™€ ê°™ì´ ì„œë¹„ìŠ¤ íŒŒì¼ì„ ë§Œë“¤ì–´ì•¼ í•œë‹¤. <code>ì• í”Œë¦¬ì¼€ì´ì…˜ ë˜ëŠ” ì„œë¹„ìŠ¤ ì´ë¦„</code>ì„ íŒŒì¼ëª…ìœ¼ë¡œ ì‘ì„±í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•œë‹¤. </p><pre class="language-bash" data-language="bash"><div class="caption"><span>/etc/systemd/system/app.service</span></div><code class="language-bash"><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span><span class="token assign-left variable">Description</span><span class="token operator">=</span>Java application <span class="token function">service</span><span class="token assign-left variable">After</span><span class="token operator">=</span>syslog.target network.target<span class="token punctuation">[</span>Service<span class="token punctuation">]</span><span class="token assign-left variable">Type</span><span class="token operator">=</span>simple<span class="token assign-left variable">SuccessExitStatus</span><span class="token operator">=</span><span class="token number">143</span><span class="token assign-left variable">Restart</span><span class="token operator">=</span>on-failure<span class="token assign-left variable">RestartSec</span><span class="token operator">=</span>10s<span class="token assign-left variable">User</span><span class="token operator">=</span>ubuntu<span class="token assign-left variable">Group</span><span class="token operator">=</span>ubuntu<span class="token assign-left variable">WorkingDirectory</span><span class="token operator">=</span>/home/ubuntu/<span class="token assign-left variable">Environment</span><span class="token operator">=</span>JAVA_HOME<span class="token operator">=</span>/home/ubuntu/.sdkman/candidates/java/current<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/bin/java <span class="token parameter variable">-jar</span> /home/ubuntu/app.jar<span class="token assign-left variable">ExecStop</span><span class="token operator">=</span>/bin/kill <span class="token parameter variable">-15</span> <span class="token variable">$MAINPID</span><span class="token punctuation">[</span>Install<span class="token punctuation">]</span><span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target</code></pre><blockquote><p>ë¦¬ëˆ…ìŠ¤ ì„œë²„ì— ì—¬ëŸ¬ê°œì˜ ìë°” ë²„ì „ì„ í˜¼ìš©í•˜ëŠ” ê²½ìš° ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì‹œ í•„ìš”í•œ JDK ë²„ì „ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì§€ì •í•˜ë„ë¡ í•˜ì. ì˜ˆê¸°ì¹˜ ì•Šì€ ìƒí™©ìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì¢…ë£Œë˜ëŠ” ê²½ìš° ë‹¤ì‹œ ì‹¤í–‰ë  ìˆ˜ ìˆë„ë¡ Restart ì˜µì…˜ì„ ì ìš©í•˜ëŠ” ê²ƒì„ ê³ ë ¤í•˜ì.</p></blockquote><h4 id="Systemd-ì„œë¹„ìŠ¤-ì‹¤í–‰í•˜ê¸°"><a href="#Systemd-ì„œë¹„ìŠ¤-ì‹¤í–‰í•˜ê¸°" class="headerlink" title="Systemd ì„œë¹„ìŠ¤ ì‹¤í–‰í•˜ê¸°"></a>Systemd ì„œë¹„ìŠ¤ ì‹¤í–‰í•˜ê¸°</h4><p><code>service</code> ëª…ë ¹ì–´ë¥¼ í†µí•´ ìë°” ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ë¥¼ ì‹¤í–‰í•˜ê³  ì¢…ë£Œí•  ìˆ˜ ìˆìœ¼ë‚˜ <code>systemctl</code> ëª…ë ¹ì–´ë¥¼ í†µí•´ ì„œë¹„ìŠ¤ë¥¼ ë°˜ì˜í•˜ê³  ë¦¬ëˆ…ìŠ¤ ì„œë²„ê°€ ë‹¤ì‹œ ì‹¤í–‰ë˜ì–´ systemd ì„œë¹„ìŠ¤ê°€ ì‹¤í–‰ë˜ë©´ ìë™ìœ¼ë¡œ ì‹œì‘ë  ìˆ˜ ìˆë„ë¡ <code>enable</code> ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.</p><pre class="language-bash" data-language="bash"><div class="caption"><span>Termianl</span></div><code class="language-bash"><span class="token function">sudo</span> systemctl daemon-reload<span class="token comment"># Systemd ì„œë¹„ìŠ¤ ì‹œì‘ ì‹œ ìë™ ì‹¤í–‰ ë“±ë¡</span>ubuntu@ubuntu:~$ <span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> app.serviceCreated symlink /etc/systemd/system/multi-user.target.wants/app.service â†’ /etc/systemd/system/app.service.<span class="token function">sudo</span> systemctl status app.service <span class="token comment"># sudo service app status</span>ubuntu@ubuntu:~$ <span class="token function">sudo</span> <span class="token function">service</span> app statusâ— app.service - Java application <span class="token function">service</span>     Loaded: loaded <span class="token punctuation">(</span>/etc/systemd/system/app.service<span class="token punctuation">;</span> enabled<span class="token punctuation">;</span> vendor preset: enabled<span class="token punctuation">)</span>     Active: active <span class="token punctuation">(</span>running<span class="token punctuation">)</span> since Thu <span class="token number">2023</span>-10-12 <span class="token number">14</span>:01:24 UTC<span class="token punctuation">;</span> 22min ago   Main PID: <span class="token number">25835</span> <span class="token punctuation">(</span>java<span class="token punctuation">)</span>      Tasks: <span class="token number">23</span> <span class="token punctuation">(</span>limit: <span class="token number">2256</span><span class="token punctuation">)</span>     Memory: <span class="token number">150</span>.6M     CGroup: /system.slice/app.service             â””â”€25835 /bin/java <span class="token parameter variable">-jar</span> /home/ubuntu/app.jar</code></pre><blockquote><p>ê°€ë”ì”© íŒ¨í‚¤ì§€ë¡œ ì„¤ì¹˜í•œ ì„œë¹„ìŠ¤ë“¤ì´ ì˜ˆê¸°ì¹˜ ì•Šì€ ìƒí™©ìœ¼ë¡œ ë¦¬ëˆ…ìŠ¤ ì„œë²„ê°€ ì¬ì‹¤í–‰ë˜ì—ˆì„ë•Œ ìë™ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ” ìƒí™©ì´ ì¢…ì¢… ë°œìƒí•œë‹¤.<br>ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ê²ƒì— ê·¸ì¹˜ì§€ ì•Šê³  ë‹¤ì–‘í•œ ë¬¸ì œì— ëŒ€í•´ ê³ ë¯¼í•´ì•¼í•  í•„ìš”ì„±ì´ ìˆëŠ” ê²ƒ ê°™ë‹¤.</p></blockquote><h4 id="ì• í”Œë¦¬ì¼€ì´ì…˜-ë¡œê·¸-ì¡°íšŒí•˜ê¸°"><a href="#ì• í”Œë¦¬ì¼€ì´ì…˜-ë¡œê·¸-ì¡°íšŒí•˜ê¸°" class="headerlink" title="ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ ì¡°íšŒí•˜ê¸°"></a>ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ ì¡°íšŒí•˜ê¸°</h4><p>ì¼ë°˜ì ìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ìƒì„±í•œ ë¡œê·¸ íŒŒì¼ì„ <code>tail</code> ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚´í´ë³´ì•˜ìœ¼ë‚˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ë¡œ ë“±ë¡í•˜ì˜€ê¸°ì— ë³„ë„ì˜ íŒŒì¼ë¡œ ì €ì¥í•˜ëŠ” ì˜µì…˜ì„ ë‘ì§€ ì•Šì•˜ë‹¤ë©´ <code>journalctl</code> ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•´ì„œ ë¡œê·¸ë¥¼ ì¡°íšŒí•´ì•¼í•œë‹¤.</p><pre class="language-bash" data-language="bash"><div class="caption"><span>Terminal</span></div><code class="language-bash"><span class="token function">sudo</span> journalctl <span class="token parameter variable">-u</span> app.service <span class="token parameter variable">-f</span></code></pre><blockquote><p>ìš´ì˜ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë‚˜ ì„œë¹„ìŠ¤ì˜ ê²½ìš° ì˜ ë™ì‘í•˜ëŠ” ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ êµ³ì´ ì„œë¹„ìŠ¤ ë°©ì‹ìœ¼ë¡œ ë°”ê¾¸ì§€ëŠ” ë§ì.</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://www.baeldung.com/linux/run-java-application-as-service&quot;&gt;Run a Java Application as a Service on Linux&lt;/a&gt; ë¥¼ ì°¸ê³ í•´ë³´ë‹ˆ &lt;code&gt;S</summary>
      
    
    
    
    
    <category term="Systemd" scheme="https://kdevkr.github.io/tags/Systemd/"/>
    
    <category term="Java" scheme="https://kdevkr.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Nginxë¡œ Vite í”„ë¡œì íŠ¸ ë°°í¬í•˜ê¸°</title>
    <link href="https://kdevkr.github.io/deploy-vite/"/>
    <id>https://kdevkr.github.io/deploy-vite/</id>
    <published>2023-10-10T11:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.886Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Q. í”„ë¡ íŠ¸ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì–´ë–»ê²Œ ë°°í¬ë¥¼ í•´ì•¼í• ê¹Œ?</p></blockquote><p>ì˜¤ë˜ì „ë¶€í„° ê¸°ë³¸ì ìœ¼ë¡œëŠ” ë°±ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ í”„ë¡ íŠ¸ UI êµ¬ì„±ì„ ìœ„í•œ ì—ì…‹ë“¤ì„ ê´€ë¦¬í•˜ê³  í•¨ê»˜ ë¹Œë“œë˜ì–´ ë°°í¬ë˜ëŠ” ë°©ì‹ì„ ì·¨í•´ì™”ë‹¤. ê·¸ëŸ¬ë‚˜, ë°±ì—”ë“œ ê°œë°œìì™€ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìë¡œ ë‚˜ëˆ„ì–´ì§€ë”ë‹ˆ í•˜ë‚˜ì˜ ì„œë¹„ìŠ¤ë¥¼ êµ¬ì„±í•˜ëŠ” í”„ë¡ íŠ¸ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ë°±ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë‚˜ëˆ„ì–´ì§€ê³  ê° ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•  ìˆ˜ ìˆëŠ” í™˜ê²½ì´ ë§Œë“¤ì–´ì§€ê³  ìˆë‹¤. ë³´í†µ ë°±ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë¹Œë“œí•˜ë©´ì„œ UI ì—ì…‹ íŒŒì¼ë“¤ì„ í¬í•¨í•˜ë¯€ë¡œ ë°°í¬ ê³¼ì •ì€ ë°±ì—”ë“œ ê°œë°œìê°€ ë‹´ë‹¹í–ˆë˜ ì¡°ì§ì´ ë§ì•˜ì„ ê²ƒ ê°™ë‹¤.</p><p>ë§Œì•½, ì¡°ì§ êµ¬ì„±ìœ¼ë¡œ ì¸í•´ í”„ë¡ íŠ¸ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì„ ìœ„í•œ í”„ë¡ íŠ¸ì—”ë“œ íŒ€ì´ ìˆëŠ” ê³³ì´ë¼ë©´ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìê°€ ë°°í¬ë¥¼ ì§ì ‘ ìˆ˜í–‰í•  ìˆ˜ë„ ìˆì–´ë³´ì¸ë‹¤. íšŒì‚¬ë§ˆë‹¤ ì¼í•˜ëŠ” ë°©ì‹ì€ ë‹¤ë¥¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë¦´ë¦¬ì¦ˆì— ëŒ€í•œ ë¶€ë¶„ì€ QA ì—”ì§€ë‹ˆì–´ê°€ ë‹´ë‹¹í•˜ê¸°ë„ í•œë‹¤. ì•„ë¬´íŠ¼ Vite ê¸°ë°˜ í”„ë¡œì íŠ¸ë¥¼ ë°°í¬í•˜ëŠ” ë°©ì•ˆì— ëŒ€í•´ì„œ ì •ë¦¬í•´ë³´ì.</p><blockquote><p><a href="https://vitejs.dev/guide/static-deploy.html#deploying-a-static-site">Deploying a Static Site</a><br>It is important to note that vite preview is intended for previewing the build locally and not meant as a production server.</p></blockquote><p>ë¡œì»¬ í™˜ê²½ì—ì„œ ì •ì  í˜ì´ì§€ë¥¼ ë°°í¬í•  ìˆ˜ ìˆëŠ” ì›¹ ì„œë²„ë¥¼ ì‹¤í–‰í•˜ëŠ” preview ëª…ë ¹ì–´ë¥¼ ì œê³µí•˜ì§€ë§Œ ìœ„ì™€ ê°™ì´ í”„ë¡œë•ì…˜ í™˜ê²½ì„ ìœ„í•œ ë°°í¬ ì„œë²„ëŠ” ì•„ë‹˜ì— ì£¼ì˜í•´ì•¼í•œë‹¤. ê¸°ë³¸ì ì¸ ê°œë…ì€ ì •ì  ë°°í¬ë¥¼ ìœ„í•œ ë¹Œë“œ íŒŒì¼ì„ ë§Œë“¤ê³ ë‚˜ì„œ ë°±ì—”ë“œ ì„œë²„ ë˜ëŠ” ì›¹ ì„œë²„ë¥¼ í†µí•´ ì •ì  íŒŒì¼ì— ëŒ€í•œ ì‘ë‹µì„ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ë‹¤.</p><ul><li><a href="https://ko.vitejs.dev/guide/build.html">Vite í”„ë¡œë•ì…˜ ë²„ì „ìœ¼ë¡œ ë¹Œë“œí•˜ê¸°</a></li><li><a href="https://ko.vitejs.dev/guide/backend-integration.html">Vite ë°±ì—”ë“œ í”„ë ˆì„ì›Œí¬ì™€ í•¨ê»˜ ì‚¬ìš©í•˜ê¸°</a></li></ul><p>ë‘ë²ˆì§¸ ë°©ì‹ì€ ì¼ë°˜ì ìœ¼ë¡œ ë§ì´ ì‚¬ìš©ë˜ëŠ” í¸ìœ¼ë¡œ ë°±ì—”ë“œ ì„œë²„ê°€ ìŠ¤í”„ë§ ë¶€íŠ¸ í”„ë¡œì íŠ¸ë¼ë©´ <a href="https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-config/static-resources.html">ì •ì  ë¦¬ì†ŒìŠ¤ ê²½ë¡œì— í¬í•¨</a>ë  ìˆ˜ ìˆë„ë¡ í•˜ë©´ ëœë‹¤. ë°±ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹Œë“œ ì‹œ í´ë˜ìŠ¤íŒ¨ìŠ¤ì— í¬í•¨ë˜ì–´ë„ ë˜ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ í”„ë¡œí¼í‹°ë¥¼ í†µí•´ íŠ¹ì • íŒŒì¼ ê²½ë¡œë¥¼ ì§€ì •í•´ë„ ëœë‹¤. ë³¸ ê¸€ì—ì„œ ì •ë¦¬í•˜ê³ ì í•˜ëŠ” ê±´ ì²«ë²ˆì§¸ ë°©ì‹ìœ¼ë¡œ í”„ë¡œë•ì…˜ ë°°í¬ë¥¼ ìœ„í•œ ì •ì  íŒŒì¼ì„ ë¹Œë“œí•˜ê³ ë‚˜ì„œ Nginxì™€ ê°™ì€ ì›¹ì„œë²„ë¥¼ í†µí•´ ì •ì  íŒŒì¼ì„ ë°°í¬í•˜ëŠ” ê²ƒì´ë‹¤.</p><blockquote><p>Nginx ì›¹ì„œë²„ì—ì„œ ì •ì  íŒŒì¼ì„ ë°°í¬í•˜ê³  ë°±ì—”ë“œ API ìš”ì²­ì— ëŒ€í•´ì„œëŠ” ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ êµ¬ì„±ì„ í•˜ë©´ ëœë‹¤. ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ êµ¬ì„±ì˜ ì¥ì ì€ ë°±ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í¬íŠ¸ë¥¼ ê°ì¶œ ìˆ˜ ìˆê²Œ ë˜ì–´ ì¡°ê¸ˆì€ ë³´ì•ˆì ì¸ ì¸í”„ë¼ êµ¬ì„±ì´ ë  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ì°¸ê³ ë¡œ Vite ê°œë°œ ì„œë²„ì—ì„œë„ <a href="https://ko.vitejs.dev/config/server-options.html#server-proxy">í”„ë¡ì‹œ êµ¬ì„±</a>ì„ í•  ìˆ˜ ìˆê²Œ ì œê³µí•œë‹¤.</p></blockquote><h4 id="Nginx-ì›¹ì„œë²„ë¡œ-Vite-ì •ì -íŒŒì¼-ë°°í¬"><a href="#Nginx-ì›¹ì„œë²„ë¡œ-Vite-ì •ì -íŒŒì¼-ë°°í¬" class="headerlink" title="Nginx ì›¹ì„œë²„ë¡œ Vite ì •ì  íŒŒì¼ ë°°í¬"></a>Nginx ì›¹ì„œë²„ë¡œ Vite ì •ì  íŒŒì¼ ë°°í¬</h4><pre class="language-javascript" data-language="javascript"><div class="caption"><span>vite.config.js</span></div><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> defineConfig <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"vite"</span><span class="token punctuation">;</span><span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">"@vitejs/plugin-vue"</span><span class="token punctuation">;</span><span class="token comment">// https://vitejs.dev/config/</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>  <span class="token literal-property property">build</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token literal-property property">manifest</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">"esnext"</span><span class="token punctuation">,</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-bash" data-language="bash"><div class="caption"><span>Windows Terminal</span></div><code class="language-bash">$ <span class="token function">yarn</span> <span class="token parameter variable">--cwd</span> <span class="token string">'frontend'</span> <span class="token function">install</span>$ <span class="token function">yarn</span> <span class="token parameter variable">--cwd</span> <span class="token string">'frontend'</span> run build <span class="token parameter variable">--mode</span> productionvite v4.4.11 building <span class="token keyword">for</span> production<span class="token punctuation">..</span>.</code></pre><p>ë¹Œë“œ ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ dist í´ë” ì•„ë˜ì— ì •ì  íŒŒì¼ë“¤ì´ ìƒì„±ëœë‹¤.</p><ul><li>dist&#x2F;assets : ì •ì  ì—ì…‹ ëª¨ìŒ</li><li>dist&#x2F;index.html : ì§„ì…ì (EntryPoint) íŒŒì¼</li><li>manifest.json : ë§¤ë‹ˆí˜ìŠ¤íŠ¸ íŒŒì¼</li></ul><p>ìƒì„±ëœ ì •ì  ë¹Œë“œ íŒŒì¼ë“¤ì„ <a href="https://github.com/kdevkr/nginx.conf">nginx.conf</a> ì˜ static í´ë”ë¡œ ëŒ€ì²´í•˜ì—¬ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ì. ì œëŒ€ë¡œ ë™ì‘í•˜ì§€ ì•Šì„í…ë° Nginxì˜ ì„¤ì • íŒŒì¼ì˜ êµ¬ì„±ì´ ë°±ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ ê¸°ë³¸ì ì¸ ìš”ì²­ì„ ì „ë‹¬í•˜ë„ë¡ ë˜ì–´ìˆê¸° ë•Œë¬¸ì´ë‹¤. <code>/</code> ê²½ë¡œì— ëŒ€í•´ì„œëŠ” index.htmlì„ ì‘ë‹µí•˜ë„ë¡ ë³€ê²½í•´ì•¼í•˜ê³  ë°±ì—”ë“œì— ëŒ€í•œ ìš”ì²­ì´ ë‚˜ì¤‘ì— ì „ë‹¬ë˜ë„ë¡ ìˆ˜ì •í•´ì•¼í•œë‹¤.</p><pre class="language-conf" data-language="conf"><div class="caption"><span>nginx-vite.conf</span></div><code class="language-conf">server &#123;  index index.html;  root &#x2F;etc&#x2F;nginx&#x2F;static;  try_files $uri &#x2F;index.html &#x3D;404;  # ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ  location ~ ^&#x2F;(api|version) &#123;      proxy_pass http:&#x2F;&#x2F;backend;      proxy_redirect off;      proxy_buffering off;      proxy_set_header Host $host;      proxy_set_header X-Real-IP $remote_addr;      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;      access_log &#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log;  &#125;&#125;</code></pre><p><img data-src="/images/posts/deploy-vite/01.png">  </p><p>ê¸°ë³¸ì ì¸ ìš”ì²­ì— ëŒ€í•´ì„œëŠ” static í´ë” ê¸°ì¤€ìœ¼ë¡œ ì •ì  íŒŒì¼ì„ ì‚¬ìš©í•´ ì‘ë‹µí•˜ë©° &#x2F;api ë° &#x2F;version ì— ëŒ€í•´ì„œë§Œ ë°±ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ ìš”ì²­ìœ¼ë¡œ ì²˜ë¦¬ë˜ë„ë¡ ìˆ˜ì •í–ˆë‹¤. ì´ì œ ì•„ë˜ì™€ ê°™ì´ ë°ëª¨ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì •ìƒì ìœ¼ë¡œ ë³´ì´ë©° &#x2F;versionì— ëŒ€í•œ ìš”ì²­ì„ ì „ë‹¬í•˜ë©´ ë°±ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ í•´ë‹¹ ê²½ë¡œê°€ ë§¤í•‘ë˜ì§€ ì•Šì•„ì„œ ìŠ¤í”„ë§ ë¶€íŠ¸ì˜ í™”ì´íŠ¸ë¼ë²¨ í˜ì´ì§€ë¡œ 404 ì‘ë‹µì„ ë³¼ ìˆ˜ ìˆë‹¤. í”„ë¡ íŠ¸ ìš”ì²­ê³¼ ë°±ì—”ë“œ ìš”ì²­ì„ íš¨ìœ¨ì ìœ¼ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆëŠ” ë°©ì•ˆì€ ë” ì—°êµ¬í•˜ê³  ì°¾ì•„ë³´ê³  í•™ìŠµí•´ì•¼í•  ë¶€ë¶„ì´ë‹¤.  </p><p>ì‚¬ì‹¤ ìƒ ë°±ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì— í”„ë¡ íŠ¸ì—”ë“œì— ëŒ€í•œ ì •ì  íŒŒì¼ì„ í¬í•¨ì‹œí‚¤ëŠ” ê²Œ ê°„ë‹¨í•˜ì§€ë§Œ ì •ì  íŒŒì¼ì„ ë°°í¬í•˜ëŠ” ê²½ëŸ‰ì˜ ì›¹ ì„œë²„ë¥¼ ë‘ëŠ” ê²Œ ë°±ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë¶€í•˜ë¥¼ ì¤„ì¼ ìˆ˜ ìˆëŠ” ë°©ì•ˆì´ë‹¤. ì •ì  íŒŒì¼ì— ëŒ€í•œ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œ ìŠ¤ë ˆë“œ í’€ì—ì„œ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ìƒê°ë³´ë‹¤ ì˜í–¥ì´ í´ ìˆ˜ë„ ìˆë‹¤. <code>ì„ íƒì€ ì—¬ëŸ¬ë¶„ì˜ ëª«ì´ë‹¤.</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;Q. í”„ë¡ íŠ¸ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì–´ë–»ê²Œ ë°°í¬ë¥¼ í•´ì•¼í• ê¹Œ?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ì˜¤ë˜ì „ë¶€í„° ê¸°ë³¸ì ìœ¼ë¡œëŠ” ë°±ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ í”„ë¡ íŠ¸ UI êµ¬ì„±ì„ ìœ„í•œ ì—ì…‹ë“¤ì„ ê´€ë¦¬í•˜ê³  í•¨ê»˜ ë¹Œë“œë˜ì–´ ë°°í¬ë˜ëŠ” ë°©ì‹ì„ ì·¨í•´ì™”ë‹¤.</summary>
      
    
    
    
    
    <category term="Deployment" scheme="https://kdevkr.github.io/tags/Deployment/"/>
    
    <category term="Nginx" scheme="https://kdevkr.github.io/tags/Nginx/"/>
    
    <category term="Vite" scheme="https://kdevkr.github.io/tags/Vite/"/>
    
  </entry>
  
  <entry>
    <title>ìœˆë„ìš° í™˜ê²½ì—ì„œ ì‚¬ì„¤ ë£¨íŠ¸ CA ì¸ì¦ì„œ ë“±ë¡í•˜ëŠ” ë°©ë²•</title>
    <link href="https://kdevkr.github.io/windows-certlm/"/>
    <id>https://kdevkr.github.io/windows-certlm/</id>
    <published>2023-10-09T13:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.890Z</updated>
    
    <content type="html"><![CDATA[<p>ìœˆë„ìš° ìš´ì˜ì²´ì œ í™˜ê²½ì—ì„œ ì‚¬ì„¤ë¡œ ë§Œë“¤ì–´ì§„ ë£¨íŠ¸ CA ì¸ì¦ì„œë¥¼ ì»´í“¨í„° ì¸ì¦ì„œì˜ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë£¨íŠ¸ ê¸°ê´€ìœ¼ë¡œ ë“±ë¡í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì€ ë‘ê°€ì§€ê°€ ìˆë‹¤. ì²«ë²ˆì§¸ë¡œëŠ” MMC(certlm.msc) í”„ë¡œê·¸ë¨ì˜ ì¸ì¦ì„œ ê°€ì ¸ì˜¤ê¸° ë§ˆë²•ì‚¬ë¥¼ ì´ìš©í•˜ëŠ” ë°©ë²•ê³¼ í¬ë¡¬ ë˜ëŠ” ì—£ì§€ ë¸Œë¼ìš°ì €ì˜ ì¸ì¦ì„œ ê´€ë¦¬ ë©”ë‰´ë¥¼ í†µí•´ ì¸ì¦ì„œ ê°€ì ¸ì˜¤ê¸° ë§ˆë²•ì‚¬ë¥¼ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì´ë‹¤. ì´ ê¸€ì„ ë³´ëŠ” ê°œë°œì ë˜ëŠ” ì—”ì§€ë‹ˆì–´ë¼ë©´ ëª…ë ¹ í”„ë¡¬í”„íŠ¸ë¥¼ í†µí•´ certutil ë„êµ¬ë¡œ ëª…ë ¹ì–´ ê¸°ë°˜ìœ¼ë¡œ ë£¨íŠ¸ CA ì¸ì¦ì„œë¥¼ ë“±ë¡í•  ìˆ˜ë„ ìˆë‹¤.</p><pre class="language-bash" data-language="bash"><div class="caption"><span>Windows Terminal</span></div><code class="language-bash">certutil <span class="token parameter variable">-addstore</span> <span class="token string">"Root"</span> <span class="token string">"locaCA.crt"</span>Root <span class="token string">"ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë£¨íŠ¸ ì¸ì¦ ê¸°ê´€"</span>ì„œëª…ì´ ê³µê°œ í‚¤ì™€ ì¼ì¹˜í•©ë‹ˆë‹¤.<span class="token string">"XXX"</span> ì¸ì¦ì„œê°€ ì €ì¥ì†Œì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.CertUtil: <span class="token parameter variable">-addstore</span> ëª…ë ¹ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.</code></pre><h4 id="Microsoft-Management-Consoleë¥¼-í†µí•´-ì¸ì¦ì„œ-ê´€ë¦¬"><a href="#Microsoft-Management-Consoleë¥¼-í†µí•´-ì¸ì¦ì„œ-ê´€ë¦¬" class="headerlink" title="Microsoft Management Consoleë¥¼ í†µí•´ ì¸ì¦ì„œ ê´€ë¦¬"></a>Microsoft Management Consoleë¥¼ í†µí•´ ì¸ì¦ì„œ ê´€ë¦¬</h4><ul><li>ìœˆë„ìš°: ì°¾ê¸° &gt; ì»´í“¨í„° ì¸ì¦ì„œ ê´€ë¦¬(certlm.msc) ë˜ëŠ” ì‹¤í–‰(Window í‚¤ + R)</li><li>í¬ë¡¬: ì„¤ì • - ê°œì¸ ì •ë³´ ë³´í˜¸ ë° ë³´ì•ˆ - ë³´ì•ˆ(ì„¸ì´í”„ ë¸Œë¼ìš°ì§• ë° ê¸°íƒ€ ë³´ì•ˆ ì„¤ì •) - ê³ ê¸‰ - ê¸°ê¸° ì¸ì¦ì„œ ê´€ë¦¬(ê¸°ê¸°ì—ì„œ HTTPS&#x2F;SSL ì¸ì¦ì„œ ê´€ë¦¬)</li></ul><p>ì¸ì¦ì„œ ê°€ì ¸ì˜¤ê¸° ë§ˆë²•ì‚¬ê°€ ì‹¤í–‰í•˜ê³  ë‚˜ì„œ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë£¨íŠ¸ ì¸ì¦ì„œ ê¸°ê´€ ì €ì¥ì†Œì— ì‚¬ì„¤ ë£¨íŠ¸ CA ì¸ì¦ì„œë¥¼ ì„ íƒí•˜ì—¬ ë“±ë¡í•˜ë©´ ëœë‹¤.</p><p><img data-src="/images/posts/windows-certlm/01.png">  </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ìœˆë„ìš° ìš´ì˜ì²´ì œ í™˜ê²½ì—ì„œ ì‚¬ì„¤ë¡œ ë§Œë“¤ì–´ì§„ ë£¨íŠ¸ CA ì¸ì¦ì„œë¥¼ ì»´í“¨í„° ì¸ì¦ì„œì˜ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë£¨íŠ¸ ê¸°ê´€ìœ¼ë¡œ ë“±ë¡í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì€ ë‘ê°€ì§€ê°€ ìˆë‹¤. ì²«ë²ˆì§¸ë¡œëŠ” MMC(certlm.msc) í”„ë¡œê·¸ë¨ì˜ ì¸ì¦ì„œ ê°€ì ¸ì˜¤ê¸° ë§ˆë²•ì‚¬ë¥¼ ì´ìš©í•˜ëŠ” ë°©ë²•ê³¼ í¬ë¡¬ ë˜</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ì  í‚¨ìŠ¤ ê·¸ë¦¬ê³  S3ì™€ í•¨ê»˜í•˜ëŠ” ë°°í¬ ìë™í™”</title>
    <link href="https://kdevkr.github.io/automated-deployment-using-s3/"/>
    <id>https://kdevkr.github.io/automated-deployment-using-s3/</id>
    <published>2023-10-09T11:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.886Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>íšŒì‚¬ ë‚´ QA ì—”ì§€ë‹ˆì–´ í‡´ì‚¬ë¡œ ì¸í•´ ìˆ˜ë™ ë°°í¬ë¥¼ ìˆ˜í–‰í•´ì™”ë˜ í…ŒìŠ¤íŠ¸ í™˜ê²½ì— ëŒ€í•´ ìë™í™” ë°°í¬ë¡œ ë³€ê²½í•˜ê³ ì í•™ìŠµí•œ ë‚´ìš©ì´ë‹¤. ì†”ë£¨ì…˜ í˜•íƒœë¡œ ì „ë‹¬ë˜ì–´ ê³ ê°ì´ ì§ì ‘ ë°°í¬ë¥¼ ìˆ˜í–‰í•˜ëŠ” í”„ë¡œì íŠ¸ë¡œ ë°°í¬ì— ëŒ€í•œ ê³¼ì •ë„ ë³€ê²½ì‚¬í•­ì— í¬í•¨ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ QA ì—”ì§€ë‹ˆì–´ê°€ í…ŒìŠ¤íŠ¸ í•­ëª©ìœ¼ë¡œ ìˆ˜ë™ ë°°í¬ë¥¼ ìˆ˜í–‰í–ˆë‹¤.</p></blockquote><h4 id="S3ë¥¼-í†µí•œ-ë°°í¬-íŒŒì¼-ë‹¤ìš´ë¡œë“œ-ìŠ¤í¬ë¦½íŠ¸"><a href="#S3ë¥¼-í†µí•œ-ë°°í¬-íŒŒì¼-ë‹¤ìš´ë¡œë“œ-ìŠ¤í¬ë¦½íŠ¸" class="headerlink" title="S3ë¥¼ í†µí•œ ë°°í¬ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ìŠ¤í¬ë¦½íŠ¸"></a>S3ë¥¼ í†µí•œ ë°°í¬ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ìŠ¤í¬ë¦½íŠ¸</h4><p>ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•œ ë¦´ë¦¬ì¦ˆ ë¹Œë“œëŠ” ì  í‚¨ìŠ¤ ë„êµ¬ë¡œ ìˆ˜í–‰í•˜ë©° ì  í‚¨ìŠ¤ ì„œë²„ì—ì„œ ì¡°ì§ ë‚´ AWS ë¦´ë¦¬ì¦ˆ ë²„í‚·ì— ì„œë¹„ìŠ¤ í™˜ê²½ í´ë”ì— ë°°í¬ íŒŒì¼ì´ ì €ì¥ë˜ë„ë¡ êµ¬ì„±ë˜ì–´ ìˆë‹¤. S3 ì—…ë¡œë“œí•˜ëŠ” ê²ƒì€ <a href="https://plugins.jenkins.io/s3/">S3 publisher</a> í”ŒëŸ¬ê·¸ì¸ì„ ì´ìš©í•  ìˆ˜ ìˆë‹¤. </p><pre class="language-bash" data-language="bash"><div class="caption"><span>auto_deployment.sh</span></div><code class="language-bash"><span class="token shebang important">#!/bin/sh</span><span class="token assign-left variable">FILE_KEY</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>aws s3 <span class="token function">ls</span> <span class="token parameter variable">--recursive</span> s3://app-release/japan/module/ <span class="token operator">|</span> <span class="token function">grep</span> module-jp-bundle <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">tail</span> <span class="token parameter variable">-n</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'&#123;print $4&#125;'</span><span class="token variable">`</span></span><span class="token assign-left variable">FILE_NAME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">echo</span> $FILE_KEY <span class="token operator">|</span> <span class="token function">sed</span> <span class="token parameter variable">-e</span> <span class="token string">"s/japan\/module\///"</span><span class="token variable">`</span></span>aws s3 <span class="token function">sync</span> s3://app-release/<span class="token variable">$FILE_KEY</span> /home/ec2-user/prepare/<span class="token function">sleep</span> <span class="token number">1</span><span class="token builtin class-name">echo</span> <span class="token string">"[<span class="token variable"><span class="token variable">`</span><span class="token function">date</span> --rfc-3339<span class="token operator">=</span>seconds<span class="token variable">`</span></span>] [INFO] current zip file : <span class="token variable">$FILE_NAME</span>"</span><span class="token function">cp</span> <span class="token parameter variable">-p</span> /home/ec2-user/prepare/<span class="token variable">$FILE_NAME</span> /home/ec2-user/prepare/backup/<span class="token variable">$FILE_NAME</span><span class="token function">unzip</span> <span class="token parameter variable">-o</span> /home/ec2-user/prepare/<span class="token variable">$FILE_NAME</span> <span class="token parameter variable">-d</span> /home/ec2-user/prepare/ <span class="token operator">></span> /dev/null</code></pre><blockquote><p>ì  í‚¨ìŠ¤ ì„œë²„ì— ì˜í•´ ë¹Œë“œ ì‹œ AWS Elastic Beanstalk ì„œë¹„ìŠ¤ì— ì˜í•´ ë°°í¬ë˜ëŠ” ë²ˆë“¤ê³¼ ê°™ì´ ì‹¤í–‰ê°€ëŠ¥í•œ war íŒŒì¼ì„ í¬í•¨í•˜ì—¬ ì••ì¶• íŒŒì¼ë¡œ S3 ë²„í‚·ì— ì—…ë¡œë“œ ë˜ì–´ìˆë‹¤. ë³¸ í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì‹œ ì°¸ì¡°ë  í”„ë¡œí¼í‹° íŒŒì¼ì€ ë³„ë„ë¡œ ê´€ë¦¬í•˜ê³  ìˆë‹¤.</p></blockquote><h4 id="ìë™-ì‹¤í–‰ì„-ìœ„í•œ-í¬ë¡ íƒ­-ë¹„â€¢í™œì„±í™”-ìŠ¤í¬ë¦½íŠ¸"><a href="#ìë™-ì‹¤í–‰ì„-ìœ„í•œ-í¬ë¡ íƒ­-ë¹„â€¢í™œì„±í™”-ìŠ¤í¬ë¦½íŠ¸" class="headerlink" title="ìë™ ì‹¤í–‰ì„ ìœ„í•œ í¬ë¡ íƒ­ ë¹„â€¢í™œì„±í™” ìŠ¤í¬ë¦½íŠ¸"></a>ìë™ ì‹¤í–‰ì„ ìœ„í•œ í¬ë¡ íƒ­ ë¹„â€¢í™œì„±í™” ìŠ¤í¬ë¦½íŠ¸</h4><p>ìˆ˜ë™ ë°°í¬ë¥¼ ìˆ˜í–‰í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ì—ëŠ” ì˜ˆê¸°ì¹˜ ì•Šì€ ìƒí™©ì— ì˜í•´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ ì‹œ ìë™ìœ¼ë¡œ ì‹¤í–‰ë˜ë„ë¡ ìŠ¤í¬ë¦½íŠ¸í™” ë˜ì–´ í™œì„±í™”ë˜ì–´ìˆëŠ” í¬ë¡ íƒ­ì„ ë¹„í™œì„±í™”í•˜ê³  ë°°í¬ ì™„ë£Œ ì‹œ í¬ë¡ íƒ­ì— ì˜í•´ ë™ì‘í•˜ë„ë¡ í™œì„±í™”í•˜ëŠ” ë°©ì•ˆì´ í•„ìš”í•˜ë‹¤. ì•„ë˜ì˜ ìŠ¤í¬ë¦½íŠ¸ëŠ” <a href="https://stackoverflow.com/a/14011095">ìŠ¤íƒì˜¤ë²„í”Œë¡œìš° ë‹µë³€</a>ì„ ì°¸ê³ í–ˆë‹¤.</p><pre class="language-bash" data-language="bash"><div class="caption"><span>disable_cron.sh</span></div><code class="language-bash"><span class="token shebang important">#!/bin/sh</span><span class="token comment"># crontab -l | sed '/^[^#].*check.sh/s/^/#/'</span><span class="token function">crontab</span> <span class="token parameter variable">-l</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'/^[^#].*check.sh/s/^/#/'</span> <span class="token operator">|</span> <span class="token function">crontab</span> -<span class="token builtin class-name">echo</span> <span class="token string">"[<span class="token variable"><span class="token variable">`</span><span class="token function">date</span> --rfc-3339<span class="token operator">=</span>seconds<span class="token variable">`</span></span>] [INFO] Disable cron of check.sh"</span></code></pre><pre class="language-bash" data-language="bash"><div class="caption"><span>enable_cron.sh</span></div><code class="language-bash"><span class="token shebang important">#!/bin/sh</span><span class="token comment">#crontab -l | sed '/^#.*check.sh/s/^#//'</span><span class="token function">crontab</span> <span class="token parameter variable">-l</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'/^#.*check.sh/s/^#//'</span> <span class="token operator">|</span> <span class="token function">crontab</span> -<span class="token builtin class-name">echo</span> <span class="token string">"[<span class="token variable"><span class="token variable">`</span><span class="token function">date</span> --rfc-3339<span class="token operator">=</span>seconds<span class="token variable">`</span></span>] [INFO] Enable cron of check.sh"</span></code></pre><h4 id="ë°°í¬-ìë™í™”-ìŠ¤í¬ë¦½íŠ¸"><a href="#ë°°í¬-ìë™í™”-ìŠ¤í¬ë¦½íŠ¸" class="headerlink" title="ë°°í¬ ìë™í™” ìŠ¤í¬ë¦½íŠ¸"></a>ë°°í¬ ìë™í™” ìŠ¤í¬ë¦½íŠ¸</h4><pre class="language-bash" data-language="bash"><div class="caption"><span>auto_deployment.sh</span></div><code class="language-bash"><span class="token builtin class-name">cd</span> /home/ec2-user/<span class="token assign-left variable">OLD_FILENAME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span> /home/ec2-user/ <span class="token operator">|</span> <span class="token function">grep</span> .war <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> .old<span class="token variable">)</span></span><span class="token assign-left variable">FILENAME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span> /home/ec2-user/prepare/ <span class="token operator">|</span> <span class="token function">grep</span> .war<span class="token variable">)</span></span><span class="token assign-left variable">UPD_OLD</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">stat</span> <span class="token parameter variable">-c</span> %Y $OLD_FILENAME<span class="token variable">)</span></span><span class="token assign-left variable">UPD_NEW</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">stat</span> <span class="token parameter variable">-c</span> %Y /home/ec2-user/prepare/$FILENAME<span class="token variable">)</span></span><span class="token builtin class-name">echo</span> <span class="token string">"[<span class="token variable"><span class="token variable">`</span><span class="token function">date</span> --rfc-3339<span class="token operator">=</span>seconds<span class="token variable">`</span></span>] [INFO] old file : <span class="token variable">$OLD_FILENAME</span>(<span class="token variable">$UPD_OLD</span>)"</span><span class="token builtin class-name">echo</span> <span class="token string">"[<span class="token variable"><span class="token variable">`</span><span class="token function">date</span> --rfc-3339<span class="token operator">=</span>seconds<span class="token variable">`</span></span>] [INFO] new file : <span class="token variable">$FILENAME</span>(<span class="token variable">$UPD_NEW</span>)"</span><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$UPD_NEW</span> <span class="token parameter variable">-gt</span> <span class="token variable">$UPD_OLD</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>  <span class="token builtin class-name">echo</span> <span class="token string">"[<span class="token variable"><span class="token variable">`</span><span class="token function">date</span> --rfc-3339<span class="token operator">=</span>seconds<span class="token variable">`</span></span>] [INFO] Start deployment using the <span class="token variable">$FILENAME</span>"</span>  <span class="token comment"># ìë™ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ ë¹„í™œì„±í™”</span>  /bin/sh /home/ec2-user/disable_cron.sh    <span class="token comment"># ê¸°ì¡´ ë°°í¬ íŒŒì¼ ë°±ì—…</span>  <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> /home/ec2-user/<span class="token variable">$OLD_FILENAME</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>    <span class="token function">mv</span> /home/ec2-user/<span class="token variable">$OLD_FILENAME</span> /home/ec2-user/<span class="token variable">$OLD_FILENAME</span>.old  <span class="token keyword">fi</span>    <span class="token comment"># ì‹ ê·œ ë°°í¬ íŒŒì¼ ë³µì‚¬</span>  <span class="token function">cp</span> /home/ec2-user/prepare/<span class="token variable">$FILENAME</span> /home/ec2-user/    <span class="token comment"># ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ ë° ì‹¤í–‰</span>  <span class="token function">sh</span> /home/ec2-user/stop.sh  <span class="token function">sleep</span> <span class="token number">10</span>  <span class="token function">sh</span> /home/ec2-user/start.sh  <span class="token comment"># ìë™ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ í™œì„±í™”</span>  /bin/sh /home/ec2-user/disable_cron.sh    <span class="token builtin class-name">echo</span> <span class="token string">"[<span class="token variable"><span class="token variable">`</span><span class="token function">date</span> --rfc-3339<span class="token operator">=</span>seconds<span class="token variable">`</span></span>] [INFO] Deployment completed"</span>  <span class="token keyword">else</span>    <span class="token builtin class-name">echo</span> <span class="token string">"[<span class="token variable"><span class="token variable">`</span><span class="token function">date</span> --rfc-3339<span class="token operator">=</span>seconds<span class="token variable">`</span></span>] [WARN] There are no new deployment file"</span><span class="token keyword">fi</span></code></pre><h4 id="ì  í‚¨ìŠ¤-ì„œë²„ì—ì„œ-ë°°í¬-ìë™í™”-ìŠ¤í¬ë¦½íŠ¸-ìˆ˜í–‰"><a href="#ì  í‚¨ìŠ¤-ì„œë²„ì—ì„œ-ë°°í¬-ìë™í™”-ìŠ¤í¬ë¦½íŠ¸-ìˆ˜í–‰" class="headerlink" title="ì  í‚¨ìŠ¤ ì„œë²„ì—ì„œ ë°°í¬ ìë™í™” ìŠ¤í¬ë¦½íŠ¸ ìˆ˜í–‰"></a>ì  í‚¨ìŠ¤ ì„œë²„ì—ì„œ ë°°í¬ ìë™í™” ìŠ¤í¬ë¦½íŠ¸ ìˆ˜í–‰</h4><p>í•œë‹¨ê³„ ë” ë‚˜ì•„ê°€ì„œëŠ” EC2 ì„œë²„ì—ì„œ ì ‘ì†í•´ì„œ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ëŠ” ê²ƒë„ ì  í‚¨ìŠ¤ ì„œë²„ì—ì„œ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤. <a href="https://plugins.jenkins.io/publish-over-ssh/">Publish over SSH</a> í”ŒëŸ¬ê·¸ì¸ì„ í†µí•´ EC2 ì„œë²„ ì ‘ì†ì„ ìœ„í•œ ë°°ìŠ¤ì²œ í˜¸ìŠ¤íŠ¸ì— SSH ì—°ê²°ì„ ìˆ˜í–‰í•˜ê³  ë°°ìŠ¤ì²œ í˜¸ìŠ¤íŠ¸ì— ì¡´ì¬í•˜ëŠ” EC2 í‚¤ í˜ì–´ íŒŒì¼ì„ í†µí•´ SSH ëª…ë ¹ê³¼ í•¨ê»˜ ë°°í¬ ìë™í™” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ëŠ” ëª…ë ¹ì–´ë¥¼ ì „ë‹¬í•˜ë©´ ëœë‹¤.</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">ssh</span> <span class="token parameter variable">-i</span> a.pem ec2-user@<span class="token punctuation">&#123;</span>ec2-ip<span class="token punctuation">&#125;</span> <span class="token string">'sh /home/ec2-user/auto_deployment.sh'</span></code></pre><blockquote><p>í…ŒìŠ¤íŠ¸ í™˜ê²½ì´ë¼ í• ì§€ë¼ë„ ë³´ì•ˆ ìƒ ê´€ì ìœ¼ë¡œ EC2 ì„œë²„ì— ì§ì ‘ ì ‘ê·¼í•˜ë„ë¡ í¬íŠ¸ë¥¼ ì˜¤í”ˆí•˜ëŠ” ê²ƒì€ ê¶Œì¥í•˜ì§€ ì•ŠëŠ”ë‹¤.</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;íšŒì‚¬ ë‚´ QA ì—”ì§€ë‹ˆì–´ í‡´ì‚¬ë¡œ ì¸í•´ ìˆ˜ë™ ë°°í¬ë¥¼ ìˆ˜í–‰í•´ì™”ë˜ í…ŒìŠ¤íŠ¸ í™˜ê²½ì— ëŒ€í•´ ìë™í™” ë°°í¬ë¡œ ë³€ê²½í•˜ê³ ì í•™ìŠµí•œ ë‚´ìš©ì´ë‹¤. ì†”ë£¨ì…˜ í˜•íƒœë¡œ ì „ë‹¬ë˜ì–´ ê³ ê°ì´ ì§ì ‘ ë°°í¬ë¥¼ ìˆ˜í–‰í•˜ëŠ” í”„ë¡œì íŠ¸ë¡œ ë°°í¬ì— ëŒ€í•œ ê³¼ì •ë„ ë³€ê²½ì‚¬í•­ì— í¬í•¨ë  </summary>
      
    
    
    
    
    <category term="Jenkins" scheme="https://kdevkr.github.io/tags/Jenkins/"/>
    
    <category term="S3" scheme="https://kdevkr.github.io/tags/S3/"/>
    
  </entry>
  
  <entry>
    <title>Amazon Linux 2ë¥¼ VirtualBoxì—ì„œ ì‹¤í–‰í•˜ê¸°</title>
    <link href="https://kdevkr.github.io/amazonlinux2-virtualbox/"/>
    <id>https://kdevkr.github.io/amazonlinux2-virtualbox/</id>
    <published>2023-10-04T13:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.886Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/amazon-linux-2-virtual-machine.html">Amazon Linux 2ë¥¼ ì˜¨í”„ë ˆë¯¸ìŠ¤ ê°€ìƒ ë¨¸ì‹ ìœ¼ë¡œ ì‹¤í–‰</a> ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì—¬ Amazon Linux 2 ê°€ìƒ ë¨¸ì‹  ì´ë¯¸ì§€ë¥¼ í†µí•´ ì˜¨í”„ë ˆë¯¸ìŠ¤ ê°œë°œ ë° í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ í™˜ê²½ì„ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. ì°¸ê³ ë¡œ AL2ì„ ëŒ€ì²´í•˜ëŠ” Amazon Linux 2023ì— ëŒ€í•´ì„œëŠ” <a href="https://github.com/amazonlinux/amazon-linux-2023/issues/102">ì•„ì§ ê°€ìƒ ë¨¸ì‹  ì´ë¯¸ì§€ë¥¼ ì œê³µí•˜ì§€ ì•ŠëŠ”</a> ê²ƒ ê°™ë‹¤. ê·¸ë˜ì„œ AL2ì´ 2025-06-30 ì¼ìë¡œ EOLì´ ë˜ë”ë¼ë„ VirtualBoxì—ì„œ Amazon Linux 2ë¥¼ ì‹¤í–‰í•´ë³´ê³ ì í•œë‹¤.</p><h4 id="Amazon-Linux-2-ê°€ìƒ-ë¨¸ì‹ -ì´ë¯¸ì§€-ë‹¤ìš´ë¡œë“œ"><a href="#Amazon-Linux-2-ê°€ìƒ-ë¨¸ì‹ -ì´ë¯¸ì§€-ë‹¤ìš´ë¡œë“œ" class="headerlink" title="Amazon Linux 2 ê°€ìƒ ë¨¸ì‹  ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ"></a>Amazon Linux 2 ê°€ìƒ ë¨¸ì‹  ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ</h4><p>ìš°ë¶„íˆ¬ì™€ ê°™ì´ Amazon Linux 2ì— ëŒ€í•œ ì„¤ì¹˜ íŒŒì¼ì„ ì œê³µí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¯€ë¡œ ë¶€íŒ…ì„ ìœ„í•œ ì´ë¯¸ì§€ì™€ ë¯¸ë¦¬ ì •ì˜ëœ ê°€ìƒ ë¨¸ì‹  ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë°›ì•„ì•¼ í•œë‹¤.</p><ul><li><a href="https://drive.google.com/file/d/17iBVLBLLJahQDb-3kgsWRCh72hzt1FIp/view?usp=sharing">seed.iso ë¶€íŒ… ì´ë¯¸ì§€</a>  </li><li><a href="https://cdn.amazonlinux.com/os-images/2.0.20230926.0/virtualbox/amzn2-virtualbox-2.0.20230926.0-x86_64.xfs.gpt.vdi">Amazon Linux 2 LTS 2.0.20230926.0 x86_64 VirtualBox image</a></li></ul><h4 id="ê°€ìƒ-ë¨¸ì‹ -ë§Œë“¤ê¸°-ë°-ì‹¤í–‰"><a href="#ê°€ìƒ-ë¨¸ì‹ -ë§Œë“¤ê¸°-ë°-ì‹¤í–‰" class="headerlink" title="ê°€ìƒ ë¨¸ì‹  ë§Œë“¤ê¸° ë° ì‹¤í–‰"></a>ê°€ìƒ ë¨¸ì‹  ë§Œë“¤ê¸° ë° ì‹¤í–‰</h4><p><img data-src="/images/posts/amazonlinux2-virtualbox/01.png" alt="1. ê°€ìƒ ë¨¸ì‹  ë§Œë“¤ê¸°">  </p><p>ìƒˆë¡œ ë§Œë“¤ê¸° ë²„íŠ¼ì„ ëˆŒëŸ¬ ê°€ìƒ ë¨¸ì‹ ì„ ë§Œë“­ë‹ˆë‹¤. ë¦¬ëˆ…ìŠ¤ ìœ í˜•ì— ëŒ€í•œ ìš´ì˜ ì²´ì œ ì¢…ë¥˜ëŠ” ê³µì‹ ë¬¸ì„œì— ë‚˜ì™€ìˆëŠ”ëŒ€ë¡œ Red Hat (64-bit)ë¥¼ ì„ íƒí•˜ì. ê·¸ë¦¬ê³  ê°€ìƒ ë””ìŠ¤í¬ëŠ” ë¯¸ë¦¬ ì •ì˜ëœ ê°€ìƒ ë¨¸ì‹  ì´ë¯¸ì§€ë¡œ ì¶”ê°€í•´ì•¼ í•œë‹¤. ìœ„ ìŠ¤í¬ë¦°ìƒ·ì— ë‚˜ì™€ìˆëŠ” ë“¯ì´ <a href="https://cdn.amazonlinux.com/os-images/latest/">Amazon Linux 2 ê°€ìƒ ë¨¸ì‹  ì´ë¯¸ì§€</a> í˜ì´ì§€ì—ì„œ ë‹¤ìš´ë¡œë“œ ë°›ì€ ì´ë¯¸ì§€ë¥¼ ì„ íƒí•˜ë©´ ëœë‹¤.</p><p><img data-src="/images/posts/amazonlinux2-virtualbox/02.png" alt="2. ë¶€íŒ… ì´ë¯¸ì§€ ë””ìŠ¤í¬ ì¶”ê°€">  </p><p>ê°€ìƒ ë¨¸ì‹ ì„ ì‹¤í–‰í•˜ê¸° ì „ì— í˜¸ìŠ¤íŠ¸ ì´ë¦„ê³¼ ì‚¬ìš©ì ê³„ì • ì •ì˜ë¥¼ ìœ„í•œ ë¶€íŒ… ì´ë¯¸ì§€ë¥¼ ê°€ìƒ ê´‘í•™ ë””ìŠ¤í¬ì— ì¶”ê°€í•´ì•¼í•œë‹¤. Amazon Linux 2 ê°€ìƒ ë¨¸ì‹  ì´ë¯¸ì§€ í˜ì´ì§€ì—ì„œ ë‹¤ìš´ë°›ì„ ìˆ˜ ìˆëŠ” seed.iso íŒŒì¼ì´ <code>VERR_NOT_SUPPORTED</code> ì‚¬ìœ ë¡œ ê°€ìƒ ê´‘í•™ ë””ìŠ¤í¬ì— ì¶”ê°€í•  ìˆ˜ ì—†ì„ ìˆ˜ ìˆëŠ”ë° ë³¸ ê¸€ì—ì„œ ì œê³µí•˜ëŠ” seed.iso ë¶€íŒ… ì´ë¯¸ì§€ ë§í¬ë¥¼ í†µí•´ <code>ê¸°ë³¸ ì‚¬ìš©ì(ec2-user:amazon)</code>ë§Œ ì •ì˜ëœ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìœ¼ë‹ˆ ì°¸ê³ í•˜ë„ë¡ í•˜ì.</p><p>â€» ë³¸ ê¸€ì—ì„œ ì œê³µí•˜ëŠ” seed.iso íŒŒì¼ì€ ì•„ë˜ì™€ ê°™ì´ ì •ì˜ë˜ì–´ìˆë‹¤.</p><pre class="language-yaml" data-language="yaml"><div class="caption"><span>user-data</span></div><code class="language-yaml"><span class="token comment">#cloud-config</span><span class="token comment">#vim:syntax=yaml</span><span class="token key atrule">users</span><span class="token punctuation">:</span>  <span class="token punctuation">-</span> default<span class="token key atrule">chpasswd</span><span class="token punctuation">:</span>  <span class="token key atrule">list</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">    ec2-user:amazon</span></code></pre><pre class="language-yaml" data-language="yaml"><div class="caption"><span>meta-data</span></div><code class="language-yaml"><span class="token key atrule">local-hostname</span><span class="token punctuation">:</span> amazonlinux</code></pre><blockquote><p>ë¶€íŒ… ì´ë¯¸ì§€ íŒŒì¼ì€ MacOS í™˜ê²½ì—ì„œ hdiutil ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒì„±í•˜ì˜€ë‹¤.<br>$ hdiutil makehybrid -o seed.iso -hfs -joliet -iso -default-volume-name cidata seedconfig&#x2F;</p></blockquote><p><img data-src="/images/posts/amazonlinux2-virtualbox/03.png" alt="3. ì‚¬ìš©ì ê³„ì • êµ¬ì„±">  </p><p>ê°€ìƒ ë¨¸ì‹ ì„ ì‹¤í–‰í•˜ê³  ë§¨ì²˜ìŒ ê¸°ë³¸ ì‚¬ìš©ì ê³„ì •ì¸ ec2-userë¥¼ ì…ë ¥í•˜ë©´ ì‚¬ìš©ì ê³„ì •ì— ëŒ€í•œ êµ¬ì„±ì„ ìˆ˜í–‰í•œë‹¤.</p><p><img data-src="/images/posts/amazonlinux2-virtualbox/04.png" alt="4. ec2-user ë¡œê·¸ì¸">  </p><p>ë‹¤ì‹œí•œë²ˆ ë¡œê·¸ì¸ í™”ë©´ì´ ì¶œë ¥ë˜ë©´ ec2-userì™€ amazonì„ ì…ë ¥í•˜ë©´ ìœ„ì™€ ê°™ì´ Amazon Linux 2ì— ëŒ€í•œ ë¡œê³ ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì²˜ìŒ ë¡œê·¸ì¸ì— ì„±ê³µí–ˆë‹¤ë©´ ê·¸ ì´í›„ì—ëŠ” ë¶€íŒ… ì´ë¯¸ì§€ê°€ í•„ìš”í•˜ì§€ ì•Šë‹¤. ê°€ìƒ ë¨¸ì‹ ì„ ì¢…ë£Œí•˜ê³  ë¶€íŒ… ì´ë¯¸ì§€ë¥¼ ê°€ìƒ ê´‘í•™ ë””ìŠ¤í¬ì—ì„œ ì œê±°í•˜ì.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/amazon-linux-2-virtual-machine.html&quot;&gt;Amazon Linux 2ë¥¼ ì˜¨í”„ë ˆë¯¸ìŠ¤ ê°€ìƒ ë¨¸ì‹ ìœ¼ë¡œ ì‹¤í–‰&lt;</summary>
      
    
    
    
    
    <category term="AL2" scheme="https://kdevkr.github.io/tags/AL2/"/>
    
    <category term="Oracle VirtualBox" scheme="https://kdevkr.github.io/tags/Oracle-VirtualBox/"/>
    
  </entry>
  
  <entry>
    <title>ìŠ¤í”„ë§ ë¶€íŠ¸ ì˜¤ë¥˜ í˜ì´ì§€</title>
    <link href="https://kdevkr.github.io/spring-boot-error-page/"/>
    <id>https://kdevkr.github.io/spring-boot-error-page/</id>
    <published>2023-10-02T03:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.890Z</updated>
    
    <content type="html"><![CDATA[<p>ìŠ¤í”„ë§ ë¶€íŠ¸ í”„ë¡œì íŠ¸ì—ì„œëŠ” ê¸°ë³¸ì ì¸ ì˜¤ë¥˜ ì‘ë‹µì— ëŒ€í•œ ì²˜ë¦¬ì™€ í™”ì´íŠ¸ë¼ë²¨ ì˜¤ë¥˜ í˜ì´ì§€ì— ëŒ€í•œ ìë™ êµ¬ì„±ì„ ì œê³µí•œë‹¤. ì˜¤ë¥˜ ì²˜ë¦¬ì— ëŒ€í•œ ìë™ êµ¬ì„±ì€ ErrorMvcAutoConfigurationë¥¼ í†µí•´ ì œê³µí•˜ë©° BasicErrorController ì™€ DefaultErrorViewResolverê°€ ë“±ë¡ëœë‹¤. </p><h4 id="Whitelabel-Error-Page"><a href="#Whitelabel-Error-Page" class="headerlink" title="Whitelabel Error Page"></a>Whitelabel Error Page</h4><p>ìŠ¤í”„ë§ ë¶€íŠ¸ì˜ ê¸°ë³¸ í™”ì´íŠ¸ë¼ë²¨ ì˜¤ë¥˜ í˜ì´ì§€ëŠ” ErrorMvcAutoConfigurationì˜ StaticViewë¡œ HTML íŒŒì¼ì´ ì•„ë‹Œ ìë°” ì½”ë“œë¡œ êµ¬í˜„ë˜ì–´ìˆë‹¤. ì´ê²ƒì€ ì• í”Œë¦¬ì¼€ì´ì…˜ í”„ë¡œí¼í‹°ë¡œ ë¹„í™œì„±í™”í•  ìˆ˜ ìˆëŠ”ë° ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ë‚´ì¥ ì›¹ ì»¨í…Œì´ë„ˆì¸ í†°ìº£ì˜ ê²½ìš° í™”ì´íŠ¸ë¼ë²¨ ì˜¤ë¥˜ í˜ì´ì§€ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ í†°ìº£ì˜ ì˜¤ë¥˜ í˜ì´ì§€ê°€ ì‘ë‹µë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><blockquote><p>í†°ìº£ì´ ì•„ë‹Œ ì–¸ë”í† ìš°ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ì–¸ë”í† ìš°ê°€ ìì²´ì ì¸ ì˜¤ë¥˜ ì‘ë‹µ í˜ì´ì§€ë¥¼ ì œê³µí•˜ì§€ ì•ŠëŠ”ë‹¤.  </p></blockquote><h4 id="Error-Templates"><a href="#Error-Templates" class="headerlink" title="Error Templates"></a>Error Templates</h4><p>í™”ì´íŠ¸ë¼ë²¨ ì˜¤ë¥˜ í˜ì´ì§€ì˜ ë¹„í™œì„±í™” ì—¬ë¶€ì™€ ìƒê´€ì—†ì´ <code>error</code>ë¼ëŠ” ë·°ë¥¼ ì²˜ë¦¬í•˜ë„ë¡ í…œí”Œë¦¿ íŒŒì¼ì„ í´ë˜ìŠ¤íŒ¨ìŠ¤ì— ì¶”ê°€í•˜ëŠ” ê²½ìš°ì—ëŠ” FreeMarkerViewResolver ë˜ëŠ” ThymeleafViewResolver ì— ì˜í•´ ì²˜ë¦¬ëœë‹¤. ErrorTemplateê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš° í™”ì´íŠ¸ë¼ë²¨ ì˜¤ë¥˜ í˜ì´ì§€ì— ëŒ€í•œ ë¹ˆ ë“±ë¡ì€ ìë™ìœ¼ë¡œ ë¹„í™œì„±í™”ëœë‹¤.</p><blockquote><p>FreeMarkerViewResolverì™€ ThymeleafViewResolverê°€ ë™ì‹œì— ì¡´ì¬í•˜ëŠ” ê²½ìš° í”„ë¦¬ë§ˆì»¤ì™€ íƒ€ì„ë¦¬í”„ì— ëŒ€í•œ ìë™ êµ¬ì„± í´ë˜ìŠ¤ì˜ êµ¬í˜„ ìƒ Orderê°’ì— ì˜í•´ FreeMarkerViewResolverì˜ ì²˜ë¦¬ ìˆœì„œê°€ ë” ë†’ë‹¤.</p></blockquote><pre class="language-ftl" data-language="ftl"><div class="caption"><span>error.ftlh</span></div><code class="language-ftl"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token ftl language-ftl"><span class="token ftl-interpolation"><span class="token punctuation">$&#123;</span><span class="token content ftl"><span class="token punctuation">.</span>lang</span><span class="token punctuation">&#125;</span></span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Error<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Oops!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>Error: <span class="token ftl language-ftl"><span class="token ftl-interpolation"><span class="token punctuation">$&#123;</span><span class="token content ftl">error</span><span class="token punctuation">&#125;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>Path: <span class="token ftl language-ftl"><span class="token ftl-interpolation"><span class="token punctuation">$&#123;</span><span class="token content ftl">path</span><span class="token punctuation">&#125;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>Status: <span class="token ftl language-ftl"><span class="token ftl-interpolation"><span class="token punctuation">$&#123;</span><span class="token content ftl">status</span><span class="token punctuation">&#125;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>Timestamp: <span class="token ftl language-ftl"><span class="token ftl-interpolation"><span class="token punctuation">$&#123;</span><span class="token content ftl">timestamp<span class="token operator">?</span><span class="token builtin-function function">datetime</span><span class="token operator">?</span><span class="token builtin-function function">iso_utc</span></span><span class="token punctuation">&#125;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Go to main<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h4 id="Error-Templates-based-HTTP-Status-Code"><a href="#Error-Templates-based-HTTP-Status-Code" class="headerlink" title="Error Templates based HTTP Status Code"></a>Error Templates based HTTP Status Code</h4><p>ì—ëŸ¬ í˜ì´ì§€ë¥¼ ê³µí†µìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ë„ ìˆê³  DefaultErrorViewResolverëŠ” error ë””ë ‰í† ë¦¬ í•˜ìœ„ì— HTTP Status Code ê°’ìœ¼ë¡œ ì´ë£¨ì–´ì§„ í…œí”Œë¦¿ íŒŒì¼ì„ êµ¬ì„±í•˜ëŠ” ê²½ìš°ì— ë” ìƒì„¸í•˜ê²Œ êµ¬ë¶„í•˜ì—¬ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. ê³µí†µ ì˜¤ë¥˜ í˜ì´ì§€ ë‚´ì—ì„œ í…œí”Œë¦¿ ë¬¸ë²•ì„ ì‚¬ìš©í•´ë„ ë¬´ë°©í•˜ì§€ë§Œ ëª…ì‹œì ìœ¼ë¡œ ë‚˜ëˆ„ì–´ì„œ ì²˜ë¦¬í•˜ê²Œ í•˜ëŠ” ê²ƒë„ ë‚˜ì˜ì§€ ì•Šì„ ê²ƒì´ë‹¤.</p><pre class="language-ftl" data-language="ftl"><div class="caption"><span>error/404.ftlh</span></div><code class="language-ftl"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token ftl language-ftl"><span class="token ftl-interpolation"><span class="token punctuation">$&#123;</span><span class="token content ftl"><span class="token punctuation">.</span>lang</span><span class="token punctuation">&#125;</span></span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>404 - Not Found<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Oops! Not Found<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>Error: <span class="token ftl language-ftl"><span class="token ftl-interpolation"><span class="token punctuation">$&#123;</span><span class="token content ftl">error</span><span class="token punctuation">&#125;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>Path: <span class="token ftl language-ftl"><span class="token ftl-interpolation"><span class="token punctuation">$&#123;</span><span class="token content ftl">path</span><span class="token punctuation">&#125;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>Status: <span class="token ftl language-ftl"><span class="token ftl-interpolation"><span class="token punctuation">$&#123;</span><span class="token content ftl">status</span><span class="token punctuation">&#125;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>Timestamp: <span class="token ftl language-ftl"><span class="token ftl-interpolation"><span class="token punctuation">$&#123;</span><span class="token content ftl">timestamp<span class="token operator">?</span><span class="token builtin-function function">datetime</span><span class="token operator">?</span><span class="token builtin-function function">iso_utc</span></span><span class="token punctuation">&#125;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Go to main<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ìŠ¤í”„ë§ ë¶€íŠ¸ í”„ë¡œì íŠ¸ì—ì„œëŠ” ê¸°ë³¸ì ì¸ ì˜¤ë¥˜ ì‘ë‹µì— ëŒ€í•œ ì²˜ë¦¬ì™€ í™”ì´íŠ¸ë¼ë²¨ ì˜¤ë¥˜ í˜ì´ì§€ì— ëŒ€í•œ ìë™ êµ¬ì„±ì„ ì œê³µí•œë‹¤. ì˜¤ë¥˜ ì²˜ë¦¬ì— ëŒ€í•œ ìë™ êµ¬ì„±ì€ ErrorMvcAutoConfigurationë¥¼ í†µí•´ ì œê³µí•˜ë©° BasicErrorController </summary>
      
    
    
    
    
    <category term="ThymeleafViewResolver" scheme="https://kdevkr.github.io/tags/ThymeleafViewResolver/"/>
    
    <category term="FreeMarkerViewResolver" scheme="https://kdevkr.github.io/tags/FreeMarkerViewResolver/"/>
    
    <category term="DefaultErrorViewResolver" scheme="https://kdevkr.github.io/tags/DefaultErrorViewResolver/"/>
    
    <category term="BasicErrorController" scheme="https://kdevkr.github.io/tags/BasicErrorController/"/>
    
  </entry>
  
  <entry>
    <title>Float32MLE (Byte Order)</title>
    <link href="https://kdevkr.github.io/float32mle/"/>
    <id>https://kdevkr.github.io/float32mle/</id>
    <published>2023-10-01T00:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.886Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="http://www.tcpschool.com/c/c_refer_endian">ë°”ì´íŠ¸ ìˆœì„œ(Byte Order)</a>ëŠ” ì˜¤ë˜ ì „ ì»´í“¨í„°ê³µí•™ê³¼ì—ì„œ ë°°ì› ë˜ ê°œë…ì´ì§€ë§Œ ì‹¤ë¬´ì—ì„œëŠ” ì‹¤ì œë¡œ ê³ ë ¤í•  í•„ìš”ê°€ ì—†ì—ˆë‹¤.</p></blockquote><p>ì»´í“¨í„°ì—ì„œ ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ì— ì €ì¥í•  ë•Œì˜ ë°”ì´íŠ¸ ìˆœì„œëŠ” ë¹… ì—”ë””ì•ˆê³¼ ë¦¬í‹€ ì—”ë””ë°© ì‹ìœ¼ë¡œ ë‚˜ëˆ„ì–´ì§€ëŠ”ë° ì´ê²ƒì€ CPU ì•„í‚¤í…ì²˜ì— ë”°ë¼ ë‚˜ëˆ„ì–´ì§„ë‹¤ê³  í•œë‹¤. TCP ë„¤íŠ¸ì›Œí¬ ìŠ¤í™ ìƒì—ëŠ” íŒ¨í‚·ì˜ ë°”ì´íŠ¸ ìˆœì„œëŠ” ë¹… ì—”ë””ì•ˆìœ¼ë¡œ êµ¬ì„±ë˜ë©° ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ìì£¼ í™œìš©ë˜ëŠ” ì–¸ì–´ì¸ ìë°”ë„ ì´ë¥¼ ê°ì•ˆí•˜ì—¬ ë¹… ì—”ë””ì•ˆì„ ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤. CPU ì•„í‚¤í…ì²˜ì™€ ë‹¤ë¥´ê²Œ ë¹… ì—”ë””ì•ˆìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ì´ìœ ëŠ” JVM ì´ë¼ëŠ” ë³„ë„ì˜ ìŠ¤íƒì„ ê¸°ë°˜ìœ¼ë¡œ êµ¬ë™ë˜ê¸° ë•Œë¬¸ì´ë¼ê³  í•œë‹¤. ê·¸ëŸ¬ë‚˜, SCADA ë˜ëŠ” PLC ì¥ë¹„ì™€ ê°™ì€ ì¼ë¶€ ì‹œìŠ¤í…œì—ì„œëŠ” ë¹… ì—”ë””ì•ˆ ë°©ì‹ì´ ì•„ë‹Œ ë¦¬í‹€ ì—”ë””ì•ˆ ë˜ëŠ” ë¯¸ë“œ ë¦¬í‹€ ì—”ë””ì•ˆìœ¼ë¡œ ë°”ì´íŠ¸ ìˆœì„œë¥¼ êµ¬ì„±í•˜ê³  ìˆëŠ”ë° ì´ëŸ¬í•œ ì‹œìŠ¤í…œì€ C ì–¸ì–´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ì–´ì§€ê¸° ë•Œë¬¸ì´ë‹¤.</p><blockquote><p>ì¼ë°˜ì ì¸ ìë°” ì›¹ ê°œë°œìë“¤ì´ ë°”ì´íŠ¸ ìˆœì„œë¥¼ ê³ ë ¤í•˜ì—¬ ë¹„íŠ¸ ì—°ì‚° ë˜ëŠ” ì‹œí”„íŠ¸ ì—°ì‚°ì„ ìˆ˜í–‰í•  ê²½ìš°ëŠ” ë§ì§€ ì•Šì„ ê²ƒ ê°™ë‹¤.</p></blockquote><h4 id="Mid-Little-Endian-MLE"><a href="#Mid-Little-Endian-MLE" class="headerlink" title="Mid Little Endian, MLE"></a>Mid Little Endian, MLE</h4><p>ë¹… ì—”ë””ì•ˆì™€ ë¦¬í‹€ ì—”ë””ì•ˆ ë¿ë§Œ ì•„ë‹ˆë¼ ë°”ì´íŠ¸ ìˆœì„œë¥¼ ìŠ¤ì™‘í•˜ëŠ” ë¯¸ë“œ ë¦¬í‹€ ì—”ë””ì•ˆì€ <code>AB CD</code>ì˜ ë°”ì´íŠ¸ ìˆœì„œê°€ ìˆì„ë•Œ <code>CD AB</code>ë¡œ í‘œí˜„í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. 32ë¹„íŠ¸ë¡œ êµ¬ì„±ë˜ëŠ” Float í˜•ì‹ì„ ë¯¸ë“œ ë¦¬í‹€ ì—”ë””ì•ˆ ë°©ì‹ìœ¼ë¡œ êµ¬ì„±í•œ ê²ƒì„ <code>Float32MLE</code> ì´ë¼ê³  í‘œê¸°í•  ìˆ˜ ìˆë‹¤.</p><p><a href="https://baseconvert.com/ieee-754-floating-point">Base Convert: IEEE 754 Floating Point</a></p><h4 id="Float32MLE-Example"><a href="#Float32MLE-Example" class="headerlink" title="Float32MLE Example"></a>Float32MLE Example</h4><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@DisplayName</span><span class="token punctuation">(</span><span class="token string">"Endian Test"</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">EndianTest</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@DisplayName</span><span class="token punctuation">(</span><span class="token string">"Float32 Mid Little Endian"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">void</span> <span class="token class-name">TestFloat32MLE</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> hexadecimal <span class="token operator">=</span> <span class="token string">"00004260"</span><span class="token punctuation">;</span> <span class="token comment">// 00 00 42 60</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> <span class="token class-name">HexFormat</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parseHex</span><span class="token punctuation">(</span>hexadecimal<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">float</span> originValue <span class="token operator">=</span> <span class="token class-name">PooledByteBufAllocator</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">.</span><span class="token function">buffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">writeBytes</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bytes<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token comment">// CD (42 60)</span>                <span class="token punctuation">.</span><span class="token function">writeBytes</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>bytes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bytes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token comment">// AB (00 00)</span>                <span class="token punctuation">.</span><span class="token function">readFloat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">float</span> value <span class="token operator">=</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>originValue<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setScale</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">RoundingMode</span><span class="token punctuation">.</span><span class="token constant">HALF_UP</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">floatValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Assertions</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token number">56.0f</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>Nettyì˜ ByteBuf í´ë˜ìŠ¤ì—ì„œëŠ” ë¹… ì—”ë””ì•ˆ ë°©ì‹ì˜ <code>readFloat</code> í•¨ìˆ˜ì™€ ë¦¬í‹€ ì—”ë””ì•ˆ ë°©ì‹ì˜ <code>readFloatLE</code> í•¨ìˆ˜ë¥¼ ì œê³µí•˜ê³  ìˆë‹¤. ê·¸ëŸ¬ë‚˜, ë¯¸ë“œ ë¦¬í‹€ ì—”ë””ì•ˆ ë°©ì‹ì˜ ê²½ìš°ì—ëŠ” ë³„ë„ë¡œ ì œê³µí•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ìœ„ì™€ ê°™ì´ ë²„í¼ì— <code>CD AB</code> ìˆœìœ¼ë¡œ ì“°ê³ ë‚˜ì„œ ë¹… ì—”ë””ì•ˆ ë°©ì‹ìœ¼ë¡œ ì½ì–´ì•¼í•œë‹¤.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://www.tcpschool.com/c/c_refer_endian&quot;&gt;ë°”ì´íŠ¸ ìˆœì„œ(Byte Order)&lt;/a&gt;ëŠ” ì˜¤ë˜ ì „ ì»´í“¨í„°ê³µí•™ê³¼ì—ì„œ ë°°ì› ë˜ ê°œë…ì´ì§€ë§Œ ì‹¤ë¬´ì—ì„œëŠ” ì‹¤ì œë¡œ ê³ ë ¤í•  í•„ìš”ê°€ ì—†ì—ˆë‹¤.&lt;/</summary>
      
    
    
    
    
    <category term="Float32" scheme="https://kdevkr.github.io/tags/Float32/"/>
    
    <category term="IEEE 754" scheme="https://kdevkr.github.io/tags/IEEE-754/"/>
    
    <category term="Byte Order" scheme="https://kdevkr.github.io/tags/Byte-Order/"/>
    
  </entry>
  
  <entry>
    <title>MariaDB Timestamp Y2K38</title>
    <link href="https://kdevkr.github.io/mariadb-timestamp-y2k38/"/>
    <id>https://kdevkr.github.io/mariadb-timestamp-y2k38/</id>
    <published>2023-09-24T05:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.890Z</updated>
    
    <content type="html"><![CDATA[<h4 id="Whatâ€™s-Y2K38"><a href="#Whatâ€™s-Y2K38" class="headerlink" title="Whatâ€™s Y2K38 ???"></a>Whatâ€™s Y2K38 ???</h4><blockquote><p>Timestamps in MariaDB have a maximum value of 2147483647, equivalent to 2038-01-19 05:14:07. This is due to the underlying 32-bit limitation. Using the function on a date beyond this will result in NULL being returned. Use DATETIME as a storage type if you require dates beyond this.</p></blockquote><p>2038ë…„ ë¬¸ì œëŠ” ì‹œê°„ì„ 32ë¹„íŠ¸ ì •ìˆ˜í˜•ìœ¼ë¡œ í‘œí˜„í•˜ëŠ” ì‹œìŠ¤í…œì—ì„œ ë°œìƒí•˜ëŠ” ë¬¸ì œì´ë‹¤. MariaDB(MySQL)ì€ ì‹œê°„ì„ í‘œí˜„í•˜ëŠ” ê²½ìš°  ë¬¸ìì—´ë¡œ ì €ì¥ë˜ëŠ” DATETIMEê³¼ UTCë¡œ ì €ì¥ë˜ëŠ” TIMESTAMPë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ë° TIMESTAMP í˜•ì‹ì€ 4ë°”ì´íŠ¸ë¡œ ì €ì¥ëœë‹¤. ë”°ë¼ì„œ, DATETIMEì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œê³ í•˜ëŠ” í¸ì´ë©° DATETIMEì€ ë¬¸ìì—´ë¡œ ì €ì¥ë˜ë¯€ë¡œ DATETIMEì„ ì €ì¥í•˜ëŠ” ì‹œì ì— UTCë¡œ ì €ì¥ë  ìˆ˜ ìˆë„ë¡ íƒ€ì„ì¡´ì„ UTCë¡œ ì„¤ì •í•˜ëŠ” ê²Œ ì¢‹ë‹¤.</p><blockquote><p>MariaDB íƒ€ì„ì¡´ì„ UTCê°€ ì•„ë‹Œ Aisa&#x2F;Seoulë¡œ ì„¤ì •í•˜ëŠ” ê²½ìš°ì—ëŠ” SQL ì¡°íšŒ ì‹œ CONVERT_TZ í•¨ìˆ˜ë¥¼ ë§¤ë²ˆ ì‚¬ìš©í•´ì•¼í•  í•„ìš”ê°€ ìˆë‹¤.</p></blockquote><h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SHOW</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">'%time_zone%'</span><span class="token punctuation">;</span><span class="token comment">-- timezone: Asia/Seoul</span><span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">TABLE</span> test<span class="token punctuation">(</span>    id         <span class="token keyword">BIGINT</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">COMMENT</span> <span class="token string">'ID'</span><span class="token punctuation">,</span>    name       <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>           <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'Name'</span><span class="token punctuation">,</span>    created_at <span class="token keyword">DATETIME</span>              <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> test <span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'mambo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">SELECT</span> convert_tz<span class="token punctuation">(</span>created_at<span class="token punctuation">,</span> <span class="token string">'+09:00'</span><span class="token punctuation">,</span> <span class="token string">'+00:00'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> created_at <span class="token keyword">FROM</span> test<span class="token punctuation">;</span><span class="token comment">-- created_at,created_at_utc</span><span class="token comment">-- 2023-09-24 16:36:30,2023-09-24 07:36:30</span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;Whatâ€™s-Y2K38&quot;&gt;&lt;a href=&quot;#Whatâ€™s-Y2K38&quot; class=&quot;headerlink&quot; title=&quot;Whatâ€™s Y2K38 ???&quot;&gt;&lt;/a&gt;Whatâ€™s Y2K38 ???&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;Timestamp</summary>
      
    
    
    
    
    <category term="MariaDB" scheme="https://kdevkr.github.io/tags/MariaDB/"/>
    
    <category term="Y2K38" scheme="https://kdevkr.github.io/tags/Y2K38/"/>
    
  </entry>
  
  <entry>
    <title>ëª¨ë“œë²„ìŠ¤ TCP</title>
    <link href="https://kdevkr.github.io/modbus-tcp/"/>
    <id>https://kdevkr.github.io/modbus-tcp/</id>
    <published>2023-09-10T12:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.890Z</updated>
    
    <content type="html"><![CDATA[<p>ëª¨ë“œë²„ìŠ¤(Modbus) í”„ë¡œí† ì½œì€ PLCì™€ ê°™ì€ ìë™í™” ì œì–´ ì„¤ë¹„ê°€ í¬í•¨ë˜ëŠ” ì‚°ì—…ì—ì„œ ê³µì‹ì ì¸ í‘œì¤€ì€ ì•„ë‹ˆì§€ë§Œ ê±°ì˜ í‘œì¤€ì²˜ëŸ¼ ì‚¬ìš©ë˜ê³  ìˆëŠ” í†µì‹  í”„ë¡œí† ì½œì´ë‹¤. ëª¨ë“œë²„ìŠ¤ í”„ë¡œí† ì½œì— ëŒ€í•œ ìŠ¤í™ì€ <a href="https://modbus.org/docs/Modbus_Messaging_Implementation_Guide_V1_0b.pdf">Modbus_Messaging_Implementation_Guide_V1_0b.pdf</a>ë¡œ ê³µê°œë˜ì–´ìˆë‹¤. ë³¸ì¸ì€ ì—ë„ˆì§€ ë¶„ì•¼ ë„ë©”ì¸ì—ì„œ ì¼í•˜ê³  ìˆëŠ” ê°œë°œìë¡œ ê°ì¢… ì—ë„ˆì§€ ê´€ë ¨ ì„¤ë¹„ì—ì„œë„ ëª¨ë“œë²„ìŠ¤ í”„ë¡œí† ì½œì„ ì§€ì›í•˜ëŠ” ì œí’ˆì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì„¤ë¹„ë“¤ì—ì„œ ë°œìƒí•˜ëŠ” ë‹¤ì–‘í•œ ì‹œê³„ì—´ ë°ì´í„°ë“¤ì„ ìˆ˜ì§‘í•˜ê¸° ìœ„í•˜ì—¬ ëª¨ë“œë²„ìŠ¤ í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ê³  ìˆë‹¤. ìë™í™” ì œì–´ì˜ ëª©ì ì´ ì•„ë‹ˆë¯€ë¡œ ì‹œë¦¬ì–¼ í†µì‹ ì´ ì•„ë‹Œ SCADA, RTU, PLCì™€ ê°™ì€ ì„¤ë¹„ì™€ TCP&#x2F;IP ë°©ì‹ìœ¼ë¡œ í†µì‹ í•œë‹¤.</p><h2 id="Modbus-TCP-x2F-IP"><a href="#Modbus-TCP-x2F-IP" class="headerlink" title="Modbus TCP&#x2F;IP"></a>Modbus TCP&#x2F;IP</h2><p>ëª¨ë“œë²„ìŠ¤ í”„ë¡œí† ì½œì€ ìë™í™” ì„¤ë¹„ ì‚°ì—…ì—ì„œ ì‚¬ìš©ë˜ê¸° ë•Œë¬¸ì— ì¼ë°˜ì ì¸ ì›¹ ê°œë°œìë“¤ì´ ê²½í—˜í•  ìˆ˜ ìˆê±°ë‚˜ ì•Œì•„ì•¼í•  ë²”ìš©ì ì¸ í†µì‹  í”„ë¡œí† ì½œì€ ì•„ë‹ˆë‹¤. ëª¨ë“œë²„ìŠ¤ TCPì—ì„œëŠ” MBAP(MODBUS Application Protocol) í—¤ë”ì™€ Function Code ê·¸ë¦¬ê³  ë°ì´í„° í”„ë ˆì„ì„ í•˜ë‚˜ë¡œ ì „ë‹¬í•˜ê²Œ ë˜ë©° ì¼ë°˜ì ì¸ ì†Œì¼“ í†µì‹ ê³¼ ë™ì¼í•˜ë‹¤. ë˜í•œ, ëª¨ë“œë²„ìŠ¤ í”„ë¡œí† ì½œì€ ë§ˆìŠ¤í„° â€¢ ìŠ¬ë ˆì´ë¸Œ êµ¬ì¡°ë¡œ ë™ì‘í•˜ë©° ë§ˆìŠ¤í„°(í´ë¼ì´ì–¸íŠ¸)ëŠ” ìŠ¬ë ˆì´ë¸Œ(ì„œë²„)ì—ì„œ ì •ì˜í•œ ë©”ëª¨ë¦¬ ë§µ ì •ë³´ë¥¼ í† ëŒ€ë¡œ ë©”ëª¨ë¦¬ì— ì €ì¥ë˜ì–´ìˆëŠ” ë°ì´í„°ë¥¼ ì½ê±°ë‚˜ ì›í•˜ëŠ” ëª…ë ¹ì„ ìˆ˜í–‰í•˜ë„ë¡ ë©”ëª¨ë¦¬ ë°ì´í„°ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.</p><h4 id="MBAP-í—¤ë”"><a href="#MBAP-í—¤ë”" class="headerlink" title="MBAP í—¤ë”"></a>MBAP í—¤ë”</h4><p>MBAP í—¤ë”ë¥¼ êµ¬ì„±í•˜ëŠ” Unit IdentifierëŠ” ëª¨ë“œë²„ìŠ¤ TCP ì—ì„œëŠ” IP ì£¼ì†Œë¡œ ì‹ë³„í•˜ê¸° ë•Œë¬¸ì— Unit IdentifierëŠ” ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” í•­ëª©ì´ì§€ë§Œ 255(0xFF)ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•œë‹¤. â€» <a href="https://sol.ls-electric.com/uploads/document/16419540742910/20130809_%EA%B9%80%EC%A7%80%EC%9A%A9D_iS7%20MODBUS-TCP.pdf">LS ì‚°ì „ì˜ ìƒë‹´í’ˆì§ˆ í–¥ìƒ êµìœ¡ ë¬¸ì„œ</a>ë¥¼ ì°¸ê³ í•´ë´ë„ 0xFFë¡œ ê³ ì •í•œë‹¤ê³  í•œë‹¤.</p><h4 id="Function-Code"><a href="#Function-Code" class="headerlink" title="Function Code"></a>Function Code</h4><p><img data-src="https://miro.medium.com/v2/resize:fit:640/format:webp/0*lOma7y90Hjtdc88d.jpg" alt="Functional codes of Modbus registers"></p><p>ì¼ë°˜ì ì¸ ì¸¡ì •ê°’ì„ í‘œí˜„í•˜ëŠ” <strong>ì•„ë‚ ë¡œê·¸</strong>ì™€ 0ê³¼ 1ë¡œ êµ¬ì„±ë˜ëŠ” ìƒíƒœê°’ì„ í‘œí˜„í•˜ëŠ” <strong>ë””ì§€í„¸</strong>ë¡œ ë‚˜ëˆ„ì–´ì„œ ê¸°ëŠ¥ ì½”ë“œë¥¼ ì‚¬ìš©í•œë‹¤. ì£¼ì†Œ ë²”ìœ„ì— ë”°ë¼ 01(0x01, Read Coil)ê³¼ 02(0x02, Read Discrete Inputs)ë¥¼ ì‚¬ìš©í•˜ë©° ì•„ë‚ ë¡œê·¸ëŠ” ì£¼ë¡œ 03(0x03, Read Holding Registers)ë¥¼ ì‚¬ìš©í•˜ëŠ” í¸ì´ë‹¤. â€» ê¸°ëŠ¥ ì½”ë“œí‘œë¥¼ ì‚´í´ë³´ë©´ 02(0x02, REad Discrete Inputs)ì™€ 04(0x04, Read Input Registers)ëŠ” ì½ê¸°ë§Œ ìˆ˜í–‰í•˜ëŠ” ë©”ëª¨ë¦¬ ë²”ìœ„ì—ì„œ ì‚¬ìš©í•˜ê²Œ ëœë‹¤ëŠ” ê²ƒì„ ì•Œì•„ì±Œ ìˆ˜ ìˆë‹¤.</p><h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><p>ë„¤í‹° ê¸°ë°˜ì˜ <a href="https://github.com/digitalpetri/modbus">digitalpetri&#x2F;modbus</a> ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ìˆìœ¼ë‚˜ <a href="https://github.com/steveohara/j2mod">steveohara&#x2F;j2mod</a>ë¼ëŠ” ìë°” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í†µí•´ ëª¨ë“œë²„ìŠ¤ TCP í†µì‹ ì„ êµ¬í˜„í•˜ëŠ”ê²Œ ê°„ë‹¨í•  ê²ƒ ê°™ë‹¤. ë‹¤ìŒì˜ ì½”ë“œëŠ” ê°„ë‹¨í•˜ê²Œ ìŠ¬ë ˆì´ë¸Œì— ëª¨ë“œë²„ìŠ¤ ë§µì„ ì´ë¯¸ì§€ë¡œ ì •ì˜í•˜ê³  ë§ˆìŠ¤í„°ì—ì„œ ì •ì˜ëœ ëª¨ë“œë²„ìŠ¤ ë§µì— ëŒ€í•´ì„œ ì½ì–´ë³´ëŠ” ìƒ˜í”Œì´ë‹¤.</p><pre class="language-groovy" data-language="groovy"><code class="language-groovy">implementation <span class="token string">'com.ghgande:j2mod:3.1.1'</span></code></pre><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Slf4j</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ModbusTCP</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">TCP_UNIT_ID</span> <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span> <span class="token comment">// 0xFF</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">DefaultProcessImageFactory</span> imageFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultProcessImageFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ProcessImageImplementation</span> memoryMap <span class="token operator">=</span> imageFactory<span class="token punctuation">.</span><span class="token function">createProcessImageImplementation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        memoryMap<span class="token punctuation">.</span><span class="token function">addDigitalOut</span><span class="token punctuation">(</span>imageFactory<span class="token punctuation">.</span><span class="token function">createDigitalOut</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ObservableRegister</span> register <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObservableRegister</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        register<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        memoryMap<span class="token punctuation">.</span><span class="token function">addRegister</span><span class="token punctuation">(</span>register<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ModbusSlave</span> tcpSlave <span class="token operator">=</span> <span class="token class-name">ModbusSlaveFactory</span><span class="token punctuation">.</span><span class="token function">createTCPSlave</span><span class="token punctuation">(</span><span class="token class-name">Modbus</span><span class="token punctuation">.</span><span class="token constant">DEFAULT_PORT</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        tcpSlave<span class="token punctuation">.</span><span class="token function">addProcessImage</span><span class="token punctuation">(</span><span class="token constant">TCP_UNIT_ID</span><span class="token punctuation">,</span> memoryMap<span class="token punctuation">)</span><span class="token punctuation">;</span>        tcpSlave<span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ModbusTCPMaster</span> modbusTCPMaster <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModbusTCPMaster</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token class-name">Modbus</span><span class="token punctuation">.</span><span class="token constant">DEFAULT_PORT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        modbusTCPMaster<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>modbusTCPMaster<span class="token punctuation">.</span><span class="token function">isConnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">BitVector</span> bitVector <span class="token operator">=</span> modbusTCPMaster<span class="token punctuation">.</span><span class="token function">readCoils</span><span class="token punctuation">(</span><span class="token constant">TCP_UNIT_ID</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">boolean</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bools <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">boolean</span><span class="token punctuation">[</span>bitVector<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> bitVector<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                bools<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> bitVector<span class="token punctuation">.</span><span class="token function">getBit</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">Register</span><span class="token punctuation">[</span><span class="token punctuation">]</span> registers <span class="token operator">=</span> modbusTCPMaster<span class="token punctuation">.</span><span class="token function">readMultipleRegisters</span><span class="token punctuation">(</span><span class="token constant">TCP_UNIT_ID</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"booleans, &#123;&#125;"</span><span class="token punctuation">,</span> bools<span class="token punctuation">)</span><span class="token punctuation">;</span>            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"registers, &#123;&#125;"</span><span class="token punctuation">,</span> registers<span class="token punctuation">)</span><span class="token punctuation">;</span>            modbusTCPMaster<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">ModbusSlaveFactory</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><blockquote><p>ìŠ¬ë ˆì´ë¸Œ ì´ë¯¸ì§€ êµ¬ì„± ì‹œ 10001-20000ì€ DigitalInë¥¼ ì‚¬ìš©í•˜ë©° 30001-40000ì€ InputRegisterë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤. ì½ê¸° ë¿ë§Œ ì•„ë‹ˆë¼ ì“°ê¸°ë„ ê°€ëŠ¥í•œ DigitalOutê³¼ Registerì— ëŒ€í•´ì„œëŠ” ìŠ¬ë ˆì´ë¸Œì—ì„œ ë³€ê²½ì— ëŒ€í•´ ê°ì§€í•  ìˆ˜ ìˆëŠ” ObservableDigitalOutê³¼ ObservableRegisterë¥¼ ì œê³µí•œë‹¤.</p></blockquote><h4 id="PLC-Simulator"><a href="#PLC-Simulator" class="headerlink" title="PLC Simulator"></a>PLC Simulator</h4><p><a href="https://sourceforge.net/projects/modrssim2/">ModRSsim2</a> í”„ë¡œê·¸ë¨ì„ í†µí•´ TCP&#x2F;IP ê¸°ë°˜ì˜ PLC ìŠ¬ë ˆì´ë¸Œì— ëŒ€í•œ ì‹œë®¬ë ˆì´í„°ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. ìœ„ ì½”ë“œì—ì„œ ìŠ¬ë ˆì´ë¸Œ ë©”ëª¨ë¦¬ ë§µ ì •ë³´ë¥¼ ë§Œë“¤ê¸°ë³´ë‹¤ ì‹œë®¬ë ˆì´í„° í”„ë¡œê·¸ë¨ìœ¼ë¡œ ë©”ëª¨ë¦¬ ë°ì´í„°ë¥¼ ì‰½ê²Œ ì •ì˜í•˜ê³  ëª¨ë“œë²„ìŠ¤ ë§ˆìŠ¤í„°ì¸ í´ë¼ì´ì–¸íŠ¸ ë¡œì§ êµ¬í˜„ì— ì§‘ì¤‘í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. </p><h2 id="ì°¸ê³ "><a href="#ì°¸ê³ " class="headerlink" title="ì°¸ê³ "></a>ì°¸ê³ </h2><ul><li><a href="https://modbus.org/docs/Modbus_Messaging_Implementation_Guide_V1_0b.pdf">MODBUS Messaging on TCP&#x2F;IP Implementation Guide V1.0b</a></li><li><a href="https://www.youtube.com/watch?v=eb8iophBMLs">ëª¨ë“œë²„ìŠ¤ í”„ë¡œí† ì½œ 11ë¶€ - ëª¨ë“œë²„ìŠ¤ TCP(ë” ë„“ì€ ì„¸ìƒìœ¼ë¡œ)</a></li><li><a href="https://www.youtube.com/watch?v=ImVbnyqAqX4">[ëª¨ë“œë²„ìŠ¤ í•¸ë“œë¶] 09ê°• ëª¨ë“œë²„ìŠ¤ TCP í†µì‹  ì˜ˆì œ</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ëª¨ë“œë²„ìŠ¤(Modbus) í”„ë¡œí† ì½œì€ PLCì™€ ê°™ì€ ìë™í™” ì œì–´ ì„¤ë¹„ê°€ í¬í•¨ë˜ëŠ” ì‚°ì—…ì—ì„œ ê³µì‹ì ì¸ í‘œì¤€ì€ ì•„ë‹ˆì§€ë§Œ ê±°ì˜ í‘œì¤€ì²˜ëŸ¼ ì‚¬ìš©ë˜ê³  ìˆëŠ” í†µì‹  í”„ë¡œí† ì½œì´ë‹¤. ëª¨ë“œë²„ìŠ¤ í”„ë¡œí† ì½œì— ëŒ€í•œ ìŠ¤í™ì€ &lt;a href=&quot;https://modbus.org/do</summary>
      
    
    
    
    
    <category term="Modbus" scheme="https://kdevkr.github.io/tags/Modbus/"/>
    
    <category term="TCP/IP" scheme="https://kdevkr.github.io/tags/TCP-IP/"/>
    
  </entry>
  
  <entry>
    <title>Spring Boot 3.x Micrometer Tracing</title>
    <link href="https://kdevkr.github.io/spring-boot-3-tracing/"/>
    <id>https://kdevkr.github.io/spring-boot-3-tracing/</id>
    <published>2023-08-27T00:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.890Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Spring Cloud Sleuth will not work with Spring Boot 3.x onward. Please check <a href="https://github.com/micrometer-metrics/tracing/wiki/Spring-Cloud-Sleuth-3.1-Migration-Guide">Spring Cloud Sleuth 3.1 Migration Guide</a>.</p></blockquote><p>Spring Cloud Sleuth í”„ë¡œì íŠ¸ëŠ” ë”ì´ìƒ Spring Boot 3.x ì™€ì˜ í˜¸í™˜ì„±ì„ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤. ë¶„ì‚° ì¶”ì  ë°ì´í„° ëª¨ë¸ì„ ì ìš©í•˜ê¸° ìœ„í•œ ìë™ êµ¬ì„±ì´ Spring Cloud Sleuth ì—ì„œ Spring Bootë¡œ ì´ë™ë˜ì–´ìˆê¸° ë•Œë¬¸ì´ë‹¤. Spring Boot 3.x ì—ì„œëŠ” ë”ì´ìƒ Spring Cloud SleuthëŠ” í•„ìš”í•˜ì§€ ì•Šìœ¼ë©° <code>Micrometer Tracing</code>ì— ëŒ€í•œ ì„¤ì •ì„ ìˆ˜í–‰í•˜ë©´ ëœë‹¤.</p><pre class="language-groovy" data-language="groovy"><div class="caption"><span>build.gradle</span></div><code class="language-groovy">plugins <span class="token punctuation">&#123;</span>    id <span class="token string">'org.springframework.boot'</span> version <span class="token string">'3.1.3'</span>    id <span class="token string">'io.spring.dependency-management'</span> version <span class="token string">'1.1.3'</span><span class="token punctuation">&#125;</span>dependencies <span class="token punctuation">&#123;</span>    implementation <span class="token string">'org.springframework.boot:spring-boot-starter-actuator'</span>    implementation <span class="token string">'io.micrometer:micrometer-tracing-bridge-brave'</span>    implementation <span class="token string">'io.zipkin.reporter2:zipkin-reporter-brave'</span>    developmentOnly <span class="token string">'org.springframework.boot:spring-boot-docker-compose'</span> <span class="token comment">// Optional</span><span class="token punctuation">&#125;</span></code></pre><h4 id="AutoConfigure-Micrometer-Tracing"><a href="#AutoConfigure-Micrometer-Tracing" class="headerlink" title="AutoConfigure Micrometer Tracing"></a>AutoConfigure Micrometer Tracing</h4><p>ìŠ¤í”„ë§ ë¶€íŠ¸ ìë™ êµ¬ì„±ì— í¬í•¨ë˜ì–´ ìˆëŠ” BraveAutoConfigurationê³¼ ZipkinAutoConfigurationê°€ ìë™ìœ¼ë¡œ ì ìš©ë˜ë¯€ë¡œ ì•„ë˜ì™€ ê°™ì´ TracingProperties ì†ì„±ì„ ì›í•˜ëŠ”ëŒ€ë¡œ ì ìš©í•˜ë©´ ëœë‹¤. ë³¸ ê¸€ì—ì„œëŠ” Zipkinê³¼ì˜ ì—°ë™ì„ ìœ„í•´ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” B3 ë°©ì‹ì„ ì§€ì •í•˜ì˜€ë‹¤.</p><pre class="language-yaml" data-language="yaml"><div class="caption"><span>application.yml</span></div><code class="language-yaml"><span class="token key atrule">management.tracing</span><span class="token punctuation">:</span>  <span class="token key atrule">propagation.type</span><span class="token punctuation">:</span> b3  <span class="token key atrule">sampling.probability</span><span class="token punctuation">:</span> <span class="token number">1.0</span>  <span class="token key atrule">logging.pattern.level</span><span class="token punctuation">:</span> <span class="token string">"%5p [$&#123;spring.application.name:&#125;,%X&#123;traceId:-&#125;,%X&#123;spanId:-&#125;]"</span></code></pre><h4 id="Automatic-Context-Propagation-for-WebFlux"><a href="#Automatic-Context-Propagation-for-WebFlux" class="headerlink" title="Automatic Context Propagation for WebFlux"></a>Automatic Context Propagation for WebFlux</h4><p>Spring Cloud Gatewayì™€ ê°™ì´ WebFlux ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” Project Reactor 3ì˜ Context Propagationì— ëŒ€í•œ ìë™ êµ¬ì„±ì„ ìœ„í•´ì„œ ì•„ë˜ì™€ ê°™ì´ Hooks.enableAutomaticContextPropagationì„ ë©”ì¸ í•¨ìˆ˜ì—ì„œ í˜¸ì¶œí•´ì•¼í•œë‹¤. ë” ìì„¸í•œ ë‚´ìš©ì€ <a href="https://spring.io/blog/2023/03/30/context-propagation-with-project-reactor-3-unified-bridging-between-reactive">Context Propagation with Project Reactor 3 - Unified Bridging between Reactive and Imperative</a>ë¥¼ ì°¸ê³ í•˜ë©´ ëœë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">reactor<span class="token punctuation">.</span>core<span class="token punctuation">.</span>publisher<span class="token punctuation">.</span></span><span class="token class-name">Hooks</span></span><span class="token punctuation">;</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Hooks</span><span class="token punctuation">.</span><span class="token function">enableAutomaticContextPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;Spring Cloud Sleuth will not work with Spring Boot 3.x onward. Please check &lt;a href=&quot;https://github.com/micrometer-metrics/t</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ë³´ì•ˆ ì·¨ì•½ì  (Vulnerability)</title>
    <link href="https://kdevkr.github.io/vulnerabilities/"/>
    <id>https://kdevkr.github.io/vulnerabilities/</id>
    <published>2023-08-22T12:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.890Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/advisories?query=type:reviewed+ecosystem:maven">Github Advisory Database</a>ì—ëŠ” Mavenì— ëŒ€í•´ ì•½ 3800ê°œì˜ ì·¨ì•½ì  ì •ë³´ê°€ ìˆë‹¤. íšŒì‚¬ì—ì„œ ì„œë¹„ìŠ¤ ëª¨ë‹ˆí„°ë§ì„ ìœ„í•œ ì‹œìŠ¤í…œì´ êµ¬ì¶•ë˜ì–´ìˆì§€ëŠ” ì•Šì§€ë§Œ ì„ì‹œì ìœ¼ë¡œ ë‰´ë ë¦­ì„ ì ìš©í•œ í™˜ê²½ì´ ìˆì–´ APM &amp; Servicesì˜ Vulnerability Management ë©”ë‰´ì—ì„œ ë³´ì•ˆ ì·¨ì•½ì  ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤. ìš°ì„  ì²´í¬ëœ ë³´ì•ˆ ì·¨ì•½ì ì€ 58ê°œë¡œ CRITICAL 6ê°œ, HIGH 25ê°œ, MEDIUM 21ê°œ, LOW 6ê°œ ì´ë‹¤.</p><h4 id="Vulnerability"><a href="#Vulnerability" class="headerlink" title="Vulnerability"></a>Vulnerability</h4><table><thead><tr><th>name</th><th>severity</th><th>exploitable</th><th>issueId</th></tr></thead><tbody><tr><td>Pivotal Spring Framework contains unsafe Java deserialization methods</td><td>CRITICAL</td><td>FALSE</td><td><a href="https://github.com/advisories/GHSA-4wrc-f8pq-fpqp">CVE-2016-1000027</a></td></tr><tr><td>Deserialization of Untrusted Data in org.codehaus.jackson:jackson-mapper-asl</td><td>CRITICAL</td><td>FALSE</td><td><a href="https://github.com/advisories/GHSA-c27h-mcmw-48hv">CVE-2019-10202</a></td></tr><tr><td>Template injection in thymeleaf-spring5</td><td>CRITICAL</td><td>FALSE</td><td><a href="https://github.com/advisories/GHSA-qcj6-jqrg-4wp2">CVE-2021-43466</a></td></tr><tr><td>Remote Code Execution in Spring Framework</td><td>CRITICAL</td><td>FALSE</td><td><a href="https://github.com/advisories/GHSA-36p3-wjmg-h94x">CVE-2022-22965</a></td></tr><tr><td>Undertow client not checking server identity presented by server certificate in https connections</td><td>CRITICAL</td><td>FALSE</td><td><a href="https://github.com/advisories/GHSA-pfcc-3g6r-8rg8">CVE-2022-4492</a></td></tr><tr><td>Spring Boot Security Bypass with Wildcard Pattern Matching on Cloud Foundry</td><td>CRITICAL</td><td>FALSE</td><td><a href="https://github.com/advisories/GHSA-g5h3-w546-pj7f">CVE-2023-20873</a></td></tr></tbody></table><details><summary>More</summary><table><thead><tr><th>name</th><th>severity</th><th>exploitable</th><th>issueId</th></tr></thead><tbody><tr><td>Pivotal Spring Framework contains unsafe Java deserialization methods</td><td>CRITICAL</td><td>FALSE</td><td>CVE-2016-1000027</td></tr><tr><td>Deserialization of Untrusted Data in org.codehaus.jackson:jackson-mapper-asl</td><td>CRITICAL</td><td>FALSE</td><td>CVE-2019-10202</td></tr><tr><td>Template injection in thymeleaf-spring5</td><td>CRITICAL</td><td>FALSE</td><td>CVE-2021-43466</td></tr><tr><td>Remote Code Execution in Spring Framework</td><td>CRITICAL</td><td>FALSE</td><td>CVE-2022-22965</td></tr><tr><td>Undertow client not checking server identity presented by server certificate in https connections</td><td>CRITICAL</td><td>FALSE</td><td>CVE-2022-4492</td></tr><tr><td>Spring Boot Security Bypass with Wildcard Pattern Matching on Cloud Foundry</td><td>CRITICAL</td><td>FALSE</td><td>CVE-2023-20873</td></tr><tr><td>Arbitrary code execution in Apache Commons BeanUtils</td><td>HIGH</td><td>FALSE</td><td>CVE-2014-0114</td></tr><tr><td>Insecure Deserialization in Apache Commons Beanutils</td><td>HIGH</td><td>FALSE</td><td>CVE-2019-10086</td></tr><tr><td>Improper Restriction of XML External Entity Reference in jackson-mapper-asl</td><td>HIGH</td><td>FALSE</td><td>CVE-2019-10172</td></tr><tr><td>Deeply nested json in jackson-databind</td><td>HIGH</td><td>FALSE</td><td>CVE-2020-36518</td></tr><tr><td>Undertow Uncontrolled Resource Consumption</td><td>HIGH</td><td>FALSE</td><td>CVE-2021-3629</td></tr><tr><td>Uncaught Exception in jsoup</td><td>HIGH</td><td>FALSE</td><td>CVE-2021-37714</td></tr><tr><td>Undertow vulnerable to Denial of Service (DoS) attacks</td><td>HIGH</td><td>FALSE</td><td>CVE-2021-3859</td></tr><tr><td>jackson-databind possible Denial of Service if using JDK serialization to serialize JsonNode</td><td>HIGH</td><td>FALSE</td><td>CVE-2021-46877</td></tr><tr><td>SnakeYaml Constructor Deserialization Remote Code Execution</td><td>HIGH</td><td>FALSE</td><td>CVE-2022-1471</td></tr><tr><td>Undertow vulnerable to Dos via Large AJP request</td><td>HIGH</td><td>FALSE</td><td>CVE-2022-2053</td></tr><tr><td>pgjdbc Does Not Check Class Instantiation when providing Plugin Classes</td><td>HIGH</td><td>FALSE</td><td>CVE-2022-21724</td></tr><tr><td>Improper handling of case sensitivity in Spring Framework</td><td>HIGH</td><td>FALSE</td><td>CVE-2022-22968</td></tr><tr><td>Denial of service in Spring Framework</td><td>HIGH</td><td>FALSE</td><td>CVE-2022-22970</td></tr><tr><td>Deserialization of Untrusted Data in Gson</td><td>HIGH</td><td>FALSE</td><td>CVE-2022-25647</td></tr><tr><td>Uncontrolled Resource Consumption in snakeyaml</td><td>HIGH</td><td>FALSE</td><td>CVE-2022-25857</td></tr><tr><td>Partial Path Traversal in com.amazonaws:aws-java-sdk-s3</td><td>HIGH</td><td>FALSE</td><td>CVE-2022-31159</td></tr><tr><td>PostgreSQL JDBC Driver SQL Injection in ResultSet.refreshRow() with malicious column names</td><td>HIGH</td><td>FALSE</td><td>CVE-2022-31197</td></tr><tr><td>Apache Xalan Java XSLT library integer truncation issue when processing malicious XSLT stylesheets</td><td>HIGH</td><td>FALSE</td><td>CVE-2022-34169</td></tr><tr><td>Denial of Service due to parser crash</td><td>HIGH</td><td>FALSE</td><td>CVE-2022-40153</td></tr><tr><td>Uncontrolled Resource Consumption in Jackson-databind</td><td>HIGH</td><td>FALSE</td><td>CVE-2022-42003</td></tr><tr><td>Uncontrolled Resource Consumption in FasterXML jackson-databind</td><td>HIGH</td><td>FALSE</td><td>CVE-2022-42004</td></tr><tr><td>json stack overflow vulnerability</td><td>HIGH</td><td>FALSE</td><td>CVE-2022-45688</td></tr><tr><td>json-smart Uncontrolled Recursion vulnerabilty</td><td>HIGH</td><td>FALSE</td><td>CVE-2023-1370</td></tr><tr><td>Spring Framework vulnerable to denial of service</td><td>HIGH</td><td>FALSE</td><td>CVE-2023-20863</td></tr><tr><td>Spring Boot Welcome Page Denial of Service</td><td>HIGH</td><td>FALSE</td><td>CVE-2023-20883</td></tr><tr><td>Uncontrolled Resource Consumption in XNIO</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2020-14340</td></tr><tr><td>Improper privilege management in elasticsearch</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2020-7019</td></tr><tr><td>Log entry injection in Spring Framework</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2021-22060</td></tr><tr><td>Improper Output Neutralization for Logs in Spring Framework</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2021-22096</td></tr><tr><td>Exposure of Sensitive Information to an Unauthorized Actor</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2021-22134</td></tr><tr><td>API information disclosure flaw in Elasticsearch</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2021-22135</td></tr><tr><td>Denial of Service in Elasticsearch</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2021-22144</td></tr><tr><td>undertow Race Condition vulnerability</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2021-3597</td></tr><tr><td>Allocation of Resources Without Limits or Throttling in Spring Framework</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2022-22950</td></tr><tr><td>Allocation of Resources Without Limits or Throttling in Spring Framework</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2022-22971</td></tr><tr><td>jsoup may not sanitize code injection XSS attempts if SafeList.preserveRelativeLinks is enabled</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2022-36033</td></tr><tr><td>snakeYAML before 1.31 vulnerable to Denial of Service due to Out-of-bounds Write</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2022-38749</td></tr><tr><td>snakeYAML before 1.31 vulnerable to Denial of Service due to Out-of-bounds Write</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2022-38750</td></tr><tr><td>snakeYAML before 1.31 vulnerable to Denial of Service due to Out-of-bounds Write</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2022-38751</td></tr><tr><td>snakeYAML before 1.32 vulnerable to Denial of Service due to Out-of-bounds Write</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2022-38752</td></tr><tr><td>Denial of Service due to parser crash</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2022-40152</td></tr><tr><td>Snakeyaml vulnerable to Stack overflow leading to denial of service</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2022-41854</td></tr><tr><td>TemporaryFolder on unix-like systems does not limit access to created files</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2022-41946</td></tr><tr><td>Spring Framework vulnerable to denial of service via specially crafted SpEL expression</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2023-20861</td></tr><tr><td>Guava vulnerable to insecure use of temporary directory</td><td>MEDIUM</td><td>FALSE</td><td>CVE-2023-2976</td></tr><tr><td>pgjdbc Arbitrary File Write Vulnerability</td><td>MEDIUM</td><td>FALSE</td><td>GHSA-673j-qm5f-xpv8</td></tr><tr><td>Privilege Context Switching Error in Elasticsearch</td><td>LOW</td><td>FALSE</td><td>CVE-2020-7020</td></tr><tr><td>Information Disclosure in Guava</td><td>LOW</td><td>FALSE</td><td>CVE-2020-8908</td></tr><tr><td>Path traversal in org.postgresql:postgresql</td><td>LOW</td><td>FALSE</td><td>CVE-2022-26520</td></tr><tr><td>Denial of Service via stack overflow</td><td>LOW</td><td>FALSE</td><td>CVE-2022-40154</td></tr><tr><td>Denial of Service via stack overflow</td><td>LOW</td><td>FALSE</td><td>CVE-2022-40155</td></tr><tr><td>Denial of Service due to parser crash</td><td>LOW</td><td>FALSE</td><td>CVE-2022-40156</td></tr></tbody></table></details><h4 id="CRITICAL-Vulnerability"><a href="#CRITICAL-Vulnerability" class="headerlink" title="CRITICAL Vulnerability"></a>CRITICAL Vulnerability</h4><p>ìœ„ CRITICAL ë ˆë²¨ì˜ ë³´ì•ˆ ì·¨ì•½ì  ì¤‘ì—ì„œ <a href="https://github.com/advisories/GHSA-c27h-mcmw-48hv">CVE-2019-10202</a>ë¥¼ ì œì™¸í•˜ê³ ëŠ” ì·¨ì•½ì  ëŒ€ìƒì´ ë˜ëŠ” ì‹œìŠ¤í…œ í™˜ê²½ì€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— êµ³ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©ì¤‘ì¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì˜ì¡´ì„± ë²„ì „ì„ ë³€ê²½í•  í•„ìš”ëŠ” ì—†ë‹¤ê³  ìƒê°ëœë‹¤. CVE-2019-10202ì— ëŒ€í•´ì„œëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ org.codehaus.jackson:jackson-mapper-asl ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ìŒì—ë„ ì¼ë¶€ ì½”ë“œê°€ ë ˆê±°ì‹œ í”„ë¡œì íŠ¸ë¡œë¶€í„° ë³µì‚¬ë˜ì—ˆê¸° ë•Œë¬¸ì— jackson-databind ë¼ì´ë¸ŒëŸ¬ë¦¬ì— í¬í•¨ëœ ISO8601Utilsë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì½”ë“œë¥¼ ë³€ê²½í•˜ê³  ë¶ˆí•„ìš”í•œ jackson-mapper-asl ì˜ì¡´ì„±ì„ ì œê±°í•˜ì˜€ë‹¤. </p><pre class="language-groovy" data-language="groovy"><code class="language-groovy">ext <span class="token punctuation">&#123;</span>    <span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'quartz.version'</span><span class="token punctuation">,</span> <span class="token string">'2.3.2'</span><span class="token punctuation">)</span> <span class="token comment">// CVE-2019-13990</span>    <span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'thymeleaf.version'</span><span class="token punctuation">,</span> <span class="token string">'3.0.13.RELEASE'</span><span class="token punctuation">)</span> <span class="token comment">// CVE-2021-43466</span>    <span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'spring-framework.version'</span><span class="token punctuation">,</span> <span class="token string">'5.2.24.RELEASE'</span><span class="token punctuation">)</span> <span class="token comment">// CVE-2022-22965</span>    <span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'undertow.version'</span><span class="token punctuation">,</span> <span class="token string">'2.2.24.Final'</span><span class="token punctuation">)</span> <span class="token comment">// CVE-2022-4492]</span><span class="token punctuation">&#125;</span></code></pre><p>ë‚˜ë¨¸ì§€ CRITICAL ë ˆë²¨ì´ ì•„ë‹Œ ì·¨ì•½ì ì€ êµ³ì´ ì¡°ì¹˜í•  í•„ìš”ì„±ì´ ë†’ì§€ëŠ” ì•Šì•„ë³´ì´ë‚˜ ìµœëŒ€í•œ ì·¨ì•½ì ì„ ì œê±°í•˜ê³ ì ë¶„ì„ í›„ Github Advisory Databaseë¥¼ í†µí•´ ì·¨ì•½ì ì´ ì¡°ì¹˜ëœ ë²„ì „ìœ¼ë¡œ ë³€ê²½í•˜ì˜€ë‹¤.</p><h4 id="Vulnerability-1"><a href="#Vulnerability-1" class="headerlink" title="Vulnerability"></a>Vulnerability</h4><p>ì·¨ì•½ì  ì¡°ì¹˜ ì´í›„ì— ì²´í¬ë˜ì–´ ë‚¨ì•„ìˆëŠ” ì·¨ì•½ì ì€ ì•„ë˜ì™€ ê°™ë‹¤. </p><table><thead><tr><th>name</th><th>severity</th><th>exploitable</th><th>issueId</th></tr></thead><tbody><tr><td>Pivotal Spring Framework contains unsafe Java deserialization methods</td><td>CRITICAL</td><td>FALSE</td><td><a href="https://github.com/advisories/GHSA-4wrc-f8pq-fpqp">CVE-2016-1000027</a></td></tr><tr><td>Spring Boot Security Bypass with Wildcard Pattern Matching on Cloud Foundry</td><td>CRITICAL</td><td>FALSE</td><td><a href="https://github.com/advisories/GHSA-g5h3-w546-pj7f">CVE-2023-20873</a></td></tr><tr><td>SnakeYaml Constructor Deserialization Remote Code Execution</td><td>HIGH</td><td>FALSE</td><td><a href="https://github.com/advisories/GHSA-mjmj-j48q-9wg2">CVE-2022-1471</a></td></tr><tr><td>Spring Boot Welcome Page Denial of Service</td><td>HIGH</td><td>FALSE</td><td><a href="https://github.com/advisories/GHSA-xf96-w227-r7c4">CVE-2023-20883</a></td></tr></tbody></table><p>CRITICAL ë ˆë²¨ì˜ CVE-2016-1000027ì™€ CVE-2023-20873 ë„ ì·¨ì•½ì  ë‚´ìš©ì„ ì‚´í´ë³´ë©´ ì·¨ì•½ì ì´ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì‹œìŠ¤í…œ í™˜ê²½ì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— êµ³ì´ ì¡°ì¹˜í•  í•„ìš”ê°€ ì—†ë‹¤. ë”êµ¬ë‚˜ ì·¨ì•½ì  ì •ë³´ë¥¼ ì œê±°í•˜ê¸° ìœ„í•´ì„œëŠ” ìƒë‹¹íˆ ë†’ì€ ìŠ¤í”„ë§ ë¶€íŠ¸ 3+ìœ¼ë¡œ ë³€ê²½í•´ì•¼í•˜ê¸° ë•Œë¬¸ì— êµ³ì´ ì‹œë„í•˜ì§€ ì•Šìœ¼ë ¤ê³  í•œë‹¤. </p><p>CVE-2022-1471ì— ëŒ€í•´ì„œëŠ” ìŠ¤í”„ë§ ë¶€íŠ¸ 2.5.15 ì—ì„œ <a href="https://github.com/spring-projects/spring-boot/commit/d1d990acd7a06aa34112896d753bcae679203f35">Improve compatibility with SnakeYAML 2.0</a> ì²˜ë¦¬ê°€ ë˜ì—ˆê¸° ë•Œë¬¸ì— Snakeyaml ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ë²„ì „ë§Œ 2.0+ë¡œ ë³€ê²½í•˜ë©´ ë˜ì§€ë§Œ ìŠ¤í”„ë§ ë¶€íŠ¸ 2.4+ë¡œ ë³€ê²½í•˜ëŠ” ê²ƒë„ ìƒê°ë³´ë‹¤ ë§ì€ ì„¤ì •ë“¤ì´ ë³€ê²½ë˜ì–´ì„œ ì‰½ì§€ ì•Šë‹¤. ë§Œì•½, ìŠ¤í”„ë§ ë¶€íŠ¸ 2.5.15ë¡œ ë³€ê²½í•œë‹¤ë©´ <a href="https://github.com/advisories/GHSA-xf96-w227-r7c4">CVE-2023-20883</a>ë„ í•¨ê»˜ ì¡°ì¹˜í•  ìˆ˜ ìˆë‹¤.</p><p>ì´ë ‡ê²Œ ì·¨ì•½ì  ì œê±° ì¡°ì¹˜ëŠ” ìˆ˜í–‰í–ˆìœ¼ë‚˜ ì‹¤ì œë¡œ ë°˜ì˜í•˜ëŠ” ê²ƒì€ ì¡°ì‹¬í•´ì•¼í•œë‹¤. ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ ë³€ê²½ìœ¼ë¡œ ì¸í•œ ì‹œìŠ¤í…œ ì˜í–¥ë„ë¥¼ ì œëŒ€ë¡œ ì²´í¬í•œë‹¤ëŠ” ê²ƒì„ ë³´ì¥í•  ìˆœ ì—†ê¸° ë•Œë¬¸ì— í•œë²ˆì— ìˆ˜ì •í•˜ëŠ” ê²ƒì€ ì§€ì–‘í•´ì•¼í•  ìˆ˜ ìˆë‹¤. ì•ì„œ, jackson-databind ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ 2.11.4 ì—ì„œ ìƒìœ„ ë²„ì „ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œí•˜ëŠ” ê³¼ì •ì—ì„œ ì•„ë˜ì™€ ê°™ì€ ì§ë ¬í™” ì´ìŠˆê°€ ë°œìƒí•˜ì˜€ë‹¤.</p><pre class="language-bash" data-language="bash"><code class="language-bash">Caused by: com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Java <span class="token number">8</span> date/time <span class="token builtin class-name">type</span> <span class="token variable"><span class="token variable">`</span>java.time.Instant<span class="token variable">`</span></span> not supported by default: <span class="token function">add</span> Module <span class="token string">"com.fasterxml.jackson.datatype:jackson-datatype-jsr310"</span> to <span class="token builtin class-name">enable</span> handling <span class="token punctuation">(</span>through reference chain: java.util.Collections<span class="token variable">$UnmodifiableMap</span><span class="token punctuation">[</span><span class="token string">"build"</span><span class="token punctuation">]</span>-<span class="token operator">></span>java.util.LinkedHashMap<span class="token punctuation">[</span><span class="token string">"time"</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p>ì´ì™€ ê°™ì€ ì´ìŠˆë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ ObjectMapperë¥¼ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ì½”ë“œì— JavaTimeModuleì„ ìˆ˜ë™ìœ¼ë¡œ ë“±ë¡í•˜ë„ë¡ ë³€ê²½í•´ì•¼í•œë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ObjectMapper</span> objectMapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>objectMapper<span class="token punctuation">.</span><span class="token function">registerModule</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JavaTimeModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ì¸í…”ë¦¬ì œì´ë¥¼ í†µí•´ ê²€ìƒ‰í•´ë³´ë‹ˆ ìƒê°ë³´ë‹¤ ê±´ë“œë ¤ì•¼í•˜ëŠ” ì½”ë“œê°€ ë§ì•„ì„œ jackson-databind ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ìƒìœ„ ë²„ì „ìœ¼ë¡œ ë³€ê²½í•˜ì§€ ì•Šê³  2.11.4ë¥¼ ìœ ì§€í•˜ê³ ì í•œë‹¤.</p><h4 id="OWASP-Dependency-Check"><a href="#OWASP-Dependency-Check" class="headerlink" title="OWASP Dependency-Check"></a>OWASP Dependency-Check</h4><p><a href="https://owasp.org/www-project-dependency-check/">OWASP Dependency-Check</a>ë¼ëŠ” SCA ë„êµ¬ë¥¼ ì‚¬ìš©í•´ì„œ CPEì™€ CVEë¥¼ ê²€ì¶œí•  ìˆ˜ ìˆë‹¤. ì•„ë˜ì™€ ê°™ì´ dependencycheck ê·¸ë˜ë“¤ í”ŒëŸ¬ê·¸ì¸ì„ ë“±ë¡í•˜ê³ ë‚˜ì„œ dependencyCheckAnalyze íƒœìŠ¤í¬ë¥¼ ìˆ˜í–‰í•˜ë©´ <code>build/reports/dependency-check-report.html</code> íŒŒì¼ì´ ìƒì„±ë˜ì–´ ì·¨ì•½ì  ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><pre class="language-groovy" data-language="groovy"><div class="caption"><span>build.gradle</span></div><code class="language-groovy">plugins <span class="token punctuation">&#123;</span>    id <span class="token string">'org.owasp.dependencycheck'</span> version <span class="token string">'8.4.0'</span><span class="token punctuation">&#125;</span>dependencyCheck <span class="token punctuation">&#123;</span>    <span class="token comment">// build/reports/dependency-check-report.html</span>    analyzers <span class="token punctuation">&#123;</span>        nodeEnabled <span class="token operator">=</span> <span class="token boolean">false</span>        nodeAudit <span class="token punctuation">&#123;</span>            enabled <span class="token operator">=</span> <span class="token boolean">false</span>            yarnEnabled <span class="token operator">=</span> <span class="token boolean">false</span>            pnpmEnabled <span class="token operator">=</span> <span class="token boolean">false</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><blockquote><p><a href="https://plugins.jenkins.io/dependency-check-jenkins-plugin/">ì  í‚¨ìŠ¤ OWASP Dependency-Check í”ŒëŸ¬ê·¸ì¸</a>ë„ ìˆëŠ”ë° OWASP Dependency-Checkë¡œ ì²´í¬í•˜ëŠ” ê²½ìš° ìƒê°ë³´ë‹¤ ë§ì€ ì·¨ì•½ì ì´ í™•ì¸ë˜ì–´ì„œ ìµœì‹  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” í”„ë¡œì íŠ¸ê°€ ì•„ë‹ˆë¼ë©´ ì¢‹ì•„ë³´ì´ì§€ëŠ” ì•ŠëŠ”ë‹¤. ê°œì¸ì ìœ¼ë¡œ CVE ê²€ì¶œì„ ìœ„í•´ì„œ ì‚¬ìš©í•˜ì§„ ì•Šì„ ê²ƒ ê°™ë‹¤.</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://github.com/advisories?query=type:reviewed+ecosystem:maven&quot;&gt;Github Advisory Database&lt;/a&gt;ì—ëŠ” Mavenì— ëŒ€í•´ ì•½ 3800ê°œì˜ ì·¨ì•½ì  ì •ë³´ê°€ ìˆë‹¤.</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ê¸°ë¡ë³´ë‹¤ ë” ì¤‘ìš”í•œ ê²ƒ</title>
    <link href="https://kdevkr.github.io/more-important-than-blogging/"/>
    <id>https://kdevkr.github.io/more-important-than-blogging/</id>
    <published>2023-08-08T11:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.890Z</updated>
    
    <content type="html"><![CDATA[<p>ì‹ ì… ê°œë°œì ì¸í„°ë·° ê³¼ì •ì—ì„œ ë°°ìš°ê²Œ ëœ ê±´ <strong>ê¸°ë¡ë³´ë‹¤ ì¤‘ìš”í•œ ê²ƒì€ ë‹¤ì‹œ ë˜ëŒì•„ë³´ëŠ” í–‰ìœ„</strong>ì¸ ê²ƒ ê°™ë‹¤.</p><p>ì‹ ì… ê°œë°œì ì´ë ¥ì„œë¥¼ ê²€í† í•˜ë‹¤ë³´ë©´ ê²½ë ¥ ê°œë°œìì™€ ë‹¤ë¥´ê²Œ ê¸°ìˆ  ë¸”ë¡œê·¸ë¥¼ í•„ìˆ˜ë¡œ ì²¨ë¶€í•˜ê±°ë‚˜ <strong>ê¸°ì–µë³´ë‹¤ ê¸°ë¡ì„</strong> ì–´í•„í•˜ëŠ” ë¶„ë“¤ì´ ìƒë‹¹íˆ ë§ë‹¤ê³  ëŠë‚€ë‹¤. ì´ë ‡ê²Œ ì‹ ì… ê°œë°œìë“¤ì—ê²Œ ê¸°ìˆ  ë¸”ë¡œê·¸ê°€ ê±°ì˜ í•„ìˆ˜ê°€ ëœ ì´ìœ ëŠ” ê¾¸ì¤€í•˜ê²Œ ë¸”ë¡œê·¸ì— ìì‹ ì˜ ìƒê°ì´ë‚˜ ê²½í—˜í•œ ê²ƒë“¤ì„ ê¸°ë¡í•˜ëŠ” ìœ íŠœë¸Œ ê°œë°œë°”ë‹¥ì˜ í–¥ë¡œë‹˜ì˜ ì˜í–¥ì´ í´ ê²ƒ ê°™ë‹¤ê³  ìƒê°ëœë‹¤.</p><p>ì•„ë¬´íŠ¼ ì‹ ì… ê°œë°œì ì¸í„°ë·° ê³¼ì •ì—ì„œ ê¸°ìˆ  ë¸”ë¡œê·¸ì— ìˆëŠ” ë‚´ìš©ì„ í† ëŒ€ë¡œ ë¬¼ì–´ë³´ê²Œ ë˜ë©´ ë‹µë³€ì„ ëª»í•˜ëŠ” ê²½ìš°ê°€ ìƒê°ë³´ë‹¤ ë§ë‹¤. ì•„ë¬´ë˜ë„ ë‹¹ì¥ ë°°ì›Œì•¼í•  ê²ƒì´ ë§ê³  ìŠì–´ë²„ë¦¬ê±°ë‚˜ ìš°ì„ ìˆœìœ„ì— ë°€ë ¤ì„œ ì‹ ê²½ì“°ì§€ ì•Šë˜ ì§€ì‹ë“¤ì´ê¸° ë•Œë¬¸ì¼ ê²ƒ ê°™ë‹¤. êµ­ë¹„ì§€ì›ì´ë‚˜ ë¶€íŠ¸ìº í”„ì—ì„œ ë§ì€ ê±¸ì„ ë°°ì› ë‹¤ê³  ìƒê°í•˜ì§€ë§Œ ì§§ì€ ê¸°ê°„ìœ¼ë¡œ ì¸í•´ ìƒëµí•˜ê³  ë„˜ì–´ê°„ ê¸°ë³¸ì ìœ¼ë¡œ ì•Œì•„ì•¼í•  ì§€ì‹ë“¤ë„ ë§ë‹¤.</p><p>ê°œì¸ì ìœ¼ë¡œ ì†”ì§í•˜ê²Œ ì‹ ì… ê°œë°œìë“¤ì—ê²Œ ë¬¼ì–´ë³¼ë§Œí•œ ê²ƒë“¤ì€ ì´ë¯¸ ì¸í„°ë„·ì— ì‹ ì… ê°œë°œì ì§ˆë¬¸ ë¦¬ìŠ¤íŠ¸ë¼ë©° ë¬¸ì œ ì€í–‰ì‹ìœ¼ë¡œ ê½¤ë‚˜ ë§ì´ ê³µìœ ë˜ì–´ ìˆë‹¤. ê·¸ë˜ì„œ ì§€ì›ìë§ˆë‹¤ ë‹¤ë¥´ê²Œ ë¬¼ì–´ë³´ê²Œ ë˜ëŠ” ê±´ <strong>ë¸”ë¡œê·¸ì— ìˆëŠ” ë‚´ìš©ì„ í† ëŒ€ë¡œ ì–¼ë§ˆë‚˜ ë” ì°¾ì•„ë³´ê³  ì´í•´í–ˆëŠ”ê°€</strong> ì´ë‹¤.</p><p>ìµœì†Œí•œ ë©´ì ‘ì„ ë³´ê¸° ì „ì— <strong>ìì‹ ì´ ì‘ì„±í–ˆë˜ ë‚´ìš©ì„ ë‹¤ì‹œ ì‚´í´ë³´ëŠ” ê²Œ ì¤‘ìš”</strong>í•  ê²ƒ ê°™ë‹¤. í˜„ì¬ ì§„í–‰í•˜ê³  ìˆëŠ” ì±„ìš©ì—ì„œ ì¸í„°ë·° ê³¼ì •ì„ ë˜ëŒì•„ë³´ì•˜ì„ ë•Œ ìì„¸íˆ ë‹µë³€ì„ í•˜ì§€ ëª»í•˜ë”ë¼ë„ ì§€ì‹ì— ëŒ€í•œ í‚¤ì›Œë“œë¥¼ ë“¤ì–´ë³¸ ë“¯í•œ ë°˜ì‘ì´ ìˆëŠ” ê²ƒê³¼ ì „í˜€ ì•Œì•„ì±„ì§€ ëª»í•˜ëŠ” ê±´ í™•ì‹¤í•˜ê²Œ ëŠë‚Œì´ ë‹¤ë¥´ë‹¤.</p><p>ë‚˜ë„ ì´ ë¸”ë¡œê·¸ì— ì‘ì„±í–ˆë˜ ê²ƒë“¤ì„ ìì£¼ ë˜ëŒì•„ë³´ì•„ì•¼ ê² ë‹¤. ğŸ™„</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ì‹ ì… ê°œë°œì ì¸í„°ë·° ê³¼ì •ì—ì„œ ë°°ìš°ê²Œ ëœ ê±´ &lt;strong&gt;ê¸°ë¡ë³´ë‹¤ ì¤‘ìš”í•œ ê²ƒì€ ë‹¤ì‹œ ë˜ëŒì•„ë³´ëŠ” í–‰ìœ„&lt;/strong&gt;ì¸ ê²ƒ ê°™ë‹¤.&lt;/p&gt;
&lt;p&gt;ì‹ ì… ê°œë°œì ì´ë ¥ì„œë¥¼ ê²€í† í•˜ë‹¤ë³´ë©´ ê²½ë ¥ ê°œë°œìì™€ ë‹¤ë¥´ê²Œ ê¸°ìˆ  ë¸”ë¡œê·¸ë¥¼ í•„ìˆ˜ë¡œ ì²¨ë¶€í•˜ê±°ë‚˜ &lt;strong&gt;ê¸°</summary>
      
    
    
    
    
    <category term="ê°œë°œì ì¸í„°ë·°" scheme="https://kdevkr.github.io/tags/%EA%B0%9C%EB%B0%9C%EC%9E%90-%EC%9D%B8%ED%84%B0%EB%B7%B0/"/>
    
    <category term="ê¸°ìˆ  ë¸”ë¡œê·¸" scheme="https://kdevkr.github.io/tags/%EA%B8%B0%EC%88%A0-%EB%B8%94%EB%A1%9C%EA%B7%B8/"/>
    
  </entry>
  
  <entry>
    <title>ì‹œë‹ˆì–´ ê°œë°œìë¡œ ì„±ì¥í•˜ê¸° ìœ„í•œ ì—­ëŸ‰</title>
    <link href="https://kdevkr.github.io/hexagonal-developer/"/>
    <id>https://kdevkr.github.io/hexagonal-developer/</id>
    <published>2023-08-06T12:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.886Z</updated>
    
    <content type="html"><![CDATA[<p>ì˜¤ëŠ˜ì€ íšŒì‚¬ì—ì„œ êµ¬ë§¤ ì‹ ì²­í•œ ìµœë²”ê· ë‹˜ì´ ê¸€ì„ ì“°ì‹  <code>ìœ¡ê°í˜• ê°œë°œì</code>ë¼ëŠ” ì±…ì„ ì½ì–´ë³´ì•˜ë‹¤. ì´ì œëŠ” ì‹œë‹ˆì–´ ê°œë°œìë¡œì„œì˜ ì—­ëŸ‰ì„ ì„±ì¥ì‹œì¼œì•¼í•˜ëŠ” ë¦¬ë”ë¡œì¨ì˜ ì—­í• ì„ ìˆ˜í–‰í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ì¢‹ì€ ì‹œë‹ˆì–´ ê°œë°œìê°€ ê°€ì§€ëŠ” ì—­ëŸ‰ì— ëŒ€í•´ì„œ ìŠ¤ìŠ¤ë¡œ ì •ë¦¬í•´ë³´ê¸° ìœ„í•´ì„œ ë‚´ ê¸°ì¤€ì—ì„œ ì–´ë–¤ ê²ƒì— ëŒ€í•œ ì—­ëŸ‰ì„ í‚¤ì›Œë‚˜ê°€ì•¼í•˜ëŠ”ì§€ ì‚´í´ë³´ê³ ì í•œë‹¤.</p><h4 id="ìš”êµ¬ì‚¬í•­-ë¶„ì„-ë°-ì„¤ê³„ì˜-ì—­ëŸ‰"><a href="#ìš”êµ¬ì‚¬í•­-ë¶„ì„-ë°-ì„¤ê³„ì˜-ì—­ëŸ‰" class="headerlink" title="ìš”êµ¬ì‚¬í•­ ë¶„ì„ ë° ì„¤ê³„ì˜ ì—­ëŸ‰"></a>ìš”êµ¬ì‚¬í•­ ë¶„ì„ ë° ì„¤ê³„ì˜ ì—­ëŸ‰</h4><p>ê°œë°œ ë¦¬ë”ë¡œì¨ ê°€ì¥ ì¤‘ìš”í•œ ì—­ëŸ‰ì€ ê°œë°œíŒ€ ì¸ì›ë“¤ì´ ë³´ë‹¤ ì •í™•í•˜ê²Œ í˜¹ì€ íš¨ìœ¨ì ìœ¼ë¡œ ìš”êµ¬ì‚¬í•­ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ ìµœëŒ€í•œ ìì„¸í•˜ì„¸ ìš”êµ¬ì‚¬í•­ê³¼ ë°°ê²½ì— ëŒ€í•´ì„œ ë¶„ì„í•˜ê³  ì‘ì—…ì— ëŒ€í•œ ë°©í–¥ì„±ì„ ì„¤ê³„í•´ì•¼ í•œë‹¤. ìš”êµ¬ì‚¬í•­ì„ ì „ë‹¬í•˜ëŠ” ì…ì¥ì—ì„œ ìŠ¤ìŠ¤ë¡œ ìš”ì•½í•˜ê¸° ìœ„í•´ì„œ ìƒëµí•˜ëŠ” ë°°ê²½ìœ¼ë¡œ ì¸í•˜ì—¬ ì˜ëª»ëœ ë°©í–¥ìœ¼ë¡œ ë¶„ì„í•˜ê³  ì‹¤ë¬´ì ì…ì¥ì—ì„œëŠ” ë‹¤ì‹œ í•œë²ˆ ì²´í¬í•˜ë”ë¼ë„ ê±°ì˜ ì™„ì„±ë˜ê³  ë‚˜ì„œì•¼ ë‹¤ì‹œ ì‘ì—…í•´ì•¼í•˜ëŠ” ê²ƒì„ ì•„ëŠ” ê²½ìš°ë„ ë§ì„ ìˆ˜ ë°–ì— ì—†ë‹¤. ë¹„ë¡ ê·¸ëŸ° ì‚¬í•­ì„ ë§Œë“¤ì§€ ì•ŠëŠ” ê²ƒì´ ì¢‹ê² ì§€ë§Œ ìµœëŒ€í•œ ê·¸ëŸ¬ì§€ ì•Šë„ë¡ ìš”êµ¬ì‚¬í•­ì— ëŒ€í•´ ì˜ì‹¬í•˜ê³  ì—¬ëŸ¬ë²ˆ ì²´í¬í•˜ëŠ” ìŠµê´€ì´ í•„ìš”í•  ê²ƒ ê°™ë‹¤.</p><h4 id="ë¬¸ì„œí™”ì—-ëŒ€í•œ-ì—­ëŸ‰"><a href="#ë¬¸ì„œí™”ì—-ëŒ€í•œ-ì—­ëŸ‰" class="headerlink" title="ë¬¸ì„œí™”ì— ëŒ€í•œ ì—­ëŸ‰"></a>ë¬¸ì„œí™”ì— ëŒ€í•œ ì—­ëŸ‰</h4><p>ê·¸ë™ì•ˆ ë¬¸ì„œí™”ì— ì†Œí™€í–ˆë˜ ì¡°ì§ì—ì„œ ì¼í•´ì™”ê¸° ë•Œë¬¸ì— ë¬¸ì„œí™”ì— ëŒ€í•œ ì¤‘ìš”ì„±ì€ ì•Œê³  ìˆì–´ë„ íšŒì‚¬ì˜ ìŠ¤íƒ€ì¼ì— ë”°ë¼ ë¬¸ì„œí™”ë‚˜ ì‘ì—… ë‚´ìš©ì— ëŒ€í•´ ì •ë¦¬í•˜ëŠ” ê²ƒì„ ìƒëµí•´ì™”ë‹¤. ì•ì„ , ìš”êµ¬ì‚¬í•­ì„ ì œëŒ€ë¡œ ë¶„ì„í•˜ê³  ì œëŒ€ë¡œ ì „ë‹¬í•˜ê¸° ìœ„í•´ì„œëŠ” ë¬¸ì„œí™”ì— ëŒ€í•œ ì—­ëŸ‰ì„ í‚¤ì›Œì•¼ë§Œ í•œë‹¤. í‰ì†Œì— ë§ìˆ˜ê°€ ì ì–´ì„œ ë§í•˜ê³ ì í•˜ëŠ” ë‚´ìš©ì„ ì „ë‹¬í•˜ê¸°ë„ ì–´ë ¤ì›Œí•˜ê¸° ë•Œë¬¸ì— ì œëŒ€ë¡œ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ì´ ë˜ê¸° ìœ„í•´ì„œëŠ” ì •í™•í•œ ë¬¸ì„œë¥¼ ì „ë‹¬í•  í•„ìš”ê°€ ìˆê¸° ë•Œë¬¸ì´ë‹¤. ë¬¸ì„œí™”ì— ëŒ€í•œ ì—­ëŸ‰ì„ ë” í–¥ìƒì‹œí‚¤ê¸° ìœ„í•´ì„œ ê°œì¸ ë¸”ë¡œê·¸ì— ê¸€ì„ ì¨ì„œ ë‚˜ì˜ ìƒê°ì„ ì •ë¦¬í•˜ëŠ” ê²ƒì„ ì§€ì†ì ìœ¼ë¡œ ìœ ì§€í•´ì•¼í•  ê²ƒ ê°™ë‹¤.</p><h4 id="ê¸°ë³¸-ì§€ì‹ì—-ëŒ€í•œ-ì—­ëŸ‰"><a href="#ê¸°ë³¸-ì§€ì‹ì—-ëŒ€í•œ-ì—­ëŸ‰" class="headerlink" title="ê¸°ë³¸ ì§€ì‹ì— ëŒ€í•œ ì—­ëŸ‰"></a>ê¸°ë³¸ ì§€ì‹ì— ëŒ€í•œ ì—­ëŸ‰</h4><p>í˜„ì¬ ì‚¬ìš©ì¤‘ì¸ ê¸°ìˆ ì— ëŒ€í•´ì„œëŠ” ì½”ë“œë¥¼ ì´í•´í•˜ê³  ìˆ˜ì •í•  ìˆ˜ ìˆì„ ì •ë„ì˜ ì§€ì‹ì´ í•„ìš”í•˜ê³  ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ê¸°ìˆ ì„ ì„ íƒí•˜ê¸° ìœ„í•´ì„œ ì¡°ì§ì—ì„œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê¸°ìˆ ì´ë¼ê³  í•˜ë”ë¼ë„ í‰ì†Œì— ê¸°ìˆ  êµ¬í˜„ì— ëŒ€í•´ í•™ìŠµí•´ì•¼í•œë‹¤. ë” ë‚˜ì•„ê°€ì„œëŠ” í•´ë‹¹ ê¸°ìˆ ì—ì„œ í•„ìš”í•œ ê¸°ë³¸ ì§€ì‹ì— ëŒ€í•´ì„œ ê¹Šì´ ì‚´í´ë³´ëŠ” ê²ƒë„ í•„ìš”í•˜ë‹¤. í˜„ì¬ ê¸°ì¤€ì—ì„œ ì í•©í•œ ë” ë‚˜ì€ ë°©ë²•ì„ ì°¾ìœ¼ë ¤ê³  ë…¸ë ¥í•´ì•¼í•˜ê¸° ë•Œë¬¸ì´ë‹¤. </p><h4 id="í…ŒìŠ¤íŠ¸ì—-ëŒ€í•œ-ì—­ëŸ‰"><a href="#í…ŒìŠ¤íŠ¸ì—-ëŒ€í•œ-ì—­ëŸ‰" class="headerlink" title="í…ŒìŠ¤íŠ¸ì— ëŒ€í•œ ì—­ëŸ‰"></a>í…ŒìŠ¤íŠ¸ì— ëŒ€í•œ ì—­ëŸ‰</h4><p>í˜„ì¬ ì¡°ì§ì€ ì „ë°˜ì ì¸ í…ŒìŠ¤íŠ¸ëŠ” QA ì—”ì§€ë‹ˆì–´ì˜ ì—­í• ì´ë¼ê³  ìƒê°í•˜ê³  ìˆì§€ë§Œ ìµœì†Œí•œì˜ í…ŒìŠ¤íŠ¸ëŠ” ê°œë°œìì— ëŒ€í•œ ì—­ëŸ‰ì´ë¼ê³  ìƒê°ëœë‹¤. í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ì„ ê°•ì œí•˜ì§€ ì•ŠëŠ” ì¡°ì§ì´ê¸° ë•Œë¬¸ì— í…ŒìŠ¤íŠ¸ì— ëŒ€í•œ ì—­ëŸ‰ì€ ê°œë°œì ìŠ¤ìŠ¤ë¡œ ìŒ“ê³  ìŠµê´€í™”í•´ì•¼ë§Œ í•œë‹¤. ë˜í•œ, í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ë‹¤ë³´ë©´ ë‹¹ì¥ í…ŒìŠ¤íŠ¸í•˜ëŠ” ì¡°ê±´ì„ í†µê³¼í•˜ê¸° ìœ„í•œ ë¡œì§ì— ëŒ€í•´ì„œë§Œ ê²€ì¦í•˜ê³  ë„˜ì–´ê°€ëŠ” ê²½ìš°ê°€ ë§ì€ ê²ƒ ê°™ë‹¤. ê·¸ë¦¬ê³  ëª¨ë“  ê²ƒì— ëŒ€í•´ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ì§€ ì•Šê²Œ ë˜ë¯€ë¡œ ë•Œë¡œëŠ” ê°„ë‹¨í•œ ìˆ˜ì •ì˜ ê²½ìš° ë³„ë‹¤ë¥¸ ì˜í–¥ë„ ì²´í¬ê°€ ë°œìƒí•˜ì§€ ì•Šì„ ê²ƒì´ë¼ ê°€ì •í•˜ê³  ë°˜ì˜í•˜ê²Œ ëœë‹¤.</p><p>ì‹ ì… ê°œë°œìì˜ ì¸í„°ë·° ê³¼ì •ì—ì„œ ê¸°ë³¸ ì§€ì‹ì— ëŒ€í•´ì„œ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ì—¬ ì²´í¬í•˜ê²Œ ë˜ëŠ” ê²ƒì²˜ëŸ¼ ì£¼ë‹ˆì–´ ê°œë°œìì—ì„œ ì‹œë‹ˆì–´ ê°œë°œìë¡œ ì„±ì¥í•˜ë©´ì„œ ê·¸ë™ì•ˆ ì•Œê³  ìˆë˜ ê¸°ë³¸ ì§€ì‹ì„ ë” ê¹Šê²Œ ë˜ëŒì•„ë³´ëŠ” ê²ƒì´ í•„ìš”í•˜ë‹¤ê³  ëŠë‚€ë‹¤. ì´ê²ƒì€ ì£¼ë‹ˆì–´ ê°œë°œìë“¤ì´ ì‘ì„±í•œ ì½”ë“œë¥¼ ë¦¬ë·°í•˜ë©´ì„œ ë‹¤ì–‘í•œ ê´€ì ì—ì„œ ë°”ë¼ë³´ê³  ì˜ê²¬ì„ ì œì‹œí•˜ê²Œ ë˜ë©´ì„œ ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°í•˜ê³  ìˆë‹¤. ê²°êµ­ ì œëŒ€ë¡œ ë¦¬ë·°í•  ìˆ˜ ìˆëŠ” ë¦¬ë·°ì–´ê°€ ë˜ê¸° ìœ„í•´ì„œëŠ” ê°œë°œ ì—­ëŸ‰ ë¿ë§Œ ì•„ë‹ˆë¼ ë‹¤ì–‘í•œ ì—­ëŸ‰ì„ ì±„ì›Œì•¼í•˜ëŠ” ê²ƒ ê°™ë‹¤.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ì˜¤ëŠ˜ì€ íšŒì‚¬ì—ì„œ êµ¬ë§¤ ì‹ ì²­í•œ ìµœë²”ê· ë‹˜ì´ ê¸€ì„ ì“°ì‹  &lt;code&gt;ìœ¡ê°í˜• ê°œë°œì&lt;/code&gt;ë¼ëŠ” ì±…ì„ ì½ì–´ë³´ì•˜ë‹¤. ì´ì œëŠ” ì‹œë‹ˆì–´ ê°œë°œìë¡œì„œì˜ ì—­ëŸ‰ì„ ì„±ì¥ì‹œì¼œì•¼í•˜ëŠ” ë¦¬ë”ë¡œì¨ì˜ ì—­í• ì„ ìˆ˜í–‰í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ì¢‹ì€ ì‹œë‹ˆì–´ ê°œë°œìê°€ ê°€ì§€ëŠ” ì—­ëŸ‰ì— ëŒ€í•´ì„œ ìŠ¤ìŠ¤ë¡œ</summary>
      
    
    
    
    
    <category term="ì‹œë‹ˆì–´ ê°œë°œì" scheme="https://kdevkr.github.io/tags/%EC%8B%9C%EB%8B%88%EC%96%B4-%EA%B0%9C%EB%B0%9C%EC%9E%90/"/>
    
    <category term="ìœ¡ê°í˜• ê°œë°œì" scheme="https://kdevkr.github.io/tags/%EC%9C%A1%EA%B0%81%ED%98%95-%EA%B0%9C%EB%B0%9C%EC%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>EdDSA</title>
    <link href="https://kdevkr.github.io/eddsa/"/>
    <id>https://kdevkr.github.io/eddsa/</id>
    <published>2023-07-31T09:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.886Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://datatracker.ietf.org/doc/html/rfc8032">EdDSA(Edwards-curve Digital Signature Algorithm)</a>ëŠ” <code>Edwards-Curve</code> ê³¡ì„ ì— ì˜í•œ ì „ì ì„œëª… ì•Œê³ ë¦¬ì¦˜ì„ ì˜ë¯¸í•œë‹¤. ê³¼ê±°ì— <a href="/ed25519">ED25519</a>ì— ëŒ€í•´ì„œ ì •ë¦¬í•œ ê²ƒê³¼ ê°™ì´ ECDSAì™€ í˜¼ë™ì´ ë  ìˆ˜ ìˆë‹¤. <a href="https://datatracker.ietf.org/doc/html/rfc8410">RFC8410</a>ì—ì„œëŠ” Internet X.509 Public Key Infrastructure ì—ì„œ Ed25519ê³¼ ê°™ì€ Algorithm Identifiersì— ëŒ€í•œ í‘œì¤€ì„ ì„¤ëª…í•˜ê³  ìˆë‹¤.</p><h4 id="Curve25519-and-Curve448-Algorithm-Identifiers"><a href="#Curve25519-and-Curve448-Algorithm-Identifiers" class="headerlink" title="Curve25519 and Curve448 Algorithm Identifiers"></a>Curve25519 and Curve448 Algorithm Identifiers</h4><p>BC(Bouncy Castle)ì˜ <code>ECNamedCurveTable.getNames()</code>ì—ëŠ” ê¸°ë³¸ì ì¸ EC ê³¡ì„ ì´ í¬í•¨ë˜ì–´ìˆê³  <code>curve25519</code>ëŠ” CustomNamedCurvesì— í¬í•¨ë˜ì–´ ìˆì–´ Curve25519 ê³¡ì„ ì— ëŒ€í•œ X9ECParametersë¥¼ ì•„ë˜ì™€ ê°™ì´ ECParameterSpecìœ¼ë¡œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">AlgorithmParameterSpec</span> <span class="token function">curve25519Spec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// NOTE: Ed25519 not contains in ECNamedCurveTable.getNames()</span>    <span class="token class-name">X9ECParameters</span> ecP <span class="token operator">=</span> <span class="token class-name">CustomNamedCurves</span><span class="token punctuation">.</span><span class="token function">getByName</span><span class="token punctuation">(</span><span class="token string">"curve25519"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ECParameterSpec</span><span class="token punctuation">(</span>ecP<span class="token punctuation">.</span><span class="token function">getCurve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ecP<span class="token punctuation">.</span><span class="token function">getG</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ecP<span class="token punctuation">.</span><span class="token function">getN</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ecP<span class="token punctuation">.</span><span class="token function">getH</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ecP<span class="token punctuation">.</span><span class="token function">getSeed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="Ed25519-í‚¤-í˜ì–´-ìƒì„±"><a href="#Ed25519-í‚¤-í˜ì–´-ìƒì„±" class="headerlink" title="Ed25519 í‚¤ í˜ì–´ ìƒì„±"></a>Ed25519 í‚¤ í˜ì–´ ìƒì„±</h4><p><code>Ed25519KeyPairGenerator</code>ì™€ í•¨ê»˜ <code>ECKeyGenerationParameters</code>ë¥¼ ì‚¬ìš©í•˜ë©´ Ed25519 í‚¤ í˜ì–´ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ°ë° ì´ë¯¸ Ed25519KeyGenerationParametersë¥¼ ì œê³µí•˜ê³  ìˆìœ¼ë¯€ë¡œ êµ³ì´ ECParameterSpecë¥¼ ì‚¬ìš©í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•  í•„ìš”ê°€ ì—†ë‹¤. ë§Œì•½, êµ³ì´ ECParameterSpecìœ¼ë¡œ ECKeyGenerationParametersë¥¼ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•˜ê³  ì‹¶ì€ ì‚¬ëŒë“¤ì„ ìœ„í•´ ì˜ˆì œ ì½”ë“œë¥¼ ì²¨ë¶€í•œë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">void</span> <span class="token class-name">TestKeyPairUsingEd25519Generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Ed25519KeyPairGenerator</span> keyPairGenerator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Ed25519KeyPairGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    keyPairGenerator<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Ed25519KeyGenerationParameters</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">AsymmetricCipherKeyPair</span> keyPair <span class="token operator">=</span> keyPairGenerator<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Test</span><span class="token keyword">void</span> <span class="token class-name">TestKeyPairUsingECParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">ECParameterSpec</span> curve25519Spec <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ECParameterSpec</span><span class="token punctuation">)</span> <span class="token function">curve25519Spec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">ECDomainParameters</span> ecParams <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ECDomainParameters</span><span class="token punctuation">(</span>curve25519Spec<span class="token punctuation">.</span><span class="token function">getCurve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> curve25519Spec<span class="token punctuation">.</span><span class="token function">getG</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> curve25519Spec<span class="token punctuation">.</span><span class="token function">getN</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> curve25519Spec<span class="token punctuation">.</span><span class="token function">getH</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">ECKeyGenerationParameters</span> ecKeyGenerationParameters <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ECKeyGenerationParameters</span><span class="token punctuation">(</span>ecParams<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Ed25519KeyPairGenerator</span> keyPairGenerator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Ed25519KeyPairGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    keyPairGenerator<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>ecKeyGenerationParameters<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">AsymmetricCipherKeyPair</span> keyPair <span class="token operator">=</span> keyPairGenerator<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="Ed25519PrivateKeyParametersë¥¼-PrivateKeyë¡œ-ë³€í™˜"><a href="#Ed25519PrivateKeyParametersë¥¼-PrivateKeyë¡œ-ë³€í™˜" class="headerlink" title="Ed25519PrivateKeyParametersë¥¼ PrivateKeyë¡œ ë³€í™˜"></a>Ed25519PrivateKeyParametersë¥¼ PrivateKeyë¡œ ë³€í™˜</h4><p>í´ë¼ì´ì–¸íŠ¸ì˜ X.509 ì¸ì¦ì„œë¥¼ ë§Œë“œëŠ” ê²½ìš° ì„œëª…ì„ ìœ„í•œ PrivateKeyê°€ í•„ìš”í•œë° ì§ì ‘ì ìœ¼ë¡œ ë³€í™˜í•  ìˆ˜ê°€ ì—†ìœ¼ë¯€ë¡œ <code>KeyFactorySpi.Ed25519</code>ì™€ <code>PrivateKeyInfoFactory</code>ë¥¼ ì‚¬ìš©í•´ì„œ Ed25519PrivateKeyParametersë¡œ ë˜ì–´ìˆëŠ” ë¹„ë°€í‚¤ë¥¼ PrivateKey í´ë˜ìŠ¤ë¡œ ë³€ê²½í•´ì•¼ í•œë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">// NOTE: AsymmetricCipherKeyPair keyPair</span><span class="token class-name">Ed25519PrivateKeyParameters</span> privateKeyP <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Ed25519PrivateKeyParameters</span><span class="token punctuation">)</span> keyPair<span class="token punctuation">.</span><span class="token function">getPrivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KeyFactorySpi<span class="token punctuation">.</span>Ed25519</span> keyFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KeyFactorySpi<span class="token punctuation">.</span>Ed25519</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">PrivateKey</span> privateKey <span class="token operator">=</span> keyFactory<span class="token punctuation">.</span><span class="token function">generatePrivate</span><span class="token punctuation">(</span><span class="token class-name">PrivateKeyInfoFactory</span><span class="token punctuation">.</span><span class="token function">createPrivateKeyInfo</span><span class="token punctuation">(</span>privateKeyP<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="ê³µê°œí‚¤ë¥¼-SubjectPublicKeyInfoFactoryë¡œ-ë³€í™˜"><a href="#ê³µê°œí‚¤ë¥¼-SubjectPublicKeyInfoFactoryë¡œ-ë³€í™˜" class="headerlink" title="ê³µê°œí‚¤ë¥¼ SubjectPublicKeyInfoFactoryë¡œ ë³€í™˜"></a>ê³µê°œí‚¤ë¥¼ SubjectPublicKeyInfoFactoryë¡œ ë³€í™˜</h4><p>Ed25519PublicKeyParametersë¡œ ë˜ì–´ìˆëŠ” ê³µê°œí‚¤ë¥¼ SubjectPublicKeyInfoë¡œ ë³€í™˜í•˜ëŠ” ê²ƒì€ <code>SubjectPublicKeyInfoFactory</code> í´ë˜ìŠ¤ì—ì„œ ì œê³µí•˜ê³  ìˆë‹¤. ì•ì„œ ë¹„ë°€í‚¤ì²˜ëŸ¼ KeyFactorySpi.Ed25519ë¥¼ ì‚¬ìš©í•´ì„œ PublicKeyë¡œ ë³€í™˜í•  í•„ìš”ëŠ” ì—†ì„ ê²ƒ ê°™ë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">// NOTE: AsymmetricCipherKeyPair keyPair</span><span class="token class-name">Ed25519PublicKeyParameters</span> publicKeyP <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Ed25519PublicKeyParameters</span><span class="token punctuation">)</span> keyPair<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">SubjectPublicKeyInfo</span> publicKeyInfo <span class="token operator">=</span> <span class="token class-name">SubjectPublicKeyInfoFactory</span><span class="token punctuation">.</span><span class="token function">createSubjectPublicKeyInfo</span><span class="token punctuation">(</span>publicKeyP<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="EdDSA-Signatures"><a href="#EdDSA-Signatures" class="headerlink" title="EdDSA Signatures"></a>EdDSA Signatures</h4><p>Curve25519ì™€ Curve448ë¥¼ ì‚¬ìš©í•œ EdDSAëŠ” ê°ê° <code>Ed25519</code>ì™€ <code>Ed448</code> ì´ë¼ëŠ” ì„œëª… ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ í‘œí˜„í•œë‹¤. ì•ì„œ, PrivateKeyì™€ SubjectPublickKeyInfoë¡œ ë³€í™˜í•œ ìƒíƒœì´ë¯€ë¡œ X.509 ì¸ì¦ì„œë¥¼ ë§Œë“œëŠ” ê²ƒì€ ì–´ë µì§€ ì•Šì„ ê²ƒì´ë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">X500Name</span> issuer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X500Name</span><span class="token punctuation">(</span><span class="token string">"CN=Mambo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">BigInteger</span> serialNumber <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">ZonedDateTime</span> now <span class="token operator">=</span> <span class="token class-name">ZonedDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Date</span> notBefore <span class="token operator">=</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>now<span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Date</span> notAfter <span class="token operator">=</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>now<span class="token punctuation">.</span><span class="token function">plus</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span><span class="token constant">YEARS</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">ContentSigner</span> contentSigner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JcaContentSignerBuilder</span><span class="token punctuation">(</span><span class="token string">"Ed25519"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setProvider</span><span class="token punctuation">(</span><span class="token class-name">BouncyCastleProvider</span><span class="token punctuation">.</span><span class="token constant">PROVIDER_NAME</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>privateKey<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">X509CertificateHolder</span> certificateHolder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JcaX509v3CertificateBuilder</span><span class="token punctuation">(</span>issuer<span class="token punctuation">,</span> serialNumber<span class="token punctuation">,</span> notBefore<span class="token punctuation">,</span> notAfter<span class="token punctuation">,</span> issuer<span class="token punctuation">,</span> publicKeyInfo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>contentSigner<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">X509Certificate</span> certificate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JcaX509CertificateConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setProvider</span><span class="token punctuation">(</span><span class="token class-name">BouncyCastleProvider</span><span class="token punctuation">.</span><span class="token constant">PROVIDER_NAME</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCertificate</span><span class="token punctuation">(</span>certificateHolder<span class="token punctuation">)</span><span class="token punctuation">;</span>certificate<span class="token punctuation">.</span><span class="token function">checkValidity</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="KeyPairGeneratorSpië¡œ-Ed25519-í‚¤-í˜ì–´-ìƒì„±"><a href="#KeyPairGeneratorSpië¡œ-Ed25519-í‚¤-í˜ì–´-ìƒì„±" class="headerlink" title="KeyPairGeneratorSpië¡œ Ed25519 í‚¤ í˜ì–´ ìƒì„±"></a>KeyPairGeneratorSpië¡œ Ed25519 í‚¤ í˜ì–´ ìƒì„±</h4><p>ì‚¬ì‹¤ì€ BCì—ì„œ KeyPairGeneratorSpië¥¼ ì œê³µí•˜ê³  ìˆìœ¼ë¯€ë¡œ ì•„ë˜ì™€ ê°™ì´ <code>BCEdDSAPrivateKey</code>ì™€ <code>BCEdDSAPublicKey</code>ë¥¼ ê°€ì§€ëŠ” í‚¤ í˜ì–´ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">KeyPairGenerator</span> keyPairGenerator <span class="token operator">=</span> <span class="token class-name">KeyPairGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"Ed25519"</span><span class="token punctuation">,</span> <span class="token class-name">BouncyCastleProvider</span><span class="token punctuation">.</span><span class="token constant">PROVIDER_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KeyPair</span> keyPair <span class="token operator">=</span> keyPairGenerator<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ë” ìì„¸í•œ ì½”ë“œëŠ” <a href="https://github.com/kdevkr/spring-boot-security/blob/main/src/test/java/com/example/demo/x509/EdDSATest.java">EdDSATest.java</a>ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc8032&quot;&gt;EdDSA(Edwards-curve Digital Signature Algorithm)&lt;/a&gt;ëŠ” &lt;code&gt;Edwards-Curve&lt;/code&gt; </summary>
      
    
    
    
    
    <category term="Ed25519" scheme="https://kdevkr.github.io/tags/Ed25519/"/>
    
    <category term="RFC8410" scheme="https://kdevkr.github.io/tags/RFC8410/"/>
    
  </entry>
  
  <entry>
    <title>BouncyCastle Javaë¡œ X.509 ì¸ì¦ì„œ ë§Œë“¤ê¸°</title>
    <link href="https://kdevkr.github.io/bouncycastle-java/"/>
    <id>https://kdevkr.github.io/bouncycastle-java/</id>
    <published>2023-07-30T05:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.886Z</updated>
    
    <content type="html"><![CDATA[<p>ìë°”ì—ì„œ ì•”í˜¸í™” ë˜ëŠ” ì „ìì„œëª…ì„ ìœ„í•œ ê¸°ëŠ¥ì„ JCAë¥¼ í†µí•´ ì œê³µí•˜ê¸°ëŠ” í•˜ì§€ë§Œ ì‹¤ì§ˆì ìœ¼ë¡œëŠ” <a href="https://github.com/bcgit/bc-java">Bouncy Castle</a>ì´ë¼ëŠ” ì•”í˜¸ ê´€ë ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•œë‹¤. ë³¸ ê¸€ì—ì„œëŠ” BouncyCastleì—ì„œ ì œê³µí•˜ëŠ” ì—¬ëŸ¬ í´ë˜ìŠ¤ë“¤ì„ í™œìš©í•´ì„œ ì‚¬ì„¤ ë£¨íŠ¸ ì¸ì¦ì„œë¥¼ ë§Œë“¤ê³  ê·¸ê²ƒì„ ê¸°ë°˜ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ë¥¼ ìœ„í•œ X.509 ì¸ì¦ì„œë¥¼ ë°œê¸‰í•˜ê¸° ìœ„í•œ ë°©ë²•ì„ ì •ë¦¬í•˜ê³ ì í•œë‹¤. ì´ë ‡ê²Œ ë§Œë“¤ì–´ì§€ëŠ” X.509 ì¸ì¦ì„œëŠ” ë³´ì•ˆ ë ˆë²¨ì´ ë†’ì€ ì‹œìŠ¤í…œì—ì„œ Mutual TLS ì¸ì¦ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.</p><pre class="language-groovy" data-language="groovy"><div class="caption"><span>build.gradle</span></div><code class="language-groovy">dependencies <span class="token punctuation">&#123;</span>    implementation <span class="token string">'org.bouncycastle:bcprov-jdk18on:1.75'</span>    implementation <span class="token string">'org.bouncycastle:bcpkix-jdk18on:1.75'</span><span class="token punctuation">&#125;</span></code></pre><blockquote><p>X.509 ì¸ì¦ì„œì— ëŒ€í•œ í‘œì¤€ì€ <a href="https://datatracker.ietf.org/doc/html/rfc5280">RFC5280</a>ë¡œ ì •ì˜ë˜ì–´ ìˆê³  ASN.1 í‘œê¸°ë¥¼ ë”°ë¥´ë©° ì§€ê¸ˆì€ X.509 v3ì„ ì‚¬ìš©í•˜ê³  ìˆë‹¤.</p></blockquote><h4 id="BouncyCastleProvider"><a href="#BouncyCastleProvider" class="headerlink" title="BouncyCastleProvider"></a>BouncyCastleProvider</h4><p>BouncyCastle ìë°” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í´ë˜ìŠ¤ íŒ¨ìŠ¤ì— ì¶”ê°€í–ˆë”ë¼ë„ BouncyCastleProviderë¥¼ JCE Providerë¡œ ì¶”ê°€í•´ì•¼í•œë‹¤. <code>$JAVA_HOME/lib/security/java.security</code>ì— ëª…ì‹œí•´ë„ ë˜ì§€ë§Œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì„±í•˜ëŠ” í´ë˜ìŠ¤ì—ì„œ ëŸ°íƒ€ì„ ì‹œì ì— BouncyCastleProviderë¥¼ ë³´ì•ˆ í”„ë¡œë°”ì´ë”ì— ì¶”ê°€í•´ë„ ëœë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">Security</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>bouncycastle<span class="token punctuation">.</span>jce<span class="token punctuation">.</span>provider<span class="token punctuation">.</span></span><span class="token class-name">BouncyCastleProvider</span></span><span class="token punctuation">;</span> <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Security</span><span class="token punctuation">.</span><span class="token function">addProvider</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BouncyCastleProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="Self-signed-CA-ì¸ì¦ì„œ-ë°œê¸‰í•˜ê¸°"><a href="#Self-signed-CA-ì¸ì¦ì„œ-ë°œê¸‰í•˜ê¸°" class="headerlink" title="Self signed CA ì¸ì¦ì„œ ë°œê¸‰í•˜ê¸°"></a>Self signed CA ì¸ì¦ì„œ ë°œê¸‰í•˜ê¸°</h4><p>ì¼ë°˜ì ìœ¼ë¡œ X.509 ì¸ì¦ì„œë¥¼ ë°œê¸‰í•˜ëŠ” ê²½ìš° openssl ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•´ì„œ í‚¤ í˜ì–´ë¥¼ ìƒì„±í•˜ê³  ê·¸ê²ƒì„ ê¸°ë°˜ìœ¼ë¡œ CSRê³¼ X.509 ì¸ì¦ì„œë¥¼ ìƒì„±í•  ê²ƒì´ë‹¤. Bouncy Castle ìë°” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥´ë¥¼ í†µí•´ ë§Œë“œë ¤ëŠ” ê²½ìš° Deprecated ì„ ì–¸ëœ X509V3CertificateGeneratorë¥¼ ì‚¬ìš©í•´ë„ ë¬´ë°©í•  ê²ƒ ê°™ì§€ë§Œ X509v3CertificateBuilderë¥¼ ì‚¬ìš©í•´ì„œ X509Certificateë¥¼ ë§Œë“¤ì–´ë³´ë ¤ê³  í•œë‹¤.</p><blockquote><p>X509V3CertificateGeneratorì— ëŒ€í•´ì„œ Deprecated ì²˜ë¦¬í•œ ì‚¬ìœ ëŠ” ë”±íˆ ì•Œ ìˆ˜ ì—†ëŠ” ê²ƒ ê°™ë‹¤. </p></blockquote><p>JcaX509v3CertificateBuilderì™€ JcaContentSignerBuilderë¥¼ ì‚¬ìš©í•´ì„œ X509CertificateHolderë¥¼ ìƒì„±í•˜ê³  JcaX509CertificateConverterë¥¼ ì´ìš©í•˜ì—¬ X509Certificateë¡œ ë³€í™˜í•  ìˆ˜ ìˆë‹¤. ëŒ€ëµì ì¸ ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ìœ¼ë‹ˆ ì°¸ê³ í•´ë³´ë„ë¡ í•˜ì.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> securityProvider <span class="token operator">=</span> <span class="token class-name">BouncyCastleProvider</span><span class="token punctuation">.</span><span class="token constant">PROVIDER_NAME</span><span class="token punctuation">;</span><span class="token class-name">JcaX509ExtensionUtils</span> x509ExtensionUtils <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JcaX509ExtensionUtils</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">JcaX509CertificateConverter</span> x509CertificateConverter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JcaX509CertificateConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setProvider</span><span class="token punctuation">(</span>securityProvider<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> signatureAlgorithm <span class="token operator">=</span> <span class="token string">"sha256WithRSA"</span><span class="token punctuation">;</span><span class="token class-name">KeyPairGenerator</span> keyPairGenerator <span class="token operator">=</span> <span class="token class-name">KeyPairGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"RSA"</span><span class="token punctuation">,</span> securityProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>keyPairGenerator<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KeyPair</span> rootKeyPair <span class="token operator">=</span> keyPairGenerator<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">X500Name</span> issuer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X500NameBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">addRDN</span><span class="token punctuation">(</span><span class="token class-name">BCStyle</span><span class="token punctuation">.</span><span class="token constant">CN</span><span class="token punctuation">,</span> <span class="token string">"Mambo Org"</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">BigInteger</span> serialNumber <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">ZonedDateTime</span> now <span class="token operator">=</span> <span class="token class-name">ZonedDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Date</span> notBefore <span class="token operator">=</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>now<span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Date</span> notAfter <span class="token operator">=</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>now<span class="token punctuation">.</span><span class="token function">plus</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span><span class="token constant">YEARS</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">SubjectPublicKeyInfo</span> publicKeyInfo <span class="token operator">=</span> <span class="token class-name">SubjectPublicKeyInfo</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>rootKeyPair<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">X509CertificateHolder</span> rootCertHolder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JcaX509v3CertificateBuilder</span><span class="token punctuation">(</span>issuer<span class="token punctuation">,</span> serialNumber<span class="token punctuation">,</span> notBefore<span class="token punctuation">,</span> notAfter<span class="token punctuation">,</span> issuer<span class="token punctuation">,</span> publicKeyInfo<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">addExtension</span><span class="token punctuation">(</span><span class="token class-name">Extension</span><span class="token punctuation">.</span>basicConstraints<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BasicConstraints</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">addExtension</span><span class="token punctuation">(</span><span class="token class-name">Extension</span><span class="token punctuation">.</span>subjectKeyIdentifier<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> x509ExtensionUtils<span class="token punctuation">.</span><span class="token function">createSubjectKeyIdentifier</span><span class="token punctuation">(</span>rootKeyPair<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JcaContentSignerBuilder</span><span class="token punctuation">(</span>signatureAlgorithm<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>rootKeyPair<span class="token punctuation">.</span><span class="token function">getPrivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">X509Certificate</span> rootCert <span class="token operator">=</span> x509CertificateConverter<span class="token punctuation">.</span><span class="token function">getCertificate</span><span class="token punctuation">(</span>rootCertHolder<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h5 id="X500Name"><a href="#X500Name" class="headerlink" title="X500Name"></a>X500Name</h5><p>ìë°”ì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µí•˜ëŠ” X500Principal ëŒ€ì‹ ì— BouncyCastleì˜ X500Name í´ë˜ìŠ¤ë¡œ FQDN, ë°œê¸‰ìì™€ ì†Œìœ ìì™€ ê°™ì€ ì£¼ì²´(Subject) ì •ë³´ë¥¼ ê¸°ì…í•  ìˆ˜ ìˆë‹¤. ë˜í•œ, RDN(Relative Distinguished Names) ë¼ê³ ë„ í•˜ëŠ”ë° X500NameBuilderì—ì„œëŠ” addRDN ì´ë¼ëŠ” í•¨ìˆ˜ë¥¼ ì œê³µí•œë‹¤. ë” ìì„¸í•œ ë‚´ìš©ì€ <a href="https://knowledge.digicert.com/generalinformation/INFO1745.html">What is a Distinguished Name (DN)?</a>ë¥¼ ì°¸ê³ í•´ë³´ì.</p><h5 id="SubjectPublickeyInfo"><a href="#SubjectPublickeyInfo" class="headerlink" title="SubjectPublickeyInfo"></a>SubjectPublickeyInfo</h5><p>X.509 ì¸ì¦ì„œì— í¬í•¨ë˜ëŠ” SubjectPublickeyInfoì— ëŒ€í•œ í´ë˜ìŠ¤ë¡œ DER ì¸ì½”ë”©ëœ ê³µê°œí‚¤ë¥¼ ì˜ë¯¸í•œë‹¤. </p><h5 id="BasicConstraints"><a href="#BasicConstraints" class="headerlink" title="BasicConstraints"></a>BasicConstraints</h5><p>ë‹¤ë¥¸ ì¸ì¦ì„œë¥¼ ë°œê¸‰í•  ê¶Œí•œì´ ìˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê²ƒìœ¼ë¡œ CA ì¸ì¦ì„œë¼ëŠ” ê²ƒì„ ì˜ë¯¸ë¡œ ë¶€ì—¬í•  ìˆ˜ ìˆë‹¤.</p><h4 id="X-509-í´ë¼ì´ì–¸íŠ¸-ì¸ì¦ì„œ-ë°œê¸‰í•˜ê¸°"><a href="#X-509-í´ë¼ì´ì–¸íŠ¸-ì¸ì¦ì„œ-ë°œê¸‰í•˜ê¸°" class="headerlink" title="X.509 í´ë¼ì´ì–¸íŠ¸ ì¸ì¦ì„œ ë°œê¸‰í•˜ê¸°"></a>X.509 í´ë¼ì´ì–¸íŠ¸ ì¸ì¦ì„œ ë°œê¸‰í•˜ê¸°</h4><p>ì•ì„œ ë£¨íŠ¸ CA ì¸ì¦ì„œ ë°œê¸‰ì„ ì´í•´í•˜ì˜€ë‹¤ë©´ CA ì¸ì¦ì„œë¥¼ ë§Œë“œëŠ”ë° ì‚¬ìš©ëœ ë¹„ë°€í‚¤ë¥¼ ì‚¬ìš©í•´ì„œ í´ë¼ì´ì–¸íŠ¸ë¥¼ ìœ„í•œ X.509 ì¸ì¦ì„œë¥¼ ë§Œë“œëŠ” ê²ƒì„ ì•Œì•„ë³´ë„ë¡ í•˜ì. </p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">KeyPair</span> clientKeyPair <span class="token operator">=</span> keyPairGenerator<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">X500Name</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X500NameBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">addRDN</span><span class="token punctuation">(</span><span class="token class-name">BCStyle</span><span class="token punctuation">.</span><span class="token constant">CN</span><span class="token punctuation">,</span> <span class="token string">"Mambo"</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">BigInteger</span> clientSN <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">ZonedDateTime</span> clientNow <span class="token operator">=</span> <span class="token class-name">ZonedDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Date</span> clientNotBefore <span class="token operator">=</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>clientNow<span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Date</span> clientNotAfter <span class="token operator">=</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>clientNow<span class="token punctuation">.</span><span class="token function">plus</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span><span class="token constant">YEARS</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">SubjectPublicKeyInfo</span> clientPublicKeyInfo <span class="token operator">=</span> <span class="token class-name">SubjectPublicKeyInfo</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>clientKeyPair<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">X509CertificateHolder</span> clientCertHolder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JcaX509v3CertificateBuilder</span><span class="token punctuation">(</span>issuer<span class="token punctuation">,</span> clientSN<span class="token punctuation">,</span> clientNotBefore<span class="token punctuation">,</span> clientNotAfter<span class="token punctuation">,</span> client<span class="token punctuation">,</span> clientPublicKeyInfo<span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">addExtension</span><span class="token punctuation">(</span><span class="token class-name">Extension</span><span class="token punctuation">.</span>basicConstraints<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BasicConstraints</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">addExtension</span><span class="token punctuation">(</span><span class="token class-name">Extension</span><span class="token punctuation">.</span>authorityKeyIdentifier<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> x509ExtensionUtils<span class="token punctuation">.</span><span class="token function">createAuthorityKeyIdentifier</span><span class="token punctuation">(</span>rootCert<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">addExtension</span><span class="token punctuation">(</span><span class="token class-name">Extension</span><span class="token punctuation">.</span>subjectKeyIdentifier<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> x509ExtensionUtils<span class="token punctuation">.</span><span class="token function">createSubjectKeyIdentifier</span><span class="token punctuation">(</span>clientKeyPair<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">addExtension</span><span class="token punctuation">(</span><span class="token class-name">Extension</span><span class="token punctuation">.</span>keyUsage<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">KeyUsage</span><span class="token punctuation">(</span><span class="token class-name">KeyUsage</span><span class="token punctuation">.</span>digitalSignature<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JcaContentSignerBuilder</span><span class="token punctuation">(</span>signatureAlgorithm<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>rootKeyPair<span class="token punctuation">.</span><span class="token function">getPrivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">X509Certificate</span> clientCert <span class="token operator">=</span> x509CertificateConverter<span class="token punctuation">.</span><span class="token function">getCertificate</span><span class="token punctuation">(</span>clientCertHolder<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>BasicConstraintsë¡œ CAê°€ ì•„ë‹ˆë©° AuthorityKeyIdentifierë¡œ ë°œê¸‰ìì˜ ê³µê°œí‚¤ë¥¼ ì‹ë³„í•  ìˆ˜ ìˆë„ë¡ í•˜ì˜€ë‹¤. ê·¸ë¦¬ê³  KeyUsageë¡œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë°œê¸‰í•œ X.509 ì¸ì¦ì„œê°€ ì „ìì„œëª… ìš©ë„ì„ì„ í™•ì¥(Extension)ì— ëª…ì‹œí–ˆë‹¤.</p><h4 id="X509Certificate-ì¸ì¦ì„œ-ê²€ì¦í•˜ê¸°"><a href="#X509Certificate-ì¸ì¦ì„œ-ê²€ì¦í•˜ê¸°" class="headerlink" title="X509Certificate ì¸ì¦ì„œ ê²€ì¦í•˜ê¸°"></a>X509Certificate ì¸ì¦ì„œ ê²€ì¦í•˜ê¸°</h4><p>í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­ ì‹œ í¬í•¨í•´ì„œ ì „ë‹¬í•œ X.509 ì¸ì¦ì„œê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ í˜¹ì€ ì‹œìŠ¤í…œì—ì„œ ë°œê¸‰í•œ ê²ƒì¸ì§€ë¥¼ ê²€ì¦í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ë‹¤. <code>java.security.cert.X509Certificate</code> í´ë˜ìŠ¤ì—ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ êµ¬í˜„ëœ verify í•¨ìˆ˜ë¥¼ ì œê³µí•˜ê³  ìˆê¸° ë•Œë¬¸ì— ì•„ë˜ì™€ ê°™ì´ ê°„ë‹¨í•˜ê²Œ ë£¨íŠ¸ ì¸ì¦ì„œì˜ ê³µê°œí‚¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ ì¸ì¦ì„œë¥¼ ê²€ì¦í•  ìˆ˜ ìˆë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java">clientCert<span class="token punctuation">.</span><span class="token function">checkValidity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>clientCert<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>rootCert<span class="token punctuation">.</span><span class="token function">getPublicKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> securityProvider<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="X-509-ì¸ì¦ì„œ-ë°-í‚¤-í˜ì–´-ì €ì¥í•˜ê¸°"><a href="#X-509-ì¸ì¦ì„œ-ë°-í‚¤-í˜ì–´-ì €ì¥í•˜ê¸°" class="headerlink" title="X.509 ì¸ì¦ì„œ ë° í‚¤ í˜ì–´ ì €ì¥í•˜ê¸°"></a>X.509 ì¸ì¦ì„œ ë° í‚¤ í˜ì–´ ì €ì¥í•˜ê¸°</h4><p>ì¼ë°˜ì ìœ¼ë¡œ X.509 ì¸ì¦ì„œì— í¬í•¨ë˜ëŠ” ê³µê°œí‚¤ëŠ” X509EncodedSpecì— ë”°ë¼ ë°”ì´ë„ˆë¦¬ í˜•íƒœì˜ DERë¡œ ì¸ì½”ë”©ë˜ì–´ í¬í•¨ëœë‹¤. ê·¸ëŸ¬ë‚˜ X.509 ì¸ì¦ì„œì™€ í‚¤ í˜ì–´ë¥¼ êµí™˜í•  ë•Œì—ëŠ” PEM íŒŒì¼ í˜•ì‹ì„ ë§ì´ ì‚¬ìš©í•˜ëŠ” í¸ìœ¼ë¡œ BouncyCastle ìë°” ë¼ì´ë¸ŒëŸ¬ë¦¬ì— í¬í•¨ëœ  PemWriterì™€ PemObjectë¥¼ í™œìš©í•´ì„œ X.509 ì¸ì¦ì„œì™€ ë¹„ë°€í‚¤ë¥¼ PEM íŒŒì¼ë¡œ ì €ì¥í•  ìˆ˜ ìˆë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PemUtil</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">PemUtil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">toPem</span><span class="token punctuation">(</span><span class="token class-name">String</span> type<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encoded<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">StringWriter</span> writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token class-name">PemWriter</span> pemWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JcaPEMWriter</span><span class="token punctuation">(</span>writer<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            pemWriter<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PemObject</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> encoded<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            pemWriter<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> writer<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">toPem</span><span class="token punctuation">(</span><span class="token class-name">PrivateKey</span> privateKey<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>privateKey<span class="token punctuation">,</span> <span class="token string">"private key is required"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">toPem</span><span class="token punctuation">(</span><span class="token string">"PRIVATE KEY"</span><span class="token punctuation">,</span> privateKey<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">toPem</span><span class="token punctuation">(</span><span class="token class-name">X509Certificate</span> certificate<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">CertificateEncodingException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>certificate<span class="token punctuation">,</span> <span class="token string">"certificate is required"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">toPem</span><span class="token punctuation">(</span><span class="token string">"CERTIFICATE"</span><span class="token punctuation">,</span> certificate<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token class-name">String</span> rootCertPem <span class="token operator">=</span> <span class="token class-name">PemUtil</span><span class="token punctuation">.</span><span class="token function">toPem</span><span class="token punctuation">(</span>rootCert<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ca.pem</span><span class="token class-name">String</span> clientCertPem <span class="token operator">=</span> <span class="token class-name">PemUtil</span><span class="token punctuation">.</span><span class="token function">toPem</span><span class="token punctuation">(</span>clientCert<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//client.pem</span><span class="token class-name">String</span> clientPrivateKeyPem <span class="token operator">=</span> <span class="token class-name">PemUtil</span><span class="token punctuation">.</span><span class="token function">toPem</span><span class="token punctuation">(</span>clientKeyPair<span class="token punctuation">.</span><span class="token function">getPrivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//client.key</span></code></pre><blockquote><p>PEM í˜•ì‹ìœ¼ë¡œ Base64ë¡œ êµ¬ì„±ëœ ë¬¸ìì—´ì„ íŒŒì¼ë¡œ ì €ì¥í•˜ëŠ” ë°©ë²•ì€ ë³¸ ê¸€ì—ì„œ ë‹¤ë£¨ì§€ ì•ŠëŠ”ë‹¤.</p></blockquote><h4 id="X-509-ì¸ì¦ì„œ-ë°-í‚¤-í˜ì–´-ë¶ˆëŸ¬ì˜¤ê¸°"><a href="#X-509-ì¸ì¦ì„œ-ë°-í‚¤-í˜ì–´-ë¶ˆëŸ¬ì˜¤ê¸°" class="headerlink" title="X.509 ì¸ì¦ì„œ ë° í‚¤ í˜ì–´ ë¶ˆëŸ¬ì˜¤ê¸°"></a>X.509 ì¸ì¦ì„œ ë° í‚¤ í˜ì–´ ë¶ˆëŸ¬ì˜¤ê¸°</h4><p>í´ë¼ì´ì–¸íŠ¸ì˜ X.509 ì¸ì¦ì„œëŠ” ìš”ì²­ì— í¬í•¨ë˜ì–´ HttpServletRequestë¡œ ë¶€í„° ê°€ì ¸ì˜¬ ìˆ˜ ìˆì§€ë§Œ í´ë¼ì´ì–¸íŠ¸ ì¸ì¦ì„œ ê²€ì¦ì„ ìœ„í•œ CA ì¸ì¦ì„œì™€ ë¹„ë°€í‚¤ëŠ” ë³„ë„ì˜ íŒŒì¼ì´ë‚˜ ë¬¸ìì—´ë¡œë¶€í„° ë¶ˆëŸ¬ì™€ì•¼í•œë‹¤. ê³µê°œí‚¤ì™€ ë¹„ë°€í‚¤ì— ëŒ€í•´ì„œëŠ” JcaPEMKeyConverterë¥¼ ì‚¬ìš©í•´ì„œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PemUtil</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">PemUtil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">PemObject</span> <span class="token function">loadPem</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encoded<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">StringReader</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>encoded<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token class-name">PEMParser</span> pemParser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PEMParser</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> pemParser<span class="token punctuation">.</span><span class="token function">readPemObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Object</span> <span class="token function">loadObject</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encoded<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">StringReader</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>encoded<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token class-name">PEMParser</span> pemParser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PEMParser</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> pemParser<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">X509Certificate</span> <span class="token function">loadCertificate</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encoded<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">CertificateException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">PemObject</span> obj <span class="token operator">=</span> <span class="token function">loadPem</span><span class="token punctuation">(</span>encoded<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">CertificateFactory</span> factory <span class="token operator">=</span> <span class="token class-name">CertificateFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"X.509"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">X509Certificate</span><span class="token punctuation">)</span> factory<span class="token punctuation">.</span><span class="token function">generateCertificate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">PublicKey</span> <span class="token function">loadPublicKey</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encoded<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Object</span> obj <span class="token operator">=</span> <span class="token function">loadObject</span><span class="token punctuation">(</span>encoded<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">JcaPEMKeyConverter</span> converter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JcaPEMKeyConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setProvider</span><span class="token punctuation">(</span><span class="token class-name">BouncyCastleProvider</span><span class="token punctuation">.</span><span class="token constant">PROVIDER_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">SubjectPublicKeyInfo</span> publicKeyInfo <span class="token operator">=</span> <span class="token class-name">SubjectPublicKeyInfo</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> converter<span class="token punctuation">.</span><span class="token function">getPublicKey</span><span class="token punctuation">(</span>publicKeyInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">PrivateKey</span> <span class="token function">loadPrivateKey</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encoded<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Object</span> obj <span class="token operator">=</span> <span class="token function">loadObject</span><span class="token punctuation">(</span>encoded<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">JcaPEMKeyConverter</span> converter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JcaPEMKeyConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setProvider</span><span class="token punctuation">(</span><span class="token class-name">BouncyCastleProvider</span><span class="token punctuation">.</span><span class="token constant">PROVIDER_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">PrivateKeyInfo</span> privateKeyInfo <span class="token operator">=</span> <span class="token class-name">PrivateKeyInfo</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> converter<span class="token punctuation">.</span><span class="token function">getPrivateKey</span><span class="token punctuation">(</span>privateKeyInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ë³¸ ê¸€ì—ì„œ ë‹¤ë£¬ ì˜ˆì œ ì½”ë“œì— ëŒ€í•œ ë³´ë‹¤ ìì„¸í•œ ê²ƒì€ <a href="https://github.com/kdevkr/spring-boot-security/blob/main/src/test/java/com/example/demo/x509/X509Test.java">X509Test.java</a>ë¥¼ í†µí•´ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><h4 id="ì°¸ê³ -ë§í¬"><a href="#ì°¸ê³ -ë§í¬" class="headerlink" title="ì°¸ê³  ë§í¬"></a>ì°¸ê³  ë§í¬</h4><ul><li><a href="https://www.baeldung.com/java-bouncy-castle">Introduction to BouncyCastle with Java</a>  </li><li><a href="https://www.baeldung.com/java-read-pem-file-keys">How to Read PEM File to Get Public and Private Keys</a>  </li><li><a href="https://www.baeldung.com/java-rsa">RSA in Java</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ìë°”ì—ì„œ ì•”í˜¸í™” ë˜ëŠ” ì „ìì„œëª…ì„ ìœ„í•œ ê¸°ëŠ¥ì„ JCAë¥¼ í†µí•´ ì œê³µí•˜ê¸°ëŠ” í•˜ì§€ë§Œ ì‹¤ì§ˆì ìœ¼ë¡œëŠ” &lt;a href=&quot;https://github.com/bcgit/bc-java&quot;&gt;Bouncy Castle&lt;/a&gt;ì´ë¼ëŠ” ì•”í˜¸ ê´€ë ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•œë‹¤. ë³¸ ê¸€ì—</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ìŠ¤í”„ë§ ë°±ì—”ë“œ ê°œë°œìê°€ CORSë¥¼ í…ŒìŠ¤íŠ¸ í•˜ëŠ” ë°©ë²•</title>
    <link href="https://kdevkr.github.io/spring-cors/"/>
    <id>https://kdevkr.github.io/spring-cors/</id>
    <published>2023-07-22T12:00:00.000Z</published>
    <updated>2023-10-22T05:50:35.890Z</updated>
    
    <content type="html"><![CDATA[<p><img data-src="/images/posts/spring-cors/01.png"></p><p>ìœ„ì™€ ê°™ì€ ì§¤ì˜ ë‚´ìš©ì²˜ëŸ¼ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìì—ê²Œ ê³ í†µì„ ì£¼ëŠ” ê²ƒì€ CORS ì´ë‹¤. ê·¸ëŸ°ë° CORSëŠ” ë¸Œë¼ìš°ì €ì—ì„œì˜ ì •ì±…ì„ì—ë„ ë¶ˆêµ¬í•˜ê³  í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìê°€ ëŒ€ì‘í•  ìˆ˜ ìˆëŠ” ë¶€ë¶„ì€ ì—†ìœ¼ë©° ë¸Œë¼ìš°ì €ì—ì„œì˜ CORS ë§¤ì»¤ë‹ˆì¦˜ì„ ì´í•´í•˜ê³  ì„œë²„ ë°±ì—”ë“œ ê°œë°œìê°€ ì²˜ë¦¬í•´ì•¼í•  ë¶€ë¶„ì´ë‹¤. MDNì˜ <a href="https://developer.mozilla.org/en-US/docs/Glossary/Preflight_request">Preflight Request</a> ë¬¸ì„œì—ì„œ ë‹¤ë£¨ëŠ” ë‚´ìš©ì²˜ëŸ¼ ëŒ€ë¶€ë¶„ì˜ CORS ë¬¸ì œëŠ” í”„ë¡ íŠ¸ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œì˜ XHR ìš”ì²­ì— ì˜í•´ í”„ë¦¬í”Œë¼ì´íŠ¸ ìš”ì²­(Preflight Request)ì— ì˜í•œ CORS ìœ„ë°° ì‘ë‹µì„ ë°›ê³  ë¸Œë¼ìš°ì €ì—ì„œ ì œí•œí•˜ê¸° ë•Œë¬¸ì— ë°œìƒí•œë‹¤.</p><h4 id="í”„ë¦¬í”Œë¼ì´íŠ¸-ìš”ì²­"><a href="#í”„ë¦¬í”Œë¼ì´íŠ¸-ìš”ì²­" class="headerlink" title="í”„ë¦¬í”Œë¼ì´íŠ¸ ìš”ì²­"></a>í”„ë¦¬í”Œë¼ì´íŠ¸ ìš”ì²­</h4><p>í”„ë¦¬í”Œë¼ì´íŠ¸ ìš”ì²­ì€ <code>Origin</code> í—¤ë”ì™€ <code>Access-Control-Request-Method</code> í—¤ë” ê·¸ë¦¬ê³  <code>OPTIONS</code> ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ìˆ˜í–‰ëœë‹¤. </p><pre class="language-text" data-language="text"><div class="caption"><span>HTTP</span></div><code class="language-text">OPTIONS /resource/fooAccess-Control-Request-Method: DELETE Access-Control-Request-Headers: origin, x-requested-with Origin: https://foo.bar.org </code></pre><p>ì°¸ê³ ë¡œ, ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ì—ì„œ <a href="https://github.com/spring-projects/spring-framework/blob/main/spring-web/src/main/java/org/springframework/web/cors/CorsUtils.java">CorsUtils</a>ì— ì˜í•´ í”„ë¦¬í”Œë¼ì´íŠ¸ ìš”ì²­ì„ êµ¬ë¶„í•˜ëŠ” ì¡°ê±´ì€ ì•„ë˜ì™€ ê°™ì´ êµ¬í˜„ë˜ì–´ìˆë‹¤.</p><pre class="language-java" data-language="java"><div class="caption"><span>Java</span></div><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">CorsUtils</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isPreFlightRequest</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">HttpMethod</span><span class="token punctuation">.</span><span class="token constant">OPTIONS</span><span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token class-name">HttpHeaders</span><span class="token punctuation">.</span><span class="token constant">ORIGIN</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span>request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token class-name">HttpHeaders</span><span class="token punctuation">.</span><span class="token constant">ACCESS_CONTROL_REQUEST_METHOD</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="ìŠ¤í”„ë§-CORS-ë””ë²„ê·¸"><a href="#ìŠ¤í”„ë§-CORS-ë””ë²„ê·¸" class="headerlink" title="ìŠ¤í”„ë§ CORS ë””ë²„ê·¸"></a>ìŠ¤í”„ë§ CORS ë””ë²„ê·¸</h4><p>CORS ìš”ì²­ì— ëŒ€í•œ ê²€ì¦ì€ CorsFilterì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©ë˜ë„ë¡ êµ¬í˜„ëœ <a href="https://github.com/spring-projects/spring-framework/blob/main/spring-web/src/main/java/org/springframework/web/cors/DefaultCorsProcessor.java">DefaultCorsProcessor</a>ì— ì˜í•´ ìˆ˜í–‰ëœë‹¤. CORS ìš”ì²­ì— ì˜í•´ ìœ„ë°°ë˜ëŠ” ìƒí™©ì— ëŒ€í•´ì„œ ì›ì¸ì„ ë¡œê·¸ë¡œ ì¶œë ¥í•´ë³´ë ¤ëŠ” ê²½ìš° DefaultCorsProcessorì— ëŒ€í•œ ë¡œê·¸ ë ˆë²¨ì„ TRACE ë˜ëŠ” DEBUGë¡œ ì§€ì •í•˜ë©´ ëœë‹¤. ê°œë°œ í™˜ê²½ì—ì„œëŠ” CorsFilter ë˜ëŠ” DefaultCorsProcessorì˜ ì½”ë“œ ë¼ì¸ì— ì¤‘ë‹¨ì ì„ ê±¸ì–´ì„œ í™•ì¸í•  ìˆ˜ ìˆê² ì§€ë§Œ ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ë¡œê·¸ ë ˆë²¨ë¡œ ì²´í¬í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</p><pre class="language-yaml" data-language="yaml"><div class="caption"><span>application.yml</span></div><code class="language-yaml"><span class="token key atrule">logging.level</span><span class="token punctuation">:</span>  <span class="token key atrule">org.springframework.web.cors.DefaultCorsProcessor</span><span class="token punctuation">:</span> TRACE</code></pre><p><img data-src="/images/posts/spring-cors/03.gif" alt="CORSì˜ í”„ë¦¬í”Œë¼ì´íŠ¸ ìš”ì²­ì„ ì´í•´í•œ ë°±ì—”ë“œ ê°œë°œì"></p><h4 id="ìŠ¤í”„ë§-MockMvcë¡œ-CORS-í…ŒìŠ¤íŠ¸"><a href="#ìŠ¤í”„ë§-MockMvcë¡œ-CORS-í…ŒìŠ¤íŠ¸" class="headerlink" title="ìŠ¤í”„ë§ MockMvcë¡œ CORS í…ŒìŠ¤íŠ¸"></a>ìŠ¤í”„ë§ MockMvcë¡œ CORS í…ŒìŠ¤íŠ¸</h4><p>ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©ì¤‘ì´ë©° <strong>CorsConfiguration</strong> ì„¤ì •ì„ í•´ë‘ì—ˆë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ <strong>MockMvc</strong>ë¥¼ í™œìš©í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤. </p><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token annotation punctuation">@DisplayName</span><span class="token punctuation">(</span><span class="token string">"Preflight request"</span><span class="token punctuation">)</span><span class="token keyword">void</span> <span class="token class-name">TestPreflightRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Assertions</span><span class="token punctuation">.</span><span class="token function">assertDoesNotThrow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> allowedOrigins <span class="token operator">=</span> corsConfiguration<span class="token punctuation">.</span><span class="token function">getAllowedOrigins</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>allowedOrigins <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            allowedOrigins <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> allowedMethods <span class="token operator">=</span> corsConfiguration<span class="token punctuation">.</span><span class="token function">getAllowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>allowedMethods <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            allowedMethods <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        mockMvc<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"Origin"</span><span class="token punctuation">,</span> allowedOrigins<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"Access-Control-Request-Method"</span><span class="token punctuation">,</span> <span class="token string">"GET"</span><span class="token punctuation">)</span>            <span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">andExpect</span><span class="token punctuation">(</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isOk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">andExpect</span><span class="token punctuation">(</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stringValues</span><span class="token punctuation">(</span><span class="token string">"Access-Control-Allow-Origin"</span><span class="token punctuation">,</span> allowedOrigins<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">andExpect</span><span class="token punctuation">(</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">"Access-Control-Allow-Methods"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">,</span> allowedMethods<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">andDo</span><span class="token punctuation">(</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="cURLë¡œ-í…ŒìŠ¤íŠ¸í•˜ëŠ”-ë°©ë²•"><a href="#cURLë¡œ-í…ŒìŠ¤íŠ¸í•˜ëŠ”-ë°©ë²•" class="headerlink" title="cURLë¡œ í…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•"></a>cURLë¡œ í…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•</h4><p>í¬ìŠ¤íŠ¸ë§¨ ë„êµ¬ë¡œ HTTP ìš”ì²­ì„ ìˆ˜í–‰í•œ ê²ƒì²˜ëŸ¼ cURLë¡œë„ í”„ë¦¬í”Œë¼ì´íŠ¸ ìš”ì²­ì„ ìˆ˜í–‰í•´ë³¼ ìˆ˜ ìˆë‹¤. í¬ìŠ¤íŠ¸ë§¨ê³¼ëŠ” ë‹¤ë¥´ê²Œ OPTIONSë¥¼ ì§ì ‘ì ìœ¼ë¡œ ì‚¬ìš©í•´ì•¼í•œë‹¤. DefaultCorsProcessorì— ì˜í•´ CORSì— ìœ„ë°°ëœ ìƒí™©ì´ ìˆë‹¤ë©´ <code>Invalid CORS request</code>ì´ë¼ëŠ” ì‘ë‹µê³¼ í•¨ê»˜ 403 ìƒíƒœ ì½”ë“œê°€ í™•ì¸ ë  ê²ƒì´ë‹¤.</p><pre class="language-powershell" data-language="powershell"><div class="caption"><span>Windows Terminal</span></div><code class="language-powershell"><span class="token function">PS</span> C:\Users\Mambo> curl <span class="token operator">-</span>X OPTIONS <span class="token string">'http://localhost:5000'</span> <span class="token operator">-</span>H <span class="token string">'Origin: http://localhost'</span> <span class="token operator">-</span>H <span class="token string">'Access-Control-Request-Method: GET'</span> <span class="token operator">-</span>v<span class="token operator">*</span>   Trying 127<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>1:5000<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">*</span> Connected to localhost <span class="token punctuation">(</span>127<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>1<span class="token punctuation">)</span> port 5000 <span class="token punctuation">(</span><span class="token comment">#0)</span>> OPTIONS <span class="token operator">/</span> HTTP/1<span class="token punctuation">.</span>1> Host: localhost:5000> User-Agent: curl/8<span class="token punctuation">.</span>0<span class="token punctuation">.</span>1> Accept: <span class="token operator">*</span><span class="token operator">/</span><span class="token operator">*</span>> Origin: http:<span class="token operator">/</span><span class="token operator">/</span>localhost> Access-Control-<span class="token function">Request-Method</span>: GET>&lt; HTTP/1<span class="token punctuation">.</span>1 403 Forbidden&lt; Expires: 0&lt; Cache-Control: no-cache<span class="token punctuation">,</span> no-store<span class="token punctuation">,</span> max-age=0<span class="token punctuation">,</span> must-revalidate&lt; X-XSS-Protection: 0&lt; Pragma: no-cache&lt; X-Frame-Options: DENY&lt; Date: Sat<span class="token punctuation">,</span> 22 Jul 2023 12:56:00 GMT&lt; Connection: keep-alive&lt; Vary: Origin&lt; Vary: Access-Control-<span class="token function">Request-Method</span>&lt; Vary: Access-Control-<span class="token function">Request-Headers</span>&lt; X-Content-<span class="token function">Type</span><span class="token operator">-</span>Options: nosniff&lt; Transfer-Encoding: chunked&lt;Invalid CORS request* Connection <span class="token comment">#0 to host localhost left intact</span></code></pre><h4 id="Postmanìœ¼ë¡œ-í…ŒìŠ¤íŠ¸í•˜ëŠ”-ë°©ë²•"><a href="#Postmanìœ¼ë¡œ-í…ŒìŠ¤íŠ¸í•˜ëŠ”-ë°©ë²•" class="headerlink" title="Postmanìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•"></a>Postmanìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•</h4><p>HTTP ìš”ì²­ì„ ìˆ˜í–‰í•´ë³¼ ìˆ˜ ìˆëŠ” í¬ìŠ¤íŠ¸ë§¨ì—ì„œ í”„ë¦¬í”Œë¼ì´íŠ¸ ìš”ì²­ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ì„œëŠ” Origin í—¤ë”ë¥¼ í¬í•¨í•˜ë©´ ëœë‹¤. í¬ìŠ¤íŠ¸ë§¨ì—ì„œ ì•Œì•„ì„œ OPTIONSë¥¼ ìˆ˜í–‰í•˜ë¯€ë¡œ ê°„ë‹¨í•˜ê²Œ í…ŒìŠ¤íŠ¸í•´ë³¼ ìˆ˜ ìˆë‹¤.</p><p><img data-src="/images/posts/spring-cors/02.png"></p><p>ë§Œì•½, CORSëŠ” í”„ë¡ íŠ¸ì—”ë“œ ì˜ì—­ì—ì„œ í•´ê²°í•´ì•¼í•  ë¬¸ì œë¼ê³  ìƒê°í•˜ê³  ìˆëŠ” ê°œë°œìê°€ ìˆë‹¤ë©´ CORSì— ëŒ€í•´ì„œ ë‹¤ì‹œ í•™ìŠµí•˜ê¸¸ ë°”ë€ë‹¤.<br>í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìê°€ CORSì˜ ê³ í†µì—ì„œ ë²—ì–´ë‚  ìˆ˜ ìˆë„ë¡ ë°±ì—”ë“œ ê°œë°œìëŠ” ì±…ì„ì„ ë‹¤í•´ì•¼ í•  ê²ƒì´ë‹¤. </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;img data-src=&quot;/images/posts/spring-cors/01.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;ìœ„ì™€ ê°™ì€ ì§¤ì˜ ë‚´ìš©ì²˜ëŸ¼ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìì—ê²Œ ê³ í†µì„ ì£¼ëŠ” ê²ƒì€ CORS ì´ë‹¤. ê·¸ëŸ°ë° CORSëŠ” ë¸Œë¼ìš°ì €ì—ì„œì˜ ì •ì±…ì„ì—ë„ ë¶ˆêµ¬í•˜ê³  í”„ë¡ íŠ¸ì—”ë“œ </summary>
      
    
    
    
    
    <category term="CORS" scheme="https://kdevkr.github.io/tags/CORS/"/>
    
    <category term="Preflight Request" scheme="https://kdevkr.github.io/tags/Preflight-Request/"/>
    
  </entry>
  
</feed>
