---
title: Test Driven Development
date: 2022-09-13
tags:
- TDD
- ATDD
---

시작하기에 앞서 TDD(Test Driven Development)에 대해서는 아래의 글들을 참고하는 것이 좋다고 생각된다. 왜냐하면 이 글은 TDD에 대해서 정리한다거나 좋은지 나쁜지에 대해서 다루지 않기 때문이다.

- [[마틴 파울러] 리팩토링의 중요성 feat.테스트 코드를 짜는 이유(한글 자막)](https://www.youtube.com/watch?v=mNPpfB8JSIU)
- [1500개 테스트를 작성하며 나는 무엇을 얻었나](https://medium.com/@minhyeok4dev/1500%EA%B0%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EC%9E%91%EC%84%B1%ED%95%98%EB%A9%B0-%EB%82%98%EB%8A%94-%EB%AC%B4%EC%97%87%EC%9D%84-%EC%96%BB%EC%97%88%EB%82%98-62b9facd53d8)
- [Product Manager 관점에서 바라 본 TDD](https://medium.com/@sryu99/product-manager-%EA%B4%80%EC%A0%90%EC%97%90%EC%84%9C-%EB%B0%94%EB%9D%BC-%EB%B3%B8-tdd-3ae25512c5d7)

현재 조직은 스프린트 단위의 개발 일정과 배포와 함께 이제는 고객과 협의하여 인수테스트를 진행하기로 하였고 그와 동시에 개발팀에서는 TDD라는 개발 방법론을 조금씩 도입하기로 결정했다. 다만, 이것은 개발자 일원 중 하나인 나의 의견이 반영된 부분이 아니며 조직 내 각 팀장급 동료들이 결정한 사항이다. 그렇다면 이 조직에서는 왜 TDD라는 개발 방식을 고려하였을까를 생각해보고자 한다.

오래전에 컴퓨터 공학과에서 배웠던 소프트웨어 공학 관점의 개발 프로세스를 다시 살펴보면 기획 및 요구사항 분석을 통해서 만들어지는 요구사항 명세서를 기반으로 결정된 사항을 토대로 시스템을 설계하며 정의된 인터페이스에 따라 세부 기능을 개발하고 테스트하는 과정을 거치면서 하나의 제품을 만드는 것이라고 설명한다.

실제로 어떠한 시스템을 개발하는데 있어서 요구사항이 명확하게 분석되어 제대로 된 작업 기준이 도출되면 요구사항에 대한 기능을 구현하는데에는 생각보다 어려움이 없을 것이다. 개발자가 어떠한 작업 방향을 결정했느냐에 따라서 약간의 결과물은 달라질 수 있겠지만 최소한 요구사항이 분석된 부분 만큼은 정해진대로 동작한다는 것을 보장한다.

![](/images/posts/test-driven-development/IMG_3970.jpg)

그런데, IT 분야에서 일하다보면 모든 회사와 많은 프로젝트들이 제대로 된 개발 산출물과 명확한 요구사항을 토대로 일하는 것은 쉽지 않다. 도메인 시장마다 그 깊이는 다르겠지만 요구사항을 명확하지 못하도록 만드는 나라마다의 정책 그리고 당장 정해질 수 없는 기준이 있다거나 개념적으로만 생각되어 미래를 준비하는 것들도 그 중의 하나이다. 

> 유튜브와 일하기 좋은 문화를 가지고 있다는 회사들이 말하는 이상적으로 일하는 방식을 갖추기엔 생각보다 어렵다. 모든 도메인 시장이 동일하게 일할 수 있는 사업적인 구조가 아닌 것도 그 이유이다.

일하기 좋은 문화를 추구한다며 많은 스타트업과 네카라쿠배와 같은 서비스 회사들에서 대외적으로 어떤 고민을 했고 지금 어떠한 방식으로 일한다고 공유하는 것을 볼 수 있지만 그들조차도 내부적으로는 많이 포장된 부분이 있을 것이고 그러한 문화를 유지하고자 때로는 어떠한 희생을 감수할 지도 모른다. 그럼에도 그러한 회사들을 많은 사람들이 선호하는 이유는 일하고 있는 방식을 더 나은 방식으로 개선하고자 노력하는 부분이지 않을까 생각한다.

현재 조직은 대외적으로는 중소기업 소속에서 외부 투자를 받아서 별도의 법인으로 분리되어서 새로운 회사가 되었지만 내부적으로는 일하는 공간이나 방식이 변경된 부분은 없는데 많은 중소기업들이 일하는 방식을 바꾸기 어려운 이유는 그렇게 일하는 것이 이미 익숙해져있다거나 비용적인 면으로 볼때 감수할 만큼 여유롭지 않기 때문이라고 느껴진다. 

회사마다 만드는 시스템의 규모도 다르고 규모와 기능에 따른 설계 방식도 다르며 심지어는 사용되는 언어와 기술, 개발된 애플리케이션을 배포하는 방법도 다양하기 때문에 모든 회사가 동일한 기술 트렌드를 따라간다거나 데브옵스를 수행하는 팀을 만들지 않는다. 더 나아가서는 꽤 많은 회사가 클라우드 서비스를 활용하고 있겠지만 굳이 사용하지 않는다고해서 그 회사가 좋지 않은 방식으로 일한다고 단정 지을 순 없다.

회사의 도메인 시장의 특성 상 시스템에 대한 기능 추가 또는 수정해야하는 요구사항을 전달받아도 대부분 두루뭉술하게 큰 틀로만 서술되어있거나 고객이 생각하는 바 또는 원하는 것을 제대로 문서화하지 않아서 요구사항에 대해서 자세하게 분석할 수 없는 상태로 개발 일정을 결정한다거나 그럴리 없다고 단정한다던가 설마 그러겠어라고 가정한 상태로 피드백이 되기도 한다.

요구사항이 명확하지 않다보니 "오늘도 개발자가 안된다고 말했다"라는 것과 같이 일단 방어적인 자세를 취하기도 하는데 대부분의 요건이 전달될 때에는 고객과 사업팀의 협의하에 이미 정해진 기한이 있는 상태에서 검토를 요청하는 히스토리도 가끔씩 발생한다. 이미 고객이 스스로 필요하다고 정해놓은 기한을 전달할 수 밖에 없는 사업팀의 어려움도 있을테지만 개발자 입장에서는 진행중인 스프린트 단위의 작업을 고려하여 원하는 기한에는 불가능하다는 피드백을 줄 수 밖에 없는 경우도 존재한다.

> 하지만, 고객이 있어야만 조직이 유지될 수 있기 때문에 울며겨자먹기로 긴급한 요구사항으로써 다른 작업을 중지하고 우선적으로 처리하기도 한다. 그리고 그것이 점차 반복되어진다는 것도 문제로 볼 수 있다.

이렇게 흘러가게 되는 이유는 조직에서는 개발중인 시스템을 플랫폼으로써 성장하고 싶은 목표가 있다고는 하지만 현재 위치 상 도메인 시장의 주요 고객들에게 솔루션 형태로 계약되어 각 고객 환경에 시스템을 구축하여 이용할 수 있도록 제공하고 있고 요구사항에 대한 비용을 산정하여 추가적인 금액을 받으면서 일하기 때문이지 않을까 생각한다.

![](/images/posts/test-driven-development/7c884b6e7580dbef56b86c796b549922.gif)

아무튼 현재 조직이 어떻게 일하는지 그리고 이상적으로 일할 수 없는지를 약간이나마 설명이 되었다면 이제는 조직의 개발자로써 바라볼 때 TDD를 결정한 이유에 대해서 생각해볼 필요가 있다. 불명확한 요구사항이 대부분이며 개발자가 작업해야할 방향이나 기준도 애매하고 심지어는 제품 품질을 높이기 위한 QA 직무를 수행하는 동료조차도 테스트해야할 기준을 잡기도 힘들다는 문제가 지속적으로 발생해왔다.

명확하지 않은 요구사항을 검토한 개발자와 실제로 스프린트 단위로 작업하기로 결정한 개발자가 다르기도 하며 대부분의 요구사항에 대한 처리에 대해 완료했다는 것은 개발자 스스로에게 맞기는 부분도 일부 존재한다. 애초에 현재 조직에서 일하는 방식의 문제점이라고 생각한다면 명확하지 않음으로부터 시작된다고 볼 수 있다. 제대로 되지 않은 요구사항 분석으로 인하여 동작했던 시스템의 기능들에서 오류가 발생하는 사이드 이펙트가 발생하고 그것이 반복될 수록 고객에게는 제품의 신뢰성을 잃게 되는 과정이 되는 것이다.

> 지난 달 발생한 [1,600만 명이 쓰는 알약 오류 사태](https://www.youtube.com/watch?v=uJ1KqQ0I2u8)도 변경사항으로 인해 심각한 버그가 발생한 케이스이다.

사실 개발자와 조직에서 문서와 테스트의 중요성을 모르는 직원은 없다고 생각된다. 그럼에도 불구하고 테스트를 제대로 수행할 수 있도록 일할 수 있는 환경은 아니기 때문에 시스템의 변경사항으로 인해서 발생하는 문제를 대부분 파악하기란 쉽지 않은 상태이다. 테스트 주도 개발에 대해서 찾아보고 이해한 바로는 요구사항의 분석을 다시한번 미리 수행함으로써 설계 또는 작업 방향에 대한 오류를 검출하고 작업에 대한 기준을 개발자가 확인하면서 진행할 수 있다는 것 그리고 요구사항이 명확하지 않더라도 최소한 개발자가 생각하는 실패의 기준을 알 수 있으며 완료된 작업에 대해서는 어떠한 기준에서 테스트 해야하는지 정리할 수 있는 장점이 있다고 보여진다.

아직 테스트 주도 개발을 경험하지 못했던 개발자로써 드는 생각은 개발자가 테스트 코드를 작성한다는 것에 대해 모든 것을 테스트 코드로 커버할 수 없다는 부분도 있다는 것을 고려해야한다는 점이다. 현재 그리고 앞으로 만들어지는 시스템들은 거의 단일 애플리케이션으로만 동작하지 않으며 여러가지 외부 솔루션이나 협의된 API를 통해서 유기적으로 통신하여 시스템을 구성하기 때문에 외부 의존성이 없는 테스트 코드를 작성하기란 쉽지 않을 것이라는 점이다.

실제로 현재 조직의 시스템이 제공하는 대부분의 주요 기능은 [KDB+라는 상용 시계열 데이터베이스](https://code.kx.com/q/)에 의존되어 구현되어있는 상태이므로 고객마다 다른 시계열 데이터를 예상하면서 테스트 환경을 준비하기가 어렵다는 부분이 존재한다. 따라서, 개발팀에서 테스트 주도 개발을 도입한다고해서 모든 요건에 대해서 테스트 코드를 작성해야할 것 같다고 부담을 가질 필요는 없다는 입장이다. 그리고 이 개발 방식을 채택한다고해서 요구사항으로 인한 변경사항이 시스템에 어떠한 영향을 미치는지 완벽히 검출할 수 있다는 관점을 가져서는 안되며 [아마존 웹 서비스의 개발 문화와 프로세스](https://www.youtube.com/watch?v=NkiHu9zGYKU)를 보더라도 마치 체계적으로 애자일 문화를 수행하는 것처럼 보이지만 실제 아마존 웹 서비스를 이용하다보면 꽤나 많은 버그가 내재되어있음을 발견할 수 있다.

제품 품질이 좋아지지 않는 이유의 가장 큰 원인은 명확하지 않은 요구사항으로부터 시작되는 것이므로 테스트 주도 개발을 통해 테스트 코드를 먼저 만드는 것이 생각보다는 어려운 시도일지 모르겠지만 개발자 입장에서도 제품 품질을 높이려는 노력은 반드시 필요한 부분이라고 생각한다.

![](/images/posts/test-driven-development/SE-2eb6c828-cc8b-4e51-a2f1-148593277123.jpg)

