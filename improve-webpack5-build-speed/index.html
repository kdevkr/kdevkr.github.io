<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png"><link rel="mask-icon" href="/images/favicon/favicon.ico" color="#222"><meta name="google-site-verification" content="LMcddVW6xLBS7X1htGQ3duOIEmVp4ljku8sd3UuIcBg"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto+Sans+KR:300,300italic,400,400italic,700,700italic%7CGmarket+Sans:300,300italic,400,400italic,700,700italic%7CRIDIBatang:300,300italic,400,400italic,700,700italic%7CJetbrains+Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-loading-bar.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"kdevkr.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.11.1","exturl":false,"sidebar":{"position":"left","display":"hide","padding":18,"offset":12,"width":240,"scrollpercent":true,"b2t":true},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script><meta name="description" content="안녕하세요 Mambo 입니다. 현재 조직에서는 웹팩 4로 구성된 프로젝트를 웹팩 5를 사용할 수 있도록 업그레이드 작업을 수행하였고 많은 노력 끝에 최신 버전의 웹팩 구성으로 변경하는 것을 완료했습니다. 그러나 오히려 웹팩 5으로 전환하게 된 후 빌드 시간이 더 늘어남을 경험하게 되었는데 오늘은 왜 이런 문제가 발생했는지를 공유하고자 합니다. Webpack"><meta property="og:type" content="article"><meta property="og:title" content="Webpack 5 빌드 속도 개선하기"><meta property="og:url" content="https://kdevkr.github.io/improve-webpack5-build-speed/index.html"><meta property="og:site_name" content="Mambo"><meta property="og:description" content="안녕하세요 Mambo 입니다. 현재 조직에서는 웹팩 4로 구성된 프로젝트를 웹팩 5를 사용할 수 있도록 업그레이드 작업을 수행하였고 많은 노력 끝에 최신 버전의 웹팩 구성으로 변경하는 것을 완료했습니다. 그러나 오히려 웹팩 5으로 전환하게 된 후 빌드 시간이 더 늘어남을 경험하게 되었는데 오늘은 왜 이런 문제가 발생했는지를 공유하고자 합니다. Webpack"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://kdevkr.github.io/images/posts/improve-webpack5-build-speed/wp5-build-02.png#full"><meta property="og:image" content="https://kdevkr.github.io/images/posts/improve-webpack5-build-speed/wp5-build-03.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/improve-webpack5-build-speed/wp5-build-04.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/improve-webpack5-build-speed/wp5-build-05.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/improve-webpack5-build-speed/wp5-build-06.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/improve-webpack5-build-speed/wp5-build-07.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/improve-webpack5-build-speed/wp5-build-08.png"><meta property="article:published_time" content="2022-01-15T00:00:00.000Z"><meta property="article:modified_time" content="2022-07-17T10:38:44.400Z"><meta property="article:author" content="Mambo"><meta property="article:tag" content="Webpack5"><meta property="article:tag" content="Persistent cache"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://kdevkr.github.io/images/posts/improve-webpack5-build-speed/wp5-build-02.png#full"><link rel="canonical" href="https://kdevkr.github.io/improve-webpack5-build-speed/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://kdevkr.github.io/improve-webpack5-build-speed/","path":"improve-webpack5-build-speed/","title":"Webpack 5 빌드 속도 개선하기"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Webpack 5 빌드 속도 개선하기 | Mambo</title><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-93954323-1","only_pageview":true}</script><script src="/js/third-party/analytics/google-analytics.js"></script><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><link rel="alternate" href="/atom.xml" title="Mambo" type="application/atom+xml">
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope itemtype="http://schema.org/WebPage"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Mambo</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Today I Learned 🔥</p></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fas fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fas fa-archive fa-fw"></i>Archives<span class="badge">65</span></a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fas fa-user fa-fw"></i>About</a></li></ul></nav></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">Table of Contents</li><li class="sidebar-nav-overview">Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Webpack5"><span class="nav-number">1.</span> <span class="nav-text">Webpack5</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8A%90%EB%A0%A4%EC%A7%84-%EC%9E%AC%EB%B9%8C%EB%93%9C-%EC%8B%9C%EA%B0%84"><span class="nav-number">1.1.</span> <span class="nav-text">느려진 재빌드 시간</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%A1%9C%EB%8D%94-%EB%B0%8F-%ED%94%8C%EB%9F%AC%EA%B7%B8%EC%9D%B8-%EB%8C%80%EC%B2%B4"><span class="nav-number">1.2.</span> <span class="nav-text">로더 및 플러그인 대체</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%B9%8C%EB%93%9C-%EA%B2%B0%EA%B3%BC-%EC%A2%85%ED%95%A9"><span class="nav-number">1.3.</span> <span class="nav-text">빌드 결과 종합</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Mambo" src="https://avatars1.githubusercontent.com/u/17937604?s=460&v=4"><p class="site-author-name" itemprop="name">Mambo</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">65</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-tags"><span class="site-state-item-count">116</span> <span class="site-state-item-name">tags</span></div></nav></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://github.com/kdevkr" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;kdevkr" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:kdevkr@gmail.com" title="E-Mail → mailto:kdevkr@gmail.com" rel="noopener" target="_blank"><i class="fas fa-envelope fa-fw"></i>E-Mail</a></span></div><div class="cc-license site-overview-item animated" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ko" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div><div class="back-to-top animated" role="button" aria-label="Back to top"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div class="sidebar-dimmer"></div></header><div class="reading-progress-bar"></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://kdevkr.github.io/improve-webpack5-build-speed/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://avatars1.githubusercontent.com/u/17937604?s=460&v=4"><meta itemprop="name" content="Mambo"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Mambo"><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Webpack 5 빌드 속도 개선하기 | Mambo"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Webpack 5 빌드 속도 개선하기</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2022-01-15 00:00:00" itemprop="dateCreated datePublished" datetime="2022-01-15T00:00:00Z">2022-01-15</time></span></div></div></header><div class="post-body" itemprop="articleBody"><p>안녕하세요 Mambo 입니다.</p><p>현재 조직에서는 웹팩 4로 구성된 프로젝트를 웹팩 5를 사용할 수 있도록 업그레이드 작업을 수행하였고 많은 노력 끝에 최신 버전의 웹팩 구성으로 변경하는 것을 완료했습니다. 그러나 오히려 웹팩 5으로 전환하게 된 후 빌드 시간이 더 늘어남을 경험하게 되었는데 오늘은 왜 이런 문제가 발생했는지를 공유하고자 합니다.</p><h2 id="Webpack5"><a href="#Webpack5" class="headerlink" title="Webpack5"></a>Webpack5</h2><p>어떤 도구에 대한 최신 버전을 사용하려는 목적은 버그 개선 뿐만 아니라 구조적인 개선으로 인한 성능 향상에 있기도 합니다. 물론 반드시 최신 버전으로 업데이트하는 것이 성능 상으로 좋아짐을 보장할 순 없습니다. 웹팩에서 마이그레이션 가이드 문서를 제공한다고해도 많은 로더와 플러그인등을 사용하기 때문에 빌드 성능이 좋지 않다는 것을 검토하기에는 어려움이 많습니다.</p><h3 id="느려진-재빌드-시간"><a href="#느려진-재빌드-시간" class="headerlink" title="느려진 재빌드 시간"></a>느려진 재빌드 시간</h3><p>웹팩 5로 전환하고나서 일부 시스템 환경에 따라 시간은 다르지만 다음과 같이 빌드 시간이 상당히 느려짐을 경험했습니다. 초기 빌드 시간은 그다지 차이가 발생하지 않았으나 웹팩 5가 조금은 빨랐습니다. 그러나, 젠킨스와 같은 CI 도구에서는 재빌드를 수행하기도 하므로 다음과 같이 재빌드에 대해서 검토한 결과 오히려 빌드가 느림을 확인했습니다.</p><p><img data-src="/images/posts/improve-webpack5-build-speed/wp5-build-02.png#full"></p><p>재빌드 시에만 웹팩 5에서 심각하게 느림을 보이는 이유는 <strong>캐시</strong>에 있었습니다. 웹팩 5에서는 영구 캐시(파일시스템 캐시)를 지원하기 위해서 캐시 방식을 변경하였습니다. 이전 웹팩 4에서는 캐시 방식이 없으므로 다음과 같이 로더와 플러그인에서 자체적인 캐시 파일을 만드는 것을 제한하지 않았습니다.</p><p><img data-src="/images/posts/improve-webpack5-build-speed/wp5-build-03.png"></p><p>그러나 우측의 웹팩 5에서는 <code>terser-webpack-plugin</code> 과 <code>css-minimizer-webpack-plugin</code>에 대한 캐시 폴더가 생성되지 않았음을 확인할 수 있는데요. 이렇게 된 정확한 이유는 찾을 수 없었지만 예상하는 바는 캐시 구조 변경으로 인하여 웹팩 자체적으로 제공하는 로더와 플러그인에 대해서는 캐시 파일을 만들지않도록 수정된 것 같습니다.</p><h4 id="영구-캐시"><a href="#영구-캐시" class="headerlink" title="영구 캐시"></a>영구 캐시</h4><p>영구 캐시(Persistent Cache)를 위해 파일시스템 캐시를 지정하면 어떻게 되는지 확인해보겠습니다.</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">cache</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'filesystem'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">buildDependencies</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token literal-property property">config</span><span class="token operator">:</span> <span class="token punctuation">[</span>__filename<span class="token punctuation">]</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre><p>node_modules 하위의 캐시 폴더를 지운 상태에서 빌드를 수행하고 다시한번 재빌드를 수행한 결과를 비교해봅니다.</p><p><img data-src="/images/posts/improve-webpack5-build-speed/wp5-build-04.png"></p><p>웹팩 5에서 지원하는 파일시스템 캐시를 적용하고나니 재빌드 시간이 무려 15초로 단축됨을 확인할 수 있습니다. 이처럼 웹팩 5로 변경하고나서 오히려 빌드 시간이 느려짐을 경험했던 분이라면 사용중인 로더와 플러그인에서 자체적인 캐시를 사용했는지 검토하고 <strong>파일시스템 캐시</strong>를 적용하셔야 할 수 있습니다.</p><h3 id="로더-및-플러그인-대체"><a href="#로더-및-플러그인-대체" class="headerlink" title="로더 및 플러그인 대체"></a>로더 및 플러그인 대체</h3><p>최신버전의 웹팩 구성을 위해서는 사용하는 로더와 플러그인들의 호환성을 위해 최신 버전으로 업데이트해야만 합니다. 로더와 플러그인들의 버전이 업데이트되면서 오히려 수행하는 일이 더 많아질 수 있음을 인지해야할 수 있습니다. 예를 들어, 바벨을 적용중이라면 더 많은 문법을 지원하거나 프리셋에 더 많은 플러그인이 기본적으로 포함될 수도 있습니다.</p><h4 id="esbuild-loader"><a href="#esbuild-loader" class="headerlink" title="esbuild-loader"></a>esbuild-loader</h4><p><a target="_blank" rel="noopener" href="https://github.com/privatenumber/esbuild-loader">esbuild-loader</a>는 esbuild를 통해 웹팩 빌드를 더 빠르게 수행하기 위한 로더 중 하나입니다. 이외에도 <a target="_blank" rel="noopener" href="https://github.com/swc-project/swc-loader">swc-loader</a>도 있습니다.</p><blockquote><p>esbuild와 swc는 떠오르는 자바스크립트 번들러입니다!</p></blockquote><p>esbuild는 자체적으로 빠른 것도 있지만 Minification도 함께 지원한다는 장점도 있습니다. 기존에는 트랜스파일링을 위해 바벨 로더를 사용하고 자바스크립트 또는 CSS 파일 축소를 위해서 terser-webpack-plugin과 css-minimizer-plugin을 적용해야했습니다. esbuild 만으로도 위 기능을 대체할 수 있기 때문에 여러가지 로더와 플러그인을 수행하는 것보다는 더 좋을 수 있습니다.</p><blockquote><p>웹팩 문서에서도 최대한 로더와 플러그인을 줄여야한다고 안내합니다.</p></blockquote><pre class="language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">&#123;</span>
                <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(node_modules)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                    <span class="token literal-property property">cacheDirectory</span><span class="token operator">:</span> <span class="token boolean">true</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token literal-property property">mimimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">CssMinimizerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
                <span class="token literal-property property">minimizerOptions</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                    <span class="token literal-property property">preset</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                        <span class="token string">'default'</span><span class="token punctuation">,</span>
                        <span class="token punctuation">&#123;</span>
                            <span class="token literal-property property">discardDuplicates</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">removeAll</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
                            <span class="token literal-property property">discardComments</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">removeAll</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span>
                        <span class="token punctuation">&#125;</span>
                    <span class="token punctuation">]</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre><p>이제 바벨을 esbuild-loader로 변경해보고 빌드를 해보겠습니다.</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">&#123;</span>
                <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(node_modules)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'esbuild-loader'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                    <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">'es2015'</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre><p><img data-src="/images/posts/improve-webpack5-build-speed/wp5-build-05.png" alt="esbuild-loader + teser + css-miminizer"></p><p>초기 빌드 시 2분 54초라는 시간에서 <strong>2분 21초</strong>로 단축되었습니다.</p><h4 id="TerserPlugin-esbuildMinify"><a href="#TerserPlugin-esbuildMinify" class="headerlink" title="TerserPlugin.esbuildMinify"></a>TerserPlugin.esbuildMinify</h4><p>terser-webpack-plugin은 esbuild로 자바스크립트에 대한 최적화를 수행할 수 있도록 <code>TerserPlugin.esbuildMinify</code>를 지원합니다.</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token literal-property property">mimimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
                <span class="token literal-property property">minify</span><span class="token operator">:</span> TerserPlugin<span class="token punctuation">.</span>esbuildMinify
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre><p><img data-src="/images/posts/improve-webpack5-build-speed/wp5-build-06.png" alt="esbuild-loader + teser[esbuild] + css-miminizer"></p><h4 id="CssMinimizerPlugin-esbuildMinify"><a href="#CssMinimizerPlugin-esbuildMinify" class="headerlink" title="CssMinimizerPlugin.esbuildMinify"></a>CssMinimizerPlugin.esbuildMinify</h4><p>css-minimizer-webpack-plugin도 esbuild로 CSS에 대한 최적화를 수행할 수 있도록 <code>CssMinimizerPlugin.esbuildMinify</code>을 지원합니다.</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token literal-property property">mimimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token keyword">new</span> <span class="token class-name">CssMinimizerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
                <span class="token literal-property property">minify</span><span class="token operator">:</span> CssMinimizerPlugin<span class="token punctuation">.</span>esbuildMinify
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre><p><img data-src="/images/posts/improve-webpack5-build-speed/wp5-build-07.png" alt="esbuild-loader + teser[esbuild] + css-miminizer[esbuild]"></p><h4 id="ESBuildMinifyPlugin"><a href="#ESBuildMinifyPlugin" class="headerlink" title="ESBuildMinifyPlugin"></a>ESBuildMinifyPlugin</h4><p>esbuild-loader에는 <a target="_blank" rel="noopener" href="https://github.com/privatenumber/esbuild-loader#css-assets">ESBuildMinifyPlugin</a>가 포함되어있으므로 굳이 terser-webpack-plugin과 css-minimizer-webpack-plugin을 사용할 필요가 없습니다. 두개의 플러그인으로 수행하는 것보다는 하나의 플러그인으로 처리하는게 더 효율적입니다. 최적화에 대한 벤치마크는 <a target="_blank" rel="noopener" href="https://github.com/privatenumber/minification-benchmarks">JS minification benchmarks</a>를 참고하시기 바랍니다.</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">&#123;</span> ESBuildMinifyPlugin <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'esbuild-loader'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token literal-property property">mimimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token keyword">new</span> <span class="token class-name">ESBuildMinifyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
                <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">'es2015'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">css</span><span class="token operator">:</span> <span class="token boolean">true</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre><p><img data-src="/images/posts/improve-webpack5-build-speed/wp5-build-08.png" alt="esbuild-loader + esbuild-minify"></p><h3 id="빌드-결과-종합"><a href="#빌드-결과-종합" class="headerlink" title="빌드 결과 종합"></a>빌드 결과 종합</h3><p>기존에 사용하던 로더와 플러그인을 대체하면서 빌드 시간이 단축됨을 확인했습니다. 그러나 여러분의 프로젝트에서 요구하는 번들링 품질에 대해서도 검토하셔야만 합니다. 단순히 빌드 시간이 단축되었다고 더 좋다고 할 수는 없기 때문입니다. 예를 들어, esbuild에서 지원하는 문법의 한계가 있으므로 반드시 목표로하는 브라우저에서 동작하는지 검증해야합니다.</p><table><thead><tr><th>로더</th><th>플러그인</th><th>빌드시간</th></tr></thead><tbody><tr><td>babel-loader</td><td>teser + css-minimizer</td><td>2 mins, 54.35 secs</td></tr><tr><td>esbuild-loader</td><td>teser + css-minimizer</td><td>2 mins, 21.11 secs</td></tr><tr><td>esbuild-loader</td><td>teser[esbuild] + css-minimizer</td><td>1 mins, 29.034 secs</td></tr><tr><td>esbuild-loader</td><td>teser[esbuild] + css-minimizer[esbuild]</td><td>1 mins, 19.44 secs</td></tr><tr><td>esbuild-loader</td><td>esbuild-minify</td><td>1 mins, 16.92 secs</td></tr></tbody></table><blockquote><p>빌드 품질에 상관없으신 분들이라면 esbuild 도입을 검토해보시는 것도 나쁘지 않을 것 같습니다.</p></blockquote><p>감사합니다.</p></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Webpack5/" rel="tag"># Webpack5</a> <a href="/tags/Persistent-cache/" rel="tag"># Persistent cache</a></div><div class="post-nav"><div class="post-nav-item"><a href="/system-failure-occurs-from-trivial-things/" rel="prev" title="장애는 사소한 것에서 발생한다"><i class="fa fa-chevron-left"></i> 장애는 사소한 것에서 발생한다</a></div><div class="post-nav-item"><a href="/base64/" rel="next" title="Base64">Base64 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments"><script src="https://utteranc.es/client.js" repo="kdevkr/kdevkr.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Mambo</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a></div></div></footer><script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script><script src="/js/third-party/fancybox.js"></script><script src="/js/third-party/pace.js"></script><script src="https://unpkg.com/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script><script>var options={bottom:"unset",right:"15px",left:"unset",time:"0.5s",mixColor:"transparent",backgroundColor:"transparent",buttonColorDark:"#100f2c",buttonColorLight:"#fff",saveInCookies:!0,label:"🌗",autoMatchOsTheme:!0};const darkmode=new Darkmode(options);window.darkmode=darkmode,darkmode.showWidget()</script></body></html>