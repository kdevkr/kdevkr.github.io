<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png"><link rel="mask-icon" href="/images/favicon/favicon.ico" color="#222"><meta name="google-site-verification" content="LMcddVW6xLBS7X1htGQ3duOIEmVp4ljku8sd3UuIcBg"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto+Sans+KR:300,300italic,400,400italic,700,700italic%7CPretendard-Bold:300,300italic,400,400italic,700,700italic%7CPretendard-Medium:300,300italic,400,400italic,700,700italic%7CJetbrains+Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-loading-bar.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"kdevkr.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.13.2","exturl":false,"sidebar":{"position":"left","display":"hide","padding":18,"offset":12,"width":240,"scrollpercent":true,"b2t":true},"copycode":{"enable":false,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script><meta name="description" content="본 글에 대한 코드는 kdevkr&#x2F;spring-boot-line-login 에서 확인할 수 있습니다.  우리가 이용하는 수 많은 웹 서비스에서는 회원가입 한 계정 혹은 이메일로 로그인하기 뿐만 아니라 카카오, 네이버, 구글, 메타, 애플, 깃허브와 같은 소셜 프로바이더의 계정으로 인증하여 쉽게 로그인할 수 있는 연동 기능을 제공한다. 국내의 경우"><meta property="og:type" content="article"><meta property="og:title" content="라인 로그인 연동"><meta property="og:url" content="https://kdevkr.github.io/line-login/index.html"><meta property="og:site_name" content="Mambo"><meta property="og:description" content="본 글에 대한 코드는 kdevkr&#x2F;spring-boot-line-login 에서 확인할 수 있습니다.  우리가 이용하는 수 많은 웹 서비스에서는 회원가입 한 계정 혹은 이메일로 로그인하기 뿐만 아니라 카카오, 네이버, 구글, 메타, 애플, 깃허브와 같은 소셜 프로바이더의 계정으로 인증하여 쉽게 로그인할 수 있는 연동 기능을 제공한다. 국내의 경우"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://lineapiusecase.com/img/LINE_login_en.webp"><meta property="og:image" content="https://kdevkr.github.io/images/posts/line-login/01.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/line-login/02.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/line-login/03.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/line-login/04.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/line-login/05.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/line-login/06.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/line-login/07.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/line-login/08.png"><meta property="article:published_time" content="2024-02-18T13:00:00.000Z"><meta property="article:modified_time" content="2024-09-22T05:17:54.791Z"><meta property="article:author" content="Mambo"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://lineapiusecase.com/img/LINE_login_en.webp"><link rel="canonical" href="https://kdevkr.github.io/line-login/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://kdevkr.github.io/line-login/","path":"line-login/","title":"라인 로그인 연동"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>라인 로그인 연동 | Mambo</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-V8LF04VMBF"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-V8LF04VMBF","only_pageview":false}</script><script src="/js/third-party/analytics/google-analytics.js"></script><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><link rel="alternate" href="/atom.xml" title="Mambo" type="application/atom+xml">
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope itemtype="http://schema.org/WebPage"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Mambo</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Today I Learned 🔥</p></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fas fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fas fa-archive fa-fw"></i>Archives<span class="badge">157</span></a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fas fa-user fa-fw"></i>About</a></li></ul></nav></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-overview-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">Table of Contents</li><li class="sidebar-nav-overview">Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Mambo" src="https://avatars1.githubusercontent.com/u/17937604?s=460&v=4"><p class="site-author-name" itemprop="name">Mambo</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">157</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-tags"><span class="site-state-item-count">253</span> <span class="site-state-item-name">tags</span></div></nav></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://github.com/kdevkr" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;kdevkr" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:kdevkr@gmail.com" title="E-Mail → mailto:kdevkr@gmail.com" rel="noopener" target="_blank"><i class="fas fa-envelope fa-fw"></i>E-Mail</a></span></div><div class="cc-license site-overview-item animated" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ko" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div><div class="back-to-top animated" role="button" aria-label="Back to top"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div class="sidebar-dimmer"></div></header><div class="reading-progress-bar"></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://kdevkr.github.io/line-login/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://avatars1.githubusercontent.com/u/17937604?s=460&v=4"><meta itemprop="name" content="Mambo"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Mambo"><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="라인 로그인 연동 | Mambo"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">라인 로그인 연동</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2024-02-18 22:00:00" itemprop="dateCreated datePublished" datetime="2024-02-18T22:00:00+09:00">2024-02-18</time></span></div></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>본 글에 대한 코드는 <a target="_blank" rel="noopener" href="https://github.com/kdevkr/spring-boot-line-login">kdevkr&#x2F;spring-boot-line-login</a> 에서 확인할 수 있습니다.</p></blockquote><p>우리가 이용하는 수 많은 웹 서비스에서는 회원가입 한 계정 혹은 이메일로 로그인하기 뿐만 아니라 카카오, 네이버, 구글, 메타, 애플, 깃허브와 같은 소셜 프로바이더의 계정으로 인증하여 쉽게 로그인할 수 있는 연동 기능을 제공한다. 국내의 경우 대부분 카카오 로그인이나 네이버 로그인을 사용하는 편인데 라인 플러스에서 제공하는 라인 메신저는 국내 보다는 일본이나 태국과 같은 해외 국가에서 많이 사용되는 편이다. <a target="_blank" rel="noopener" href="https://linepluscorp.com/">라인 플러스</a>가 있지만 라인 개발자 사이트 및 개발 문서의 경우 영어와 일본어만 지원하고 있다. 만약, 회사에서 만드는 서비스가 일본이나 태국 그리고 말레시이아 국가의 고객들을 대상으로 한다면 라인 메신저를 통한 연동 기능 지원은 거의 필수적으로 도입될 가능성이 있다.</p><p><img data-src="https://lineapiusecase.com/img/LINE_login_en.webp" alt="LINE Login Diagram"></p><h4 id="LINE-Developers-Console"><a href="#LINE-Developers-Console" class="headerlink" title="LINE Developers Console"></a>LINE Developers Console</h4><p><a target="_blank" rel="noopener" href="https://manager.line.biz/">라인 비즈니스 콘솔</a>을 통해 비즈니스 계정을 생성할 수 있으며 라인 비즈니스 계정을 만든 후에 <a target="_blank" rel="noopener" href="https://developers.line.biz/">개발자 콘솔</a>에 별도로 접속하여 라인 로그인 이나 메시지 채널을 등록하고 설정할 수 있다. 라인 플랫폼에 연동할 서비스 프로바이더를 생성해야하며 라인 로그인과 메시징 API 채널은 별도로 구분되어 만들어진다. 각 채널은 별도로 운영될 수 있지만 라인 로그인 채널에 친구 옵션으로 메시지 채널 계정을 연결할 수 있게 지원한다.</p><blockquote><p>라인 사용자가 로그인 채널에 연동하더라도 서비스 앱에서 사용자에게 메시지를 보내기 위해서는 사용자가 메시지 채널에 친구로 등록되어있어야만 합니다.</p></blockquote><h4 id="라인-로그인-채널-추가하기"><a href="#라인-로그인-채널-추가하기" class="headerlink" title="라인 로그인 채널 추가하기"></a>라인 로그인 채널 추가하기</h4><p>사용자가 라인 플랫폼을 통해 서비스에 연동할 수 있도록 웹 애플리케이션 방식의 라인 로그인 채널을 추가해야한다. 서비스 지역 옵션의 경우 일본 • 태국 • 대만 • 인도네이사 뿐이며 한국을 선택할 수 없는게 의아하긴 하지만 국내의 경우 가장 가까운 일본을 선택하면 될 것 같다.</p><p><img data-src="/images/posts/line-login/01.png"></p><h4 id="라인-로그인-콜백-주소-설정"><a href="#라인-로그인-콜백-주소-설정" class="headerlink" title="라인 로그인 콜백 주소 설정"></a>라인 로그인 콜백 주소 설정</h4><p>라인 로그인 채널을 추가했다면 LINE Login 설정 페이지로 이동하여 라인 로그인 과정에서 라인 플랫폼이 인증된 코드를 전달해줄 서비스 콜백 주소를 등록해두어야 한다. 반드시 백엔드 서버 주소가 콜백 주소일 필요는 없으며 프론트엔드에서 콜백을 받은 후 코드값을 백엔드에 REST API로 전달해도 무방하다. 콜백 주소는 개행으로 여러개를 등록하여 사용할 수 있도록 지원한다.</p><p><img data-src="/images/posts/line-login/02.png"></p><pre class="language-bash" data-language="bash"><div class="caption"><span>Callback URL</span></div><code class="language-bash">https://access.line.me/oauth2/v2.1/authorize?response_type<span class="token operator">=</span>code<span class="token operator">&amp;</span><span class="token assign-left variable">client_id</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>LOGIN_CHANNEL_ID<span class="token punctuation">&#125;</span><span class="token operator">&amp;</span><span class="token assign-left variable">redirect_uri</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>CALLBACK_URL<span class="token punctuation">&#125;</span></code></pre><blockquote><p>콜백 주소는 서비스에서 인증 코드로 액세스 토큰을 발급하는 경우에도 사용자 로그인 시 사용된 동일한 콜백 주소를 요구하므로 백엔드 서버에서도 채널 아이디와 채널 시크릿 뿐만 아니라 별도로 콜백 주소를 관리해야합니다.</p></blockquote><h4 id="OIDC-이메일-권한-요청"><a href="#OIDC-이메일-권한-요청" class="headerlink" title="OIDC 이메일 권한 요청"></a>OIDC 이메일 권한 요청</h4><p>서비스 연동시 사용자가 사용하는 이메일 주소가 반드시 필요하다면 이메일 획득 권한을 위해서 로그인 채널 옵션의 OpenID Connect에 대한 이메일 주소 권한을 별도로 활성화 해야한다. 실제로는 이메일을 어떻게 사용하는지에 대한 스크린샷을 업로드 해야하겠지만 개발 단계에서는 임의의 이미지를 등록해도 허용된다. 사용자 로그인 시 전달하는 URL 파라미터 중 스코프에 아래와 같이 email을 추가하면 이메일에 대한 권한 옵션이 UI에 노출될 것이다.</p><p><img data-src="/images/posts/line-login/03.png"><br><img data-src="/images/posts/line-login/04.png"><br><img data-src="/images/posts/line-login/05.png"></p><pre class="language-bash" data-language="bash"><div class="caption"><span>profile+openid+email</span></div><code class="language-bash">https://access.line.me/oauth2/v2.1/authorize?response_type<span class="token operator">=</span>code<span class="token operator">&amp;</span><span class="token assign-left variable">client_id</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>LOGIN_CHANNEL_ID<span class="token punctuation">&#125;</span><span class="token operator">&amp;</span><span class="token assign-left variable">scope</span><span class="token operator">=</span>profile%20openid%20email</code></pre><blockquote><p>사용자 인증 화면에서 이메일 주소 권한을 필수로 요구하는 옵션은 지원하지 않습니다.</p></blockquote><h4 id="OAuth-v2-1-액세스-토큰-발급"><a href="#OAuth-v2-1-액세스-토큰-발급" class="headerlink" title="OAuth v2.1 액세스 토큰 발급"></a>OAuth v2.1 액세스 토큰 발급</h4><p>사용자 로그인 후 콜백되어 전달되는 URL에 포함된 code 파라미터를 사용하여 서버에서는 <a target="_blank" rel="noopener" href="https://developers.line.biz/en/reference/line-login/#issue-access-token">액세스 토큰</a>을 발급할 수 있다. OpenID Connect 에 따라 액세스 토큰과 함께 ID Token이 제공되는데 JWT 형식으로 구성된 문자열이므로 페이로드를 확인하거나 <a target="_blank" rel="noopener" href="https://developers.line.biz/en/reference/line-login/#verify-id-token">Verify ID token</a>을 통해 토큰 검증과 함께 분석된 결과를 응답으로 받아볼 수 있다.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> idToken <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getIdToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> payload <span class="token operator">=</span> idToken<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"\\."</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> claims <span class="token operator">=</span> objectMapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getUrlDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">TypeReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"iss"</span><span class="token operator">:</span> <span class="token string">"https://access.line.me"</span><span class="token punctuation">,</span>
  <span class="token property">"sub"</span><span class="token operator">:</span> <span class="token string">"U1234567890abcdef1234567890abcdef"</span><span class="token punctuation">,</span>
  <span class="token property">"aud"</span><span class="token operator">:</span> <span class="token string">"1234567890"</span><span class="token punctuation">,</span>
  <span class="token property">"exp"</span><span class="token operator">:</span> <span class="token number">1504169092</span><span class="token punctuation">,</span>
  <span class="token property">"iat"</span><span class="token operator">:</span> <span class="token number">1504263657</span><span class="token punctuation">,</span>
  <span class="token property">"nonce"</span><span class="token operator">:</span> <span class="token string">"0987654asdf"</span><span class="token punctuation">,</span>
  <span class="token property">"amr"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"pwd"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Taro Line"</span><span class="token punctuation">,</span>
  <span class="token property">"picture"</span><span class="token operator">:</span> <span class="token string">"https://sample_line.me/aBcdefg123456"</span><span class="token punctuation">,</span>
  <span class="token property">"email"</span><span class="token operator">:</span> <span class="token string">"taro.line@example.com"</span>
<span class="token punctuation">&#125;</span></code></pre><blockquote><p>JWT 페이로드에 포함되는 항목 중 <code>sub</code> 는 라인 사용자에 대한 User ID를 의미합니다.</p></blockquote><hr><h4 id="메시지-채널과-연동하기-친구-추가-옵션"><a href="#메시지-채널과-연동하기-친구-추가-옵션" class="headerlink" title="메시지 채널과 연동하기 (친구 추가 옵션)"></a>메시지 채널과 연동하기 (친구 추가 옵션)</h4><p>라인 로그인 기능을 도입하더라도 로그인 채널과 메시지 채널은 별도로 분리되어있어 메시지 채널을 별도로 생성한 후 로그인 채널에서 메시지 채널에 등록할 수 있는 기능을 활성화하고 <a target="_blank" rel="noopener" href="https://developers.line.biz/en/docs/line-login/link-a-bot/">사용자에게 친구 추가를 요구</a>해야한다. 친구 추가 옵션(Add friend option)에 메시지 채널을 선택한다면 로그인 연동 시 사용할 수 있는 bot_prompt 파라미터에 값에 따라 친구 추가 옵션 노출 방식을 제공할 수 있다.</p><pre class="language-bash" data-language="bash"><code class="language-bash">https://client.example.org/cb?code<span class="token operator">=</span><span class="token punctuation">&#123;</span>CODE<span class="token punctuation">&#125;</span><span class="token operator">&amp;</span><span class="token assign-left variable">state</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>STATE<span class="token punctuation">&#125;</span><span class="token operator">&amp;</span><span class="token assign-left variable">friendship_status_changed</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>FRIENDSHIP_STATUS_CHANGED<span class="token punctuation">&#125;</span></code></pre><p>친구 추가 옵션을 사용하는 경우에 사용자 로그인 후 콜백 시 전달되는 코드 파라미터 이외에 friendship_status_changed 파라미터가 추가적으로 전달되어 해당 사용자가 친구 추가를 수행했는지 여부를 확인할 수 있다. 만약, 로그인 화면에 메시지 채널을 친구로 추가할 수 있는 버튼이 노출되지 않는다면 아래와 같은 항목을 제대로 설정했는지 다시 한번 체크해보도록 하자.</p><ul><li><a target="_blank" rel="noopener" href="https://developers.line.biz/en/docs/line-login/link-a-bot/#link-a-line-official-account">Link a LINE Official Account with your channel</a></li><li><a target="_blank" rel="noopener" href="https://developers.line.biz/en/docs/line-login/link-a-bot/#redirect-users">Redirect users to the LINE Login authorization URL with the bot_prompt query parameter</a></li></ul><h4 id="사용자에게-메시지-보내기"><a href="#사용자에게-메시지-보내기" class="headerlink" title="사용자에게 메시지 보내기"></a>사용자에게 메시지 보내기</h4><p>사용자가 메시지 채널에 친구로 등록하였다면 로그인 연동을 수행한 사용자에게 메시지를 보낼 수 있다. 사용자 프로필 정보를 포함하고 있는 <a target="_blank" rel="noopener" href="https://developers.line.biz/en/docs/line-login/verify-id-token/#page-title">JWT 형식의 IDToken</a>의 항목 중 sub 가 라인에서 제공하는 API에서 내부적으로 사용할 수 있는 User ID이며 <a target="_blank" rel="noopener" href="https://developers.line.biz/en/reference/messaging-api/#send-push-message">Messaging API</a> 에서는 User ID를 사용하여 사용자에게 메시지를 보낼 수 있도록 제공한다.</p><pre class="language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">line</span><span class="token punctuation">:</span>
  <span class="token key atrule">bot</span><span class="token punctuation">:</span>
    <span class="token key atrule">channel-token</span><span class="token punctuation">:</span> WQ9SQjcWBJqD020+ri<span class="token important">***</span>
    <span class="token key atrule">channel-secret</span><span class="token punctuation">:</span> 1ba24f197605a2<span class="token important">***</span></code></pre><blockquote><p>User ID는 U1234567890abcdef1234567890abcdef 와 같이 UXXX 로 시작하는 값 입니다.<br>Line Java SDK 에서 채널 토큰은 메시지 채널의 아이디가 아닌 Messaging API의 액세스 토큰임을 주의해야합니다.</p></blockquote><h4 id="라인-로그인-인증-화면-국제화"><a href="#라인-로그인-인증-화면-국제화" class="headerlink" title="라인 로그인 인증 화면 국제화"></a>라인 로그인 인증 화면 국제화</h4><p><img data-src="/images/posts/line-login/06.png"></p><p><code>ui_locales</code> 파라미터에 로케일을 전달하여 사용자가 라인 플랫폼에 인증하기 위한 화면에 대해 국제화를 적용할 수 있다. 또한, 라인 로그인 채널 설정에서 Localization 설정을 통해 채널 이름과 설명 부분을 언어에 따라 표시되도록 설정할 수 있다. 단, 친구 옵션으로 표시되는 메시지 채널에 대한 이름은 별도로 지원하지 않는다.</p><pre class="language-bash" data-language="bash"><code class="language-bash">https://access.line.me/oauth2/v2.1/authorize?response_type<span class="token operator">=</span>code<span class="token operator">&amp;</span><span class="token assign-left variable">client_id</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>LOGIN_CHANNEL_ID<span class="token punctuation">&#125;</span><span class="token operator">&amp;</span><span class="token assign-left variable">redirect_uri</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>CALLBACK_URL<span class="token punctuation">&#125;</span><span class="token operator">&amp;</span><span class="token assign-left variable">ui_locales</span><span class="token operator">=</span>ja_JP</code></pre><p><img data-src="/images/posts/line-login/07.png"></p><p><img data-src="/images/posts/line-login/08.png"></p></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-item"><a href="/springdoc-openapi-ui/" rel="prev" title="Springdoc OpenAPI UI"><i class="fa fa-chevron-left"></i> Springdoc OpenAPI UI</a></div><div class="post-nav-item"><a href="/java-locale-from-language/" rel="next" title="문자열에서 로케일로 변환하는 방법">문자열에서 로케일로 변환하는 방법 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments giscus-container"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Mambo</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script><script src="/js/third-party/fancybox.js"></script><script src="/js/third-party/pace.js"></script><script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script><script>var options={bottom:"unset",right:"15px",left:"unset",time:"0.5s",mixColor:"transparent",backgroundColor:"transparent",buttonColorDark:"#100f2c",buttonColorLight:"#fff",saveInCookies:!0,label:"🌗",autoMatchOsTheme:!0};const darkmode=new Darkmode(options);window.darkmode=darkmode,darkmode.showWidget()</script><script class="next-config" data-name="giscus" type="application/json">{"enable":true,"repo":"kdevkr/kdevkr.github.io","repo_id":"MDEwOlJlcG9zaXRvcnkxNTQxNjA4OTA=","category":"Announcements","category_id":"DIC_kwDOCTBO-s4CYmQM","mapping":"pathname","reactions_enabled":1,"emit_metadata":1,"theme":"light","lang":"ko","crossorigin":"anonymous","input_position":"bottom","loading":"lazy"}</script><script>document.addEventListener("page:loaded",()=>{CONFIG.page.comments&&NexT.utils.loadComments(".giscus-container").then(()=>NexT.utils.getScript("https://giscus.app/client.js",{attributes:{async:!0,crossOrigin:"anonymous","data-repo":CONFIG.giscus.repo,"data-repo-id":CONFIG.giscus.repo_id,"data-category":CONFIG.giscus.category,"data-category-id":CONFIG.giscus.category_id,"data-mapping":CONFIG.giscus.mapping,"data-reactions-enabled":CONFIG.giscus.reactions_enabled,"data-emit-metadata":CONFIG.giscus.emit_metadata,"data-theme":CONFIG.giscus.theme,"data-lang":CONFIG.giscus.lang,"data-input-position":CONFIG.giscus.input_position,"data-loading":CONFIG.giscus.loading},parentNode:document.querySelector(".giscus-container")}))})</script></body></html>