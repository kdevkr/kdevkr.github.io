<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png"><link rel="mask-icon" href="/images/favicon/favicon.ico" color="#222"><meta name="google-site-verification" content="LMcddVW6xLBS7X1htGQ3duOIEmVp4ljku8sd3UuIcBg"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto+Sans+KR:300,300italic,400,400italic,700,700italic%7CPretendard-Bold:300,300italic,400,400italic,700,700italic%7CPretendard-Medium:300,300italic,400,400italic,700,700italic%7CJetbrains+Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-loading-bar.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"kdevkr.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.13.2","exturl":false,"sidebar":{"position":"left","display":"hide","padding":18,"offset":12,"width":240,"scrollpercent":true,"b2t":true},"copycode":{"enable":false,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script><meta property="og:type" content="website"><meta property="og:title" content="Mambo"><meta property="og:url" content="https://kdevkr.github.io/page/19/index.html"><meta property="og:site_name" content="Mambo"><meta property="og:locale" content="en_US"><meta property="article:author" content="Mambo"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://kdevkr.github.io/page/19/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/19/index.html","title":""}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Mambo</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-V8LF04VMBF"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-V8LF04VMBF","only_pageview":false}</script><script src="/js/third-party/analytics/google-analytics.js"></script><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><link rel="alternate" href="/atom.xml" title="Mambo" type="application/atom+xml">
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope itemtype="http://schema.org/WebPage"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><h1 class="site-title">Mambo</h1><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Today I Learned 🔥</p></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fas fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fas fa-archive fa-fw"></i>Archives<span class="badge">106</span></a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fas fa-user fa-fw"></i>About</a></li></ul></nav></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-overview-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">Table of Contents</li><li class="sidebar-nav-overview">Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Mambo" src="https://avatars1.githubusercontent.com/u/17937604?s=460&v=4"><p class="site-author-name" itemprop="name">Mambo</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">106</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-tags"><span class="site-state-item-count">157</span> <span class="site-state-item-name">tags</span></div></nav></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://github.com/kdevkr" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;kdevkr" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:kdevkr@gmail.com" title="E-Mail → mailto:kdevkr@gmail.com" rel="noopener" target="_blank"><i class="fas fa-envelope fa-fw"></i>E-Mail</a></span></div><div class="cc-license site-overview-item animated" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ko" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div><div class="back-to-top animated" role="button" aria-label="Back to top"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div class="sidebar-dimmer"></div></header><div class="reading-progress-bar"></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner index posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://kdevkr.github.io/bouncycastle-java/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://avatars1.githubusercontent.com/u/17937604?s=460&v=4"><meta itemprop="name" content="Mambo"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Mambo"><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="undefined | Mambo"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/bouncycastle-java/" class="post-title-link" itemprop="url">BouncyCastle Java로 X.509 인증서 만들기</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2023-07-30 14:00:00" itemprop="dateCreated datePublished" datetime="2023-07-30T14:00:00+09:00">2023-07-30</time></span></div></div></header><div class="post-body" itemprop="articleBody"><p>자바에서 암호화 또는 전자서명을 위한 기능을 JCA를 통해 제공하기는 하지만 실질적으로는 <a target="_blank" rel="noopener" href="https://github.com/bcgit/bc-java">Bouncy Castle</a>이라는 암호 관련 라이브러리를 활용한다. 본 글에서는 BouncyCastle에서 제공하는 여러 클래스들을 활용해서 사설 루트 인증서를 만들고 그것을 기반으로 클라이언트를 위한 X.509 인증서를 발급하기 위한 방법을 정리하고자 한다. 이렇게 만들어지는 X.509 인증서는 보안 레벨이 높은 시스템에서 Mutual TLS 인증을 수행할 수 있다.</p><pre class="language-groovy" data-language="groovy"><div class="caption"><span>build.gradle</span></div><code class="language-groovy">dependencies <span class="token punctuation">&#123;</span>
    implementation <span class="token string">'org.bouncycastle:bcprov-jdk18on:1.75'</span>
    implementation <span class="token string">'org.bouncycastle:bcpkix-jdk18on:1.75'</span>
<span class="token punctuation">&#125;</span></code></pre><blockquote><p>X.509 인증서에 대한 표준은 <a target="_blank" rel="noopener" href="https://datatracker.ietf.org/doc/html/rfc5280">RFC5280</a>로 정의되어 있고 ASN.1 표기를 따르며 지금은 X.509 v3을 사용하고 있다.</p></blockquote><h4 id="BouncyCastleProvider"><a href="#BouncyCastleProvider" class="headerlink" title="BouncyCastleProvider"></a>BouncyCastleProvider</h4><p>BouncyCastle 자바 라이브러리를 클래스 패스에 추가했더라도 BouncyCastleProvider를 JCE Provider로 추가해야한다. <code>$JAVA_HOME/lib/security/java.security</code>에 명시해도 되지만 애플리케이션을 구성하는 클래스에서 런타임 시점에 BouncyCastleProvider를 보안 프로바이더에 추가해도 된다.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">Security</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>bouncycastle<span class="token punctuation">.</span>jce<span class="token punctuation">.</span>provider<span class="token punctuation">.</span></span><span class="token class-name">BouncyCastleProvider</span></span><span class="token punctuation">;</span>
 
<span class="token keyword">static</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">Security</span><span class="token punctuation">.</span><span class="token function">addProvider</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BouncyCastleProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre><h4 id="Self-signed-CA-인증서-발급하기"><a href="#Self-signed-CA-인증서-발급하기" class="headerlink" title="Self signed CA 인증서 발급하기"></a>Self signed CA 인증서 발급하기</h4><p>일반적으로 X.509 인증서를 발급하는 경우 openssl 명령어를 사용해서 키 페어를 생성하고 그것을 기반으로 CSR과 X.509 인증서를 생성할 것이다. Bouncy Castle 자바 라이브러리르를 통해 만드려는 경우 Deprecated 선언된 X509V3CertificateGenerator를 사용해도 무방할 것 같지만 X509v3CertificateBuilder를 사용해서 X509Certificate를 만들어보려고 한다.</p><blockquote><p>X509V3CertificateGenerator에 대해서 Deprecated 처리한 사유는 딱히 알 수 없는 것 같다.</p></blockquote><p>JcaX509v3CertificateBuilder와 JcaContentSignerBuilder를 사용해서 X509CertificateHolder를 생성하고 JcaX509CertificateConverter를 이용하여 X509Certificate로 변환할 수 있다. 대략적인 코드는 아래와 같으니 참고해보도록 하자.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> securityProvider <span class="token operator">=</span> <span class="token class-name">BouncyCastleProvider</span><span class="token punctuation">.</span><span class="token constant">PROVIDER_NAME</span><span class="token punctuation">;</span>
<span class="token class-name">JcaX509ExtensionUtils</span> x509ExtensionUtils <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JcaX509ExtensionUtils</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">JcaX509CertificateConverter</span> x509CertificateConverter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JcaX509CertificateConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setProvider</span><span class="token punctuation">(</span>securityProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> signatureAlgorithm <span class="token operator">=</span> <span class="token string">"sha256WithRSA"</span><span class="token punctuation">;</span>

<span class="token class-name">KeyPairGenerator</span> keyPairGenerator <span class="token operator">=</span> <span class="token class-name">KeyPairGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"RSA"</span><span class="token punctuation">,</span> securityProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>
keyPairGenerator<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">KeyPair</span> rootKeyPair <span class="token operator">=</span> keyPairGenerator<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">X500Name</span> issuer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X500NameBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">addRDN</span><span class="token punctuation">(</span><span class="token class-name">BCStyle</span><span class="token punctuation">.</span><span class="token constant">CN</span><span class="token punctuation">,</span> <span class="token string">"Mambo Org"</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">BigInteger</span> serialNumber <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">ZonedDateTime</span> now <span class="token operator">=</span> <span class="token class-name">ZonedDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Date</span> notBefore <span class="token operator">=</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>now<span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Date</span> notAfter <span class="token operator">=</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>now<span class="token punctuation">.</span><span class="token function">plus</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span><span class="token constant">YEARS</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">SubjectPublicKeyInfo</span> publicKeyInfo <span class="token operator">=</span> <span class="token class-name">SubjectPublicKeyInfo</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>rootKeyPair<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">X509CertificateHolder</span> rootCertHolder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JcaX509v3CertificateBuilder</span><span class="token punctuation">(</span>issuer<span class="token punctuation">,</span> serialNumber<span class="token punctuation">,</span> notBefore<span class="token punctuation">,</span> notAfter<span class="token punctuation">,</span> issuer<span class="token punctuation">,</span> publicKeyInfo<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addExtension</span><span class="token punctuation">(</span><span class="token class-name">Extension</span><span class="token punctuation">.</span>basicConstraints<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BasicConstraints</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addExtension</span><span class="token punctuation">(</span><span class="token class-name">Extension</span><span class="token punctuation">.</span>subjectKeyIdentifier<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> x509ExtensionUtils<span class="token punctuation">.</span><span class="token function">createSubjectKeyIdentifier</span><span class="token punctuation">(</span>rootKeyPair<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JcaContentSignerBuilder</span><span class="token punctuation">(</span>signatureAlgorithm<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>rootKeyPair<span class="token punctuation">.</span><span class="token function">getPrivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">X509Certificate</span> rootCert <span class="token operator">=</span> x509CertificateConverter<span class="token punctuation">.</span><span class="token function">getCertificate</span><span class="token punctuation">(</span>rootCertHolder<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h5 id="X500Name"><a href="#X500Name" class="headerlink" title="X500Name"></a>X500Name</h5><p>자바에서 기본적으로 제공하는 X500Principal 대신에 BouncyCastle의 X500Name 클래스로 FQDN, 발급자와 소유자와 같은 주체(Subject) 정보를 기입할 수 있다. 또한, RDN(Relative Distinguished Names) 라고도 하는데 X500NameBuilder에서는 addRDN 이라는 함수를 제공한다. 더 자세한 내용은 <a target="_blank" rel="noopener" href="https://knowledge.digicert.com/generalinformation/INFO1745.html">What is a Distinguished Name (DN)?</a>를 참고해보자.</p><h5 id="SubjectPublickeyInfo"><a href="#SubjectPublickeyInfo" class="headerlink" title="SubjectPublickeyInfo"></a>SubjectPublickeyInfo</h5><p>X.509 인증서에 포함되는 SubjectPublickeyInfo에 대한 클래스로 DER 인코딩된 공개키를 의미한다.</p><h5 id="BasicConstraints"><a href="#BasicConstraints" class="headerlink" title="BasicConstraints"></a>BasicConstraints</h5><p>다른 인증서를 발급할 권한이 있는지를 나타내는 것으로 CA 인증서라는 것을 의미로 부여할 수 있다.</p><h4 id="X-509-클라이언트-인증서-발급하기"><a href="#X-509-클라이언트-인증서-발급하기" class="headerlink" title="X.509 클라이언트 인증서 발급하기"></a>X.509 클라이언트 인증서 발급하기</h4><p>앞서 루트 CA 인증서 발급을 이해하였다면 CA 인증서를 만드는데 사용된 비밀키를 사용해서 클라이언트를 위한 X.509 인증서를 만드는 것을 알아보도록 하자.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">KeyPair</span> clientKeyPair <span class="token operator">=</span> keyPairGenerator<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">X500Name</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X500NameBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">addRDN</span><span class="token punctuation">(</span><span class="token class-name">BCStyle</span><span class="token punctuation">.</span><span class="token constant">CN</span><span class="token punctuation">,</span> <span class="token string">"Mambo"</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">BigInteger</span> clientSN <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ZonedDateTime</span> clientNow <span class="token operator">=</span> <span class="token class-name">ZonedDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Date</span> clientNotBefore <span class="token operator">=</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>clientNow<span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Date</span> clientNotAfter <span class="token operator">=</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>clientNow<span class="token punctuation">.</span><span class="token function">plus</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span><span class="token constant">YEARS</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">SubjectPublicKeyInfo</span> clientPublicKeyInfo <span class="token operator">=</span> <span class="token class-name">SubjectPublicKeyInfo</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>clientKeyPair<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">X509CertificateHolder</span> clientCertHolder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JcaX509v3CertificateBuilder</span><span class="token punctuation">(</span>issuer<span class="token punctuation">,</span> clientSN<span class="token punctuation">,</span> clientNotBefore<span class="token punctuation">,</span> clientNotAfter<span class="token punctuation">,</span> client<span class="token punctuation">,</span> clientPublicKeyInfo<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">addExtension</span><span class="token punctuation">(</span><span class="token class-name">Extension</span><span class="token punctuation">.</span>basicConstraints<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BasicConstraints</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">addExtension</span><span class="token punctuation">(</span><span class="token class-name">Extension</span><span class="token punctuation">.</span>authorityKeyIdentifier<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> x509ExtensionUtils<span class="token punctuation">.</span><span class="token function">createAuthorityKeyIdentifier</span><span class="token punctuation">(</span>rootCert<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">addExtension</span><span class="token punctuation">(</span><span class="token class-name">Extension</span><span class="token punctuation">.</span>subjectKeyIdentifier<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> x509ExtensionUtils<span class="token punctuation">.</span><span class="token function">createSubjectKeyIdentifier</span><span class="token punctuation">(</span>clientKeyPair<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">addExtension</span><span class="token punctuation">(</span><span class="token class-name">Extension</span><span class="token punctuation">.</span>keyUsage<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">KeyUsage</span><span class="token punctuation">(</span><span class="token class-name">KeyUsage</span><span class="token punctuation">.</span>digitalSignature<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JcaContentSignerBuilder</span><span class="token punctuation">(</span>signatureAlgorithm<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>rootKeyPair<span class="token punctuation">.</span><span class="token function">getPrivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">X509Certificate</span> clientCert <span class="token operator">=</span> x509CertificateConverter<span class="token punctuation">.</span><span class="token function">getCertificate</span><span class="token punctuation">(</span>clientCertHolder<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>BasicConstraints로 CA가 아니며 AuthorityKeyIdentifier로 발급자의 공개키를 식별할 수 있도록 하였다. 그리고 KeyUsage로 클라이언트에게 발급한 X.509 인증서가 전자서명 용도임을 확장(Extension)에 명시했다.</p><h4 id="X509Certificate-인증서-검증하기"><a href="#X509Certificate-인증서-검증하기" class="headerlink" title="X509Certificate 인증서 검증하기"></a>X509Certificate 인증서 검증하기</h4><p>클라이언트가 요청 시 포함해서 전달한 X.509 인증서가 애플리케이션 혹은 시스템에서 발급한 것인지를 검증하는 과정이 필요하다. <code>java.security.cert.X509Certificate</code> 클래스에는 기본적으로 구현된 verify 함수를 제공하고 있기 때문에 아래와 같이 간단하게 루트 인증서의 공개키를 기반으로 클라이언트 인증서를 검증할 수 있다.</p><pre class="language-java" data-language="java"><code class="language-java">clientCert<span class="token punctuation">.</span><span class="token function">checkValidity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
clientCert<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>rootCert<span class="token punctuation">.</span><span class="token function">getPublicKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> securityProvider<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="X-509-인증서-및-키-페어-저장하기"><a href="#X-509-인증서-및-키-페어-저장하기" class="headerlink" title="X.509 인증서 및 키 페어 저장하기"></a>X.509 인증서 및 키 페어 저장하기</h4><p>일반적으로 X.509 인증서에 포함되는 공개키는 X509EncodedSpec에 따라 바이너리 형태의 DER로 인코딩되어 포함된다. 그러나 X.509 인증서와 키 페어를 교환할 때에는 PEM 파일 형식을 많이 사용하는 편으로 BouncyCastle 자바 라이브러리에 포함된 PemWriter와 PemObject를 활용해서 X.509 인증서와 비밀키를 PEM 파일로 저장할 수 있다.</p><pre class="language-java" data-language="java"><code class="language-java">
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PemUtil</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">PemUtil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">toPem</span><span class="token punctuation">(</span><span class="token class-name">String</span> type<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encoded<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">StringWriter</span> writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token class-name">PemWriter</span> pemWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JcaPEMWriter</span><span class="token punctuation">(</span>writer<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            pemWriter<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PemObject</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> encoded<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            pemWriter<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> writer<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">toPem</span><span class="token punctuation">(</span><span class="token class-name">PrivateKey</span> privateKey<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>privateKey<span class="token punctuation">,</span> <span class="token string">"private key is required"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">toPem</span><span class="token punctuation">(</span><span class="token string">"PRIVATE KEY"</span><span class="token punctuation">,</span> privateKey<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">toPem</span><span class="token punctuation">(</span><span class="token class-name">X509Certificate</span> certificate<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">CertificateEncodingException</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>certificate<span class="token punctuation">,</span> <span class="token string">"certificate is required"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">toPem</span><span class="token punctuation">(</span><span class="token string">"CERTIFICATE"</span><span class="token punctuation">,</span> certificate<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>


<span class="token class-name">String</span> rootCertPem <span class="token operator">=</span> <span class="token class-name">PemUtil</span><span class="token punctuation">.</span><span class="token function">toPem</span><span class="token punctuation">(</span>rootCert<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ca.pem</span>
<span class="token class-name">String</span> clientCertPem <span class="token operator">=</span> <span class="token class-name">PemUtil</span><span class="token punctuation">.</span><span class="token function">toPem</span><span class="token punctuation">(</span>clientCert<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//client.pem</span>
<span class="token class-name">String</span> clientPrivateKeyPem <span class="token operator">=</span> <span class="token class-name">PemUtil</span><span class="token punctuation">.</span><span class="token function">toPem</span><span class="token punctuation">(</span>clientKeyPair<span class="token punctuation">.</span><span class="token function">getPrivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//client.key</span></code></pre><blockquote><p>PEM 형식으로 Base64로 구성된 문자열을 파일로 저장하는 방법은 본 글에서 다루지 않는다.</p></blockquote><h4 id="X-509-인증서-및-키-페어-불러오기"><a href="#X-509-인증서-및-키-페어-불러오기" class="headerlink" title="X.509 인증서 및 키 페어 불러오기"></a>X.509 인증서 및 키 페어 불러오기</h4><p>클라이언트의 X.509 인증서는 요청에 포함되어 HttpServletRequest로 부터 가져올 수 있지만 클라이언트 인증서 검증을 위한 CA 인증서와 비밀키는 별도의 파일이나 문자열로부터 불러와야한다. 공개키와 비밀키에 대해서는 JcaPEMKeyConverter를 사용해서 가져올 수 있다.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PemUtil</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">PemUtil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">PemObject</span> <span class="token function">loadPem</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encoded<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">StringReader</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>encoded<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token class-name">PEMParser</span> pemParser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PEMParser</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> pemParser<span class="token punctuation">.</span><span class="token function">readPemObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Object</span> <span class="token function">loadObject</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encoded<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">StringReader</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>encoded<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token class-name">PEMParser</span> pemParser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PEMParser</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> pemParser<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">X509Certificate</span> <span class="token function">loadCertificate</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encoded<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">CertificateException</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">PemObject</span> obj <span class="token operator">=</span> <span class="token function">loadPem</span><span class="token punctuation">(</span>encoded<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CertificateFactory</span> factory <span class="token operator">=</span> <span class="token class-name">CertificateFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"X.509"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">X509Certificate</span><span class="token punctuation">)</span> factory<span class="token punctuation">.</span><span class="token function">generateCertificate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">PublicKey</span> <span class="token function">loadPublicKey</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encoded<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Object</span> obj <span class="token operator">=</span> <span class="token function">loadObject</span><span class="token punctuation">(</span>encoded<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">JcaPEMKeyConverter</span> converter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JcaPEMKeyConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setProvider</span><span class="token punctuation">(</span><span class="token class-name">BouncyCastleProvider</span><span class="token punctuation">.</span><span class="token constant">PROVIDER_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SubjectPublicKeyInfo</span> publicKeyInfo <span class="token operator">=</span> <span class="token class-name">SubjectPublicKeyInfo</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> converter<span class="token punctuation">.</span><span class="token function">getPublicKey</span><span class="token punctuation">(</span>publicKeyInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">PrivateKey</span> <span class="token function">loadPrivateKey</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encoded<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Object</span> obj <span class="token operator">=</span> <span class="token function">loadObject</span><span class="token punctuation">(</span>encoded<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">JcaPEMKeyConverter</span> converter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JcaPEMKeyConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setProvider</span><span class="token punctuation">(</span><span class="token class-name">BouncyCastleProvider</span><span class="token punctuation">.</span><span class="token constant">PROVIDER_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrivateKeyInfo</span> privateKeyInfo <span class="token operator">=</span> <span class="token class-name">PrivateKeyInfo</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> converter<span class="token punctuation">.</span><span class="token function">getPrivateKey</span><span class="token punctuation">(</span>privateKeyInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre><p>본 글에서 다룬 예제 코드에 대한 보다 자세한 것은 <a target="_blank" rel="noopener" href="https://github.com/kdevkr/spring-boot-security/blob/main/src/test/java/com/example/demo/x509/X509Test.java">X509Test.java</a>를 통해 확인할 수 있다.</p><h4 id="참고-링크"><a href="#참고-링크" class="headerlink" title="참고 링크"></a>참고 링크</h4><ul><li><a target="_blank" rel="noopener" href="https://www.baeldung.com/java-bouncy-castle">Introduction to BouncyCastle with Java</a></li><li><a target="_blank" rel="noopener" href="https://www.baeldung.com/java-read-pem-file-keys">How to Read PEM File to Get Public and Private Keys</a></li><li><a target="_blank" rel="noopener" href="https://www.baeldung.com/java-rsa">RSA in Java</a></li></ul></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><nav class="pagination"><a class="extend prev" rel="prev" href="/page/18/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><span class="page-number current">19</span><a class="page-number" href="/page/20/">20</a><span class="space">&hellip;</span><a class="page-number" href="/page/106/">106</a><a class="extend next" rel="next" href="/page/20/"><i class="fa fa-angle-right" aria-label="Next page"></i></a></nav></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Mambo</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script><script src="/js/third-party/fancybox.js"></script><script src="/js/third-party/pace.js"></script><script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script><script>var options={bottom:"unset",right:"15px",left:"unset",time:"0.5s",mixColor:"transparent",backgroundColor:"transparent",buttonColorDark:"#100f2c",buttonColorLight:"#fff",saveInCookies:!0,label:"🌗",autoMatchOsTheme:!0};const darkmode=new Darkmode(options);window.darkmode=darkmode,darkmode.showWidget()</script><script class="next-config" data-name="giscus" type="application/json">{"enable":true,"repo":"kdevkr/kdevkr.github.io","repo_id":"MDEwOlJlcG9zaXRvcnkxNTQxNjA4OTA=","category":"Announcements","category_id":"DIC_kwDOCTBO-s4CYmQM","mapping":"pathname","reactions_enabled":1,"emit_metadata":1,"theme":"light","lang":"ko","input_position":"bottom","loading":"lazy"}</script><script>document.addEventListener("page:loaded",()=>{CONFIG.page.comments&&NexT.utils.loadComments(".giscus-container").then(()=>NexT.utils.getScript("https://giscus.app/client.js",{attributes:{async:!0,crossOrigin:"anonymous","data-repo":CONFIG.giscus.repo,"data-repo-id":CONFIG.giscus.repo_id,"data-category":CONFIG.giscus.category,"data-category-id":CONFIG.giscus.category_id,"data-mapping":CONFIG.giscus.mapping,"data-reactions-enabled":CONFIG.giscus.reactions_enabled,"data-emit-metadata":CONFIG.giscus.emit_metadata,"data-theme":CONFIG.giscus.theme,"data-lang":CONFIG.giscus.lang,"data-input-position":CONFIG.giscus.input_position,"data-loading":CONFIG.giscus.loading},parentNode:document.querySelector(".giscus-container")}))})</script></body></html>