<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png"><link rel="mask-icon" href="/images/favicon/favicon.ico" color="#222"><meta name="google-site-verification" content="LMcddVW6xLBS7X1htGQ3duOIEmVp4ljku8sd3UuIcBg"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto+Sans+KR:300,300italic,400,400italic,700,700italic%7CPretendard-Bold:300,300italic,400,400italic,700,700italic%7CPretendard-Medium:300,300italic,400,400italic,700,700italic%7CJetbrains+Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-loading-bar.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"kdevkr.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.13.2","exturl":false,"sidebar":{"position":"left","display":"hide","padding":18,"offset":12,"width":240,"scrollpercent":true,"b2t":true},"copycode":{"enable":false,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script><meta name="description" content="패스키 로그인은 사용자 계정에 대한 비밀번호를 입력하지 않고 사용자 계정에 미리 등록한 기기를 통해 지문이나 얼굴 인식 그리고 보안키 등으로 비교적 쉽고 안전하게 인증을 수행하는 것을 말한다. 패스키 인증은 로그인 뿐만 아니라 아마존 웹 서비스와 깃허브처럼 MFA를 위해 도입되기도 한다. 패스키 구현에 대해서 찾아보면 참고할만한 예제는 많은데 그것만으로 이"><meta property="og:type" content="article"><meta property="og:title" content="패스키 로그인"><meta property="og:url" content="https://kdevkr.github.io/passkey-login/index.html"><meta property="og:site_name" content="Mambo"><meta property="og:description" content="패스키 로그인은 사용자 계정에 대한 비밀번호를 입력하지 않고 사용자 계정에 미리 등록한 기기를 통해 지문이나 얼굴 인식 그리고 보안키 등으로 비교적 쉽고 안전하게 인증을 수행하는 것을 말한다. 패스키 인증은 로그인 뿐만 아니라 아마존 웹 서비스와 깃허브처럼 MFA를 위해 도입되기도 한다. 패스키 구현에 대해서 찾아보면 참고할만한 예제는 많은데 그것만으로 이"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://kdevkr.github.io/images/posts/passkey-login/01.png"><meta property="article:published_time" content="2024-07-11T12:00:00.000Z"><meta property="article:modified_time" content="2024-07-11T13:02:49.203Z"><meta property="article:author" content="Mambo"><meta property="article:tag" content="Passkey"><meta property="article:tag" content="WebAuthn"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://kdevkr.github.io/images/posts/passkey-login/01.png"><link rel="canonical" href="https://kdevkr.github.io/passkey-login/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://kdevkr.github.io/passkey-login/","path":"passkey-login/","title":"패스키 로그인"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>패스키 로그인 | Mambo</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-V8LF04VMBF"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-V8LF04VMBF","only_pageview":false}</script><script src="/js/third-party/analytics/google-analytics.js"></script><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><link rel="alternate" href="/atom.xml" title="Mambo" type="application/atom+xml">
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope itemtype="http://schema.org/WebPage"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Mambo</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Today I Learned 🔥</p></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fas fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fas fa-archive fa-fw"></i>Archives<span class="badge">149</span></a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fas fa-user fa-fw"></i>About</a></li></ul></nav></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-overview-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">Table of Contents</li><li class="sidebar-nav-overview">Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Mambo" src="https://avatars1.githubusercontent.com/u/17937604?s=460&v=4"><p class="site-author-name" itemprop="name">Mambo</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">149</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-tags"><span class="site-state-item-count">234</span> <span class="site-state-item-name">tags</span></div></nav></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://github.com/kdevkr" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;kdevkr" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:kdevkr@gmail.com" title="E-Mail → mailto:kdevkr@gmail.com" rel="noopener" target="_blank"><i class="fas fa-envelope fa-fw"></i>E-Mail</a></span></div><div class="cc-license site-overview-item animated" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ko" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div><div class="back-to-top animated" role="button" aria-label="Back to top"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div class="sidebar-dimmer"></div></header><div class="reading-progress-bar"></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://kdevkr.github.io/passkey-login/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://avatars1.githubusercontent.com/u/17937604?s=460&v=4"><meta itemprop="name" content="Mambo"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Mambo"><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="패스키 로그인 | Mambo"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">패스키 로그인</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2024-07-11 21:00:00" itemprop="dateCreated datePublished" datetime="2024-07-11T21:00:00+09:00">2024-07-11</time></span></div></div></header><div class="post-body" itemprop="articleBody"><p>패스키 로그인은 사용자 계정에 대한 비밀번호를 입력하지 않고 사용자 계정에 미리 등록한 기기를 통해 지문이나 얼굴 인식 그리고 보안키 등으로 비교적 쉽고 안전하게 인증을 수행하는 것을 말한다. 패스키 인증은 로그인 뿐만 아니라 <a target="_blank" rel="noopener" href="https://aws.amazon.com/ko/about-aws/whats-new/2024/06/aws-identity-access-management-passkey-authentication-factor/?nc1=h_ls">아마존 웹 서비스</a>와 <a target="_blank" rel="noopener" href="https://docs.github.com/ko/authentication/authenticating-with-a-passkey/signing-in-with-a-passkey">깃허브</a>처럼 MFA를 위해 도입되기도 한다. 패스키 구현에 대해서 찾아보면 참고할만한 예제는 많은데 그것만으로 이해하고 개발하기에는 쉽지 않은 것 같다. 예를 들어, 패스키 인증이 도입되어있는 사내 프로젝트를 보니 데이터베이스 설계가 생체 인증이라는 용어를 사용해서 패스키에 대한 의미가 잘못되어있음을 확인할 수 있었다.</p><blockquote><p>패스키는 지문 또는 얼굴 인식과 같은 생체 인증 뿐만 아니라 PIN 이나 보안 기기 등 다양한 방식으로 인증을 수행하는 걸 지원해요.<br>따라서, 생체 인증이 아닌 passkey 또는 webauthn 이라는 용어로 스키마를 설계하는 것을 추천합니다.</p></blockquote><h4 id="패스키-로그인-구현에-참고할-수-있는-링크"><a href="#패스키-로그인-구현에-참고할-수-있는-링크" class="headerlink" title="패스키 로그인 구현에 참고할 수 있는 링크"></a>패스키 로그인 구현에 참고할 수 있는 링크</h4><p>패스키 로그인 구현에 앞서 아래의 정보들을 참고하면 패스키 로그인 구현에 대해서 어느정도 이해할 수 있다.<br>더 자세한 정보들은 <a target="_blank" rel="noopener" href="https://github.com/yackermann/awesome-webauthn">WebAuthn Awesome</a>에서 찾아보자.</p><ul><li><a target="_blank" rel="noopener" href="https://webauthn.io/">WebAuthn.io 데모 사이트</a></li><li><a target="_blank" rel="noopener" href="https://webauthn.guide/">WebAuthn 가이드</a></li><li><a target="_blank" rel="noopener" href="https://www.passkeys.io/compatible-devices">패스키 지원 디바이스 정보</a></li><li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API">WebAuthn: Web Authentication API</a></li><li><a target="_blank" rel="noopener" href="https://webauthn.wtf/">What is WebAuthn?</a></li><li><a target="_blank" rel="noopener" href="https://passkeys.dev/docs/intro/what-are-passkeys/">What are passkeys?</a></li><li><a target="_blank" rel="noopener" href="https://fidoalliance.org/ux-guidelines-for-passkey-creation-and-sign-ins/?lang=ko">패스키 생성 및 로그인을 위한 FIDO 얼라이언스 UX 가이드라인</a></li><li><a target="_blank" rel="noopener" href="https://webauthn.me/passkeys">Web Authentication and Passkeys</a></li><li><a target="_blank" rel="noopener" href="https://web.dev/articles/passkey-registration?hl=ko">비밀번호 없는 로그인의 패스키 생성</a></li><li><a target="_blank" rel="noopener" href="https://web.dev/articles/passkey-form-autofill?hl=ko">양식 자동 완성을 통한 패스키 로그인</a></li><li><a target="_blank" rel="noopener" href="https://web.dev/articles/webauthn-exclude-credentials">패스키 중복 등록을 방지하는 방법</a></li><li><a target="_blank" rel="noopener" href="https://web.dev/articles/webauthn-aaguid?hl=ko">AAGUID로 패스키 제공업체 확인</a></li></ul><h4 id="패스키-로그인-서버-측-구현"><a href="#패스키-로그인-서버-측-구현" class="headerlink" title="패스키 로그인 서버 측 구현"></a>패스키 로그인 서버 측 구현</h4><p>자바 기반의 애플리케이션에서는 Yubico의 <a target="_blank" rel="noopener" href="https://developers.yubico.com/java-webauthn-server/">java-webauthn-server</a>를 이용할 수 있다. 패스키 로그인 시 클라이언트는 서버로부터 사이트 도메인에 대한 <a target="_blank" rel="noopener" href="https://webauthn.wtf/how-it-works/relying-party">Relying Party</a>와 함께 챌린지를 요청을 하고 제공받아야한다. 일반적으로 웹 사이트의 패스키 로그인에서 <code>rpID</code>는 도메인을 의미하며 <code>Challenge</code>는 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Glossary/Replay_attack">Replay attack</a>을 방지하기 위해 의사 난수로 생성된 바이트 버퍼이다. 그 외에 여러가지 옵션들이 있는데 WebAuthn 가이드에서 <a target="_blank" rel="noopener" href="https://webauthn.guide/#registration">publicKeyCredentialCreationOptions</a>을 살펴보면 서버로부터 어떤 정보를 요구하는지와 각 필드 항목의 의미에 대해서 확인할 수 있다.</p><h5 id="User-Handle-user-id"><a href="#User-Handle-user-id" class="headerlink" title="User Handle(user.id)"></a>User Handle(user.id)</h5><p>공개키 크레덴셜에 포함되는 User Handle은 로그인 시 사용되는 계정 아이디를 그대로 사용하지 않고 사용자 계정에 대해 난수로 이루어진 바이트 배열을 발급하여 사용한다. User Handle은 <a target="_blank" rel="noopener" href="https://developers.yubico.com/WebAuthn/WebAuthn_Developer_Guide/Registering_Multiple_Devices.html">Registering Multiple Devices</a>에 나와있는 것처럼 크레덴셜 아이디와 조합하여 어떤 사용자에게 저장된 공개키 크레덴셜인지를 구분할 수 있다. 만약, 사용자 계정에 대해 유일하게 발급해서 사용하고 싶다면 User Handle을 저장하는 스키마를 별도로 구성하면 된다.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">createUserHandle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NoSuchAlgorithmException</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> userHandle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">SecureRandom</span><span class="token punctuation">.</span><span class="token function">getInstanceStrong</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextBytes</span><span class="token punctuation">(</span>userHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> userHandle<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre><h5 id="PublicKeyCredential-response-attestationObject-authData"><a href="#PublicKeyCredential-response-attestationObject-authData" class="headerlink" title="PublicKeyCredential.response.attestationObject.authData"></a>PublicKeyCredential.response.attestationObject.authData</h5><p>패스키 등록 과정에서는 공개키 크레덴셜 내에 존재하는 Authenticator Data의 공개키 바이트 배열과 크레덴셜 ID를 사용자를 식별할 수 있는 키와 함께 데이터베이스에 저장하게 된다. 등록 이후 패스키 로그인 시 패스키로 등록된 기기에서의 인증 후에 전달받게 되는 크레덴셜 내 사용자 핸들(User Handle)과 크레덴셜 아이디(CredentialId)를 통해 서버에 저장된 공개키를 가져와서 서명되는 경우 인증을 수행한 것으로 처리하게 된다.</p><blockquote><p>클라이언트의 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API">WebAuthn API</a>에서는 RP에 대해 사용자 기기에 대한 식별을 위해 발급된 크레덴셜에 있는 공개키를 서버로 전달하여 사용자 계정에 대해 인증 장치로 등록하도록 요구하여 서버에서는 공개키를 보유하고 비밀키는 사용자 기기에서 보유하기 때문에 보안 상 안전하다는 것을 보여줍니다.</p></blockquote><p>결론적으로, 서버 측에서는 패스키 등록을 위한 정보를 제공한 후 클라이언트가 사용자로부터 인증받은 기기에 대한 공개키와 식별 정보를 데이터베이스에 저장하고 패스키 로그인 시 전달받은 정보가 서버에 저장된 공개키로 신뢰할 수 있는지를 검증하고나서 사용자 계정에 대한 인증 처리를 수행하는 것이다.</p><h4 id="패스키-로그인-클라이언트-측-구현"><a href="#패스키-로그인-클라이언트-측-구현" class="headerlink" title="패스키 로그인 클라이언트 측 구현"></a>패스키 로그인 클라이언트 측 구현</h4><p>클라이언트 측 구현은 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API#webauthn_concepts_and_usage">Web Authentication API</a>를 이용하면 되는데 <a target="_blank" rel="noopener" href="https://simplewebauthn.dev/">SimpleWebAuthn</a> 라이브러리를 활용하면 더 간단하게 패스키 등록과 인증을 수행하는 로직을 구현할 수 있다. 특히나, <a target="_blank" rel="noopener" href="https://simplewebauthn.dev/docs/packages/browser#browsersupportswebauthn">browserSupportsWebAuthn()</a>와 같은 함수를 통해 패스키를 지원하는 브라우저 또는 자동 완성(autofill)을 제공할 수 있는지를 쉽게 판단할 수 있게 도와준다.</p><h5 id="자동-완성을-위한-mediation-옵션"><a href="#자동-완성을-위한-mediation-옵션" class="headerlink" title="자동 완성을 위한 mediation 옵션"></a>자동 완성을 위한 mediation 옵션</h5><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/CredentialsContainer/get">CredentailsContainer.get</a> 함수를 호출할 때 <code>mediation</code> 옵션을 <code>conditional</code>로 지정하는 경우 사용자에게 즉시 패스키를 선택하도록 요구하지 않고 자동 완성(조건부 UI)이 표시되도록 적용할 수 있다. 자동 완성에 의한 패스키 인증이 수행되기 전까지는 프로미스는 대기하고 있으며 자동 완성 폼에 표시되는 패스키 사용을 선택하고나서 인증 처리 과정은 동일하게 수행되도록 구현해야한다. <a target="_blank" rel="noopener" href="https://web.dev/articles/passkey-form-autofill?hl=ko">양식 자동 완성을 통한 패스키 로그인</a>에서처럼 로그인 화면을 제공하기 전에 패스키 요구를 조건부로 호출하여 대기하도록 하고나서 사용자 계정을 입력하는 필드에 <code>autocomplete=webauthn</code> 을 포함하면 된다.</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// Login.vue</span>
<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">await</span> <span class="token function">processAutofill</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

<span class="token comment">// passkey.js</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">processAutofill</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">browserSupportsWebAuthnAutofill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// todo: 서버로부터 rp 와 challenge 받아오기</span>
        <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token literal-property property">challenge</span><span class="token operator">:</span> <span class="token string">'0NHRvLkOxc1Xja9inn1dEA6sSLc3ufvP_eNqu8IxRQU'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">rpId</span><span class="token operator">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">const</span> authResp <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">startAuthentication</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// 자동 완성으로 패스키를 선택할때까지 대기</span>
        <span class="token keyword">const</span> signInResp <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/passkey/signin'</span><span class="token punctuation">,</span> authResp<span class="token punctuation">)</span> <span class="token comment">// 서버로부터 패스키 검증 및 인증 정보 획득</span>
        <span class="token comment">// todo: 인증 유무에 따른 처리</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre><h4 id="계정-설정-내-패스키-표시"><a href="#계정-설정-내-패스키-표시" class="headerlink" title="계정 설정 내 패스키 표시"></a>계정 설정 내 패스키 표시</h4><p>패스키 등록 시 서버에 저장된 정보에는 사용자 친화적으로 표시할 수 있는 정보가 포함되어있지 않다. <a target="_blank" rel="noopener" href="https://developers.google.com/identity/passkeys/ux/communicating-passkeys?hl=ko#what_information_to_use_to_create_a_passkey">패스키를 만드는 데 사용할 정보</a>나 <a target="_blank" rel="noopener" href="https://developers.google.com/identity/passkeys/ux/user-interface-design?hl=ko">계정 설정 내 패스키 카드 표시</a>와 같은 정보들을 참고하며 패스키에 대해 아래와 같은 항목들을 설정할 수 있게 설계하는게 좋다.</p><ul><li>패스키에 대해 표시할 이름 (Nickname)</li><li>패스키가 마지막으로 사용된 시간 (Last Access Time)</li><li>패스키 인증 기기 유형 (AAGUID)</li></ul><p>패스키에 대해 표시할 이름을 설정하는 건 필수 사항은 아니지만 깃허브에서의 패스키 관리 시 이름을 설정할 수 있게 제공하는데 사용자 스스로 구분할 수 있게 지원해줄 수 있는 것 같다. 패스키 인증 기기 정보의 경우 AttestedCredentialData에 포함된 AAGUID를 통해 인증 기기를 제공하는 업체을 식별할 수 있다. AAGUID는 일반적으로 사람이 인지할 수 있는 문자열은 아니므로 AAGUID 저장소의 <a target="_blank" rel="noopener" href="https://github.com/passkeydeveloper/passkey-authenticator-aaguids/blob/main/aaguid.json">aaguid.json</a> 인증 장치의 유형에 대해서 이름이나 아이콘을 표시할 수 있다.</p><blockquote><p>패스키에 대한 UX 가이드라인을 살펴보면 패스키 관리에 대해 <a target="_blank" rel="noopener" href="https://fonts.google.com/icons?icon.query=passkey">패스키 아이콘</a>을 표시하는걸 권장한다고 하네요.</p></blockquote><h4 id="패스키-삭제"><a href="#패스키-삭제" class="headerlink" title="패스키 삭제"></a>패스키 삭제</h4><p>사용자 계정에 등록한 패스키 목록에서 패스키를 삭제할 때 고려해보아야할 부분이 있다. 패스키에 대한 공개키 크레덴셜을 저장하고 있는 시스템에서는 사용자 기기에 등록된 패스키 정보를 삭제할 방법이 없다. 또한, 사용자가 패스키를 등록하고나서 디바이스에 등록된 패스키를 삭제하는 경우에는 시스템에는 불필요하게 패스키 목록이 남겨지는 문제가 있으므로 이를 고려해보아야한다.</p><p><img data-src="/images/posts/passkey-login/01.png"></p><p>예를 들어, 위와 같이 깃허브에서는 패스키 삭제 후에 기기에 남아있는 패스키 정보로 인해 로그인 시도 시 패스키 옵션이 표시될 수 있음을 안내하고 있다. AAGUID와 디바이스에 따라 패스키를 관리하고 삭제하는 방법이 다르므로 자세한 가이드는 제공하지 않는 것 같다. 그럼에도 가이드를 제공하고 싶다면 자주 사용될 수 있는 기기에 대해서는 제공해줄 수 있어보인다.</p><ul><li>Google Passsword Manager: 브라우저 URL에 chrome:&#x2F;&#x2F;settings&#x2F;passkeys 입력</li><li>iCloud Keychain: <a target="_blank" rel="noopener" href="https://support.apple.com/ko-kr/guide/mac-help/mchl77e2cb66/mac">Mac 및 iCloud 키체인에서 패스키 또는 암호 제거하기</a></li><li>Samsung Pass: Samsung Wallet → Samsung Pass → 로그인 정보 → 패스키 에서 삭제할 수 있다.</li><li>Chrome Profile: <a target="_blank" rel="noopener" href="https://support.google.com/chrome/answer/13168025?hl=ko">Chrome에서 패스키 관리하기</a></li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Passkey/" rel="tag"># Passkey</a> <a href="/tags/WebAuthn/" rel="tag"># WebAuthn</a></div><div class="post-nav"><div class="post-nav-item"><a href="/amazon-sns-fcm-mobile-push/" rel="prev" title="Amazon SNS - FCM 모바일 푸시"><i class="fa fa-chevron-left"></i> Amazon SNS - FCM 모바일 푸시</a></div><div class="post-nav-item"></div></div></footer></article></div><div class="comments giscus-container"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Mambo</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script><script src="/js/third-party/fancybox.js"></script><script src="/js/third-party/pace.js"></script><script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script><script>var options={bottom:"unset",right:"15px",left:"unset",time:"0.5s",mixColor:"transparent",backgroundColor:"transparent",buttonColorDark:"#100f2c",buttonColorLight:"#fff",saveInCookies:!0,label:"🌗",autoMatchOsTheme:!0};const darkmode=new Darkmode(options);window.darkmode=darkmode,darkmode.showWidget()</script><script class="next-config" data-name="giscus" type="application/json">{"enable":true,"repo":"kdevkr/kdevkr.github.io","repo_id":"MDEwOlJlcG9zaXRvcnkxNTQxNjA4OTA=","category":"Announcements","category_id":"DIC_kwDOCTBO-s4CYmQM","mapping":"pathname","reactions_enabled":1,"emit_metadata":1,"theme":"light","lang":"ko","crossorigin":"anonymous","input_position":"bottom","loading":"lazy"}</script><script>document.addEventListener("page:loaded",()=>{CONFIG.page.comments&&NexT.utils.loadComments(".giscus-container").then(()=>NexT.utils.getScript("https://giscus.app/client.js",{attributes:{async:!0,crossOrigin:"anonymous","data-repo":CONFIG.giscus.repo,"data-repo-id":CONFIG.giscus.repo_id,"data-category":CONFIG.giscus.category,"data-category-id":CONFIG.giscus.category_id,"data-mapping":CONFIG.giscus.mapping,"data-reactions-enabled":CONFIG.giscus.reactions_enabled,"data-emit-metadata":CONFIG.giscus.emit_metadata,"data-theme":CONFIG.giscus.theme,"data-lang":CONFIG.giscus.lang,"data-input-position":CONFIG.giscus.input_position,"data-loading":CONFIG.giscus.loading},parentNode:document.querySelector(".giscus-container")}))})</script></body></html>