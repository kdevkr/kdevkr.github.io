<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png"><link rel="mask-icon" href="/images/favicon/favicon.ico" color="#222"><meta name="google-site-verification" content="LMcddVW6xLBS7X1htGQ3duOIEmVp4ljku8sd3UuIcBg"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto+Sans+KR:300,300italic,400,400italic,700,700italic%7CGmarket+Sans:300,300italic,400,400italic,700,700italic%7CRIDIBatang:300,300italic,400,400italic,700,700italic%7CJetbrains+Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-loading-bar.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"kdevkr.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.11.1","exturl":false,"sidebar":{"position":"left","display":"hide","padding":18,"offset":12,"width":240,"scrollpercent":true,"b2t":true},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script><meta name="description" content="ì•ˆë…•í•˜ì„¸ìš” Mambo ì…ë‹ˆë‹¤. ì´ë²ˆ ê¸€ì˜ ì£¼ì œëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° êµ¬ì„±í•˜ê¸°ì…ë‹ˆë‹¤. IT ì¸í”„ë¼ì— ëŒ€í•œ ì „ë¬¸ ì¸ë ¥ì´ ì•„ë‹Œ ì¼ë°˜ ê°œë°œìê°€ ì»¨í…Œì´ë„ˆ í™˜ê²½ì„ ìœ„í•œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì´í•´í•˜ê³  êµ¬ì„±í•˜ê¸°ê¹Œì§€ëŠ” ìƒê°ë³´ë‹¤ ë§ì€ ì‹œê°„ì´ ì†Œìš”ë˜ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤. ë‹¨ìˆœíˆ ë„ì»¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ëŠ” ê²ƒì€ ì–´ë µì§€ ì•Šì•„ì„œ ë„ì»¤ ì»´í¬ì¦ˆ ë¬¸ì„œë¥¼ ì •ì˜í•´ì„œ ì—¬ëŸ¬ê°€ì§€ ì¸ìŠ¤í„´ìŠ¤ë¥¼"><meta property="og:type" content="article"><meta property="og:title" content="ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° êµ¬ì„±í•˜ê¸°"><meta property="og:url" content="https://kdevkr.github.io/setup-kubernetes-cluster/index.html"><meta property="og:site_name" content="Mambo"><meta property="og:description" content="ì•ˆë…•í•˜ì„¸ìš” Mambo ì…ë‹ˆë‹¤. ì´ë²ˆ ê¸€ì˜ ì£¼ì œëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° êµ¬ì„±í•˜ê¸°ì…ë‹ˆë‹¤. IT ì¸í”„ë¼ì— ëŒ€í•œ ì „ë¬¸ ì¸ë ¥ì´ ì•„ë‹Œ ì¼ë°˜ ê°œë°œìê°€ ì»¨í…Œì´ë„ˆ í™˜ê²½ì„ ìœ„í•œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì´í•´í•˜ê³  êµ¬ì„±í•˜ê¸°ê¹Œì§€ëŠ” ìƒê°ë³´ë‹¤ ë§ì€ ì‹œê°„ì´ ì†Œìš”ë˜ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤. ë‹¨ìˆœíˆ ë„ì»¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ëŠ” ê²ƒì€ ì–´ë µì§€ ì•Šì•„ì„œ ë„ì»¤ ì»´í¬ì¦ˆ ë¬¸ì„œë¥¼ ì •ì˜í•´ì„œ ì—¬ëŸ¬ê°€ì§€ ì¸ìŠ¤í„´ìŠ¤ë¥¼"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://kdevkr.github.io/images/posts/setup-kubernetes-cluster/setup-kubernetes-cluster-01.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/setup-kubernetes-cluster/setup-kubernetes-cluster-02.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/setup-kubernetes-cluster/setup-kubernetes-cluster-03.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/setup-kubernetes-cluster/control-kubernetes-cluster-03.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/setup-kubernetes-cluster/control-kubernetes-cluster-04.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/setup-kubernetes-cluster/control-kubernetes-cluster-05.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/setup-kubernetes-cluster/control-kubernetes-cluster-06.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/setup-kubernetes-cluster/control-kubernetes-cluster-07.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/setup-kubernetes-cluster/access-kubernetes-dashboard-02.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/setup-kubernetes-cluster/access-kubernetes-dashboard-01.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/setup-kubernetes-cluster/access-kubernetes-dashboard-02.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/setup-kubernetes-cluster/access-kubernetes-dashboard-03.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/setup-kubernetes-cluster/access-kubernetes-dashboard-04.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/setup-kubernetes-cluster/access-kubernetes-dashboard-05.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/setup-kubernetes-cluster/access-kubernetes-dashboard-06.png"><meta property="article:published_time" content="2021-07-27T00:00:00.000Z"><meta property="article:modified_time" content="2022-05-27T09:02:30.859Z"><meta property="article:author" content="Mambo"><meta property="article:tag" content="Kubernetes"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://kdevkr.github.io/images/posts/setup-kubernetes-cluster/setup-kubernetes-cluster-01.png"><link rel="canonical" href="https://kdevkr.github.io/setup-kubernetes-cluster/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://kdevkr.github.io/setup-kubernetes-cluster/","path":"setup-kubernetes-cluster/","title":"ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° êµ¬ì„±í•˜ê¸°"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° êµ¬ì„±í•˜ê¸° | Mambo</title><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-93954323-1","only_pageview":true}</script><script src="/js/third-party/analytics/google-analytics.js"></script><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><link rel="alternate" href="/atom.xml" title="Mambo" type="application/atom+xml">
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope itemtype="http://schema.org/WebPage"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Mambo</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Today I Learned ğŸ”¥</p></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fas fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fas fa-archive fa-fw"></i>Archives<span class="badge">61</span></a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fas fa-user fa-fw"></i>About</a></li></ul></nav></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">Table of Contents</li><li class="sidebar-nav-overview">Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0"><span class="nav-number">1.</span> <span class="nav-text">ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EA%B5%AC%EC%84%B1%EC%9D%98-%EC%96%B4%EB%A0%A4%EC%9B%80"><span class="nav-number">1.1.</span> <span class="nav-text">í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì˜ ì–´ë ¤ì›€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EB%B0%B0%ED%8F%AC-%EB%8F%84%EA%B5%AC"><span class="nav-number">1.2.</span> <span class="nav-text">ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë°°í¬ ë„êµ¬</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88-%EC%9D%B8%ED%94%84%EB%9D%BC-%ED%99%98%EA%B2%BD%EC%9D%98-%EA%B0%80%EC%9A%A9%EC%84%B1"><span class="nav-number">1.3.</span> <span class="nav-text">ì»¨í…Œì´ë„ˆ ì¸í”„ë¼ í™˜ê²½ì˜ ê°€ìš©ì„±</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-DNS-%EC%84%9C%EB%B2%84"><span class="nav-number">1.4.</span> <span class="nav-text">ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° DNS ì„œë²„</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0"><span class="nav-number">2.</span> <span class="nav-text">ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì‹œì‘í•˜ê¸°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EA%B5%AC%EC%84%B1-%ED%98%B8%EC%8A%A4%ED%8A%B8%EC%97%90-%EB%8C%80%ED%95%9C-%EC%82%AC%EC%A0%84-%EC%9E%91%EC%97%85"><span class="nav-number">2.1.</span> <span class="nav-text">í´ëŸ¬ìŠ¤í„° êµ¬ì„± í˜¸ìŠ¤íŠ¸ì— ëŒ€í•œ ì‚¬ì „ ì‘ì—…</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EC%BB%A8%ED%8A%B8%EB%A1%A4-%ED%94%8C%EB%A0%88%EC%9D%B8-%EB%85%B8%EB%93%9C-%EC%B4%88%EA%B8%B0%ED%99%94"><span class="nav-number">2.2.</span> <span class="nav-text">ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ ë…¸ë“œ ì´ˆê¸°í™”</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%ED%94%8C%EB%9F%AC%EA%B7%B8%EC%9D%B8-%EC%84%A4%EC%B9%98"><span class="nav-number">2.3.</span> <span class="nav-text">ë„¤íŠ¸ì›Œí¬ í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EC%9B%8C%EC%BB%A4-%EB%85%B8%EB%93%9C-%EC%B6%94%EA%B0%80"><span class="nav-number">2.4.</span> <span class="nav-text">ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì›Œì»¤ ë…¸ë“œ ì¶”ê°€</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EC%A0%9C%EC%96%B4%ED%95%98%EA%B8%B0"><span class="nav-number">3.</span> <span class="nav-text">ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì œì–´í•˜ê¸°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%EC%99%B8%EB%B6%80-%ED%98%B8%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EC%9C%84%ED%95%9C-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EC%A0%91%EA%B7%BC-%EA%B5%AC%EC%84%B1-%ED%8C%8C%EC%9D%BC-%EC%A0%95%EC%9D%98"><span class="nav-number">3.1.</span> <span class="nav-text">ì™¸ë¶€ í˜¸ìŠ¤íŠ¸ë¥¼ ìœ„í•œ í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„± íŒŒì¼ ì •ì˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EC%99%B8%EB%B6%80-%ED%98%B8%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EC%9C%84%ED%95%9C-%EC%82%AC%EC%9A%A9%EC%9E%90-%EB%B0%8F-%EC%9D%B8%EC%A6%9D%EC%84%9C-%EB%B0%9C%ED%96%89"><span class="nav-number">3.2.</span> <span class="nav-text">ì™¸ë¶€ í˜¸ìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì‚¬ìš©ì ë° ì¸ì¦ì„œ ë°œí–‰</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EA%B4%80%EB%A6%AC%ED%95%98%EA%B8%B0"><span class="nav-number">4.</span> <span class="nav-text">ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ê´€ë¦¬í•˜ê¸°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EC%9D%B8%EC%A6%9D%EC%84%9C-%EA%B0%B1%EC%8B%A0%ED%95%98%EA%B8%B0"><span class="nav-number">4.1.</span> <span class="nav-text">í´ëŸ¬ìŠ¤í„° ì¸ì¦ì„œ ê°±ì‹ í•˜ê¸°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EC%9D%B8%EC%A6%9D%EC%84%9C-%EB%A7%8C%EB%A3%8C%EC%9D%BC%EC%9E%90-%EC%A1%B0%ED%9A%8C%ED%95%98%EA%B8%B0"><span class="nav-number">4.2.</span> <span class="nav-text">í´ëŸ¬ìŠ¤í„° ì¸ì¦ì„œ ë§Œë£Œì¼ì ì¡°íšŒí•˜ê¸°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EC%9D%B8%EC%A6%9D%EC%84%9C-%EC%88%98%EB%8F%99-%EA%B0%B1%EC%8B%A0"><span class="nav-number">4.3.</span> <span class="nav-text">í´ëŸ¬ìŠ¤í„° ì¸ì¦ì„œ ìˆ˜ë™ ê°±ì‹ </span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%EB%8C%80%EC%8B%9C%EB%B3%B4%EB%93%9C-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0"><span class="nav-number">5.</span> <span class="nav-text">ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ì„¤ì¹˜í•˜ê¸°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%EB%8C%80%EC%8B%9C%EB%B3%B4%EB%93%9C-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%9C%A0%ED%98%95-%EB%B3%80%EA%B2%BD%ED%95%98%EA%B8%B0"><span class="nav-number">5.1.</span> <span class="nav-text">ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ì„œë¹„ìŠ¤ ìœ í˜• ë³€ê²½í•˜ê¸°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%EB%8C%80%EC%8B%9C%EB%B3%B4%EB%93%9C-%EB%A1%9C%EA%B7%B8%EC%9D%B8%ED%95%98%EA%B8%B0"><span class="nav-number">5.2.</span> <span class="nav-text">ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ë¡œê·¸ì¸í•˜ê¸°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%EB%8C%80%EC%8B%9C%EB%B3%B4%EB%93%9C%EC%97%90%EC%84%9C-%EB%A7%A4%ED%8A%B8%EB%A6%AD-%EC%84%9C%EB%B2%84-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0"><span class="nav-number">5.3.</span> <span class="nav-text">ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œì—ì„œ ë§¤íŠ¸ë¦­ ì„œë²„ ì„¤ì¹˜í•˜ê¸°</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Mambo" src="https://avatars1.githubusercontent.com/u/17937604?s=460&v=4"><p class="site-author-name" itemprop="name">Mambo</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">61</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-tags"><span class="site-state-item-count">103</span> <span class="site-state-item-name">tags</span></div></nav></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://github.com/kdevkr" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;kdevkr" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:kdevkr@gmail.com" title="E-Mail â†’ mailto:kdevkr@gmail.com" rel="noopener" target="_blank"><i class="fas fa-envelope fa-fw"></i>E-Mail</a></span></div><div class="cc-license site-overview-item animated" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ko" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div><div class="back-to-top animated" role="button" aria-label="Back to top"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div class="sidebar-dimmer"></div></header><div class="reading-progress-bar"></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://kdevkr.github.io/setup-kubernetes-cluster/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://avatars1.githubusercontent.com/u/17937604?s=460&v=4"><meta itemprop="name" content="Mambo"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Mambo"><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° êµ¬ì„±í•˜ê¸° | Mambo"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° êµ¬ì„±í•˜ê¸°</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2021-07-27 00:00:00" itemprop="dateCreated datePublished" datetime="2021-07-27T00:00:00Z">2021-07-27</time></span></div></div></header><div class="post-body" itemprop="articleBody"><p>ì•ˆë…•í•˜ì„¸ìš” Mambo ì…ë‹ˆë‹¤.</p><p>ì´ë²ˆ ê¸€ì˜ ì£¼ì œëŠ” <strong>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° êµ¬ì„±í•˜ê¸°</strong>ì…ë‹ˆë‹¤. IT ì¸í”„ë¼ì— ëŒ€í•œ ì „ë¬¸ ì¸ë ¥ì´ ì•„ë‹Œ ì¼ë°˜ ê°œë°œìê°€ ì»¨í…Œì´ë„ˆ í™˜ê²½ì„ ìœ„í•œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì´í•´í•˜ê³  êµ¬ì„±í•˜ê¸°ê¹Œì§€ëŠ” ìƒê°ë³´ë‹¤ ë§ì€ ì‹œê°„ì´ ì†Œìš”ë˜ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤. ë‹¨ìˆœíˆ ë„ì»¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ëŠ” ê²ƒì€ ì–´ë µì§€ ì•Šì•„ì„œ ë„ì»¤ ì»´í¬ì¦ˆ ë¬¸ì„œë¥¼ ì •ì˜í•´ì„œ ì—¬ëŸ¬ê°€ì§€ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë³„ë‹¤ë¥¸ ì„¤ì •ì—†ì´ ê°„ë‹¨í•˜ê²Œ ì‹¤í–‰í•´ì™”ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ, ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•˜ê³  ìš´ì˜í•˜ê¸° ìœ„í•˜ì—¬ ì»¨í…Œì´ë„ˆ ì¸í”„ë¼ í™˜ê²½ì„ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¡œ êµ¬ì„±í•˜ëŠ” ê²ƒì€ IT ì¸í”„ë¼ì— ëŒ€í•œ ì „ë¬¸ ì§€ì‹ì´ í•„ìš”í•©ë‹ˆë‹¤.</p><p>í˜„ì¬ ë‹¤ë‹ˆê³  ìˆëŠ” íšŒì‚¬ì˜ ì†Œì†íŒ€ì—ì„œëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì•„ë§ˆì¡´ ì›¹ ì„œë¹„ìŠ¤ì˜ ë¹ˆìŠ¤í†¡(Beanstalk)ì„ ì‚¬ìš©í•˜ì—¬ ë°°í¬í•˜ê³  ìš´ì˜í•˜ê¸° ë•Œë¬¸ì— ì»¨í…Œì´ë„ˆ í™˜ê²½ì˜ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ëŒ€í•œ í•™ìŠµì´ í•„ìš”í•˜ì§„ ì•Šì•˜ìŠµë‹ˆë‹¤.</p><blockquote><p>ë¬¼ë¡ , ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë„ì…ì„ ì‹œë„í•˜ê¸´ í–ˆìŠµë‹ˆë‹¤ë§Œâ€¦ í˜„ì¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ê·œëª¨ ìƒ ë°°ë³´ë‹¤ ë°°ê¼½ì´ ë” í¬ë‹¤ëŠ” ê²°ê³¼ë¥¼ ê°€ì§„ë‹¤ê³  íŒë‹¨í•˜ì—¬ ë„ì…ì„ ì·¨ì†Œí–ˆìŠµë‹ˆë‹¤.</p></blockquote><p>ê·¸ëŸ¬ë‚˜ 2021ë…„ í´ë¼ìš°ë“œ í”Œë˜ê·¸ì‹­ í”„ë¡œì íŠ¸ ì¤‘ ì—ë„ˆì§€ ë¶„ì•¼ì— ì°¸ì—¬í•¨ìœ¼ë¡œì¨ í˜„ì¬ ìš´ì˜ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ ì»¨í…Œì´ë„ˆ í™˜ê²½ìœ¼ë¡œ ë°°í¬í•˜ê³  ìš´ì˜í•˜ê¸° ìœ„í•˜ì—¬ ëª¨ë†€ë¦¬ì‹ ì•„í‚¤í…ì²˜ë¡œ ê°œë°œëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì¼ì • ë¶€ë¶„ì„ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ë¡œ ë³€ê²½í•˜ì—¬ ê¸°ëŠ¥ì ìœ¼ë¡œ ë¶„ë¦¬í•˜ëŠ” ì‘ì—…ì„ ì§„í–‰ì¤‘ì…ë‹ˆë‹¤. ì´ë ‡ê²Œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ë¡œ ë¶„ë¦¬ë˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ë“¤ì€ ë‚˜ë¬´ê¸°ìˆ ì˜ <strong>ì¹µí…Œì¼ í´ë¼ìš°ë“œ</strong>ë¼ê³ í•˜ëŠ” PaaSë¥¼ í†µí•´ ë°°í¬ë˜ê³  ìš´ì˜ë  ì˜ˆì •ì…ë‹ˆë‹¤.</p><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì§ì ‘ êµ¬ì„±í•˜ì—¬ ìš´ì˜ ë° ê´€ë¦¬ë¥¼ ìˆ˜í–‰í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆì§€ë§Œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ê¸°ë°˜ì˜ ì»¨í…Œì´ë„ˆ ì¸í”„ë¼ í™˜ê²½ì„ ì´í•´í•˜ê¸° ìœ„í•´ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì§ì ‘ êµ¬ì„±í•´ë³´ê³  ê°„ë‹¨í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•´ë³´ëŠ” ê²ƒì„ í•™ìŠµí•˜ê³  ì´ ê¸€ì„ í†µí•´ ê³µìœ í•˜ê³ ìí•©ë‹ˆë‹¤.</p><h2 id="ì¿ ë²„ë„¤í‹°ìŠ¤-í´ëŸ¬ìŠ¤í„°"><a href="#ì¿ ë²„ë„¤í‹°ìŠ¤-í´ëŸ¬ìŠ¤í„°" class="headerlink" title="ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°"></a>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°</h2><p>ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” ë¶„ì‚°í˜• ì½”ë””ë„¤ì´í„°ì¸ ì£¼í‚¤í¼ì²˜ëŸ¼ ë‹¤ìˆ˜ì˜ í˜¸ìŠ¤íŠ¸ê°€ ì„œë¡œ í†µì‹ í•˜ì—¬ í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•˜ê²Œë˜ë©° ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ ë…¸ë“œì˜ API ì„œë²„ê°€ ë™ì‘í•˜ê²Œ ë˜ëŠ” ë§ˆìŠ¤í„° ë…¸ë“œì™€ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ëŠ” í™˜ê²½ì´ ë˜ëŠ” ì›Œì»¤ ë…¸ë“œë¡œ êµ¬ë¶„ë©ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ì›Œì»¤ ë…¸ë“œì™€ëŠ” í†µì‹ í•  í•„ìš”ê°€ ì—†ìœ¼ë©° ë§ˆìŠ¤í„° ë…¸ë“œì˜ API ì„œë²„ì™€ í†µì‹ í•˜ì—¬ í´ëŸ¬ìŠ¤í„°ë¥¼ ì œì–´í•˜ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•˜ê²Œë©ë‹ˆë‹¤.</p><h3 id="í´ëŸ¬ìŠ¤í„°-êµ¬ì„±ì˜-ì–´ë ¤ì›€"><a href="#í´ëŸ¬ìŠ¤í„°-êµ¬ì„±ì˜-ì–´ë ¤ì›€" class="headerlink" title="í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì˜ ì–´ë ¤ì›€"></a>í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì˜ ì–´ë ¤ì›€</h3><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•˜ëŠ”ê²Œ ì–´ë ¤ìš´ ì´ìœ ëŠ” IT ì¸í”„ë¼ ì§€ì‹ ë¿ë§Œ ì•„ë‹ˆë¼ í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì„ ìœ„í•´ ì—¬ëŸ¬ê°€ì§€ ì˜¤í”ˆì†ŒìŠ¤ ê¸°ìˆ ì´ ì‚¬ìš©ëœë‹¤ëŠ” ì ì…ë‹ˆë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì— ëŒ€í•œ ì„œë¹„ìŠ¤ë¥¼ PaaSë¡œ ì œê³µí•˜ëŠ” <a target="_blank" rel="noopener" href="https://paas-ta.kr/intro/guideInstall">íŒŒìŠ¤-íƒ€(PaaS-TA)</a> ë˜ëŠ” <a target="_blank" rel="noopener" href="https://www.cocktailcloud.io/main.do">ì¹µí…Œì¼ í´ë¼ìš°ë“œ</a>ë„ <strong>kubespray, istio</strong> ë“± ì—¬ëŸ¬ê°€ì§€ ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ê²°í•©í•œ ì†”ë£¨ì…˜ì„ ë§Œë“¤ì–´ ì œê³µí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ë˜í•œ, ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ìš´ì˜ ê´€ë¦¬ì˜ ì–´ë ¤ì›€ìœ¼ë¡œ ì¸í•˜ì—¬ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‰½ê²Œ êµ¬ì„±í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” AWSì˜ <a target="_blank" rel="noopener" href="https://docs.aws.amazon.com/eks/latest/userguide/what-is-eks.html">Amazon EKS</a> ë˜ëŠ” êµ¬ê¸€ í´ë¼ìš°ë“œ í”Œë«í¼ì˜ GKEì™€ ê°™ì´ í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ì—ì„œ ì‰½ê²Œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” ì´ìœ ì´ê¸°ë„ í•©ë‹ˆë‹¤.</p><h3 id="ì¿ ë²„ë„¤í‹°ìŠ¤-í´ëŸ¬ìŠ¤í„°-ë°°í¬-ë„êµ¬"><a href="#ì¿ ë²„ë„¤í‹°ìŠ¤-í´ëŸ¬ìŠ¤í„°-ë°°í¬-ë„êµ¬" class="headerlink" title="ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë°°í¬ ë„êµ¬"></a>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë°°í¬ ë„êµ¬</h3><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆëŠ” ë„êµ¬ëŠ” <strong>kubeadm, kops, kubespray</strong> ë¿ë§Œ ì•„ë‹ˆë¼ IoTë¥¼ ëª©ì ìœ¼ë¡œ ê²½ëŸ‰í™”ëœ í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì„ ëª©ì ìœ¼ë¡œí•˜ëŠ” <a target="_blank" rel="noopener" href="https://k3s.io/">k3s</a>, <a target="_blank" rel="noopener" href="https://microk8s.io/">MicroK8s</a>ë“± ì—¬ëŸ¬ê°€ì§€ ì˜¤í”ˆì†ŒìŠ¤ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ì €ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ ê³µì‹ ë¬¸ì„œì—ì„œë„ ê°€ì´ë“œë¥¼ ì œê³µí•˜ê³  ì˜¨-í”„ë ˆë¯¸ìŠ¤ í™˜ê²½ì—ì„œ ì¼ë°˜ì ìœ¼ë¡œ ë§ì´ ì‚¬ìš©ë  ìˆ˜ ìˆëŠ” ê¸°ë³¸ì ì¸ ë°°í¬ ë„êµ¬ì¸ <code>kubeadm</code>ì„ ì‚¬ìš©í•˜ì—¬ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•˜ê² ìŠµë‹ˆë‹¤.</p><blockquote><p>ë³¸ ê¸€ì—ì„œëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ë°ë¹„ì•ˆ ê³„ì—´ì˜ ë°°í¬íŒì¸ ìš°ë¶„íˆ¬ ë¦¬ëˆ…ìŠ¤ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p></blockquote><pre class="language-sh" data-language="sh"><div class="caption"><span>ìš°ë¶„íˆ¬ kubeadm íŒ¨í‚¤ì§€ ì„¤ì¹˜</span></div><code class="language-sh">sudo apt-get update
sudo apt-get install -y apt-transport-https ca-certificates curl

sudo curl -fsSLo &#x2F;usr&#x2F;share&#x2F;keyrings&#x2F;kubernetes-archive-keyring.gpg https:&#x2F;&#x2F;packages.cloud.google.com&#x2F;apt&#x2F;doc&#x2F;apt-key.gpg
echo &quot;deb [signed-by&#x3D;&#x2F;usr&#x2F;share&#x2F;keyrings&#x2F;kubernetes-archive-keyring.gpg] https:&#x2F;&#x2F;apt.kubernetes.io&#x2F; kubernetes-xenial main&quot; | sudo tee &#x2F;etc&#x2F;apt&#x2F;sources.list.d&#x2F;kubernetes.list

sudo apt-get update
sudo apt-get install -y kubelet kubeadm kubectl
sudo apt-mark hold kubelet kubeadm kubectl</code></pre><p>ìœ„ ëª…ë ¹ì–´ì— ì˜í•´ ì„¤ì¹˜ëœ íŒ¨í‚¤ì§€ëŠ” ë‹¤ìŒì˜ ì—­í• ì„ ìˆ˜í–‰í•˜ê²Œ ë˜ë©° í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•˜ëŠ” ëª¨ë“  í˜¸ìŠ¤íŠ¸ì— ì„¤ì¹˜í•´ì•¼í•©ë‹ˆë‹¤.</p><table><thead><tr><th>íŒ¨í‚¤ì§€</th><th>ìš©ë„</th></tr></thead><tbody><tr><td>kubeadm</td><td>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë°°í¬</td></tr><tr><td>kubelet</td><td>ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ ë…¸ë“œì™€ í†µì‹ í•˜ì—¬ ì»¨í…Œì´ë„ˆê°€ íŒŒë“œì— ì‹¤í–‰ë  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ì—ì´ì „íŠ¸</td></tr><tr><td>kubectl</td><td>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ëª…ë ¹ì„ ë‚´ë¦¬ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” CLI</td></tr></tbody></table><blockquote><p>ë³¸ ê¸€ì—ì„œëŠ” ìµœì‹  ë²„ì „ì˜ <strong>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° 1.21+</strong> ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.<br>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì•ˆì •ì ìœ¼ë¡œ ìœ ì§€í•˜ê¸° ìœ„í•˜ì—¬ ì£¼ê¸°ì ìœ¼ë¡œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì˜ ë²„ì „ì„ ì—…ê·¸ë ˆì´ë“œí•˜ëŠ” ê²ƒì„ ê¶Œì¥í•œë‹¤ê³  í•©ë‹ˆë‹¤.</p></blockquote><h3 id="ì»¨í…Œì´ë„ˆ-ì¸í”„ë¼-í™˜ê²½ì˜-ê°€ìš©ì„±"><a href="#ì»¨í…Œì´ë„ˆ-ì¸í”„ë¼-í™˜ê²½ì˜-ê°€ìš©ì„±" class="headerlink" title="ì»¨í…Œì´ë„ˆ ì¸í”„ë¼ í™˜ê²½ì˜ ê°€ìš©ì„±"></a>ì»¨í…Œì´ë„ˆ ì¸í”„ë¼ í™˜ê²½ì˜ ê°€ìš©ì„±</h3><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° êµ¬ì„± ê°€ì´ë“œì— ë”°ë¥´ë©´ í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•˜ê²Œ ë˜ëŠ” ëª¨ë“  í˜¸ìŠ¤íŠ¸ê°€ ì»¨í…Œì´ë„ˆ ì¸í”„ë¼ í™˜ê²½ì„ êµ¬ì„±í•  ìˆ˜ ìˆëŠ”ì§€ ê°€ìš©ì„±ì„ í™•ì¸í•´ì•¼í•©ë‹ˆë‹¤. ë”°ë¼ì„œ, ì´ë¯¸ ì‚¬ìš©í•˜ê³  ìˆëŠ” í˜¸ìŠ¤íŠ¸ ë³´ë‹¤ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±ì„ ìœ„í•œ ë³„ë„ì˜ í˜¸ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ”ê²Œ ì¢‹ìŠµë‹ˆë‹¤.</p><h4 id="ë©”ëª¨ë¦¬-ìŠ¤ì™‘-ê¸°ëŠ¥-ë¹„í™œì„±í™”"><a href="#ë©”ëª¨ë¦¬-ìŠ¤ì™‘-ê¸°ëŠ¥-ë¹„í™œì„±í™”" class="headerlink" title="ë©”ëª¨ë¦¬ ìŠ¤ì™‘ ê¸°ëŠ¥ ë¹„í™œì„±í™”"></a>ë©”ëª¨ë¦¬ ìŠ¤ì™‘ ê¸°ëŠ¥ ë¹„í™œì„±í™”</h4><p><a target="_blank" rel="noopener" href="https://github.com/kubernetes/enhancements/issues/2400">Node swap support</a>ì™€ ê°™ì´ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ ìŠ¤ì™‘ ê¸°ëŠ¥ì„ í™œì„±í™”í•˜ê¸° ìœ„í•œ ì‘ì—…ì„ ì§„í–‰ì¤‘ì´ì§€ë§Œ í˜„ì¬ë¡œì„  <strong>kubelet</strong>ì´ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ê¸° ìœ„í•´ì„œëŠ” ë°˜ë“œì‹œ ìš°ë¶„íˆ¬ ë¦¬ëˆ…ìŠ¤ì˜ ë©”ëª¨ë¦¬ ìŠ¤ì™‘ ê¸°ëŠ¥ì„ ë¹„í™œì„±í™” í•´ì•¼í•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>ìš°ë¶„íˆ¬ ë©”ëª¨ë¦¬ ìŠ¤ì™‘ ë¹„í™œì„±í™”</span></div><code class="language-sh">sudo swapoff -a &amp;&amp; sudo sed -i &#39;&#x2F; swap &#x2F; s&#x2F;^\(.*\)$&#x2F;#\1&#x2F;g&#39; &#x2F;etc&#x2F;fstab</code></pre><h4 id="í´ëŸ¬ìŠ¤í„°-ë…¸ë“œì˜-ê³ ìœ -ì£¼ì†Œ-í™•ì¸"><a href="#í´ëŸ¬ìŠ¤í„°-ë…¸ë“œì˜-ê³ ìœ -ì£¼ì†Œ-í™•ì¸" class="headerlink" title="í´ëŸ¬ìŠ¤í„° ë…¸ë“œì˜ ê³ ìœ  ì£¼ì†Œ í™•ì¸"></a>í´ëŸ¬ìŠ¤í„° ë…¸ë“œì˜ ê³ ìœ  ì£¼ì†Œ í™•ì¸</h4><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•˜ëŠ” í˜¸ìŠ¤íŠ¸ë“¤ì´ ì„œë¡œ í†µì‹ í•  ìˆ˜ ìˆë„ë¡ ë„¤íŠ¸ì›Œí¬ í™˜ê²½ì—ì„œ ê³ ìœ í•œ ì£¼ì†Œë¥¼ ê°€ì§€ê³  ìˆëŠ”ì§€ í™•ì¸í•´ì•¼í•©ë‹ˆë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œëŠ” ê° ë…¸ë“œë¥¼ <strong>í˜¸ìŠ¤íŠ¸ì˜ MAC ì£¼ì†Œ</strong> ë° <strong>product_uuid</strong>ë¥¼ ê¸°ì¤€ìœ¼ë¡œ êµ¬ë¶„í•œë‹¤ê³  í•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>MAC ì£¼ì†Œ ë° product_uuid ì¡°íšŒ</span></div><code class="language-sh">sudo apt install net-tools
sudo ifconfig -a
sudo cat &#x2F;sys&#x2F;class&#x2F;dmi&#x2F;id&#x2F;product_uuid</code></pre><p>ê·¸ë¦¬ê³  ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•˜ëŠ” í˜¸ìŠ¤íŠ¸ì˜ ì—­í• ì— ë§ê²Œ ì‚¬ìš©í•´ì•¼ë  í¬íŠ¸ë¥¼ ì ìœ í•˜ê³  ìˆëŠ”ì§€ í™•ì¸í•´ì•¼í•©ë‹ˆë‹¤.</p><p><img data-src="/images/posts/setup-kubernetes-cluster/setup-kubernetes-cluster-01.png"></p><h4 id="ì»¨í…Œì´ë„ˆ-ëŸ°íƒ€ì„-ì„ íƒí•˜ê¸°"><a href="#ì»¨í…Œì´ë„ˆ-ëŸ°íƒ€ì„-ì„ íƒí•˜ê¸°" class="headerlink" title="ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ ì„ íƒí•˜ê¸°"></a>ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ ì„ íƒí•˜ê¸°</h4><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ íŒŒë“œ ì•ˆì— ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ê²Œ ë  ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ì„ ì„ íƒí•˜ê³  ì„¤ì¹˜í•´ì•¼í•©ë‹ˆë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•˜ëŠ” ë§ì€ ê¸€ì—ì„œ ë„ì»¤ë¥¼ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ ì†Œê°œí•˜ê³ ìˆì§€ë§Œ ì•ìœ¼ë¡œ ìµœì‹  ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë²„ì „ì—ì„œëŠ” <a target="_blank" rel="noopener" href="https://kubernetes.io/blog/2020/12/02/dont-panic-kubernetes-and-docker/">ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì¤€ìˆ˜í•˜ì§€ ì•ŠëŠ” ë„ì»¤</a>ë¥¼ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ìœ¼ë¡œ ì§€ì›í•˜ì§€ ì•Šì„ ì˜ˆì •ì…ë‹ˆë‹¤. ë”°ë¼ì„œ, ì €ëŠ” <a target="_blank" rel="noopener" href="https://cri-o.io/">CRI-O</a>ë¥¼ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ìœ¼ë¡œ ì„ íƒí•˜ê³  ì„¤ì¹˜í•˜ê² ìŠµë‹ˆë‹¤.</p><p>CRI-Oë¥¼ ì„¤ì¹˜í•˜ê¸° ì „ì— ìš°ë¶„íˆ¬ì˜ iptablesê°€ ë¸Œë¦¿ì§€ëœ íŠ¸ë˜í”½ì„ ë°”ë¼ë³´ë„ë¡ ì„¤ì •í•´ì•¼í•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>ì˜¤ë²„ë ˆì´ ë„¤íŠ¸ì›Œí¬ ë° iptables ë¸Œë¦¿ì§€ íŠ¸ë˜í”½ í™œì„±í™”</span></div><code class="language-sh">cat &lt;&lt;EOF | sudo tee &#x2F;etc&#x2F;modules-load.d&#x2F;crio.conf
overlay
br_netfilter
EOF

sudo modprobe overlay
sudo modprobe br_netfilter

cat &lt;&lt;EOF | sudo tee &#x2F;etc&#x2F;sysctl.d&#x2F;99-kubernetes-cri.conf
net.bridge.bridge-nf-call-iptables  &#x3D; 1
net.ipv4.ip_forward                 &#x3D; 1
net.bridge.bridge-nf-call-ip6tables &#x3D; 1
EOF

sudo sysctl --system</code></pre><p>ìœ„ ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆë‹¤ë©´ ë‹¤ìŒì˜ ëª…ë ¹ì–´ë¡œ CRI-O ê´€ë ¨ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>CRI-O ê´€ë ¨ íŒ¨í‚¤ì§€ ì„¤ì¹˜</span></div><code class="language-sh">echo &quot;deb https:&#x2F;&#x2F;download.opensuse.org&#x2F;repositories&#x2F;devel:&#x2F;kubic:&#x2F;libcontainers:&#x2F;stable&#x2F;xUbuntu_20.04&#x2F; &#x2F;&quot; | sudo tee &#x2F;etc&#x2F;apt&#x2F;sources.list.d&#x2F;devel:kubic:libcontainers:stable.list
echo &quot;deb http:&#x2F;&#x2F;download.opensuse.org&#x2F;repositories&#x2F;devel:&#x2F;kubic:&#x2F;libcontainers:&#x2F;stable:&#x2F;cri-o:&#x2F;1.21&#x2F;xUbuntu_20.04&#x2F; &#x2F;&quot; | sudo tee &#x2F;etc&#x2F;apt&#x2F;sources.list.d&#x2F;devel:kubic:libcontainers:stable:cri-o:1.21.list

curl -L https:&#x2F;&#x2F;download.opensuse.org&#x2F;repositories&#x2F;devel:kubic:libcontainers:stable:cri-o:1.21&#x2F;xUbuntu_20.04&#x2F;Release.key | sudo apt-key add -
curl -L https:&#x2F;&#x2F;download.opensuse.org&#x2F;repositories&#x2F;devel:&#x2F;kubic:&#x2F;libcontainers:&#x2F;stable&#x2F;xUbuntu_20.04&#x2F;Release.key | sudo apt-key add -

sudo apt-get update
sudo apt-get install -y cri-o cri-o-runc
sudo apt-mark hold cri-o cri-o-runc
sudo systemctl daemon-reload
sudo systemctl enable crio --now</code></pre><h4 id="íŒŒë“œ-ë„¤íŠ¸ì›Œí¬-í”ŒëŸ¬ê·¸ì¸-ê²°ì •í•˜ê¸°"><a href="#íŒŒë“œ-ë„¤íŠ¸ì›Œí¬-í”ŒëŸ¬ê·¸ì¸-ê²°ì •í•˜ê¸°" class="headerlink" title="íŒŒë“œ ë„¤íŠ¸ì›Œí¬ í”ŒëŸ¬ê·¸ì¸ ê²°ì •í•˜ê¸°"></a>íŒŒë“œ ë„¤íŠ¸ì›Œí¬ í”ŒëŸ¬ê·¸ì¸ ê²°ì •í•˜ê¸°</h4><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ì‹¤í–‰ë˜ëŠ” íŒŒë“œì—ì„œ ì»¨í…Œì´ë„ˆ ê°„ í†µì‹ ì„ ìœ„í•´ì„œ <a target="_blank" rel="noopener" href="https://github.com/containernetworking/cni">ì»¨í…Œì´ë„ˆ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤(CNI)</a>ë¥¼ ì‚¬ìš©í•˜ê²Œ ë©ë‹ˆë‹¤. ë‹¤ì–‘í•œ CNI ì˜¤í”ˆì†ŒìŠ¤ ì¤‘ì—ì„œ íŒŒë“œ ë„¤íŠ¸ì›Œí¬ í”ŒëŸ¬ê·¸ì¸ì„ ì„ íƒí•´ì•¼í•˜ë©° íŒŒë“œ ë„¤íŠ¸ì›Œí¬ í”ŒëŸ¬ê·¸ì¸ì— ë”°ë¼ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‹œì‘í•  ë•Œ CIDR ë¸”ë¡ì„ ì§€ì •í•´ì•¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>ì˜ˆë¥¼ ë“¤ì–´, <a target="_blank" rel="noopener" href="https://github.com/flannel-io/flannel">í”Œë¼ë„¬(Flannel)</a>ì„ CNIë¡œ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì‹œì‘ ì‹œ <strong>10.244.0.0&#x2F;16</strong>ë¥¼ íŒŒë“œ ë„¤íŠ¸ì›Œí¬ CIDR ë¸”ë¡ìœ¼ë¡œ ì§€ì •í•´ì•¼í•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>í”Œë¼ë„¬ì„ íŒŒë“œ ë„¤íŠ¸ì›Œí¬ í”ŒëŸ¬ê·¸ì¸ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” í´ëŸ¬ìŠ¤í„° ì‹œì‘ ì˜ˆì‹œ</span></div><code class="language-sh">sudo kubeadm init --pod-network-cidr&#x3D;10.244.0.0&#x2F;16
sudo kubectl apply -f https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;coreos&#x2F;flannel&#x2F;master&#x2F;Documentation&#x2F;kube-flannel.yml</code></pre><h4 id="ë„¤íŠ¸ì›Œí¬-ì •ì±…-í”ŒëŸ¬ê·¸ì¸"><a href="#ë„¤íŠ¸ì›Œí¬-ì •ì±…-í”ŒëŸ¬ê·¸ì¸" class="headerlink" title="ë„¤íŠ¸ì›Œí¬ ì •ì±… í”ŒëŸ¬ê·¸ì¸"></a>ë„¤íŠ¸ì›Œí¬ ì •ì±… í”ŒëŸ¬ê·¸ì¸</h4><p>íŒŒë“œ ë„¤íŠ¸ì›Œí¬ í”ŒëŸ¬ê·¸ì¸ìœ¼ë¡œ ê²°ì •í•œ <strong>í”Œë¼ë„¬</strong>ì´ë¼ëŠ” CNIëŠ” ë„¤íŠ¸ì›Œí¬ ì •ì±… ê¸°ëŠ¥ì„ í¬í•¨í•˜ê³  ìˆì§€ ì•ŠëŠ” ìˆœìˆ˜í•˜ê²Œ ë„¤íŠ¸ì›Œí¬ í†µì‹ ì„ ëª©ì ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ ì˜¤í”ˆì†ŒìŠ¤ì…ë‹ˆë‹¤. ë§Œì•½, ìš°ë¦¬ì˜ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì˜ íŒŒë“œì— ëŒ€í•œ íŠ¸ë˜í”½ ì œì–´ë¥¼ ìœ„í•´ì„œ ì¸ê·¸ë ˆìŠ¤ ë˜ëŠ” ì´ê·¸ë ˆìŠ¤ì™€ ê°™ì€ ê¸°ëŠ¥ì„ ì ìš©í•´ì•¼í•œë‹¤ë©´ <strong>ë„¤íŠ¸ì›Œí¬ ì •ì±…</strong> ê¸°ëŠ¥ì´ í¬í•¨ëœ í”ŒëŸ¬ê·¸ì¸ì„ íŒŒë“œ ë„¤íŠ¸ì›Œí¬ í”ŒëŸ¬ê·¸ì¸ìœ¼ë¡œ ì‚¬ìš©í•´ì•¼í•©ë‹ˆë‹¤.</p><p>ì¼ë°˜ì ìœ¼ë¡œ êµ¬í˜„ ë°©ì‹ì˜ ì°¨ì´ê°€ ìˆì§€ë§Œ ë‹¤ìŒê³¼ ê°™ì€ ë„¤íŠ¸ì›Œí¬ ì •ì±…ì„ í¬í•¨í•˜ëŠ” í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</p><ul><li><a target="_blank" rel="noopener" href="https://github.com/antrea-io/antrea">Antrea</a></li><li><a target="_blank" rel="noopener" href="https://github.com/projectcalico/calico">Calico</a></li><li><a target="_blank" rel="noopener" href="https://github.com/weaveworks/weave">Weave Net</a></li><li><a target="_blank" rel="noopener" href="https://docs.projectcalico.org/getting-started/kubernetes/flannel/flannel">Canal</a></li></ul><p>ì˜ˆë¥¼ ë“¤ì–´, í”Œë¼ë„¬ì„ CNIë¡œ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´ ìº˜ë¦¬ì½”(Calico)ë¥¼ ë„¤íŠ¸ì›Œí¬ ì •ì±… ê³µê¸‰ìë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” <strong>ì¹´ë‚ (Canal)</strong> ì„ ì„ íƒí•˜ë©´ ë©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>ì¹´ë‚ ì„ ì‚¬ìš©í•˜ëŠ” í´ëŸ¬ìŠ¤í„° ì‹œì‘ ì˜ˆì‹œ</span></div><code class="language-sh">sudo kubeadm init --pod-network-cidr&#x3D;10.244.0.0&#x2F;16
sudo kubectl apply -f https:&#x2F;&#x2F;docs.projectcalico.org&#x2F;manifests&#x2F;canal.yaml</code></pre><blockquote><p>ì¹´ë‚ ì€ í”Œë¼ë„¬ì„ CNIë¡œ ì‚¬ìš©í•˜ë¯€ë¡œ í”Œë¼ë„¬ì˜ íŒŒë“œ ë„¤íŠ¸ì›Œí¬ CIDR ë¸”ë¡ì„ ì§€ì •í•©ë‹ˆë‹¤.</p></blockquote><h3 id="ì¿ ë²„ë„¤í‹°ìŠ¤-í´ëŸ¬ìŠ¤í„°-DNS-ì„œë²„"><a href="#ì¿ ë²„ë„¤í‹°ìŠ¤-í´ëŸ¬ìŠ¤í„°-DNS-ì„œë²„" class="headerlink" title="ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° DNS ì„œë²„"></a>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° DNS ì„œë²„</h3><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ë¥¼ ì ìš©í•˜ê¸° ìœ„í•˜ì—¬ DNS ì„œë²„ë¥¼ ì„¤ì¹˜í•´ì•¼í•©ë‹ˆë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° 1.11+ ë¶€í„°ëŠ” <a target="_blank" rel="noopener" href="https://github.com/kubernetes/dns">kube-dns</a> ë³´ë‹¤ëŠ” <a target="_blank" rel="noopener" href="https://coredns.io/">CoreDNS</a>ì„ ê¶Œì¥í•˜ê³  ìš°ë¦¬ê°€ í´ëŸ¬ìŠ¤í„° ì‹œì‘ ì‹œ ì‚¬ìš©í•˜ê²Œ ë  kubeadmì€ ê¸°ë³¸ì ìœ¼ë¡œ <strong>CoreDNS</strong>ë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ í¬í•¨ë˜ëŠ” CoreDNSëŠ” <strong>ëŒ€ê¸° ìƒíƒœ</strong>ì— ìˆë‹¤ê°€ ìš°ë¦¬ê°€ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— íŒŒë“œ ë„¤íŠ¸ì›Œí¬ í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•˜ë©´ ìë™ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.</p><h2 id="ì¿ ë²„ë„¤í‹°ìŠ¤-í´ëŸ¬ìŠ¤í„°-ì‹œì‘í•˜ê¸°"><a href="#ì¿ ë²„ë„¤í‹°ìŠ¤-í´ëŸ¬ìŠ¤í„°-ì‹œì‘í•˜ê¸°" class="headerlink" title="ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì‹œì‘í•˜ê¸°"></a>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì‹œì‘í•˜ê¸°</h2><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì„ ìœ„í•´ í™•ì¸í•´ì•¼í•  ëª‡ê°€ì§€ í•­ëª©ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤. ì´ì œ ì €ì™€ í•¨ê»˜ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•  í˜¸ìŠ¤íŠ¸ë¥¼ ì¤€ë¹„í•˜ê³  ì¿ ë²„ë„¤í‹°ìŠ¤ ë°°í¬ ë„êµ¬ì¸ <strong>kubeadm</strong>ì„ ì‚¬ìš©í•˜ì—¬ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‹œì‘í•´ë³´ê² ìŠµë‹ˆë‹¤.</p><p>ë¨¼ì €, ì•„ë§ˆì¡´ ì›¹ ì„œë¹„ìŠ¤ì˜ EC2 ì¸ìŠ¤í„´ìŠ¤ë¥¼ <strong>ìš°ë¶„íˆ¬ 20.04 LTS</strong> ë¡œ ì‹œì‘í•˜ê² ìŠµë‹ˆë‹¤.</p><p><img data-src="/images/posts/setup-kubernetes-cluster/setup-kubernetes-cluster-02.png"></p><p>ê·¸ë¦¬ê³  kubeadmëŠ” í´ëŸ¬ìŠ¤í„° ì‹œì‘ì„ ìœ„í•´ <strong>CPU 2ì½”ì–´ ì´ìƒ, ë©”ëª¨ë¦¬ 2GB ì´ìƒ</strong> ì„ ìš”êµ¬í•˜ë¯€ë¡œ t2.medium ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì„ íƒí–ˆìŠµë‹ˆë‹¤.</p><p><img data-src="/images/posts/setup-kubernetes-cluster/setup-kubernetes-cluster-03.png"></p><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì„ ìœ„í•œ í•™ìŠµì„ ëª©ì ìœ¼ë¡œ í•˜ë¯€ë¡œ <strong>ë§ˆìŠ¤í„° ë…¸ë“œì™€ í•¨ê»˜ 1ê°œ ì´ìƒì˜ ì›Œì»¤ ë…¸ë“œë¥¼ êµ¬ì„±</strong>í•˜ê¸° ìœ„í•˜ì—¬ <strong>ìµœì†Œ 2ê°œì˜ ìš°ë¶„íˆ¬ ì¸ìŠ¤í„´ìŠ¤</strong>ë¥¼ ì¤€ë¹„í•©ë‹ˆë‹¤.</p><h3 id="í´ëŸ¬ìŠ¤í„°-êµ¬ì„±-í˜¸ìŠ¤íŠ¸ì—-ëŒ€í•œ-ì‚¬ì „-ì‘ì—…"><a href="#í´ëŸ¬ìŠ¤í„°-êµ¬ì„±-í˜¸ìŠ¤íŠ¸ì—-ëŒ€í•œ-ì‚¬ì „-ì‘ì—…" class="headerlink" title="í´ëŸ¬ìŠ¤í„° êµ¬ì„± í˜¸ìŠ¤íŠ¸ì— ëŒ€í•œ ì‚¬ì „ ì‘ì—…"></a>í´ëŸ¬ìŠ¤í„° êµ¬ì„± í˜¸ìŠ¤íŠ¸ì— ëŒ€í•œ ì‚¬ì „ ì‘ì—…</h3><p>ìš°ë¦¬ê°€ ì¤€ë¹„í•œ ìš°ë¶„íˆ¬ ì¸ìŠ¤í„´ìŠ¤ì— ì¿ ë²„ë„¤í‹°ìŠ¤ ì¸í”„ë¼ í™˜ê²½ì„ êµ¬ì„±í•˜ê¸° ìœ„í•œ ì‚¬ì „ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>ë©”ëª¨ë¦¬ ìŠ¤ì™‘ ê¸°ëŠ¥ ë¹„í™œì„±í™”</span></div><code class="language-sh">sudo swapoff -a &amp;&amp; sudo sed -i &#39;&#x2F; swap &#x2F; s&#x2F;^\(.*\)$&#x2F;#\1&#x2F;g&#39; &#x2F;etc&#x2F;fstab

cat &lt;&lt;EOF | sudo tee &#x2F;etc&#x2F;modules-load.d&#x2F;crio.conf
overlay
br_netfilter
EOF

sudo modprobe overlay
sudo modprobe br_netfilter

cat &lt;&lt;EOF | sudo tee &#x2F;etc&#x2F;sysctl.d&#x2F;99-kubernetes-cri.conf
net.bridge.bridge-nf-call-iptables  &#x3D; 1
net.ipv4.ip_forward                 &#x3D; 1
net.bridge.bridge-nf-call-ip6tables &#x3D; 1
EOF

sudo sysctl --system</code></pre><pre class="language-sh" data-language="sh"><div class="caption"><span>CRI-O ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ ì„¤ì¹˜í•˜ê¸°</span></div><code class="language-sh">echo &quot;deb https:&#x2F;&#x2F;download.opensuse.org&#x2F;repositories&#x2F;devel:&#x2F;kubic:&#x2F;libcontainers:&#x2F;stable&#x2F;xUbuntu_20.04&#x2F; &#x2F;&quot; | sudo tee &#x2F;etc&#x2F;apt&#x2F;sources.list.d&#x2F;devel:kubic:libcontainers:stable.list
echo &quot;deb http:&#x2F;&#x2F;download.opensuse.org&#x2F;repositories&#x2F;devel:&#x2F;kubic:&#x2F;libcontainers:&#x2F;stable:&#x2F;cri-o:&#x2F;1.21&#x2F;xUbuntu_20.04&#x2F; &#x2F;&quot; | sudo tee &#x2F;etc&#x2F;apt&#x2F;sources.list.d&#x2F;devel:kubic:libcontainers:stable:cri-o:1.21.list

curl -L https:&#x2F;&#x2F;download.opensuse.org&#x2F;repositories&#x2F;devel:kubic:libcontainers:stable:cri-o:1.21&#x2F;xUbuntu_20.04&#x2F;Release.key | sudo apt-key add -
curl -L https:&#x2F;&#x2F;download.opensuse.org&#x2F;repositories&#x2F;devel:&#x2F;kubic:&#x2F;libcontainers:&#x2F;stable&#x2F;xUbuntu_20.04&#x2F;Release.key | sudo apt-key add -

sudo apt-get update
sudo apt-get install -y cri-o cri-o-runc
sudo apt-mark hold cri-o cri-o-runc
sudo systemctl daemon-reload
sudo systemctl enable crio --now</code></pre><h3 id="ì»¨íŠ¸ë¡¤-í”Œë ˆì¸-ë…¸ë“œ-ì´ˆê¸°í™”"><a href="#ì»¨íŠ¸ë¡¤-í”Œë ˆì¸-ë…¸ë“œ-ì´ˆê¸°í™”" class="headerlink" title="ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ ë…¸ë“œ ì´ˆê¸°í™”"></a>ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ ë…¸ë“œ ì´ˆê¸°í™”</h3><p>ì´ì œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‹œì‘í•˜ê¸° ìœ„í•´ì„œ <strong>kubeadm init</strong> ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ <strong>ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ ë…¸ë“œë¥¼ ì´ˆê¸°í™”</strong> í•©ë‹ˆë‹¤. ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ ë…¸ë“œê°€ í˜•ì„±ëœ í˜¸ìŠ¤íŠ¸ë¥¼ <strong>ë§ˆìŠ¤í„° ë…¸ë“œ</strong>ë¼ê³  ë¶€ë¥´ê²Œ ë©ë‹ˆë‹¤.</p><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ íŒŒë“œ ë„¤íŠ¸ì›Œí¬ í”ŒëŸ¬ê·¸ì¸ì„ í”Œë¼ë„¬ì„ ì‚¬ìš©í•  ì˜ˆì •ì´ë¯€ë¡œ ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ ë…¸ë“œ ì‹œì‘ ì‹œ <strong>íŒŒë“œ ë„¤íŠ¸ì›Œí¬ CIDR ë¸”ë¡</strong>ì„ <code>10.244.0.0/16</code>ìœ¼ë¡œ ì§€ì •í•´ì•¼í•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ ë…¸ë“œë¥¼ ì´ˆê¸°í™”í•˜ì—¬ í´ëŸ¬ìŠ¤í„° ì‹œì‘</span></div><code class="language-sh">sudo kubeadm init --pod-network-cidr&#x3D;10.244.0.0&#x2F;16

...
Your Kubernetes control-plane has initialized successfully!

To start using your cluster, you need to run the following as a regular user:

  mkdir -p $HOME&#x2F;.kube
  sudo cp -i &#x2F;etc&#x2F;kubernetes&#x2F;admin.conf $HOME&#x2F;.kube&#x2F;config
  sudo chown $(id -u):$(id -g) $HOME&#x2F;.kube&#x2F;config

Alternatively, if you are the root user, you can run:

  export KUBECONFIG&#x3D;&#x2F;etc&#x2F;kubernetes&#x2F;admin.conf

You should now deploy a pod network to the cluster.
Run &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at:
  https:&#x2F;&#x2F;kubernetes.io&#x2F;docs&#x2F;concepts&#x2F;cluster-administration&#x2F;addons&#x2F;

Then you can join any number of worker nodes by running the following on each as root:

kubeadm join 172.31.11.193:6443 --token oov7g6.bi85jo3kv15oeryf \
--discovery-token-ca-cert-hash sha256:08874017445a8ddf06dde3e9e7be79097c470883f0384c046290e207ec3342bd</code></pre><p>ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ ë…¸ë“œê°€ ì„±ê³µì ìœ¼ë¡œ ì´ˆê¸°í™”ë˜ì—ˆìœ¼ë‹ˆ íŒŒë“œ ë„¤íŠ¸ì›Œí¬ í”ŒëŸ¬ê·¸ì¸ìœ¼ë¡œ í”Œë¼ë„¬ì„ ì„¤ì¹˜í•´ì•¼í•©ë‹ˆë‹¤. í”Œë¼ë„¬ì„ ì„¤ì¹˜í•˜ê¸° ìœ„í•´ì„œëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì œì–´í•˜ëŠ”ë° ì‚¬ìš©í•˜ëŠ” <strong>íë¸Œì»¨íŠ¸ë¡¤(kubectl)</strong> ì— í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ì„ ìœ„í•œ ì„¤ì •ì„ ì§„í–‰í•´ì•¼í•©ë‹ˆë‹¤. ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ ë…¸ë“œ ì´ˆê¸°í™” ì‹œ ì¶œë ¥ëœ ë‹¤ìŒì˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>íë¸Œì»¨íŠ¸ë¡¤ì— í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ ì„¤ì •</span></div><code class="language-sh">mkdir -p $HOME&#x2F;.kube
sudo cp -i &#x2F;etc&#x2F;kubernetes&#x2F;admin.conf $HOME&#x2F;.kube&#x2F;config
sudo chown $(id -u):$(id -g) $HOME&#x2F;.kube&#x2F;config</code></pre><p>ìœ„ ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•˜ê³  ë‚˜ë©´ íë¸Œì»¨íŠ¸ë¡¤ì´ <strong>$HOME&#x2F;.kube</strong> ê²½ë¡œì— ìˆëŠ” í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„±íŒŒì¼ì´ë¼ê³  í•˜ëŠ” <code>kubeconfig</code>ë¥¼ ì°¸ì¡°í•˜ì—¬ í´ëŸ¬ìŠ¤í„°ì— ì ‘ê·¼í•˜ì—¬ ëª…ë ¹ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„±íŒŒì¼ì— ëŒ€í•´ì„œëŠ” ìì„¸íˆ ì•Œì•„ë³¼ í•„ìš”ê°€ ì—†ìœ¼ë¯€ë¡œ ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤.</p><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ì‹¤í–‰ëœ ëª¨ë“  íŒŒë“œë¥¼ ì¡°íšŒí•˜ê¸° ìœ„í•˜ì—¬ ë‹¤ìŒì˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>í´ëŸ¬ìŠ¤í„°ì˜ ëª¨ë“  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ëŒ€í•œ íŒŒë“œ ì¡°íšŒ</span></div><code class="language-sh">kubectl get pods --all-namespaces
...
NAMESPACE     NAME                                       READY   STATUS    RESTARTS   AGE
kube-system   coredns-558bd4d5db-b9t9v                   0&#x2F;1     Pending   0          106s
kube-system   coredns-558bd4d5db-bkhc4                   0&#x2F;1     Pending   0          106s
kube-system   etcd-ip-172-31-11-193                      1&#x2F;1     Running   0          117s
kube-system   kube-apiserver-ip-172-31-11-193            1&#x2F;1     Running   0          117s
kube-system   kube-controller-manager-ip-172-31-11-193   1&#x2F;1     Running   0          2m4s
kube-system   kube-proxy-gm8tr                           1&#x2F;1     Running   0          106s
kube-system   kube-scheduler-ip-172-31-11-193            1&#x2F;1     Running   0          2m5s</code></pre><p>ì•ì„œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° DNS ì„œë²„ ê´€ë ¨í•´ì„œ CoreDNSëŠ” íŒŒë“œ ë„¤íŠ¸ì›Œí¬ í”ŒëŸ¬ê·¸ì¸ì´ ì„¤ì¹˜ë˜ê¸°ê¹Œì§€ ëŒ€ê¸° ìƒíƒœì— ìˆë‹¤ê³  í•˜ì˜€ìŠµë‹ˆë‹¤. í”Œë¼ë„¬ì„ íŒŒë“œ ë„¤íŠ¸ì›Œí¬ í”ŒëŸ¬ê·¸ì¸ìœ¼ë¡œ ì„¤ì¹˜í•˜ê³ ë‚˜ì„œ CoreDNSê°€ ì‹¤í–‰ë˜ëŠ”ì§€ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.</p><h3 id="ë„¤íŠ¸ì›Œí¬-í”ŒëŸ¬ê·¸ì¸-ì„¤ì¹˜"><a href="#ë„¤íŠ¸ì›Œí¬-í”ŒëŸ¬ê·¸ì¸-ì„¤ì¹˜" class="headerlink" title="ë„¤íŠ¸ì›Œí¬ í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜"></a>ë„¤íŠ¸ì›Œí¬ í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜</h3><p>íŒŒë“œ ë„¤íŠ¸ì›Œí¬ í”ŒëŸ¬ê·¸ì¸ìœ¼ë¡œ í”Œë¼ë„¬ì„ ì‚¬ìš©í•˜ë©´ì„œ ë„¤íŠ¸ì›Œí¬ ì •ì±… ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ê¸° ìœ„í•´ ë„¤íŠ¸ì›Œí¬ ì •ì±… í”ŒëŸ¬ê·¸ì¸ìœ¼ë¡œ ìº˜ë¦¬ì½”ë¥¼ ì‚¬ìš©í•˜ëŠ” ì¹´ë‚ (Canal)ì„ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ì„¤ì¹˜í•˜ê² ìŠµë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>ì¹´ë‚  ë„¤íŠ¸ì›Œí¬ í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜</span></div><code class="language-sh">kubectl apply -f https:&#x2F;&#x2F;docs.projectcalico.org&#x2F;manifests&#x2F;canal.yaml
...

kubectl get pods -A
...
NAMESPACE     NAME                                       READY   STATUS    RESTARTS   AGE
kube-system   calico-kube-controllers-78d6f96c7b-ltz89   1&#x2F;1     Running   0          22s
kube-system   canal-2mmz5                                2&#x2F;2     Running   0          23s
kube-system   coredns-558bd4d5db-t4w4s                   1&#x2F;1     Running   0          94s
kube-system   coredns-558bd4d5db-wg7zg                   1&#x2F;1     Running   0          94s
kube-system   etcd-ip-172-31-11-193                      1&#x2F;1     Running   0          102s
kube-system   kube-apiserver-ip-172-31-11-193            1&#x2F;1     Running   0          109s
kube-system   kube-controller-manager-ip-172-31-11-193   1&#x2F;1     Running   0          102s
kube-system   kube-proxy-gmp4q                           1&#x2F;1     Running   0          93s
kube-system   kube-scheduler-ip-172-31-11-193            1&#x2F;1     Running   0          102s</code></pre><p>ì¹´ë‚ ì„ ì„¤ì¹˜í•˜ê³ ë‚˜ì„œ íŒŒë“œ ì¡°íšŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë‹ˆ ëŒ€ê¸°ì¤‘ì´ì—ˆë˜ <strong>CoreDNS</strong>ê°€ ì‹¤í–‰ë˜ì—ˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><blockquote><p>ëˆˆì¹˜ì±„ì‹  ë¶„ë“¤ë„ ê³„ì‹œê² ì§€ë§Œ íë¸Œì»¨íŠ¸ë¡¤ë¡œ ëª¨ë“  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ëŒ€í•´ì„œ ì¡°íšŒí•˜ê¸° ìœ„í•´ì„œ ì‚¬ìš©í•˜ëŠ” <strong>â€“all-namespaces</strong> ì˜µì…˜ ëŒ€ì‹ ì— <strong>-A</strong>ë¥¼ ëŒ€ì‹  ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>ì´ë ‡ê²Œ íë¸Œì»¨íŠ¸ë¡¤ì„ ì‚¬ìš©í•  ë•Œ ê¸´ ì´ë¦„ì„ ëŒ€ì‹ í•  ìˆ˜ ìˆëŠ” ì¶•ì•½ì–´ë¥¼ ì§€ì›í•˜ë‹ˆ ì—¬ëŸ¬ê°€ì§€ ì¶•ì•½ í˜•íƒœë¥¼ ì°¾ì•„ë³´ì„¸ìš”.</p></blockquote><h3 id="ì¿ ë²„ë„¤í‹°ìŠ¤-í´ëŸ¬ìŠ¤í„°-ì›Œì»¤-ë…¸ë“œ-ì¶”ê°€"><a href="#ì¿ ë²„ë„¤í‹°ìŠ¤-í´ëŸ¬ìŠ¤í„°-ì›Œì»¤-ë…¸ë“œ-ì¶”ê°€" class="headerlink" title="ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì›Œì»¤ ë…¸ë“œ ì¶”ê°€"></a>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì›Œì»¤ ë…¸ë“œ ì¶”ê°€</h3><p>ì•ì„  ì‘ì—…ê¹Œì§€ ìˆ˜í–‰í•˜ë©´ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì‹œì‘ì´ ì™„ë£Œë˜ì—ˆë‹¤ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì„ ì™„ë£Œí•˜ê¸° ìœ„í•˜ì—¬ í´ëŸ¬ìŠ¤í„°ê°€ íŒŒë“œì— ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ëŠ” í™˜ê²½ì´ ë˜ëŠ” ì›Œì»¤ ë…¸ë“œë¥¼ ì°¸ì—¬ì‹œì¼œì•¼í•©ë‹ˆë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ë‹¤ë¥¸ í˜¸ìŠ¤íŠ¸ë¥¼ ì›Œì»¤ ë…¸ë“œë¡œ ì°¸ì—¬ì‹œí‚¤ê¸° ìœ„í•´ì„œëŠ” ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ ë…¸ë“œë¥¼ ì´ˆê¸°í™”í•˜ê³  ë‚˜ì„œ ì¶œë ¥ë˜ëŠ” ë‹¤ìŒì˜ ëª…ë ¹ì–´ë¥¼ ì›Œì»¤ ë…¸ë“œê°€ ë  í˜¸ìŠ¤íŠ¸ì—ì„œ ì‹¤í–‰í•´ì•¼í•©ë‹ˆë‹¤.</p><blockquote><p>í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•˜ëŠ” ëª¨ë“  í˜¸ìŠ¤íŠ¸ì— kubectl, kubeletì„ ì„¤ì¹˜í•˜ëŠ” ê²ƒì´ ì´ëŸ¬í•œ ì´ìœ ì…ë‹ˆë‹¤.</p></blockquote><pre class="language-sh" data-language="sh"><div class="caption"><span>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ì›Œì»¤ ë…¸ë“œ ì°¸ì—¬</span></div><code class="language-sh">kubeadm join 172.31.11.193:6443 --token oov7g6.bi85jo3kv15oeryf \
--discovery-token-ca-cert-hash sha256:08874017445a8ddf06dde3e9e7be79097c470883f0384c046290e207ec3342bd 
...
This node has joined the cluster:
* Certificate signing request was sent to apiserver and a response was received.
* The Kubelet was informed of the new secure connection details.

Run &#39;kubectl get nodes&#39; on the control-plane to see this node join the cluster.</code></pre><p>ë§ˆì§€ë§‰ ë¬¸ì¥ì— ë”°ë¼ ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ ë…¸ë“œê°€ ìˆëŠ” ë§ˆìŠ¤í„° ë…¸ë“œì—ì„œ <strong>kubectl get nodes</strong> ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•´ë´…ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì˜ ë…¸ë“œ ì¡°íšŒ</span></div><code class="language-sh"># kubectl get [nodes&#x2F;node&#x2F;no]
kubectl get no
...
NAME               STATUS   ROLES                  AGE     VERSION
ip-172-31-11-193   Ready    control-plane,master   3m18s   v1.21.3
ip-172-31-41-106   Ready    &lt;none&gt;                 42s     v1.21.3</code></pre><p>ì €ëŠ” í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•˜ëŠ” ë…¸ë“œë¥¼ ì¡°íšŒí•˜ëŠ” ëª…ë ¹ì–´ë¥¼ ì¶•ì•½ í˜•íƒœë¡œ ì‹¤í–‰í–ˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ íë¸Œì»¨íŠ¸ë¡¤ë¡œ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•  ë•Œ ì¿ ë²„ë„¤í‹°ìŠ¤ ë¦¬ì†ŒìŠ¤ë¥¼ <strong>ë³µìˆ˜í˜•, ë‹¨ìˆ˜í˜•, ì¶•ì•½í˜•</strong>ì„ ëª¨ë‘ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ ì¿ ë²„ë„¤í‹°ìŠ¤ ë°°í¬ ë„êµ¬ë¡œ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‹œì‘í•˜ê³  ì›Œì»¤ ë…¸ë“œë¥¼ ì°¸ì—¬ì‹œì¼œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.</p><blockquote><p>ìœ„ ëª…ë ¹ì–´ ìˆ˜í–‰ê²°ê³¼ì—ì„œ ì›Œì»¤ ë…¸ë“œì— ROLESê°€ ì—†ëŠ” ê²ƒì´ ë¬¸ì œê°€ ì•ˆë˜ì§€ë§Œ ì •í™•í•œ êµ¬ë¶„ì„ ìœ„í•´ workerë¥¼ ì¶”ê°€í•˜ê³  ì‹¶ë‹¤ë©´ ë‹¤ìŒì˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì‹œë©´ ë©ë‹ˆë‹¤.</p></blockquote><pre class="language-sh" data-language="sh"><div class="caption"><span>ì›Œì»¤ ë…¸ë“œì— worker ROLE ë ˆì´ë¸” ì¶”ê°€</span></div><code class="language-sh">kubectl label node ip-172-31-41-106 node-role.kubernetes.io&#x2F;worker&#x3D;worker</code></pre><h2 id="ì¿ ë²„ë„¤í‹°ìŠ¤-í´ëŸ¬ìŠ¤í„°-ì œì–´í•˜ê¸°"><a href="#ì¿ ë²„ë„¤í‹°ìŠ¤-í´ëŸ¬ìŠ¤í„°-ì œì–´í•˜ê¸°" class="headerlink" title="ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì œì–´í•˜ê¸°"></a>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì œì–´í•˜ê¸°</h2><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì œì–´í•˜ê¸° ìœ„í•´ì„œëŠ” ë§ˆìŠ¤í„° ë…¸ë“œì¸ í˜¸ìŠ¤íŠ¸ì— ì ‘ì†í•˜ì—¬ íë¸Œì»¨íŠ¸ë¡¤ìœ¼ë¡œ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•´ì•¼í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜, ë°˜ë“œì‹œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì œì–´ë¥¼ ìœ„í•´ì„œ ë§ˆìŠ¤í„° ë…¸ë“œì—ì„œ ìˆ˜í–‰í•  í•„ìš”ëŠ” ì—†ìŠµë‹ˆë‹¤. ê·¸ ì´ìœ ëŠ” <strong>íë¸Œì»¨íŠ¸ë¡¤(kubectl)</strong> ì´ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ì„ ìœ„í•´ì„œ <strong>í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„± íŒŒì¼(kubeconfig)</strong> ì„ ì°¸ì¡°í•´ì„œ í´ëŸ¬ìŠ¤í„°ì— ì ‘ê·¼í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì˜ ë§ˆìŠ¤í„° ë…¸ë“œê°€ ì•„ë‹Œ <strong>ë¡œì»¬ ì»´í“¨í„°(ì™¸ë¶€ í˜¸ìŠ¤íŠ¸)</strong> ì—ì„œ íë¸Œì»¨íŠ¸ë¡¤ì„ ì‚¬ìš©í•˜ì—¬ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ì„œ <a target="_blank" rel="noopener" href="https://kubernetes.io/ko/docs/concepts/configuration/organize-cluster-access-kubeconfig">í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„± íŒŒì¼ì„ ì •ì˜</a>í•˜ê³  <a target="_blank" rel="noopener" href="https://kubernetes.io/ko/docs/tasks/administer-cluster/kubeadm/kubeadm-certs">ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì‚¬ìš©ì¤‘ì¸ ì¸ì¦ì„œë¥¼ ê°±ì‹ </a>í•˜ëŠ” ì‘ì—…ì„ ìˆ˜í–‰í•´ì•¼í•©ë‹ˆë‹¤.</p><h3 id="ì™¸ë¶€-í˜¸ìŠ¤íŠ¸ë¥¼-ìœ„í•œ-í´ëŸ¬ìŠ¤í„°-ì ‘ê·¼-êµ¬ì„±-íŒŒì¼-ì •ì˜"><a href="#ì™¸ë¶€-í˜¸ìŠ¤íŠ¸ë¥¼-ìœ„í•œ-í´ëŸ¬ìŠ¤í„°-ì ‘ê·¼-êµ¬ì„±-íŒŒì¼-ì •ì˜" class="headerlink" title="ì™¸ë¶€ í˜¸ìŠ¤íŠ¸ë¥¼ ìœ„í•œ í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„± íŒŒì¼ ì •ì˜"></a>ì™¸ë¶€ í˜¸ìŠ¤íŠ¸ë¥¼ ìœ„í•œ í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„± íŒŒì¼ ì •ì˜</h3><p>ë¨¼ì €, ë§ˆìŠ¤í„° ë…¸ë“œì—ì„œ ì‚¬ìš©ì¤‘ì¸ í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„±íŒŒì¼ì„ ì™¸ë¶€ í˜¸ìŠ¤íŠ¸ì¸ ë¡œì»¬ ì»´í“¨í„°ì— ë³µì‚¬í•˜ì—¬ ë¡œì»¬ ì»´í“¨í„°ì— ì„¤ì¹˜ëœ íë¸Œì»¨íŠ¸ë¡¤ë¡œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p><blockquote><p>ë§ˆìŠ¤í„° ë…¸ë“œì¸ í˜¸ìŠ¤íŠ¸ì˜ ì™¸ë¶€ ì•„ì´í”¼ëŠ” 54.180.137.161 ì…ë‹ˆë‹¤.</p></blockquote><pre class="language-ps" data-language="ps"><div class="caption"><span>ì™¸ë¶€ í˜¸ìŠ¤íŠ¸ì—ì„œ í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„±íŒŒì¼ ë³µì‚¬</span></div><code class="language-ps">mkdir .kube
scp -i .\keypair\mambo.pem ubuntu@54.180.137.161:.kube&#x2F;config .kube&#x2F;config</code></pre><p>ë¡œì»¬ ì»´í“¨í„°ì—ì„œ íë¸Œì»¨íŠ¸ë¡¤ì´ ì°¸ì¡°í•˜ëŠ” í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„±ì •ë³´ë¥¼ ì¡°íšŒí•´ë³´ë©´ ë§ˆìŠ¤í„° ë…¸ë“œì—ì„œ ì‚¬ìš©í•˜ë˜ í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„± íŒŒì¼ì´ê¸° ë•Œë¬¸ì— í´ëŸ¬ìŠ¤í„°ì˜ ì£¼ì†Œê°€ ë§ˆìŠ¤í„° ë…¸ë“œì˜ ë‚´ë¶€ ì•„ì´í”¼ì¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p><img data-src="/images/posts/setup-kubernetes-cluster/control-kubernetes-cluster-03.png" alt="í´ëŸ¬ìŠ¤í„° ì£¼ì†Œê°€ ë§ˆìŠ¤í„° ë…¸ë“œì˜ ë‚´ë¶€ ì•„ì´í”¼"></p><p>í´ëŸ¬ìŠ¤í„° ì£¼ì†Œë¥¼ ì™¸ë¶€ ì•„ì´í”¼ë¡œ ë³€ê²½í•˜ê¸° ìœ„í•´ì„œ ë‹¤ìŒì˜ ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p><pre class="language-ps" data-language="ps"><div class="caption"><span>í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„± íŒŒì¼ì˜ í´ëŸ¬ìŠ¤í„° ì£¼ì†Œ ë³€ê²½</span></div><code class="language-ps">kubectl config --kubeconfig&#x3D;config set-cluster kubernetes --server&#x3D;https:&#x2F;&#x2F;54.180.137.161:6443 </code></pre><p>ë‹¤ì‹œ íë¸Œì»¨íŠ¸ë¡¤ì´ ì°¸ì¡°í•˜ëŠ” í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„± ì •ë³´ë¥¼ ì¡°íšŒí•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ í´ëŸ¬ìŠ¤í„° ì£¼ì†Œê°€ ì™¸ë¶€ ì•„ì´í”¼ë¡œ ë³€ê²½ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p><img data-src="/images/posts/setup-kubernetes-cluster/control-kubernetes-cluster-04.png" alt="ì™¸ë¶€ ì•„ì´í”¼ë¡œ ë³€ê²½ëœ í´ëŸ¬ìŠ¤í„° ì£¼ì†Œ"></p><p>ì´ì œ ë¡œì»¬ ì»´í“¨í„°ì—ì„œ íë¸Œì»¨íŠ¸ë¡¤ì´ í´ëŸ¬ìŠ¤í„°ì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ ì ‘ê·¼ êµ¬ì„± íŒŒì¼ì„ ì •ì˜í–ˆìŠµë‹ˆë‹¤. (ìˆ˜ì •ì´ì§€ë§Œâ€¦?) íë¸Œì»¨íŠ¸ë¡¤ë¡œ í´ëŸ¬ìŠ¤í„°ì˜ ëª¨ë“  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ëŒ€í•œ íŒŒë“œë¥¼ ì¡°íšŒí•´ë´…ë‹ˆë‹¤.</p><pre class="language-ps" data-language="ps"><div class="caption"><span>ì™¸ë¶€ í˜¸ìŠ¤íŠ¸ì—ì„œ í´ëŸ¬ìŠ¤í„°ì˜ ëª¨ë“  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ëŒ€í•œ íŒŒë“œ ì¡°íšŒ</span></div><code class="language-ps">kubectl get po -A
...
Unable to connect to the server: x509: certificate is valid for 10.96.0.1, 172.31.6.192, not 54.180.137.16</code></pre><p>ìœ„ì™€ ê°™ì´ X509 ì¸ì¦ì„œ ê´€ë ¨ ì˜¤ë¥˜ê°€ ë°œìƒí•œ ì´ìœ ëŠ” ìš°ë¦¬ê°€ ì…ë ¥í•œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì£¼ì†Œì¸ 54.180.137.161ì´ ì ‘ê·¼ êµ¬ì„± íŒŒì¼ì— ìˆëŠ” ì¸ì¦ì„œ ì •ë³´ì— í¬í•¨ë˜ì–´ìˆì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì‹œì‘ ì‹œ ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ ë…¸ë“œë¥¼ ì´ˆê¸°í™”í•  ë•Œ API ì„œë²„ì—ì„œ ì‚¬ìš©í•  ì¸ì¦ì„œë¥¼ ìƒì„±í•˜ëŠ” ê³¼ì •ì—ì„œ ë‚´ë¶€ ì•„ì´í”¼ë§Œì„ ì¸ì¦ì„œì— í¬í•¨ì‹œí‚¤ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p><p>ë§ˆìŠ¤í„° ë…¸ë“œë¡œ ëŒì•„ê°€ì„œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì‹œì‘ ì‹œ ì¸ì¦ì„œì— ì™¸ë¶€ì•„ì´í”¼ë¥¼ í¬í•¨ì‹œí‚¤ê¸° ìœ„í•´ì„œ í˜ë“¤ê²Œ êµ¬ì„±í•˜ì˜€ë˜ í´ëŸ¬ìŠ¤í„°ë¥¼ ì´ˆê¸°í™”ì‹œí‚¤ê² ìŠµë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì´ˆê¸°í™”</span></div><code class="language-sh">sudo kubeadm reset
rm $HOME&#x2F;.kube&#x2F;config</code></pre><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì‹œì‘ ì‹œ ì™¸ë¶€ ì•„ì´í”¼ë¥¼ API ì„œë²„ì— ëŒ€í•œ ì¸ì¦ì„œì— í¬í•¨í•˜ë„ë¡ <strong>--apiserver-cert-extra-sans</strong> íŒŒë¼ë¯¸í„° ì˜µì…˜ì„ ì¶”ê°€í•©ë‹ˆë‹¤.</p><p><img data-src="/images/posts/setup-kubernetes-cluster/control-kubernetes-cluster-05.png"></p><p>ìœ„ì™€ ê°™ì´ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì‹œì‘ ì‹œ ì¶œë ¥ë˜ëŠ” ì •ë³´ë¥¼ í†µí•´ ìš°ë¦¬ê°€ íŒŒë¼ë¯¸í„°ë¡œ ì…ë ¥í•œ <strong>ì™¸ë¶€ ì•„ì´í”¼(54.180.137.161)ê°€ ì¸ì¦ì„œì— í¬í•¨ë¨</strong> ì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‹œì‘í•˜ì—¬ ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ ë…¸ë“œê°€ ì´ˆê¸°í™”ë˜ì—ˆìœ¼ë©´ kubeconfig íŒŒì¼ì„ ë¡œì»¬ ì»´í“¨í„°ë¡œ ë³µì‚¬í•˜ê³  íë¸Œì»¨íŠ¸ë¡¤ìœ¼ë¡œ íŒŒë“œ ì¡°íšŒë¥¼ ì‹œë„í•´ë´…ë‹ˆë‹¤.</p><p><img data-src="/images/posts/setup-kubernetes-cluster/control-kubernetes-cluster-06.png"></p><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì¸ì¦ì„œì— í¬í•¨ëœ ì™¸ë¶€ ì•„ì´í”¼ë¥¼ í™•ì¸í•˜ì—¬ í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ì„ í—ˆìš©í•˜ì—¬ ëª¨ë“  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ëŒ€í•œ íŒŒë“œê°€ ì¡°íšŒë˜ì—ˆìŠµë‹ˆë‹¤.</p><h3 id="ì™¸ë¶€-í˜¸ìŠ¤íŠ¸ë¥¼-ìœ„í•œ-ì‚¬ìš©ì-ë°-ì¸ì¦ì„œ-ë°œí–‰"><a href="#ì™¸ë¶€-í˜¸ìŠ¤íŠ¸ë¥¼-ìœ„í•œ-ì‚¬ìš©ì-ë°-ì¸ì¦ì„œ-ë°œí–‰" class="headerlink" title="ì™¸ë¶€ í˜¸ìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì‚¬ìš©ì ë° ì¸ì¦ì„œ ë°œí–‰"></a>ì™¸ë¶€ í˜¸ìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì‚¬ìš©ì ë° ì¸ì¦ì„œ ë°œí–‰</h3><p>ì•ì„œ í™•ì¸í•œ ë‚´ìš©ì€ í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„±íŒŒì¼ì„ í†µí•´ ì™¸ë¶€ í˜¸ìŠ¤íŠ¸ì—ì„œ í´ëŸ¬ìŠ¤í„°ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ°ë° ìš°ë¦¬ê°€ ë§ˆìŠ¤í„° ë…¸ë“œì—ì„œ ì‚¬ìš©í•˜ë˜ í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„±íŒŒì¼ì—ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì œì–´í•˜ê¸° ìœ„í•œ kubernetes-admin ì‚¬ìš©ìì˜ ì¸ì¦ì •ë³´ê°€ í¬í•¨ë˜ì–´ìˆìŠµë‹ˆë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ê´€ë¦¬ ë‹´ë‹¹ìëŠ” í´ëŸ¬ìŠ¤í„°ì— ëŒ€í•œ ëª¨ë“  ê¶Œí•œì„ ê°€ì§€ëŠ” ì ‘ê·¼ êµ¬ì„±íŒŒì¼ì„ ë‚´ë³´ë‚´ì§€ì•Šê³  í´ëŸ¬ìŠ¤í„°ì— ì ‘ê·¼í•  ìˆ˜ ìˆìœ¼ë©° íŠ¹ì • ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê¶Œí•œì´ ë¶€ì—¬ëœ ì‚¬ìš©ìë¥¼ ë§Œë“¤ê³  ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì˜ ë£¨íŠ¸ CA ì¸ì¦ì„œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‚¬ìš©ìì˜ ì¸ì¦ì„œë¥¼ ë°œí–‰í•˜ì—¬ í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„± íŒŒì¼ì„ ì •ì˜í•  ìˆ˜ ìˆê²Œ ì§€ì›í•˜ëŠ” ê²Œ ì¢‹ìŠµë‹ˆë‹¤.</p><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ëŠ” ì‚¬ìš©ìë¼ëŠ” ì˜¤ë¸Œì íŠ¸ëŠ” ì—†ì§€ë§Œ ì¸ì¦ì„œì— í¬í•¨ë˜ëŠ” ì£¼ì²´ë¥¼ í†µí•´ ê·¸ë£¹ê³¼ ì‚¬ìš©ì ê°œë…ì„ ì‚¬ìš©í•´ì„œ ì¸ì¦ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ë”°ë¼ì„œ, ìš°ë¦¬ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì˜ ë£¨íŠ¸ CA ì¸ì¦ì„œë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ìœ„ ì¸ì¦ì„œ ë°œí–‰í•˜ê³  í•˜ìœ„ ì¸ì¦ì„œì— í¬í•¨ëœ ì£¼ì²´ì— ëŒ€í•œ RBAC ê¸°ë°˜ì˜ Roleì„ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ìƒì„±í•´ì•¼í•©ë‹ˆë‹¤.</p><p>ë¨¼ì €, ë£¨íŠ¸ CA ì¸ì¦ì„œë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ìœ„ ì¸ì¦ì„œë¥¼ ë°œí–‰í•˜ê¸° ìœ„í•˜ì—¬ í´ë¼ìš°ë“œí”Œë ˆì–´ì—ì„œ ë§Œë“  cfssl ì„¤ì¹˜í•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>ë§ˆìŠ¤í„° ë…¸ë“œì— cfssl íŒ¨í‚¤ì§€ ì„¤ì¹˜</span></div><code class="language-sh">curl -L https:&#x2F;&#x2F;github.com&#x2F;cloudflare&#x2F;cfssl&#x2F;releases&#x2F;download&#x2F;v1.5.0&#x2F;cfssl_1.5.0_linux_amd64 -o cfssl
curl -L https:&#x2F;&#x2F;github.com&#x2F;cloudflare&#x2F;cfssl&#x2F;releases&#x2F;download&#x2F;v1.5.0&#x2F;cfssljson_1.5.0_linux_amd64 -o cfssljson
curl -L https:&#x2F;&#x2F;github.com&#x2F;cloudflare&#x2F;cfssl&#x2F;releases&#x2F;download&#x2F;v1.5.0&#x2F;cfssl-certinfo_1.5.0_linux_amd64 -o cfssl-certinfo

chmod +x cfssl* 
sudo mv cfssl* &#x2F;usr&#x2F;bin&#x2F;</code></pre><p>cfsslì´ ì„¤ì¹˜ë˜ì—ˆìœ¼ë©´ ì‚¬ìš©ì ì¸ì¦ì„œê°€ ë°œí–‰ë  í´ë”ë¥¼ ë§Œë“¤ê³ ë‚˜ì„œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ê°€ ì‚¬ìš©ì¤‘ì¸ ë£¨íŠ¸ CA ì¸ì¦ì„œ íŒŒì¼ì„ ë³µì‚¬í•©ë‹ˆë‹¤. ë£¨íŠ¸ CA ì¸ì¦ì„œ íŒŒì¼ì€ ì¼ë°˜ì ìœ¼ë¡œ <strong>&#x2F;etc&#x2F;kubernetes&#x2F;pki</strong> í´ë”ì— ìˆìŠµë‹ˆë‹¤.</p><p>ì¸ì¦ì„œ ë°œí–‰ì„ ìœ„í•´ ë‹¤ìŒì˜ ëª…ë ¹ì–´ë¥¼ ì°¨ë¡€ëŒ€ë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>ì¸ì¦ì„œ ë°œí–‰ í´ë” ì´ë™ ë° ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë£¨íŠ¸ CA ì¸ì¦ì„œ ë³µì‚¬</span></div><code class="language-sh">mkdir cert &amp;&amp; cd cert
sudo cp &#x2F;etc&#x2F;kubernetes&#x2F;pki&#x2F;ca* .&#x2F;</code></pre><pre class="language-sh" data-language="sh"><div class="caption"><span>í•˜ìœ„ ì¸ì¦ì„œ ë°œí–‰ ì •ë³´ ë° ì„œëª… ìš”ì²­ ì •ì˜</span></div><code class="language-sh">cat &lt;&lt;EOF | tee mambo-config.json
&#123;
  &quot;signing&quot;: &#123;
    &quot;default&quot;: &#123;
      &quot;expiry&quot;: &quot;8760h&quot;
    &#125;,
    &quot;profiles&quot;: &#123;
      &quot;mambo&quot;: &#123;
        &quot;usages&quot;: [
          &quot;signing&quot;,
          &quot;key encipherment&quot;,
          &quot;server auth&quot;,
          &quot;client auth&quot;
        ],
        &quot;expiry&quot;: &quot;8760h&quot;
      &#125;
    &#125;
  &#125;
&#125;
EOF

cat &lt;&lt;EOF | tee mambo-csr.json
&#123;
  &quot;CN&quot;: &quot;mambo&quot;,
  &quot;key&quot;: &#123;
    &quot;algo&quot;: &quot;rsa&quot;,
    &quot;size&quot;: 2048
  &#125;,
  &quot;names&quot;:[
    &#123;
      &quot;O&quot;: &quot;system:masters&quot;
    &#125;
  ]
&#125;
EOF</code></pre><pre class="language-sh" data-language="sh"><div class="caption"><span>ì‚¬ìš©ì ì¸ì¦ì„œ ë°œí–‰</span></div><code class="language-sh">sudo cfssl gencert -ca&#x3D;ca.crt -ca-key&#x3D;ca.key -config&#x3D;mambo-config.json -profile&#x3D;mambo mambo-csr.json | cfssljson -bare mambo

ll
-rw-r--r-- 1 mambo mambo 1066 Jul 28 15:04 ca.crt
-rw------- 1 root  root  1679 Jul 28 15:04 ca.key
-rw-rw-r-- 1 mambo mambo  277 Jul 28 15:02 mambo-config.json
-rw-r--r-- 1 mambo mambo  920 Jul 28 15:08 mambo.csr
-rw-rw-r-- 1 mambo mambo  129 Jul 28 15:02 mambo-csr.json
-rw------- 1 mambo mambo 1675 Jul 28 15:08 mambo-key.pem
-rw-rw-r-- 1 mambo mambo 1204 Jul 28 15:08 mambo.pem</code></pre><p>ì´ë ‡ê²Œ ë§Œë“¤ì–´ì§„ ì¸ì¦ì„œë¥¼ ê¸°ë°˜ìœ¼ë¡œ íë¸Œì»¨íŠ¸ë¡¤ì„ ì‚¬ìš©í•˜ì—¬ í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„± íŒŒì¼(kubeconfig)ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>ì‚¬ìš©ì í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„± íŒŒì¼ ì •ì˜</span></div><code class="language-sh">kubectl config --kubeconfig&#x3D;mambo-config set-cluster kubernetes --server&#x3D;https:&#x2F;&#x2F;54.180.137.161:6443 --certificate-authority&#x3D;ca.crt
kubectl config --kubeconfig&#x3D;mambo-config set-credentials mambo --client-certificate&#x3D;mambo.pem --client-key&#x3D;mambo-key.pem
kubectl config --kubeconfig&#x3D;mambo-config set-context kubernetes-master --cluster&#x3D;kubernetes --user&#x3D;mambo
kubectl config --kubeconfig&#x3D;mambo-config use-context kubernetes-master</code></pre><p>ë§Œë“¤ì–´ì§„ í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„± ì •ë³´ë¥¼ ì¡°íšŒí•˜ê³  íŒŒë“œë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ êµ¬ì„± ì •ë³´ ì¡°íšŒ</span></div><code class="language-sh">kubectl config view --kubeconfig&#x3D;mambo-config
apiVersion: v1
clusters:
- cluster:
    certificate-authority: ca.crt
    server: https:&#x2F;&#x2F;54.180.137.161:6443
  name: kubernetes
contexts:
- context:
    cluster: kubernetes
    user: mambo
  name: kubernetes-master
current-context: kubernetes-master
kind: Config
preferences: &#123;&#125;
users:
- name: mambo
  user:
    client-certificate: mambo.pem
    client-key: mambo-key.pem</code></pre><p>ìš°ë¦¬ëŠ” mambo ì‚¬ìš©ìì— ëŒ€í•œ Roleì„ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ìƒì„±í•˜ì§€ ì•Šì•˜ì§€ë§Œ íŒŒë“œê°€ ì¡°íšŒê°€ ê°€ëŠ¥í•œ ì´ìœ ëŠ” ì¸ì¦ì„œ ë°œí–‰ ì‹œ <strong>system:masters</strong> ë¼ê³  ì§€ì •í•˜ì˜€ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ëŠ” ë¯¸ë¦¬ ì •ì˜ëœ <a target="_blank" rel="noopener" href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/#user-facing-roles">Role</a>ì´ ì¡´ì¬í•˜ëŠ”ë° ê·¸ ì¤‘ì—ì„œ <code>system:masters</code>ëŠ” ëª¨ë“  ê¶Œí•œì„ ê°€ì§€ëŠ” ì‚¬ìš©ì ê·¸ë£¹(cluster-admin)ì„ ê°€ë¦¬í‚¤ê²Œë˜ì–´ mamboë¼ëŠ” ì‚¬ìš©ìëŠ” ëª¨ë“  ê¶Œí•œì„ ë³´ìœ í•œ ê²ƒìœ¼ë¡œ ì²˜ë¦¬ëœ ê²ƒì…ë‹ˆë‹¤.</p><blockquote><p>ê²°êµ­ mambo ë¼ëŠ” ì‚¬ìš©ìëŠ” ëª¨ë“  ê¶Œí•œì„ ê°€ì§€ëŠ” ì‚¬ìš©ì kubernetes-adminê³¼ ê°™ìŠµë‹ˆë‹¤.</p></blockquote><p>ìš°ë¦¬ëŠ” ëª¨ë“  ê¶Œí•œì„ ê°€ì§€ëŠ” ì‚¬ìš©ìê°€ ì•„ë‹ˆë¼ íŠ¹ì • ê¶Œí•œì„ ê°€ì§€ëŠ” ì‚¬ìš©ìë¥¼ ë§Œë“¤ê³  ì¸ì¦í•´ì•¼í•˜ë¯€ë¡œ ê¸°ì¡´ì— ë§Œë“¤ì—ˆë˜ ì¸ì¦ì„œë¥¼ ì‚­ì œí•˜ê³  íŠ¹ì • ê¶Œí•œì„ ê°€ì§€ëŠ” ì¸ì¦ì„œë¥¼ ë‹¤ì‹œ ë°œí–‰í•´ì•¼í•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>ì¸ì¦ì„œ ì„œëª… ìš”ì²­ íŒŒì¼ ìˆ˜ì • ë° ì¸ì¦ì„œ ì¬ë°œí–‰</span></div><code class="language-sh">cat &lt;&lt;EOF | tee mambo-csr.json
&#123;
  &quot;CN&quot;: &quot;mambo&quot;,
  &quot;key&quot;: &#123;
    &quot;algo&quot;: &quot;rsa&quot;,
    &quot;size&quot;: 2048
  &#125;,
  &quot;names&quot;:[
    &#123;
      &quot;O&quot;: &quot;admin:mambo&quot;
    &#125;
  ]
&#125;
EOF

sudo cfssl gencert -ca&#x3D;ca.crt -ca-key&#x3D;ca.key -config&#x3D;mambo-config.json -profile&#x3D;mambo mambo-csr.json | cfssljson -bare mambo</code></pre><p>ì´ì œ ë‹¤ì‹œ íë¸Œì»¨íŠ¸ë¡¤ì„ ì‚¬ìš©í•˜ì—¬ í´ëŸ¬ìŠ¤í„°ì˜ íŒŒë“œë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>í´ëŸ¬ìŠ¤í„° íŒŒë“œ ì¡°íšŒ</span></div><code class="language-sh">kubectl get po -n kube-system --kubeconfig&#x3D;config
Error from server (Forbidden): pods is forbidden: User &quot;mambo&quot; cannot list resource &quot;pods&quot; in API group &quot;&quot; in the namespace &quot;kube-system&quot;</code></pre><p><strong>system:masters</strong>ì„ ì§€ì •í–ˆë˜ê²ƒê³¼ ë‹¤ë¥´ê²Œ mambo ì‚¬ìš©ìëŠ” kube-system ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ëŒ€í•œ íŒŒë“œ ì¡°íšŒë¥¼ ìˆ˜í–‰í•  ìˆ˜ ì—†ê²Œë˜ì—ˆìŠµë‹ˆë‹¤. ì´ê²ƒì€ ìš°ë¦¬ê°€ ì•„ì§ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— mambo ì‚¬ìš©ìì— ëŒ€í•œ Roleì„ ìƒì„±í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì´ì œ ë‹¤ìŒê³¼ ê°™ì´ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— Mambo ì‚¬ìš©ìê°€ íŒŒë“œ ì¡°íšŒë¥¼ ìœ„í•œ ê¶Œí•œì„ ê°€ì§€ë„ë¡ Roleì„ ìƒì„±í•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>ì‚¬ìš©ì Role ë° Rolebinding ìƒì„±</span></div><code class="language-sh">cat &lt;&lt;EOF | tee mambo-rbac.yaml
apiVersion: rbac.authorization.k8s.io&#x2F;v1
kind: Role
metadata:
  namespace: kube-system
  name: mambo-rbac-role
rules:
- apiGroups: [&quot;&quot;]
  resources: [&quot;pods&quot;]
  verbs: [&quot;get&quot;, &quot;watch&quot;, &quot;list&quot;]
---
apiVersion: rbac.authorization.k8s.io&#x2F;v1
kind: RoleBinding
metadata:
  namespace: kube-system
  name: mambo-rbac-rolebinding
subjects:
- kind: User
  name: mambo
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: mambo-rbac-role
  apiGroup: rbac.authorization.k8s.io
EOF

kubectl create -f mambo-rbac.yaml
role.rbac.authorization.k8s.io&#x2F;mambo-rbac-role created
rolebinding.rbac.authorization.k8s.io&#x2F;mambo-rbac-rolebinding created</code></pre><pre class="language-sh" data-language="sh"><div class="caption"><span>í´ëŸ¬ìŠ¤í„° íŒŒë“œ ì¡°íšŒ</span></div><code class="language-sh">kubectl get po -n kube-system --kubeconfig&#x3D;mambo-config
...
NAME                                      READY   STATUS    RESTARTS   AGE
coredns-558bd4d5db-kvfhl                  1&#x2F;1     Running   0          4h33m
coredns-558bd4d5db-z7kf7                  1&#x2F;1     Running   0          4h33m
etcd-ip-172-31-6-192                      1&#x2F;1     Running   0          3h54m
kube-apiserver-ip-172-31-6-192            1&#x2F;1     Running   0          3h54m
kube-controller-manager-ip-172-31-6-192   1&#x2F;1     Running   0          3h54m
kube-flannel-ds-dh2xp                     1&#x2F;1     Running   0          4h23m
kube-proxy-tbm76                          1&#x2F;1     Running   0          4h33m
kube-scheduler-ip-172-31-6-192            1&#x2F;1     Running   0          3h54m</code></pre><p>ì‹ ê·œ ì‚¬ìš©ìì— ëŒ€í•œ ì¸ì¦ì„œë¥¼ ë°œí–‰í•˜ê³  Roleì„ ë§Œë“¤ì–´ ì‚¬ìš©ìì—ê²Œ ë°”ì¸ë”©í•¨ìœ¼ë¡œì¨ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ë™ì‘ì¤‘ì¸ íŒŒë“œë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.</p><h2 id="ì¿ ë²„ë„¤í‹°ìŠ¤-í´ëŸ¬ìŠ¤í„°-ê´€ë¦¬í•˜ê¸°"><a href="#ì¿ ë²„ë„¤í‹°ìŠ¤-í´ëŸ¬ìŠ¤í„°-ê´€ë¦¬í•˜ê¸°" class="headerlink" title="ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ê´€ë¦¬í•˜ê¸°"></a>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ê´€ë¦¬í•˜ê¸°</h2><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì‹œì‘ ì‹œ ë°œí–‰ë˜ëŠ” ì¸ì¦ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 1ë…„ë™ì•ˆ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë§Œë£Œì¼ìê°€ ì„¤ì •ë©ë‹ˆë‹¤. ë”°ë¼ì„œ, ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ê°€ ì‹œì‘ëœ ì§€ 1ë…„ì´ ì§€ë‚˜ê²Œë˜ë©´ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë™ì‘ì´ ì •ìƒì ì´ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ìš°ë¦¬ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì‚¬ìš©ì¤‘ì¸ ì¸ì¦ì„œê°€ ë§Œë£Œë˜ê¸°ì „ì— ì¸ì¦ì„œë¥¼ ê°±ì‹ í•  ìˆ˜ ìˆì–´ì•¼í•©ë‹ˆë‹¤.</p><h3 id="í´ëŸ¬ìŠ¤í„°-ì¸ì¦ì„œ-ê°±ì‹ í•˜ê¸°"><a href="#í´ëŸ¬ìŠ¤í„°-ì¸ì¦ì„œ-ê°±ì‹ í•˜ê¸°" class="headerlink" title="í´ëŸ¬ìŠ¤í„° ì¸ì¦ì„œ ê°±ì‹ í•˜ê¸°"></a>í´ëŸ¬ìŠ¤í„° ì¸ì¦ì„œ ê°±ì‹ í•˜ê¸°</h3><p>ì•ì„œ ìš°ë¦¬ëŠ” í´ëŸ¬ìŠ¤í„° ì™¸ë¶€ í˜¸ìŠ¤íŠ¸ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì‹œì‘ ì‹œ ì™¸ë¶€ ì•„ì´í”¼ë¥¼ íŒŒë¼ë¯¸í„° ì˜µì…˜ìœ¼ë¡œ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ, ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ìš´ì˜í•˜ê³  ìˆëŠ” ë„ì¤‘ì—ëŠ” í´ëŸ¬ìŠ¤í„°ë¥¼ ì´ˆê¸°í™”í•˜ê³  ë‹¤ì‹œ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì‚¬ìš©ì¤‘ì¸ ì¸ì¦ì„œë¥¼ ë‹¤ì‹œ ë°œí–‰í•˜ê¸° ìœ„í•´ì„œëŠ” <a target="_blank" rel="noopener" href="https://kubernetes.io/docs/reference/setup-tools/kubeadm/kubeadm-init-phase/#cmd-phase-certs">kubeadm init phase certs</a> ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•´ì•¼í•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>Terminal</span></div><code class="language-sh">cd &#x2F;etc&#x2F;kubernetes&#x2F;pki
# ê¸°ì¡´ ì¸ì¦ì„œ ì‚­ì œ ë˜ëŠ” ë°±ì—…
sudo cp apiserver.crt apiserver.crt.old
sudo cp apiserver.key apiserver.key.old
sudo rm apiserver.crt apiserver.key

sudo kubeadm init phase certs apiserver --apiserver-advertise-address&#x3D;172.31.6.192 --apiserver-cert-extra-sans&#x3D;54.180.137.161
[certs] Generating &quot;apiserver&quot; certificate and key
[certs] apiserver serving cert is signed for DNS names [ip-172-31-6-192 kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local] and IPs [10.96.0.1 172.31.6.192 54.180.137.161]

sudo cp -i &#x2F;etc&#x2F;kubernetes&#x2F;admin.conf $HOME&#x2F;.kube&#x2F;config</code></pre><p>ì¿ ë²„ë„¤í‹°ìŠ¤ ì‹œì‘ ì‹œ ìˆ˜í–‰í•˜ëŠ” ê³¼ì • ì¤‘ ì¼ë¶€ë¥¼ ìˆ˜í–‰í•˜ì—¬ API ì„œë²„ì— ëŒ€í•œ ì¸ì¦ì„œë¥¼ ë°œí–‰í•˜ë©´ì„œ ì™¸ë¶€ ì•„ì´í”¼ê°€ í¬í•¨ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p><img data-src="/images/posts/setup-kubernetes-cluster/control-kubernetes-cluster-07.png"></p><p>ìœ„ì™€ ê°™ì´ ì™¸ë¶€ í˜¸ìŠ¤íŠ¸ì¸ ë¡œì»¬ ì»´í“¨í„°ì—ì„œë„ í´ëŸ¬ìŠ¤í„°ì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.</p><h3 id="í´ëŸ¬ìŠ¤í„°-ì¸ì¦ì„œ-ë§Œë£Œì¼ì-ì¡°íšŒí•˜ê¸°"><a href="#í´ëŸ¬ìŠ¤í„°-ì¸ì¦ì„œ-ë§Œë£Œì¼ì-ì¡°íšŒí•˜ê¸°" class="headerlink" title="í´ëŸ¬ìŠ¤í„° ì¸ì¦ì„œ ë§Œë£Œì¼ì ì¡°íšŒí•˜ê¸°"></a>í´ëŸ¬ìŠ¤í„° ì¸ì¦ì„œ ë§Œë£Œì¼ì ì¡°íšŒí•˜ê¸°</h3><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì‚¬ìš©ì¤‘ì¸ ì¸ì¦ì„œë¥¼ ë°œí–‰í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì•Œì•˜ì§€ë§Œ ì¸ì¦ì„œê°€ ì–¸ì œ ë§Œë£Œë˜ëŠ”ì§€ë„ ì•Œì•„ì•¼í•©ë‹ˆë‹¤. <strong>kubeadm certs check-expiration</strong> ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ë©´ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì‚¬ìš©ì¤‘ì¸ ì¸ì¦ì„œì˜ ë§Œë£Œì¼ìë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>í´ëŸ¬ìŠ¤í„° ì¸ì¦ì„œ ë§Œë£Œì¼ì ì¡°íšŒ</span></div><code class="language-sh">sudo kubeadm certs check-expiration
[check-expiration] Reading configuration from the cluster...
[check-expiration] FYI: You can look at this config file with &#39;kubectl -n kube-system get cm kubeadm-config -o yaml&#39;

CERTIFICATE                EXPIRES                  RESIDUAL TIME   CERTIFICATE AUTHORITY   EXTERNALLY MANAGED
admin.conf                 Jul 28, 2022 11:17 UTC   364d                                    no
apiserver                  Jul 28, 2022 11:17 UTC   364d            ca                      no
apiserver-etcd-client      Jul 28, 2022 11:17 UTC   364d            etcd-ca                 no
apiserver-kubelet-client   Jul 28, 2022 11:17 UTC   364d            ca                      no
controller-manager.conf    Jul 28, 2022 11:17 UTC   364d                                    no
etcd-healthcheck-client    Jul 28, 2022 11:17 UTC   364d            etcd-ca                 no
etcd-peer                  Jul 28, 2022 11:17 UTC   364d            etcd-ca                 no
etcd-server                Jul 28, 2022 11:17 UTC   364d            etcd-ca                 no
front-proxy-client         Jul 28, 2022 11:17 UTC   364d            front-proxy-ca          no
scheduler.conf             Jul 28, 2022 11:17 UTC   364d                                    no

CERTIFICATE AUTHORITY   EXPIRES                  RESIDUAL TIME   EXTERNALLY MANAGED
ca                      Jul 26, 2031 11:17 UTC   9y              no
etcd-ca                 Jul 26, 2031 11:17 UTC   9y              no
front-proxy-ca          Jul 26, 2031 11:17 UTC   9y              no</code></pre><h3 id="í´ëŸ¬ìŠ¤í„°-ì¸ì¦ì„œ-ìˆ˜ë™-ê°±ì‹ "><a href="#í´ëŸ¬ìŠ¤í„°-ì¸ì¦ì„œ-ìˆ˜ë™-ê°±ì‹ " class="headerlink" title="í´ëŸ¬ìŠ¤í„° ì¸ì¦ì„œ ìˆ˜ë™ ê°±ì‹ "></a>í´ëŸ¬ìŠ¤í„° ì¸ì¦ì„œ ìˆ˜ë™ ê°±ì‹ </h3><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì‚¬ìš©ì¤‘ì¸ ì¸ì¦ì„œë¥¼ ê°±ì‹ í•˜ëŠ” ë°©ë²•ì—ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë²„ì „ì„ ì—…ê·¸ë ˆì´ë“œí•˜ì—¬ ìë™ìœ¼ë¡œ ê°±ì‹ ë˜ê²Œí•˜ê±°ë‚˜ ì‚¬ìš©ì¤‘ì¸ ì¸ì¦ì„œë¥¼ ìˆ˜ë™ìœ¼ë¡œ ê°±ì‹ í•˜ëŠ” ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•´ì•¼í•©ë‹ˆë‹¤. <strong>kubeadm certs renew all</strong> ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë©´ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì‚¬ìš©ì¤‘ì¸ ì¸ì¦ì„œë¥¼ ìˆ˜ë™ìœ¼ë¡œ ê°±ì‹ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>Terminal</span></div><code class="language-sh">sudo kubeadm certs renew all
[renew] Reading configuration from the cluster...
[renew] FYI: You can look at this config file with &#39;kubectl -n kube-system get cm kubeadm-config -o yaml&#39;

certificate embedded in the kubeconfig file for the admin to use and for kubeadm itself renewed
certificate for serving the Kubernetes API renewed
certificate the apiserver uses to access etcd renewed
certificate for the API server to connect to kubelet renewed
certificate embedded in the kubeconfig file for the controller manager to use renewed
certificate for liveness probes to healthcheck etcd renewed
certificate for etcd nodes to communicate with each other renewed
certificate for serving etcd renewed
certificate for the front proxy client renewed
certificate embedded in the kubeconfig file for the scheduler manager to use renewed

Done renewing certificates. You must restart the kube-apiserver, kube-controller-manager, kube-scheduler and etcd, so that they can use the new certificates.</code></pre><p>ë§ˆì§€ë§‰ì— ì¶œë ¥ëœ ì •ë³´ì— ë”°ë¼ ê°±ì‹ ëœ ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ kube-apiserver, kube-controller-manager, kube-scheduler, etcd íŒŒë“œë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•´ì•¼í•˜ë¯€ë¡œ íë¸Œì»¨íŠ¸ë¡¤ì„ ì‚¬ìš©í•˜ì—¬ íŒŒë“œ ì‚­ì œ ëª…ë ¹ì„ ì‹¤í–‰í•˜ë©´ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ëŠ” íŒŒë“œë¥¼ ì œê±°í•œ ë’¤ ë‹¤ì‹œ ì‹¤í–‰í•˜ê²Œ ë©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>ì¸ì¦ì„œë¥¼ ê°±ì‹ í•œ íŒŒë“œë¥¼ ì‚­ì œí•˜ì—¬ ì¬ì‹¤í–‰</span></div><code class="language-sh"># ì‚­ì œí•  íŒŒë“œ ì¡°íšŒ
kubectl get po -n kube-system
NAME                                   READY   STATUS    RESTARTS   AGE
coredns-558bd4d5db-6fqm2               1&#x2F;1     Running   0          33m
coredns-558bd4d5db-kgdfs               1&#x2F;1     Running   0          33m
etcd-mambo-master                      1&#x2F;1     Running   0          33m
kube-apiserver-mambo-master            1&#x2F;1     Running   0          33m
kube-controller-manager-mambo-master   1&#x2F;1     Running   0          33m
kube-flannel-ds-g59bl                  1&#x2F;1     Running   0          23m
kube-flannel-ds-nf4xt                  1&#x2F;1     Running   0          23m
kube-flannel-ds-q5hkb                  1&#x2F;1     Running   0          32m
kube-proxy-7j5b6                       1&#x2F;1     Running   0          33m
kube-proxy-8f47j                       1&#x2F;1     Running   0          23m
kube-proxy-rflgf                       1&#x2F;1     Running   0          23m
kube-scheduler-mambo-master            1&#x2F;1     Running   0          33m

# ì¸ì¦ì„œê°€ ê°±ì‹ ëœ íŒŒë“œë¥¼ ì‚­ì œ
kubectl delete po kube-apiserver-mambo-master kube-controller-manager-mambo-master kube-scheduler-mambo-master etcd-mambo-master -n kube-system
pod &quot;kube-apiserver-mambo-master&quot; deleted
pod &quot;kube-controller-manager-mambo-master&quot; deleted
pod &quot;kube-scheduler-mambo-master&quot; deleted
pod &quot;etcd-mambo-master&quot; deleted

# ì‚­ì œí•œ íŒŒë“œê°€ ë‹¤ì‹œ ì‹¤í–‰ë˜ì—ˆëŠ”ì§€ ì¡°íšŒ
kubectl get po -n kube-system
NAME                                   READY   STATUS    RESTARTS   AGE
coredns-558bd4d5db-6fqm2               1&#x2F;1     Running   0          38m
coredns-558bd4d5db-kgdfs               1&#x2F;1     Running   0          38m
etcd-mambo-master                      1&#x2F;1     Running   0          11s
kube-apiserver-mambo-master            1&#x2F;1     Running   0          11s
kube-controller-manager-mambo-master   1&#x2F;1     Running   0          11s
kube-flannel-ds-g59bl                  1&#x2F;1     Running   0          29m
kube-flannel-ds-nf4xt                  1&#x2F;1     Running   0          29m
kube-flannel-ds-q5hkb                  1&#x2F;1     Running   0          38m
kube-proxy-7j5b6                       1&#x2F;1     Running   0          38m
kube-proxy-8f47j                       1&#x2F;1     Running   0          29m
kube-proxy-rflgf                       1&#x2F;1     Running   0          29m
kube-scheduler-mambo-master            1&#x2F;1     Running   0          11s</code></pre><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì‚¬ìš©ì¤‘ì¸ ì¸ì¦ì„œì— ëŒ€í•œ ë§Œë£Œì¼ìë¥¼ ë‹¤ì‹œ ì¡°íšŒí•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>Terminal</span></div><code class="language-sh">sudo kubeadm certs check-expiration
[check-expiration] Reading configuration from the cluster...
[check-expiration] FYI: You can look at this config file with &#39;kubectl -n kube-system get cm kubeadm-config -o yaml&#39;

CERTIFICATE                EXPIRES                  RESIDUAL TIME   CERTIFICATE AUTHORITY   EXTERNALLY MANAGED
admin.conf                 Jul 28, 2022 11:45 UTC   364d                                    no
apiserver                  Jul 28, 2022 11:45 UTC   364d            ca                      no
apiserver-etcd-client      Jul 28, 2022 11:45 UTC   364d            etcd-ca                 no
apiserver-kubelet-client   Jul 28, 2022 11:45 UTC   364d            ca                      no
controller-manager.conf    Jul 28, 2022 11:45 UTC   364d                                    no
etcd-healthcheck-client    Jul 28, 2022 11:45 UTC   364d            etcd-ca                 no
etcd-peer                  Jul 28, 2022 11:45 UTC   364d            etcd-ca                 no
etcd-server                Jul 28, 2022 11:45 UTC   364d            etcd-ca                 no
front-proxy-client         Jul 28, 2022 11:45 UTC   364d            front-proxy-ca          no
scheduler.conf             Jul 28, 2022 11:45 UTC   364d                                    no

CERTIFICATE AUTHORITY   EXPIRES                  RESIDUAL TIME   EXTERNALLY MANAGED
ca                      Jul 26, 2031 11:17 UTC   9y              no
etcd-ca                 Jul 26, 2031 11:17 UTC   9y              no
front-proxy-ca          Jul 26, 2031 11:17 UTC   9y              no</code></pre><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì˜ ë§Œë£Œì¼ìê°€ ê°±ì‹ ë˜ì—ˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><h2 id="ì¿ ë²„ë„¤í‹°ìŠ¤-ëŒ€ì‹œë³´ë“œ-ì„¤ì¹˜í•˜ê¸°"><a href="#ì¿ ë²„ë„¤í‹°ìŠ¤-ëŒ€ì‹œë³´ë“œ-ì„¤ì¹˜í•˜ê¸°" class="headerlink" title="ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ì„¤ì¹˜í•˜ê¸°"></a>ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ì„¤ì¹˜í•˜ê¸°</h2><p>ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ì• ë“œì˜¨ì€ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì›¹ UI ê¸°ë°˜ìœ¼ë¡œ ì œì–´í•˜ê³  í´ëŸ¬ìŠ¤í„°ì— ëŒ€í•œ ì •ë³´ë¥¼ ì¡°íšŒí•˜ê³  ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œë¥¼ í´ëŸ¬ìŠ¤í„°ì— ì¶”ê°€í•˜ê¸° ìœ„í•˜ì—¬ ë‹¤ìŒì˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ì• ë“œì˜¨ ì„¤ì¹˜</span></div><code class="language-sh">kubectl create -f https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;kubernetes&#x2F;dashboard&#x2F;v2.3.1&#x2F;aio&#x2F;deploy&#x2F;recommended.yaml
---
namespace&#x2F;kubernetes-dashboard created
serviceaccount&#x2F;kubernetes-dashboard created
service&#x2F;kubernetes-dashboard created
secret&#x2F;kubernetes-dashboard-certs created
secret&#x2F;kubernetes-dashboard-csrf created
secret&#x2F;kubernetes-dashboard-key-holder created
configmap&#x2F;kubernetes-dashboard-settings created
role.rbac.authorization.k8s.io&#x2F;kubernetes-dashboard created
clusterrole.rbac.authorization.k8s.io&#x2F;kubernetes-dashboard created
rolebinding.rbac.authorization.k8s.io&#x2F;kubernetes-dashboard created
clusterrolebinding.rbac.authorization.k8s.io&#x2F;kubernetes-dashboard created
deployment.apps&#x2F;kubernetes-dashboard created
service&#x2F;dashboard-metrics-scraper created
deployment.apps&#x2F;dashboard-metrics-scraper created

kubectl get deploy -n kubernetes-dashboard
---
NAME                        READY   UP-TO-DATE   AVAILABLE   AGE
dashboard-metrics-scraper   1&#x2F;1     1            1           24s
kubernetes-dashboard        1&#x2F;1     1            1           24s</code></pre><p>ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œë¥¼ ì„¤ì¹˜í–ˆì§€ë§Œ ì„œë¹„ìŠ¤ë¥¼ ì¡°íšŒí•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ <strong>ClusterIP</strong> ìœ í˜•ì¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ì„œë¹„ìŠ¤ ì¡°íšŒ</span></div><code class="language-sh">kubectl get svc -n kubernetes-dashboard
NAME                        TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)    AGE
dashboard-metrics-scraper   ClusterIP   10.108.18.117   &lt;none&gt;        8000&#x2F;TCP   74s
kubernetes-dashboard        ClusterIP   10.100.36.145   &lt;none&gt;        443&#x2F;TCP    74s</code></pre><p>ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œì— ëŒ€í•œ ì„œë¹„ìŠ¤ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ClusterIP ìœ í˜•ìœ¼ë¡œ ë˜ì–´ìˆìœ¼ë¯€ë¡œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° í™˜ê²½ì—ì„œë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§ˆìŠ¤í„° ë…¸ë“œì—ì„œ íë¸Œì»¨íŠ¸ë¡¤ë¡œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— í”„ë¡ì‹œë¥¼ í™œì„±í™”í•˜ê³ ë‚˜ì„œ ë¡œì»¬ ì»´í“¨í„°ì—ì„œ ë§ˆìŠ¤í„° ë…¸ë“œì— ëŒ€í•´ì„œ SSH í„°ë„ë§ì„ í†µí•´ ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° í”„ë¡ì‹œ ë° SSH í„°ë„ë§</span></div><code class="language-sh">kubectl cluster-info
Kubernetes control plane is running at https:&#x2F;&#x2F;192.168.0.5:6443
CoreDNS is running at https:&#x2F;&#x2F;192.168.0.5:6443&#x2F;api&#x2F;v1&#x2F;namespaces&#x2F;kube-system&#x2F;services&#x2F;kube-dns:dns&#x2F;proxy

kubectl proxy
Starting to serve on 127.0.0.1:8001
# http:&#x2F;&#x2F;127.0.0.1:8001&#x2F;api&#x2F;v1&#x2F;namespaces&#x2F;kubernetes-dashboard&#x2F;services&#x2F;https:kubernetes-dashboard:&#x2F;proxy&#x2F;

ssh -L 8001:localhost:8001 mambo@192.168.0.5</code></pre><p>ì´ì œ ë¡œì»¬ ì»´í“¨í„°ì—ì„œ <a target="_blank" rel="noopener" href="http://127.0.0.1:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/%EB%A1%9C">http://127.0.0.1:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/ë¡œ</a> ì ‘ì†í•˜ë©´ ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ë¡œê·¸ì¸ í™”ë©´ì´ í‘œì‹œë©ë‹ˆë‹¤.</p><p><img data-src="/images/posts/setup-kubernetes-cluster/access-kubernetes-dashboard-02.png"></p><p>í•˜ì§€ë§Œ, ì´ë ‡ê²Œ SSH í„°ë„ë§ìœ¼ë¡œ ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œë¡œ ì ‘ê·¼í•˜ëŠ” ë°©ì‹ì€ ë¶ˆí¸í•œì ì´ ìˆê¸° ë•Œë¬¸ì— ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œë¥¼ ì™¸ë¶€ì—ì„œ ì§ì ‘ ì ‘ê·¼í•  ìˆ˜ ìˆìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤. ì™¸ë¶€ì—ì„œ ì ‘ê·¼í•˜ê¸° ìœ„í•´ì„œëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œë¥¼ ì™¸ë¶€ë¡œ ë…¸ì¶œí•  ìˆ˜ ìˆë„ë¡ ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ì„œë¹„ìŠ¤ì˜ ìœ í˜•ì„ ClusterIP ì—ì„œ <strong>NodePort</strong>ë¡œ ë³€ê²½í•´ì•¼í•©ë‹ˆë‹¤.</p><h3 id="ì¿ ë²„ë„¤í‹°ìŠ¤-ëŒ€ì‹œë³´ë“œ-ì„œë¹„ìŠ¤-ìœ í˜•-ë³€ê²½í•˜ê¸°"><a href="#ì¿ ë²„ë„¤í‹°ìŠ¤-ëŒ€ì‹œë³´ë“œ-ì„œë¹„ìŠ¤-ìœ í˜•-ë³€ê²½í•˜ê¸°" class="headerlink" title="ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ì„œë¹„ìŠ¤ ìœ í˜• ë³€ê²½í•˜ê¸°"></a>ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ì„œë¹„ìŠ¤ ìœ í˜• ë³€ê²½í•˜ê¸°</h3><pre class="language-sh" data-language="sh"><div class="caption"><span>ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ì„œë¹„ìŠ¤ ë³€ê²½</span></div><code class="language-sh">kubectl edit svc kubernetes-dashboard -n kubernetes-dashboard

apiVersion: v1
kind: Service
metadata:
  creationTimestamp: &quot;2021-07-30T10:47:00Z&quot;
  labels:
    k8s-app: kubernetes-dashboard
  name: kubernetes-dashboard
  namespace: kubernetes-dashboard
  resourceVersion: &quot;240375&quot;
  uid: ae974cb2-d0af-46be-8036-4a9d33c9afbd
spec:
  clusterIP: 10.100.36.145
  clusterIPs:
  - 10.100.36.145
  ipFamilies:
  - IPv4
  ipFamilyPolicy: SingleStack
  ports:
  - port: 443
    protocol: TCP
    targetPort: 8443
  selector:
    k8s-app: kubernetes-dashboard
  sessionAffinity: None
  type: NodePort
status:
  loadBalancer: &#123;&#125;

# kubectl get service kubernetes-dashboard -n kubernetes-dashboard -o jsonpath&#x3D;&quot;&#123;.spec.ports[0].nodePort&#125;&quot; | awk &#39;&#123;print $1&#125;&#39;
kubectl get svc kubernetes-dashboard -n kubernetes-dashboard
NAME                   TYPE       CLUSTER-IP      EXTERNAL-IP   PORT(S)         AGE
kubernetes-dashboard   NodePort   10.100.36.145   &lt;none&gt;        443:31532&#x2F;TCP   21m</code></pre><p>ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œê°€ 31532 í¬íŠ¸ë¡œ ë…¸ì¶œë˜ì—ˆìœ¼ë‹ˆ <strong><a target="_blank" rel="noopener" href="https://192.168.0.5:31532/">https://192.168.0.5:31532</a></strong>ìœ¼ë¡œ ì ‘ì†í•©ë‹ˆë‹¤.</p><p><img data-src="/images/posts/setup-kubernetes-cluster/access-kubernetes-dashboard-01.png"></p><p>ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë£¨íŠ¸ CA ì¸ì¦ì„œê°€ í˜„ì¬ ë¸Œë¼ìš°ì €ì— ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” CA ì¸ì¦ì„œë¡œ ë“±ë¡ë˜ì–´ìˆì§€ ì•Šê¸° ë•Œë¬¸ì— <strong>ì•ˆì „í•˜ì§€ ì•ŠìŒìœ¼ë¡œ ì´ë™</strong>ì„ ëˆŒëŸ¬ ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œë¡œ ë“¤ì–´ê°‘ë‹ˆë‹¤.</p><h3 id="ì¿ ë²„ë„¤í‹°ìŠ¤-ëŒ€ì‹œë³´ë“œ-ë¡œê·¸ì¸í•˜ê¸°"><a href="#ì¿ ë²„ë„¤í‹°ìŠ¤-ëŒ€ì‹œë³´ë“œ-ë¡œê·¸ì¸í•˜ê¸°" class="headerlink" title="ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ë¡œê·¸ì¸í•˜ê¸°"></a>ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ë¡œê·¸ì¸í•˜ê¸°</h3><p><img data-src="/images/posts/setup-kubernetes-cluster/access-kubernetes-dashboard-02.png"></p><p>ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ì„œë¹„ìŠ¤ ì–´ì¹´ìš´íŠ¸ì˜ í† í°ìœ¼ë¡œ ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œì— ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íë¸Œì»¨íŠ¸ë¡¤ë¡œ ë‹¤ìŒì˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ì‚¬ìš©ìì˜ í† í°ì„ ì¡°íšŒí•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ì‚¬ìš©ì í† í° ì¡°íšŒ</span></div><code class="language-sh"># kubectl get secret -n kubernetes-dashboard $(kubectl get sa kubernetes-dashboard -n kubernetes-dashboard -o jsonpath&#x3D;&quot;&#123;.secrets[0].name&#125;&quot;) -o jsonpath&#x3D;&quot;&#123;.data.token&#125;&quot; | base64 --decode | awk &#39;&#123;print $1&#125;&#39;

kubectl describe secret $(kubectl get secret -n kubernetes-dashboard | grep kubernetes-dashboard-token | awk &#39;&#123;print $1&#125;&#39;) -n kubernetes-dashboard

Name:         kubernetes-dashboard-token-4qs2r
Namespace:    kubernetes-dashboard
Labels:       &lt;none&gt;
Annotations:  kubernetes.io&#x2F;service-account.name: kubernetes-dashboard
              kubernetes.io&#x2F;service-account.uid: 52ab8346-d0ce-465a-b170-1a240cbcbf83

Type:  kubernetes.io&#x2F;service-account-token

Data
&#x3D;&#x3D;&#x3D;&#x3D;
namespace:  20 bytes
token:      eyJhbGciOiJSUzI1NiIsImtpZCI6InhrcWdOeEV2RFh2ajZES0Z1b0lLb3F2TmtuSUVnLVdFbktadk9SWjNYXzQifQ....
ca.crt:     1066 bytes</code></pre><p>ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ì‚¬ìš©ìì˜ í† í°ì„ ë³µì‚¬í•´ì„œ ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œì— ë¡œê·¸ì¸í•©ë‹ˆë‹¤.</p><p><img data-src="/images/posts/setup-kubernetes-cluster/access-kubernetes-dashboard-03.png"></p><p>í† í°ì„ ì‚¬ìš©í•˜ì—¬ ë¡œê·¸ì¸ë˜ì—ˆì§€ë§Œ ì´ ì„œë¹„ìŠ¤ ì–´ì¹´ìš´íŠ¸ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ëŒ€í•œ ê¶Œí•œì„ ê°€ì§€ê³  ìˆì§€ ì•Šì•„ì„œ ì–´ë– í•œ ì •ë³´ë„ í‘œì‹œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p><p><img data-src="/images/posts/setup-kubernetes-cluster/access-kubernetes-dashboard-04.png"></p><p>ìš°ë¦¬ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ëŒ€í•œ ê¶Œí•œì„ ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ì‚¬ìš©ìì—ê²Œ ë¶€ì—¬í•´ì•¼í•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>Terminal</span></div><code class="language-sh">kubectl delete clusterrole kubernetes-dashboard -n kubernetes-dashboard
kubectl delete clusterrolebinding kubernetes-dashboard -n kubernetes-dashboard

cat &lt;&lt;EOF | tee dashboard-admin.yaml
apiVersion: rbac.authorization.k8s.io&#x2F;v1
kind: ClusterRoleBinding
metadata:
  name: kubernetes-dashboard
  namespace: kubernetes-dashboard
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
  - kind: ServiceAccount
    name: kubernetes-dashboard
    namespace: kubernetes-dashboard
EOF

kubectl create -f dashboard-admin.yaml
clusterrolebinding.rbac.authorization.k8s.io&#x2F;kubernetes-dashboard created</code></pre><p>ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ì‚¬ìš©ìì—ê²Œ ëª¨ë“  ê¶Œí•œì„ ë¶€ì—¬í•˜ëŠ” <strong>ClusterRole</strong>ê³¼ <strong>ClusterRoleBinding</strong>ì„ ë‹¤ì‹œ ë§Œë“¤ì—ˆìœ¼ë‹ˆ ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œì— ë‹¤ì‹œ ë¡œê·¸ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.</p><p><img data-src="/images/posts/setup-kubernetes-cluster/access-kubernetes-dashboard-05.png"></p><p>ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œì˜ ì„œë¹„ìŠ¤ ì–´ì¹´ìš´íŠ¸ê°€ í´ëŸ¬ìŠ¤í„° ê¶Œí•œì„ ê°€ì§€ê²Œ ë˜ì—ˆìœ¼ë¯€ë¡œ ëŒ€ì‹œë³´ë“œì— <strong>ëª¨ë“  ë„¤ì„ìŠ¤í˜ì´ìŠ¤</strong>ì— ëŒ€í•œ ì›Œí¬ë¡œë“œ ìƒíƒœë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><h3 id="ì¿ ë²„ë„¤í‹°ìŠ¤-ëŒ€ì‹œë³´ë“œì—ì„œ-ë§¤íŠ¸ë¦­-ì„œë²„-ì„¤ì¹˜í•˜ê¸°"><a href="#ì¿ ë²„ë„¤í‹°ìŠ¤-ëŒ€ì‹œë³´ë“œì—ì„œ-ë§¤íŠ¸ë¦­-ì„œë²„-ì„¤ì¹˜í•˜ê¸°" class="headerlink" title="ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œì—ì„œ ë§¤íŠ¸ë¦­ ì„œë²„ ì„¤ì¹˜í•˜ê¸°"></a>ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œì—ì„œ ë§¤íŠ¸ë¦­ ì„œë²„ ì„¤ì¹˜í•˜ê¸°</h3><p>ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œì—ì„œ í´ëŸ¬ìŠ¤í„° ì œì–´ê°€ ê°€ëŠ¥í•œì§€ ê²€ì¦í•˜ê¸° ìœ„í•´ì„œ ëŒ€ì‹œë³´ë“œë¥¼ í†µí•´ í´ëŸ¬ìŠ¤í„°ì— ë§¤íŠ¸ë¦­ ì„œë²„(metrics-server)ë¥¼ ì„¤ì¹˜í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p><p><a target="_blank" rel="noopener" href="https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml">https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml</a></p><p>ìœ„ YAML íŒŒì¼ì„ ë‹¤ìš´ë°›ì•„ì„œ ì•„ë˜ í™”ë©´ê³¼ ê°™ì´ <strong>kubelet-insecure-tls</strong> ì˜µì…˜ì„ ì¶”ê°€í•˜ì—¬ ì—…ë¡œë“œ ë²„íŠ¼ì„ ì„ íƒí•©ë‹ˆë‹¤.</p><p><img data-src="/images/posts/setup-kubernetes-cluster/access-kubernetes-dashboard-06.png"></p><p>ë§¤íŠ¸ë¦­ ì„œë²„ê°€ ì„¤ì¹˜ë˜ì—ˆìœ¼ë¯€ë¡œ íë¸Œì»¨íŠ¸ë¡¤ìœ¼ë¡œ ë§¤íŠ¸ë¦­ì„ ì¡°íšŒí•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p><pre class="language-sh" data-language="sh"><div class="caption"><span>Terminal</span></div><code class="language-sh">kubectl top no --use-protocol-buffers

NAME              CPU(cores)   CPU%   MEMORY(bytes)   MEMORY%
mambo-master      136m         13%    1275Mi          67%
mambo-worker-01   22m          2%     710Mi           37%
mambo-worker-02   33m          3%     815Mi           43%</code></pre><p>ì´ë ‡ê²Œ ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œë¥¼ í†µí•´ì„œë„ í´ëŸ¬ìŠ¤í„°ë¥¼ ì œì–´í•  ìˆ˜ ìˆìŒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜, ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œëŠ” í´ëŸ¬ìŠ¤í„° ì™¸ë¶€ì— ë…¸ì¶œë˜ì–´ìˆìœ¼ë¯€ë¡œ ì‚¬ìš©ìì˜ í† í°ì´ ìœ ì¶œë˜ì§€ ì•Šë„ë¡ ì˜ ê´€ë¦¬í•´ì•¼í•©ë‹ˆë‹¤. ì €ëŠ” í•™ìŠµ ëª©ì ìœ¼ë¡œ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œ ì‚¬ìš©ìê°€ ëª¨ë“  ê¶Œí•œì„ ê°€ì§€ê²Œ í•˜ì˜€ì§€ë§Œ í´ëŸ¬ìŠ¤í„°ì— ëŒ€í•œ ëª¨ë“  ê¶Œí•œì„ ê°€ì§€ëŠ”ê²Œ ì•„ë‹ˆë¼ ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ì‹œë³´ë“œì— ë¡œê·¸ì¸í•  ì‚¬ìš©ìë¥¼ ë³„ë„ë¡œ ë§Œë“¤ì–´ì„œ íŠ¹ì • ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì™€ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ê¶Œí•œì„ ê°œë³„ì ìœ¼ë¡œ ì§€ì •í•˜ëŠ”ê²Œ ì¢‹ìŠµë‹ˆë‹¤.</p><p>ì´ìƒìœ¼ë¡œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ëŒ€í•œ í•™ìŠµì„ ë§ˆì¹©ë‹ˆë‹¤.</p></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Kubernetes/" rel="tag"># Kubernetes</a></div><div class="post-nav"><div class="post-nav-item"><a href="/using-pushgateway-to-monitor-private-network-instance/" rel="prev" title="Pushgatewayë¥¼ í™œìš©í•˜ì—¬ ì‚¬ì„¤ë§ ì¸ìŠ¤í„´ìŠ¤ ëª¨ë‹ˆí„°ë§í•˜ê¸°"><i class="fa fa-chevron-left"></i> Pushgatewayë¥¼ í™œìš©í•˜ì—¬ ì‚¬ì„¤ë§ ì¸ìŠ¤í„´ìŠ¤ ëª¨ë‹ˆí„°ë§í•˜ê¸°</a></div><div class="post-nav-item"><a href="/connecting-with-mqtt-using-aws-iot-device-sdk/" rel="next" title="AWS IoT Device SDK Javaë¡œ MQTT ì—°ê²°í•˜ê¸°">AWS IoT Device SDK Javaë¡œ MQTT ì—°ê²°í•˜ê¸° <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments"><script src="https://utteranc.es/client.js" repo="kdevkr/kdevkr.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Mambo</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a></div></div></footer><script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script><script src="/js/third-party/fancybox.js"></script><script src="/js/third-party/pace.js"></script><script src="https://unpkg.com/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script><script>var options={bottom:"unset",right:"15px",left:"unset",time:"0.5s",mixColor:"transparent",backgroundColor:"transparent",buttonColorDark:"#100f2c",buttonColorLight:"#fff",saveInCookies:!0,label:"ğŸŒ—",autoMatchOsTheme:!0};const darkmode=new Darkmode(options);window.darkmode=darkmode,darkmode.showWidget()</script></body></html>