---
title: 스스로 괴롭히는 사이드 이펙트
date: 2022-05-21
tags:
- 회고
- 장애
- 버그
- 사이드 이펙트
---

> 본 글은 스스로 만들어낸 사이드 이펙트를 힘들게 찾아가고 사이드 이펙트가 만들어진 사유를 되돌아보고자 작성한 것입니다.

![](images/posts/side-effect-myself/00.jpg)

완벽한 시스템을 만드는게 아니지만 최대한 노력해서 시스템에 문제가 발생하지 않도록 최선을 다하는데요. 그럼에도 불구하고 고객의 요구사항의 다양함과 원하는 일정으로 인하여 작업이 가능한 부분을 먼저 처리한다던가 요구사항에서 고려되지 않은 부분을 확인하고 피드백을 받고 작업 요건을 정리해서 처리하는 편입니다. 허나 애초에 고객 조차도 자신이 원하는 바가 무엇인지가 정리되기 힘들기 때문에 작업한 내용을 확인해보고 추가로 문제가 될 부분에 대해서 피드백이 오고 계속해서 추가하거나 수정되는 작업이 빈번한 경우도 발생합니다.

![](images/posts/side-effect-myself/01.jpg)

고객의 다양한 요구사항을 처리하다보면 관련없는 부분에 대해서도 문제를 일으킬 수 있는 사이드 이펙트가 발생하곤 합니다. 시스템의 모든 부분을 알고 있는 개발자는 드물기 때문에 어떤 요구사항을 처리하는 것에 있어서 어디까지 영향이 가는지는 검토 및 작업 과정에서도 판단이 안되기도 합니다. 심지어는 프로덕트 팀에서도 작업된 요건에 대해서만 검증하고 피드백을 전달하기 때문에 어디서 문제가 내재되었는지 검출이 되지 않을 가능성도 있습니다.

![](images/posts/side-effect-myself/02.jpg)

때로는 어떠한 문제를 파악하기 위해서 디버그할 수 있는 정보를 포함하여 핫픽스로 시스템을 재배포하고나서 실제로 수정된 코드는 없는데 발생하였던 버그가 나타지않을 때도 있습니다. 이번에 발생한 사이드 이펙트도 어떠한 과정을 거치게되서야 예상하지 못한 곳에서 그 과정으로 인해 생긴 정보로 인하여 제대로 된 결과를 가져오지 못하여 발생하였습니다.

![](images/posts/side-effect-myself/03.jpg)

처음에는 특정 환경에서만 발생하는 사유로 인하여 JDBC와 PostgreSQL 버전 사이의 문제로 예상했었습니다. 하지만 어찌저찌 트릭을 쓰면서까지 힘들게 찾은 원인은 전역 변수의 사용에 있었습니다. 문제가 확인되었던 곳에서는 정상적으로 전역 변수를 올바르게 사용하고 있었으나 일부 고객의 요구사항을 보완하는 과정에서 전역 변수임을 확인하지 않고 전역변수가 내부적으로 가지는 조회 기준 정보에 어떤 값을 넣는 코드가 추가됨에 따라 다른 작업에 의해서 현재 문제가 검토된 곳에서 검출이 된 것입니다.

![](images/posts/side-effect-myself/04.jpg)

문제를 일으킨 코드를 만든 사람은 바로 저였기에 스스로를 함정에 빠트리게 된 것이죠. 그나마 다행힌 점은 내가 작업한 코드로 인하여 다른 사람이 작업한 기능에 영향은 끼치지 않았다는 점입니다. 고객이 검증중인 기능에 제대로 동작하지 않는다는 문제를 보고받았고 고객이 피드백한 이슈는 아니지만 스스로 발견한 문제가 동일한 방식으로 전역 변수를 사용하는 코드가 포함되어있기에 결국에는 같은 원인으로 발생한 문제인 것까지 확인할 수 있었습니다.

이러한 문제가 발생했다는 것을 토대로 더 노력해야할 것 같습니다.