---
title: 통신 프로토콜 이해하기 시리즈 - ICMP
date: 2021-02-22
categories:
- Communication Protocol
tags:
- protocol
- icmp
---

통신 프로토콜 이해하기 시리즈는 컴퓨터 또는 디바이스 간 통신에 사용되는 다양한 프로토콜을 이해하는 시간을 가집니다. 실무에서 다양한 프로젝트를 진행하다보면 통신에 사용되는 프로토콜이 다양하다는 것을 느낄 수 있습니다. 이번 통신 프로토콜 이해하기 시리즈에서 살펴볼 통신 프로토콜은 `ICMP`입니다.

## ICMP
ICMP(Internet Control Message Protocol)는 인터넷 제어 메시지 프로토콜으로 포트 1번이 할당되어있습니다. ICMP 프로토콜의 메시지는 IP 패킷을 전송하는 과정에서 발생한 오류를 진단하고 원인을 알려주는데에 사용됩니다. 주요 네트워크 유틸리티에서 ICMP를 많이 사용하고 있으며 대표적으로 `ping` 그리고 `traceroute`가 있습니다.

### 핑 테스트
네트워크 환경에서 목적지 호스트와 연결되는지 가장 많이 사용되는 것이 핑 테스트입니다. `ping` 명령어는 ICMP 프로토콜을 사용해서 Echo 메시지를 목적지로 전송하고 응답 메시지를 받는 것으로 네트워크 연결 상태를 측정합니다.

윈도우 터미널에서 ping 명령어를 사용해서 [Cloudflare(1.1.1.1) DNS](https://1.1.1.1/dns/) 주소로 외부 네트워크가 연결되는지 확인할 수 있습니다.
```sh Windows Terminal
PS C:\Users\Mambo> ping 1.1.1.1

Ping 1.1.1.1 32바이트 데이터 사용:
1.1.1.1의 응답: 바이트=32 시간=2ms TTL=56
1.1.1.1의 응답: 바이트=32 시간=2ms TTL=56
1.1.1.1의 응답: 바이트=32 시간=2ms TTL=56
1.1.1.1의 응답: 바이트=32 시간=2ms TTL=56

1.1.1.1에 대한 Ping 통계:
    패킷: 보냄 = 4, 받음 = 4, 손실 = 0 (0% 손실),
왕복 시간(밀리초):
    최소 = 2ms, 최대 = 2ms, 평균 = 2ms
```

> 주로 외부 네트워크와 연결될 수 있는지 확인할 때 Cloudflare(1.1.1.1) 또는 Google(8.8.8.8)을 사용해요.

#### 국내 인터넷 서비스 공급자 DNS

- KT : 168.126.63.1 / 168.126.63.2
- SK 브로드밴드 : 210.220.163.82 / 219.250.36.130
- LG : 164.124.101.2 / 203.248.252.2

### 네트워크 경로 추적
ICMP 프로토콜을 사용하는 또 다른 명령어는 `tracert` 또는 `traceroute` 입니다. 이 명령어는 목적지 호스트에 도달할 때 까지의 네트워크 경로와 지연 시간을 추적합니다.

#### 1.1.1.1 vs 8.8.8.8
클라우드플레어(1.1.1.1)과 구글(8.8.8.8) DNS 주소로 도달하기까지의 경로를 tracert 명령으로 추적해서 비교해봅시다.

```sh Windows Terminal
#### Cloudeflare
PS C:\Users\Mambo> tracert 1.1.1.1

최대 30홉 이상의
one.one.one.one [1.1.1.1](으)로 가는 경로 추적:

  1    <1 ms    <1 ms    <1 ms  192.168.0.1
  2     *        *        *     요청 시간이 만료되었습니다.
  3     2 ms     1 ms     1 ms  *.97.250.33
  4    12 ms    <1 ms     1 ms  112.188.105.41
  5     *        *        *     요청 시간이 만료되었습니다.
  6     *        *        *     요청 시간이 만료되었습니다.
  7     1 ms     2 ms     5 ms  *.174.72.190
  8     4 ms     3 ms     4 ms  *.134.40.130
  9     2 ms     2 ms     2 ms  one.one.one.one [1.1.1.1]

#### Google
PS C:\Users\Mambo> tracert 8.8.8.8

최대 30홉 이상의
dns.google [8.8.8.8](으)로 가는 경로 추적:

  1    <1 ms    <1 ms    <1 ms  192.168.0.1
  2     *        *        *     요청 시간이 만료되었습니다.
  3     1 ms     1 ms     2 ms  *.97.250.33
  4     *        *        1 ms  *.188.105.41
  5     *        *        *     요청 시간이 만료되었습니다.
  6     *        *        *     요청 시간이 만료되었습니다.
  7     1 ms     1 ms     1 ms  *.174.11.178
  8    32 ms    31 ms    32 ms  *.14.209.154
  9    37 ms    37 ms    37 ms  *.239.40.253
 10    32 ms    32 ms    31 ms  *.250.226.7
 11    31 ms    30 ms    31 ms  dns.google [8.8.8.8]

추적을 완료했습니다.
```

클라우드플레어보다 구글 DNS에 도달하기 까지의 경로가 더 많은 것을 확인할 수 있습니다.

### Telnet
텔넷(Telnet)은 ICMP 프로토콜과 다르게 네트워크 연결을 위한 프로토콜으로 23번 포트를 사용하여 원격 호스트에 연결을 수행할 수 있습니다.

텔넷 명령어를 활용해서 클라우드플레어에 연결할 수 있는지 테스트합니다.

```sh Windows Terminal
telnet 1.1.1.1 80

Microsoft Telnet Client 시작
  이스케이프 문자: 'CTRL+]'
  
Microsoft Telnet> q 
```

> 실제로 원격 호스트에 연결할 때는 보안 프로토콜인 SSH(22)를 사용합니다.

ICMP 프로토콜은 원격 호스트와 네트워크 연결을 수행할 수 있는지 확인하는 네트워크 유틸리티에서 사용한다는 것을 기억하시면 됩니다.

감사합니다.