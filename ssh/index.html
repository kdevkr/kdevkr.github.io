<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png"><link rel="mask-icon" href="/images/favicon/favicon.ico" color="#222"><meta name="google-site-verification" content="LMcddVW6xLBS7X1htGQ3duOIEmVp4ljku8sd3UuIcBg"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto+Sans+KR:300,300italic,400,400italic,700,700italic%7CGmarket+Sans:300,300italic,400,400italic,700,700italic%7CRIDIBatang:300,300italic,400,400italic,700,700italic%7CJetbrains+Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-loading-bar.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"kdevkr.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.11.1","exturl":false,"sidebar":{"position":"left","display":"hide","padding":18,"offset":12,"width":240,"scrollpercent":true,"b2t":true},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script><meta name="description" content="일반적으로 (원격 호스트인) 서버에 접속하기 위해서 사용자 계정과 비밀번호를 공유하기보다는 SSH 프로토콜을 사용하여 TCP 보안 채널을 연결하고 통신 내용에 대한 암호화를 통해 패킷을 보호하고 안전하게 서버에 접속해서 통신할 수 있도록 구성합니다. 오늘은 SSH 프로토콜을 통해 서버에 접속하는 과정에 대해서 정리해보면서 그저 서버 접속을 위한 PEM 파일"><meta property="og:type" content="article"><meta property="og:title" content="SSH 키 페어 발급 및 원격 호스트 연결하기"><meta property="og:url" content="https://kdevkr.github.io/ssh/index.html"><meta property="og:site_name" content="Mambo"><meta property="og:description" content="일반적으로 (원격 호스트인) 서버에 접속하기 위해서 사용자 계정과 비밀번호를 공유하기보다는 SSH 프로토콜을 사용하여 TCP 보안 채널을 연결하고 통신 내용에 대한 암호화를 통해 패킷을 보호하고 안전하게 서버에 접속해서 통신할 수 있도록 구성합니다. 오늘은 SSH 프로토콜을 통해 서버에 접속하는 과정에 대해서 정리해보면서 그저 서버 접속을 위한 PEM 파일"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://kdevkr.github.io/images/posts/ssh/ssh-01.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/ssh/ssh-02.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/ssh/ssh-03.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/ssh/ssh-04.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/ssh/ssh-05.png"><meta property="og:image" content="https://kdevkr.github.io/images/posts/ssh/ssh-06.png"><meta property="article:published_time" content="2022-07-03T00:00:00.000Z"><meta property="article:modified_time" content="2022-09-10T08:28:40.145Z"><meta property="article:author" content="Mambo"><meta property="article:tag" content="SSH"><meta property="article:tag" content="Key Pair"><meta property="article:tag" content="RSA"><meta property="article:tag" content="ED25519"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://kdevkr.github.io/images/posts/ssh/ssh-01.png"><link rel="canonical" href="https://kdevkr.github.io/ssh/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://kdevkr.github.io/ssh/","path":"ssh/","title":"SSH 키 페어 발급 및 원격 호스트 연결하기"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>SSH 키 페어 발급 및 원격 호스트 연결하기 | Mambo</title><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-93954323-1","only_pageview":true}</script><script src="/js/third-party/analytics/google-analytics.js"></script><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><link rel="alternate" href="/atom.xml" title="Mambo" type="application/atom+xml">
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope itemtype="http://schema.org/WebPage"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Mambo</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Today I Learned 🔥</p></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fas fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fas fa-archive fa-fw"></i>Archives<span class="badge">75</span></a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fas fa-user fa-fw"></i>About</a></li></ul></nav></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">Table of Contents</li><li class="sidebar-nav-overview">Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#SSH-%ED%82%A4-%ED%8E%98%EC%96%B4"><span class="nav-number">1.</span> <span class="nav-text">SSH 키 페어</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SSH-%ED%82%A4-%ED%8E%98%EC%96%B4-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0"><span class="nav-number">1.1.</span> <span class="nav-text">SSH 키 페어 생성하기</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EA%B9%83%ED%97%88%EB%B8%8C-%EA%B3%B5%EA%B0%9C%ED%82%A4-%EB%93%B1%EB%A1%9D%ED%95%98%EA%B8%B0"><span class="nav-number">1.2.</span> <span class="nav-text">깃허브 공개키 등록하기</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EC2-%EA%B3%B5%EA%B0%9C%ED%82%A4-%EB%93%B1%EB%A1%9D%ED%95%98%EA%B8%B0"><span class="nav-number">1.3.</span> <span class="nav-text">EC2 공개키 등록하기</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AWS-ED25519-Invalid-Format"><span class="nav-number">2.</span> <span class="nav-text">AWS ED25519 Invalid Format</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%EC%B0%B8%EA%B3%A0"><span class="nav-number">3.</span> <span class="nav-text">참고</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Mambo" src="https://avatars1.githubusercontent.com/u/17937604?s=460&v=4"><p class="site-author-name" itemprop="name">Mambo</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">75</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-tags"><span class="site-state-item-count">132</span> <span class="site-state-item-name">tags</span></div></nav></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://github.com/kdevkr" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;kdevkr" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:kdevkr@gmail.com" title="E-Mail → mailto:kdevkr@gmail.com" rel="noopener" target="_blank"><i class="fas fa-envelope fa-fw"></i>E-Mail</a></span></div><div class="cc-license site-overview-item animated" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ko" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div><div class="back-to-top animated" role="button" aria-label="Back to top"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div class="sidebar-dimmer"></div></header><div class="reading-progress-bar"></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://kdevkr.github.io/ssh/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://avatars1.githubusercontent.com/u/17937604?s=460&v=4"><meta itemprop="name" content="Mambo"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Mambo"><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="SSH 키 페어 발급 및 원격 호스트 연결하기 | Mambo"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">SSH 키 페어 발급 및 원격 호스트 연결하기</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2022-07-03 00:00:00" itemprop="dateCreated datePublished" datetime="2022-07-03T00:00:00Z">2022-07-03</time></span></div></div></header><div class="post-body" itemprop="articleBody"><p>일반적으로 (원격 호스트인) 서버에 접속하기 위해서 사용자 계정과 비밀번호를 공유하기보다는 SSH 프로토콜을 사용하여 TCP 보안 채널을 연결하고 통신 내용에 대한 암호화를 통해 패킷을 보호하고 안전하게 서버에 접속해서 통신할 수 있도록 구성합니다. 오늘은 SSH 프로토콜을 통해 서버에 접속하는 과정에 대해서 정리해보면서 그저 서버 접속을 위한 PEM 파일을 받아서 접속할 뿐이었던 부분을 머리속에서 정리해보고자 합니다. 저와 함께 SSH 키 페어를 발급해보고 발급된 키 페어를 아마존 웹 서비스의 EC2 인스턴스 또는 깃허브 저장소에 등록한 후 원격 호스트에 연결하여 성공적으로 인증할 수 있는지를 확인해보시기 바랍니다.</p><h2 id="SSH-키-페어"><a href="#SSH-키-페어" class="headerlink" title="SSH 키 페어"></a>SSH 키 페어</h2><p>SSH 프로토콜을 사용하기 위해서는 SSH 키 페어라고 하는 공개키와 비밀키(퍼블릭 키와 프라이빗 키)로 구성된 키 페어를 만들고나서 서버에서는 공개키를 보유하도록 하고 서버에 접속 또는 인증하고자하는 클라이언트는 비밀키를 가지고 있음으로써 공개키 기반의 인증을 수행하여 보안 채널을 연결하게 됩니다. SSH 프로토콜을 사용해서 TCP 보안 채널을 연결하는 과정에 대해서는 본 글에서 다루고자하는 부분이 아니므로 자세히 설명된 다른 글들을 찾아보시기 바랍니다.</p><h3 id="SSH-키-페어-생성하기"><a href="#SSH-키-페어-생성하기" class="headerlink" title="SSH 키 페어 생성하기"></a>SSH 키 페어 생성하기</h3><p>아마존 웹 서비스를 이용하고 있는 개발자라면 웹 콘솔이나 AWS CLI의 create-key-pair 명령을 사용해서 RSA 또는 ED25519 기반의 키 페어를 생성할 수도 있습니다만, 일반적인 개발자라면 어떤 환경에 의존하지 않는 OpenSSH에 포함되는 ssh-keygen 도구를 사용해야 합니다. 자신이 사용하는 운영체제에 따라서 기본으로 포함된 OpenSSH를 사용하거나 설치하면 됩니다. 만약 윈도우 10을 사용하고 있다면 Git Bash를 설치하면 ssh-keygen이 포함되어있고 선택적 기능을 통해서 OpenSSH 클라이언트를 쉽게 설치할 수 있습니다.</p><p><img data-src="/images/posts/ssh/ssh-01.png" alt="윈도우 10의 선택적 기능을 통해서 설치한 OpenSSH 클라이언트"></p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment"># in Windows Terminal</span>
<span class="token function">PS</span> C:\Users\Mambo\keypair> ssh <span class="token operator">-</span>V
OpenSSH_for_Windows_7<span class="token punctuation">.</span>7p1<span class="token punctuation">,</span> LibreSSL 2<span class="token punctuation">.</span>6<span class="token punctuation">.</span>5

<span class="token comment"># in Git Bash</span>
$ ssh <span class="token operator">-</span>V
OpenSSH_9<span class="token punctuation">.</span>0p1<span class="token punctuation">,</span> OpenSSL 1<span class="token punctuation">.</span>1<span class="token punctuation">.</span>1p  21 Jun 2022</code></pre><p>아무튼 OpenSSH를 확인했다면 <a target="_blank" rel="noopener" href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">Generating a new SSH key and adding it to the ssh-agent</a>와 같은 문서를 참고해서 ssh-keygen으로 SSH 키 페어를 생성해보도록 하겠습니다.</p><p>먼저, RSA 알고리즘 기반의 키 페어를 만들때는 기본적으로 2048 비트 이상으로 만들어지게 되며 이 글을 작성하는 시점에서는 아마존 웹 서비스나 깃허브 저장소 모두 4096 비트를 지원하고 권장하는 편입니다.</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">PS</span> C:\Users\Mambo\keypair> ssh-keygen <span class="token operator">-</span>t rsa <span class="token operator">-</span>b 4096 <span class="token operator">-</span>m PEM <span class="token operator">-</span>f win-mambo-rsa-4096<span class="token punctuation">.</span>pem
Generating public/private rsa key pair<span class="token punctuation">.</span>
Enter passphrase <span class="token punctuation">(</span>empty <span class="token keyword">for</span> no passphrase<span class="token punctuation">)</span>:
Enter same passphrase again:
Your identification has been saved in win-mambo-rsa-4096<span class="token punctuation">.</span>pem<span class="token punctuation">.</span>
Your public key has been saved in win-mambo-rsa-4096<span class="token punctuation">.</span>pem<span class="token punctuation">.</span>pub<span class="token punctuation">.</span>
The key fingerprint is:
SHA256:F3ECBEjeXszb6ccTJ2EWz9eaxvZoAg4f6F4rU0aDYJY mambo@DESKTOP-OJJ4TB3
The key's randomart image is:
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">-</span><span class="token namespace">[RSA 4096]</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token punctuation">|</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">+</span>o<span class="token punctuation">.</span>o o    <span class="token punctuation">|</span>
<span class="token punctuation">|</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>Eo   <span class="token operator">+</span> <span class="token operator">+</span>  <span class="token punctuation">.</span><span class="token punctuation">|</span>
<span class="token punctuation">|</span>    <span class="token punctuation">.</span>o<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">+</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">+</span> o o<span class="token punctuation">|</span>
<span class="token punctuation">|</span>     <span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">+</span>o= o <span class="token operator">+</span> <span class="token punctuation">|</span>
<span class="token punctuation">|</span>      <span class="token punctuation">.</span> S<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">.</span>o B  <span class="token punctuation">|</span>
<span class="token punctuation">|</span>       <span class="token punctuation">.</span> <span class="token operator">*</span>o+ <span class="token operator">*</span> o <span class="token punctuation">|</span>
<span class="token punctuation">|</span>        <span class="token punctuation">.</span>o= = o <span class="token punctuation">.</span><span class="token punctuation">|</span>
<span class="token punctuation">|</span>       <span class="token punctuation">.</span>o<span class="token punctuation">.</span> o <span class="token operator">+</span>   <span class="token punctuation">|</span>
<span class="token punctuation">|</span>        <span class="token punctuation">.</span>o<span class="token punctuation">.</span>      <span class="token punctuation">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token namespace">[SHA256]</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span></code></pre><p>4096 비트를 가지는 RSA 키 페어를 만들게되면 키의 길이가 너무 길어지게 되므로 ED25519 알고리즘을 지원하는 원격 호스트라면 ED25519 기반의 키 페어를 생성하고 사용하는게 더 좋습니다. 지난 <a href="/ed25519/">ed25519</a> 글을 읽어보시면 RSA 보다 ED25519를 사용하게 되는 이유에 대해서 알아가실 수 있습니다.</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">PS</span> C:\Users\Mambo\keypair> ssh-keygen <span class="token operator">-</span>t ed25519 <span class="token operator">-</span>m PEM <span class="token operator">-</span>f win-mambo-ed25519<span class="token punctuation">.</span>pem
Generating public/private ed25519 key pair<span class="token punctuation">.</span>
Enter passphrase <span class="token punctuation">(</span>empty <span class="token keyword">for</span> no passphrase<span class="token punctuation">)</span>:
Enter same passphrase again:
Your identification has been saved in win-mambo-ed25519<span class="token punctuation">.</span>pem<span class="token punctuation">.</span>
Your public key has been saved in win-mambo-ed25519<span class="token punctuation">.</span>pem<span class="token punctuation">.</span>pub<span class="token punctuation">.</span>
The key fingerprint is:
SHA256:oad/A11tVJQFxRIDA63pozCFj/FsTCDh51hALNdFBVU mambo@DESKTOP-OJJ4TB3
The key's randomart image is:
<span class="token operator">+</span><span class="token operator">--</span><span class="token namespace">[ED25519 256]</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token punctuation">|</span>   o+o o+<span class="token operator">++</span><span class="token operator">+</span>E<span class="token punctuation">.</span><span class="token operator">+</span>BB<span class="token punctuation">|</span>
<span class="token punctuation">|</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">+</span><span class="token punctuation">.</span>o     <span class="token punctuation">.</span><span class="token punctuation">.</span>oo<span class="token punctuation">.</span><span class="token punctuation">|</span>
<span class="token punctuation">|</span>   o<span class="token punctuation">.</span><span class="token punctuation">.</span>oo<span class="token punctuation">.</span>  o o <span class="token punctuation">.</span> <span class="token punctuation">|</span>
<span class="token punctuation">|</span>     =o<span class="token punctuation">.</span>o<span class="token punctuation">.</span>o <span class="token punctuation">.</span> o  <span class="token punctuation">|</span>
<span class="token punctuation">|</span>    <span class="token punctuation">.</span> oXSo <span class="token punctuation">.</span> <span class="token punctuation">.</span>   <span class="token punctuation">|</span>
<span class="token punctuation">|</span>      <span class="token operator">+</span>oB <span class="token operator">+</span>      <span class="token punctuation">|</span>
<span class="token punctuation">|</span>      <span class="token punctuation">.</span><span class="token operator">+</span> o <span class="token punctuation">.</span>     <span class="token punctuation">|</span>
<span class="token punctuation">|</span>       <span class="token punctuation">.</span><span class="token punctuation">.</span> o      <span class="token punctuation">|</span>
<span class="token punctuation">|</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">.</span>     <span class="token punctuation">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token namespace">[SHA256]</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span></code></pre><h3 id="깃허브-공개키-등록하기"><a href="#깃허브-공개키-등록하기" class="headerlink" title="깃허브 공개키 등록하기"></a>깃허브 공개키 등록하기</h3><p>사용자 계정 설정 &gt; 액세스 &gt; <a target="_blank" rel="noopener" href="https://github.com/settings/keys">SSH and GPG Keys</a> 메뉴로 진입하면 SSH 키를 등록할 수 있는 기능을 제공하고 있습니다. 앞서 만들었던 ED25519 키 페어를 등록하고 깃허브에 접속할 수 있는지 테스트 해보겠습니다.</p><p><img data-src="/images/posts/ssh/ssh-02.png"></p><p><img data-src="/images/posts/ssh/ssh-03.png"></p><p><img data-src="/images/posts/ssh/ssh-04.png"></p><p>자 이제 깃허브에 등록한 공개키에 대한 비밀키를 사용해서 SSH 접속을 시도해보면 어떻게 될까요?</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">PS</span> C:\Users\Mambo\keypair> ssh <span class="token operator">-</span>i win-mambo-ed25519<span class="token punctuation">.</span>pem <span class="token operator">-</span>T git@github<span class="token punctuation">.</span>com
The authenticity of host <span class="token string">'github.com (15.164.81.167)'</span> cannot be established<span class="token punctuation">.</span>
ECDSA key fingerprint is SHA256:p2QAMXNIC1TJYWeIOttrVc98/R1BUFWu3/LiyKgUfQM<span class="token punctuation">.</span>
Are you sure you want to <span class="token keyword">continue</span> connecting <span class="token punctuation">(</span>yes/no<span class="token punctuation">)</span>? yes
Warning: Permanently added <span class="token string">'github.com,15.164.81.167'</span> <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span> to the list of known hosts<span class="token punctuation">.</span>
Hi kdevkr! You've successfully authenticated<span class="token punctuation">,</span> but GitHub does not provide shell access<span class="token punctuation">.</span></code></pre><h3 id="EC2-공개키-등록하기"><a href="#EC2-공개키-등록하기" class="headerlink" title="EC2 공개키 등록하기"></a>EC2 공개키 등록하기</h3><p>아마존 웹 서비스에서 EC2 인스턴스를 실행할 때 키 페어를 만들지 않아도 이미 만들어진 SSH 키 페어를 가져와서 등록할 수 있도록 제공하고 있습니다.</p><p><img data-src="/images/posts/ssh/ssh-05.png"></p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">PS</span> C:\Users\Mambo\keypair> ssh <span class="token operator">-</span>i win-mambo-ed25519<span class="token punctuation">.</span>pem ec2-user@15<span class="token punctuation">.</span>164<span class="token punctuation">.</span>219<span class="token punctuation">.</span>55
The authenticity of host <span class="token string">'15.164.219.55 (15.164.219.55)'</span> cannot be established<span class="token punctuation">.</span>
ECDSA key fingerprint is SHA256:64Ca/STwUWZkN+ggo5jx6BCvwyhNRcCY5/xjk0SkSjU<span class="token punctuation">.</span>
Are you sure you want to <span class="token keyword">continue</span> connecting <span class="token punctuation">(</span>yes/no<span class="token punctuation">)</span>? yes
Warning: Permanently added <span class="token string">'15.164.219.55'</span> <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span> to the list of known hosts<span class="token punctuation">.</span>

       __<span class="token punctuation">|</span>  __<span class="token punctuation">|</span>_  <span class="token punctuation">)</span>
       _<span class="token punctuation">|</span>  <span class="token punctuation">(</span>     <span class="token operator">/</span>   Amazon Linux 2 AMI
      ___<span class="token punctuation">|</span>\___<span class="token punctuation">|</span>___<span class="token punctuation">|</span>

https:<span class="token operator">/</span><span class="token operator">/</span>aws<span class="token punctuation">.</span>amazon<span class="token punctuation">.</span>com/amazon-linux-2/

<span class="token namespace">[ec2-user@ip-10-0-2-243 ~]</span>$ <span class="token function">cat</span> ~<span class="token operator">/</span><span class="token punctuation">.</span>ssh/authorized_keys
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOy21gZ45To8FNf6hilxV51QqT9JCBjIpVKCRlup7m4D window-mambo</code></pre><p>퍼블릭 서브넷에 위치한 EC2 인스턴스에 SSH 접속이 가능함을 확인했습니다.</p><h2 id="AWS-ED25519-Invalid-Format"><a href="#AWS-ED25519-Invalid-Format" class="headerlink" title="AWS ED25519 Invalid Format"></a>AWS ED25519 Invalid Format</h2><p>지난 <a href="/ed25519">ED25519</a> 글을 잘 읽어보신 분들이라면 아마존 웹 서비스의 웹 콘솔이나 AWS CLI를 통해서 ED25519 키 페어를 발급하고 윈도우 환경에서 비밀키를 사용해서 인증을 시도하면 키 형식이 올바르지 않는 문제가 있다는 것을 확인할 수 있었을텐데요. 지난 글에서는 단순히 안되는 것 같다고 마무리 하였지만 이 문제에 대해서 왜 그런것인가에 대해서 궁금해져서 <a target="_blank" rel="noopener" href="https://github.com/aws/aws-cli/discussions/7074">aws-cli&#x2F;discussions&#x2F;7074</a>로 관련 문제에 대해서 질문을 하였고 원인을 찾게 되었습니다.</p><p><img data-src="/images/posts/ssh/ssh-06.png"></p><p>윈도우 환경에서 AWS CLI를 통해 키 페어를 발급하고 비밀키를 파일로 만들면 위와 같이 UTF-16LE 인코딩 형식과 CRLF 개행 방식으로 되어있는 것을 확인할 수 있었습니다. OpenSSH의 ssh-keygen으로 만들어지는 키페어 파일을 UTF-8과 LF로 만들어집니다. Git Bash에 포함되어있는 dos2unix라는 도구를 통해서 UTF-16LE로 되어있는 인코딩 형식을 UTF-8로 변경해보고 시도해보았습니다.</p><pre class="language-sh" data-language="sh"><code class="language-sh">$ dos2unix aws-mambo.pem
dos2unix: converting UTF-16LE file aws-mambo.pem to UTF-8 Unix format...</code></pre><p>윈도우 터미널을 통해서 UTF-16LE 및 CRLF로 되어있는 비밀키를 사용하면 올바르지 않았던 키 형식 문제가 해결되었고 다음과 같이 성공적으로 접속되었습니다.</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">PS</span> C:\Users\Mambo\keypair> ssh <span class="token operator">-</span>i aws-mambo<span class="token punctuation">.</span>pem ec2-user@3<span class="token punctuation">.</span>34<span class="token punctuation">.</span>188<span class="token punctuation">.</span>47

       __<span class="token punctuation">|</span>  __<span class="token punctuation">|</span>_  <span class="token punctuation">)</span>
       _<span class="token punctuation">|</span>  <span class="token punctuation">(</span>     <span class="token operator">/</span>   Amazon Linux 2 AMI
      ___<span class="token punctuation">|</span>\___<span class="token punctuation">|</span>___<span class="token punctuation">|</span>

https:<span class="token operator">/</span><span class="token operator">/</span>aws<span class="token punctuation">.</span>amazon<span class="token punctuation">.</span>com/amazon-linux-2/
<span class="token namespace">[ec2-user@ip-10-0-2-42 ~]</span>$</code></pre><p>이 상태에서 윈도우 터미널이 아닌 Git Bash에서도 시도를 하면 다음과 같이 다시 키 형식이 올바르지 않다는 문제가 발생하게 됩니다.</p><pre class="language-sh" data-language="sh"><code class="language-sh">$ ssh -i aws-mambo.pem ec2-user@3.34.188.47
Load key &quot;aws-mambo.pem&quot;: invalid format
ec2-user@3.34.188.47: Permission denied (publickey,gssapi-keyex,gssapi-with-mic).</code></pre><p>이때는 CRLF로 되어있던 개행 형식을 LF로 변경하면 성공적으로 접속됨을 확인할 수 있습니다.</p><pre class="language-sh" data-language="sh"><code class="language-sh">$ ssh -i aws-mambo.pem ec2-user@3.34.188.47

       __|  __|_  )
       _|  (     &#x2F;   Amazon Linux 2 AMI
      ___|\___|___|

https:&#x2F;&#x2F;aws.amazon.com&#x2F;amazon-linux-2&#x2F;
[ec2-user@ip-10-0-2-42 ~]$</code></pre><p>이렇게 SSH 키 페어를 발급하고 원격 호스트에 연결하는 과정에 대해서 알아보았고 지난 글에서 경험했던 문제에 대해서 다시한번 살펴보며 원인을 찾아보는 경험도 해보았습니다. 감사합니다.</p><h2 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h2><ul><li><a target="_blank" rel="noopener" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AccessingInstancesLinux.html">Connect to your Linux instance using SSH</a></li><li><a target="_blank" rel="noopener" href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh">Connecting to GitHub with SSH</a></li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/SSH/" rel="tag"># SSH</a> <a href="/tags/Key-Pair/" rel="tag"># Key Pair</a> <a href="/tags/RSA/" rel="tag"># RSA</a> <a href="/tags/ED25519/" rel="tag"># ED25519</a></div><div class="post-nav"><div class="post-nav-item"><a href="/network/" rel="prev" title="개발자가 알아야할 네트워크 지식"><i class="fa fa-chevron-left"></i> 개발자가 알아야할 네트워크 지식</a></div><div class="post-nav-item"><a href="/sha-256/" rel="next" title="SHA-256">SHA-256 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments"><script src="https://utteranc.es/client.js" repo="kdevkr/kdevkr.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Mambo</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a></div></div></footer><script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script><script src="/js/third-party/fancybox.js"></script><script src="/js/third-party/pace.js"></script><script src="https://unpkg.com/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script><script>var options={bottom:"unset",right:"15px",left:"unset",time:"0.5s",mixColor:"transparent",backgroundColor:"transparent",buttonColorDark:"#100f2c",buttonColorLight:"#fff",saveInCookies:!0,label:"🌗",autoMatchOsTheme:!0};const darkmode=new Darkmode(options);window.darkmode=darkmode,darkmode.showWidget()</script></body></html>